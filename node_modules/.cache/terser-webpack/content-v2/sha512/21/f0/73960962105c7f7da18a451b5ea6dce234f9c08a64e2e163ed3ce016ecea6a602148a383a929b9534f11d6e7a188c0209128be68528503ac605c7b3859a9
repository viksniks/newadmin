{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{\"/6Yf\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"Component\",(function(){return Component})),__webpack_require__.d(__webpack_exports__,\"ComponentContainer\",(function(){return ComponentContainer})),__webpack_require__.d(__webpack_exports__,\"Provider\",(function(){return Provider}));var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(\"mrSG\"),_firebase_util__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(\"qOnz\"),Component=function(){function Component(name,instanceFactory,type){this.name=name,this.instanceFactory=instanceFactory,this.type=type,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode=\"LAZY\",this.onInstanceCreated=null}return Component.prototype.setInstantiationMode=function(mode){return this.instantiationMode=mode,this},Component.prototype.setMultipleInstances=function(multipleInstances){return this.multipleInstances=multipleInstances,this},Component.prototype.setServiceProps=function(props){return this.serviceProps=props,this},Component.prototype.setInstanceCreatedCallback=function(callback){return this.onInstanceCreated=callback,this},Component}(),Provider=function(){function Provider(name,container){this.name=name,this.container=container,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Set}return Provider.prototype.get=function(identifier){void 0===identifier&&(identifier=\"[DEFAULT]\");var normalizedIdentifier=this.normalizeInstanceIdentifier(identifier);if(!this.instancesDeferred.has(normalizedIdentifier)){var deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_1__.Deferred;if(this.instancesDeferred.set(normalizedIdentifier,deferred),this.isInitialized(normalizedIdentifier)||this.shouldAutoInitialize())try{var instance=this.getOrInitializeService({instanceIdentifier:normalizedIdentifier});instance&&deferred.resolve(instance)}catch(e){}}return this.instancesDeferred.get(normalizedIdentifier).promise},Provider.prototype.getImmediate=function(options){var _a=Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({identifier:\"[DEFAULT]\",optional:!1},options),optional=_a.optional,normalizedIdentifier=this.normalizeInstanceIdentifier(_a.identifier);if(!this.isInitialized(normalizedIdentifier)&&!this.shouldAutoInitialize()){if(optional)return null;throw Error(\"Service \"+this.name+\" is not available\")}try{return this.getOrInitializeService({instanceIdentifier:normalizedIdentifier})}catch(e){if(optional)return null;throw e}},Provider.prototype.getComponent=function(){return this.component},Provider.prototype.setComponent=function(component){var e_1,_a;if(component.name!==this.name)throw Error(\"Mismatching Component \"+component.name+\" for Provider \"+this.name+\".\");if(this.component)throw Error(\"Component for \"+this.name+\" has already been provided\");if(this.component=component,this.shouldAutoInitialize()){if(function(component){return\"EAGER\"===component.instantiationMode}(component))try{this.getOrInitializeService({instanceIdentifier:\"[DEFAULT]\"})}catch(e){}try{for(var _b=Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(this.instancesDeferred.entries()),_c=_b.next();!_c.done;_c=_b.next()){var _d=Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(_c.value,2),instanceDeferred=_d[1],normalizedIdentifier=this.normalizeInstanceIdentifier(_d[0]);try{var instance=this.getOrInitializeService({instanceIdentifier:normalizedIdentifier});instanceDeferred.resolve(instance)}catch(e){}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}}},Provider.prototype.clearInstance=function(identifier){void 0===identifier&&(identifier=\"[DEFAULT]\"),this.instancesDeferred.delete(identifier),this.instances.delete(identifier)},Provider.prototype.delete=function(){return Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this,void 0,void 0,(function(){var services;return Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this,(function(_a){switch(_a.label){case 0:return services=Array.from(this.instances.values()),[4,Promise.all(Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)(Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([],Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(services.filter((function(service){return\"INTERNAL\"in service})).map((function(service){return service.INTERNAL.delete()})))),Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(services.filter((function(service){return\"_delete\"in service})).map((function(service){return service._delete()})))))];case 1:return _a.sent(),[2]}}))}))},Provider.prototype.isComponentSet=function(){return null!=this.component},Provider.prototype.isInitialized=function(identifier){return void 0===identifier&&(identifier=\"[DEFAULT]\"),this.instances.has(identifier)},Provider.prototype.initialize=function(opts){var e_2,_a;void 0===opts&&(opts={});var _b=opts.instanceIdentifier,_c=opts.options,options=void 0===_c?{}:_c,normalizedIdentifier=this.normalizeInstanceIdentifier(void 0===_b?\"[DEFAULT]\":_b);if(this.isInitialized(normalizedIdentifier))throw Error(this.name+\"(\"+normalizedIdentifier+\") has already been initialized\");if(!this.isComponentSet())throw Error(\"Component \"+this.name+\" has not been registered yet\");var instance=this.getOrInitializeService({instanceIdentifier:normalizedIdentifier,options:options});try{for(var _d=Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(this.instancesDeferred.entries()),_e=_d.next();!_e.done;_e=_d.next()){var _f=Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(_e.value,2),instanceDeferred=_f[1];normalizedIdentifier===this.normalizeInstanceIdentifier(_f[0])&&instanceDeferred.resolve(instance)}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_e&&!_e.done&&(_a=_d.return)&&_a.call(_d)}finally{if(e_2)throw e_2.error}}return this.invokeOnInitCallbacks(instance,normalizedIdentifier),instance},Provider.prototype.onInit=function(callback){var _this=this;return this.onInitCallbacks.add(callback),function(){_this.onInitCallbacks.delete(callback)}},Provider.prototype.invokeOnInitCallbacks=function(instance,identifier){var e_3,_a;try{for(var _b=Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(this.onInitCallbacks),_c=_b.next();!_c.done;_c=_b.next()){var callback=_c.value;try{callback(instance,identifier)}catch(_d){}}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_3)throw e_3.error}}},Provider.prototype.getOrInitializeService=function(_a){var identifier,instanceIdentifier=_a.instanceIdentifier,_b=_a.options,options=void 0===_b?{}:_b,instance=this.instances.get(instanceIdentifier);if(!instance&&this.component&&(instance=this.component.instanceFactory(this.container,{instanceIdentifier:(identifier=instanceIdentifier,\"[DEFAULT]\"===identifier?void 0:identifier),options:options}),this.instances.set(instanceIdentifier,instance),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,instanceIdentifier,instance)}catch(_c){}return instance||null},Provider.prototype.normalizeInstanceIdentifier=function(identifier){return this.component?this.component.multipleInstances?identifier:\"[DEFAULT]\":identifier},Provider.prototype.shouldAutoInitialize=function(){return!!this.component&&\"EXPLICIT\"!==this.component.instantiationMode},Provider}(),ComponentContainer=function(){function ComponentContainer(name){this.name=name,this.providers=new Map}return ComponentContainer.prototype.addComponent=function(component){var provider=this.getProvider(component.name);if(provider.isComponentSet())throw new Error(\"Component \"+component.name+\" has already been registered with \"+this.name);provider.setComponent(component)},ComponentContainer.prototype.addOrOverwriteComponent=function(component){this.getProvider(component.name).isComponentSet()&&this.providers.delete(component.name),this.addComponent(component)},ComponentContainer.prototype.getProvider=function(name){if(this.providers.has(name))return this.providers.get(name);var provider=new Provider(name,this);return this.providers.set(name,provider),provider},ComponentContainer.prototype.getProviders=function(){return Array.from(this.providers.values())},ComponentContainer}()},\"3UD+\":function(module,exports){module.exports=function(originalModule){if(!originalModule.webpackPolyfill){var module=Object.create(originalModule);module.children||(module.children=[]),Object.defineProperty(module,\"loaded\",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,\"id\",{enumerable:!0,get:function(){return module.i}}),Object.defineProperty(module,\"exports\",{enumerable:!0}),module.webpackPolyfill=1}return module}},\"6Uf2\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";(function(module){var _firebase_app__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(\"zIRd\"),_firebase_component__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(\"/6Yf\"),_firebase_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(\"qOnz\"),tslib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(\"mrSG\"),_firebase_logger__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(\"q/0M\"),SDK_VERSION=\"\";function setSDKVersion(version){SDK_VERSION=version}var id,DOMStorageWrapper=function(){function DOMStorageWrapper(domStorage_){this.domStorage_=domStorage_,this.prefix_=\"firebase:\"}return DOMStorageWrapper.prototype.set=function(key,value){null==value?this.domStorage_.removeItem(this.prefixedName_(key)):this.domStorage_.setItem(this.prefixedName_(key),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(value))},DOMStorageWrapper.prototype.get=function(key){var storedVal=this.domStorage_.getItem(this.prefixedName_(key));return null==storedVal?null:Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.jsonEval)(storedVal)},DOMStorageWrapper.prototype.remove=function(key){this.domStorage_.removeItem(this.prefixedName_(key))},DOMStorageWrapper.prototype.prefixedName_=function(name){return this.prefix_+name},DOMStorageWrapper.prototype.toString=function(){return this.domStorage_.toString()},DOMStorageWrapper}(),MemoryStorage=function(){function MemoryStorage(){this.cache_={},this.isInMemoryStorage=!0}return MemoryStorage.prototype.set=function(key,value){null==value?delete this.cache_[key]:this.cache_[key]=value},MemoryStorage.prototype.get=function(key){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(this.cache_,key)?this.cache_[key]:null},MemoryStorage.prototype.remove=function(key){delete this.cache_[key]},MemoryStorage}(),createStoragefor=function(domStorageName){try{if(\"undefined\"!=typeof window&&void 0!==window[domStorageName]){var domStorage=window[domStorageName];return domStorage.setItem(\"firebase:sentinel\",\"cache\"),domStorage.removeItem(\"firebase:sentinel\"),new DOMStorageWrapper(domStorage)}}catch(e){}return new MemoryStorage},PersistentStorage=createStoragefor(\"localStorage\"),SessionStorage=createStoragefor(\"sessionStorage\"),logClient=new _firebase_logger__WEBPACK_IMPORTED_MODULE_4__.Logger(\"@firebase/database\"),LUIDGenerator=(id=1,function(){return id++}),sha1=function(str){var utf8Bytes=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringToByteArray)(str),sha1=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Sha1;sha1.update(utf8Bytes);var sha1Bytes=sha1.digest();return _firebase_util__WEBPACK_IMPORTED_MODULE_2__.base64.encodeByteArray(sha1Bytes)},buildLogMessage_=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];for(var message=\"\",i=0;i<varArgs.length;i++){var arg=varArgs[i];Array.isArray(arg)||arg&&\"object\"==typeof arg&&\"number\"==typeof arg.length?message+=buildLogMessage_.apply(null,arg):message+=\"object\"==typeof arg?Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(arg):arg,message+=\" \"}return message},logger=null,firstLog_=!0,enableLogging=function(logger_,persistent){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!persistent||!0===logger_||!1===logger_,\"Can't turn on custom loggers persistently.\"),!0===logger_?(logClient.logLevel=_firebase_logger__WEBPACK_IMPORTED_MODULE_4__.LogLevel.VERBOSE,logger=logClient.log.bind(logClient),persistent&&SessionStorage.set(\"logging_enabled\",!0)):\"function\"==typeof logger_?logger=logger_:(logger=null,SessionStorage.remove(\"logging_enabled\"))},log=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];if(!0===firstLog_&&(firstLog_=!1,null===logger&&!0===SessionStorage.get(\"logging_enabled\")&&enableLogging(!0)),logger){var message=buildLogMessage_.apply(null,varArgs);logger(message)}},logWrapper=function(prefix){return function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];log.apply(void 0,Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__spreadArray)([prefix],Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__read)(varArgs)))}},error=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];var message=\"FIREBASE INTERNAL ERROR: \"+buildLogMessage_.apply(void 0,Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__spreadArray)([],Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__read)(varArgs)));logClient.error(message)},fatal=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];var message=\"FIREBASE FATAL ERROR: \"+buildLogMessage_.apply(void 0,Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__spreadArray)([],Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__read)(varArgs)));throw logClient.error(message),new Error(message)},warn=function(){for(var varArgs=[],_i=0;_i<arguments.length;_i++)varArgs[_i]=arguments[_i];var message=\"FIREBASE WARNING: \"+buildLogMessage_.apply(void 0,Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__spreadArray)([],Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__read)(varArgs)));logClient.warn(message)},isInvalidJSONNumber=function(data){return\"number\"==typeof data&&(data!=data||data===Number.POSITIVE_INFINITY||data===Number.NEGATIVE_INFINITY)},MIN_NAME=\"[MIN_NAME]\",MAX_NAME=\"[MAX_NAME]\",nameCompare=function(a,b){if(a===b)return 0;if(a===MIN_NAME||b===MAX_NAME)return-1;if(b===MIN_NAME||a===MAX_NAME)return 1;var aAsInt=tryParseInt(a),bAsInt=tryParseInt(b);return null!==aAsInt?null!==bAsInt?aAsInt-bAsInt==0?a.length-b.length:aAsInt-bAsInt:-1:null!==bAsInt?1:a<b?-1:1},stringCompare=function(a,b){return a===b?0:a<b?-1:1},requireKey=function(key,obj){if(obj&&key in obj)return obj[key];throw new Error(\"Missing required key (\"+key+\") in object: \"+Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(obj))},ObjectToUniqueKey=function(obj){if(\"object\"!=typeof obj||null===obj)return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(obj);var keys=[];for(var k in obj)keys.push(k);keys.sort();for(var key=\"{\",i=0;i<keys.length;i++)0!==i&&(key+=\",\"),key+=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(keys[i]),key+=\":\",key+=ObjectToUniqueKey(obj[keys[i]]);return key+\"}\"},splitStringBySize=function(str,segsize){var len=str.length;if(len<=segsize)return[str];for(var dataSegs=[],c=0;c<len;c+=segsize)dataSegs.push(str.substring(c,c+segsize>len?len:c+segsize));return dataSegs};function each(obj,fn){for(var key in obj)obj.hasOwnProperty(key)&&fn(key,obj[key])}var doubleToIEEE754String=function(v){var s,e,f,ln,i;Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!isInvalidJSONNumber(v),\"Invalid JSON number\"),0===v?(e=0,f=0,s=1/v==-1/0?1:0):(s=v<0,(v=Math.abs(v))>=Math.pow(2,-1022)?(e=(ln=Math.min(Math.floor(Math.log(v)/Math.LN2),1023))+1023,f=Math.round(v*Math.pow(2,52-ln)-Math.pow(2,52))):(e=0,f=Math.round(v/Math.pow(2,-1074))));var bits=[];for(i=52;i;i-=1)bits.push(f%2?1:0),f=Math.floor(f/2);for(i=11;i;i-=1)bits.push(e%2?1:0),e=Math.floor(e/2);bits.push(s?1:0),bits.reverse();var str=bits.join(\"\"),hexByteString=\"\";for(i=0;i<64;i+=8){var hexByte=parseInt(str.substr(i,8),2).toString(16);1===hexByte.length&&(hexByte=\"0\"+hexByte),hexByteString+=hexByte}return hexByteString.toLowerCase()},INTEGER_REGEXP_=new RegExp(\"^-?(0*)\\\\d{1,10}$\"),tryParseInt=function(str){if(INTEGER_REGEXP_.test(str)){var intVal=Number(str);if(intVal>=-2147483648&&intVal<=2147483647)return intVal}return null},exceptionGuard=function(fn){try{fn()}catch(e){setTimeout((function(){throw warn(\"Exception was thrown by user callback.\",e.stack||\"\"),e}),Math.floor(0))}},setTimeoutNonBlocking=function(fn,time){var timeout=setTimeout(fn,time);return\"object\"==typeof timeout&&timeout.unref&&timeout.unref(),timeout},AppCheckTokenProvider=function(){function AppCheckTokenProvider(appName_,appCheckProvider){var _this=this;this.appName_=appName_,this.appCheckProvider=appCheckProvider,this.appCheck=null==appCheckProvider?void 0:appCheckProvider.getImmediate({optional:!0}),this.appCheck||null==appCheckProvider||appCheckProvider.get().then((function(appCheck){return _this.appCheck=appCheck}))}return AppCheckTokenProvider.prototype.getToken=function(forceRefresh){var _this=this;return this.appCheck?this.appCheck.getToken(forceRefresh):new Promise((function(resolve,reject){setTimeout((function(){_this.appCheck?_this.getToken(forceRefresh).then(resolve,reject):resolve(null)}),0)}))},AppCheckTokenProvider.prototype.addTokenChangeListener=function(listener){var _a;null===(_a=this.appCheckProvider)||void 0===_a||_a.get().then((function(appCheck){return appCheck.addTokenListener(listener)}))},AppCheckTokenProvider.prototype.notifyForInvalidToken=function(){warn('Provided AppCheck credentials for the app named \"'+this.appName_+'\" are invalid. This usually indicates your app was not initialized correctly.')},AppCheckTokenProvider}(),FirebaseAuthTokenProvider=function(){function FirebaseAuthTokenProvider(appName_,firebaseOptions_,authProvider_){var _this=this;this.appName_=appName_,this.firebaseOptions_=firebaseOptions_,this.authProvider_=authProvider_,this.auth_=null,this.auth_=authProvider_.getImmediate({optional:!0}),this.auth_||authProvider_.onInit((function(auth){return _this.auth_=auth}))}return FirebaseAuthTokenProvider.prototype.getToken=function(forceRefresh){var _this=this;return this.auth_?this.auth_.getToken(forceRefresh).catch((function(error){return error&&\"auth/token-not-initialized\"===error.code?(log(\"Got auth/token-not-initialized error.  Treating as null token.\"),null):Promise.reject(error)})):new Promise((function(resolve,reject){setTimeout((function(){_this.auth_?_this.getToken(forceRefresh).then(resolve,reject):resolve(null)}),0)}))},FirebaseAuthTokenProvider.prototype.addTokenChangeListener=function(listener){this.auth_?this.auth_.addAuthTokenListener(listener):this.authProvider_.get().then((function(auth){return auth.addAuthTokenListener(listener)}))},FirebaseAuthTokenProvider.prototype.removeTokenChangeListener=function(listener){this.authProvider_.get().then((function(auth){return auth.removeAuthTokenListener(listener)}))},FirebaseAuthTokenProvider.prototype.notifyForInvalidToken=function(){var errorMessage='Provided authentication credentials for the app named \"'+this.appName_+'\" are invalid. This usually indicates your app was not initialized correctly. ';warn(errorMessage+=\"credential\"in this.firebaseOptions_?'Make sure the \"credential\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.':\"serviceAccount\"in this.firebaseOptions_?'Make sure the \"serviceAccount\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.':'Make sure the \"apiKey\" and \"databaseURL\" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.')},FirebaseAuthTokenProvider}(),EmulatorTokenProvider=function(){function EmulatorTokenProvider(accessToken){this.accessToken=accessToken}return EmulatorTokenProvider.prototype.getToken=function(forceRefresh){return Promise.resolve({accessToken:this.accessToken})},EmulatorTokenProvider.prototype.addTokenChangeListener=function(listener){listener(this.accessToken)},EmulatorTokenProvider.prototype.removeTokenChangeListener=function(listener){},EmulatorTokenProvider.prototype.notifyForInvalidToken=function(){},EmulatorTokenProvider.OWNER=\"owner\",EmulatorTokenProvider}(),FORGE_DOMAIN_RE=/(console\\.firebase|firebase-console-\\w+\\.corp|firebase\\.corp)\\.google\\.com/,RepoInfo=function(){function RepoInfo(host,secure,namespace,webSocketOnly,nodeAdmin,persistenceKey,includeNamespaceInQueryParams){void 0===nodeAdmin&&(nodeAdmin=!1),void 0===persistenceKey&&(persistenceKey=\"\"),void 0===includeNamespaceInQueryParams&&(includeNamespaceInQueryParams=!1),this.secure=secure,this.namespace=namespace,this.webSocketOnly=webSocketOnly,this.nodeAdmin=nodeAdmin,this.persistenceKey=persistenceKey,this.includeNamespaceInQueryParams=includeNamespaceInQueryParams,this._host=host.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(\".\")+1),this.internalHost=PersistentStorage.get(\"host:\"+host)||this._host}return RepoInfo.prototype.isCacheableHost=function(){return\"s-\"===this.internalHost.substr(0,2)},RepoInfo.prototype.isCustomHost=function(){return\"firebaseio.com\"!==this._domain&&\"firebaseio-demo.com\"!==this._domain},Object.defineProperty(RepoInfo.prototype,\"host\",{get:function(){return this._host},set:function(newHost){newHost!==this.internalHost&&(this.internalHost=newHost,this.isCacheableHost()&&PersistentStorage.set(\"host:\"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),RepoInfo.prototype.toString=function(){var str=this.toURLString();return this.persistenceKey&&(str+=\"<\"+this.persistenceKey+\">\"),str},RepoInfo.prototype.toURLString=function(){return(this.secure?\"https://\":\"http://\")+this.host+\"/\"+(this.includeNamespaceInQueryParams?\"?ns=\"+this.namespace:\"\")},RepoInfo}();function repoInfoConnectionURL(repoInfo,type,params){var connURL;if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\"string\"==typeof type,\"typeof type must == string\"),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\"object\"==typeof params,\"typeof params must == object\"),\"websocket\"===type)connURL=(repoInfo.secure?\"wss://\":\"ws://\")+repoInfo.internalHost+\"/.ws?\";else{if(\"long_polling\"!==type)throw new Error(\"Unknown connection type: \"+type);connURL=(repoInfo.secure?\"https://\":\"http://\")+repoInfo.internalHost+\"/.lp?\"}(function(repoInfo){return repoInfo.host!==repoInfo.internalHost||repoInfo.isCustomHost()||repoInfo.includeNamespaceInQueryParams})(repoInfo)&&(params.ns=repoInfo.namespace);var pairs=[];return each(params,(function(key,value){pairs.push(key+\"=\"+value)})),connURL+pairs.join(\"&\")}var StatsCollection=function(){function StatsCollection(){this.counters_={}}return StatsCollection.prototype.incrementCounter=function(name,amount){void 0===amount&&(amount=1),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(this.counters_,name)||(this.counters_[name]=0),this.counters_[name]+=amount},StatsCollection.prototype.get=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.deepCopy)(this.counters_)},StatsCollection}(),collections={},reporters={};function statsManagerGetCollection(repoInfo){var hashString=repoInfo.toString();return collections[hashString]||(collections[hashString]=new StatsCollection),collections[hashString]}var PacketReceiver=function(){function PacketReceiver(onMessage_){this.onMessage_=onMessage_,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return PacketReceiver.prototype.closeAfter=function(responseNum,callback){this.closeAfterResponse=responseNum,this.onClose=callback,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},PacketReceiver.prototype.handleResponse=function(requestNum,data){var _this=this;this.pendingResponses[requestNum]=data;for(var _loop_1=function(){var toProcess=this_1.pendingResponses[this_1.currentResponseNum];delete this_1.pendingResponses[this_1.currentResponseNum];for(var _loop_2=function(i){toProcess[i]&&exceptionGuard((function(){_this.onMessage_(toProcess[i])}))},i=0;i<toProcess.length;++i)_loop_2(i);if(this_1.currentResponseNum===this_1.closeAfterResponse)return this_1.onClose&&(this_1.onClose(),this_1.onClose=null),\"break\";this_1.currentResponseNum++},this_1=this;this.pendingResponses[this.currentResponseNum]&&\"break\"!==_loop_1(););},PacketReceiver}(),BrowserPollConnection=function(){function BrowserPollConnection(connId,repoInfo,applicationId,appCheckToken,authToken,transportSessionId,lastSessionId){var _this=this;this.connId=connId,this.repoInfo=repoInfo,this.applicationId=applicationId,this.appCheckToken=appCheckToken,this.authToken=authToken,this.transportSessionId=transportSessionId,this.lastSessionId=lastSessionId,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(connId),this.stats_=statsManagerGetCollection(repoInfo),this.urlFn=function(params){return _this.appCheckToken&&(params.ac=_this.appCheckToken),repoInfoConnectionURL(repoInfo,\"long_polling\",params)}}return BrowserPollConnection.prototype.open=function(onMessage,onDisconnect){var _this=this;this.curSegmentNum=0,this.onDisconnect_=onDisconnect,this.myPacketOrderer=new PacketReceiver(onMessage),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){_this.log_(\"Timed out trying to connect.\"),_this.onClosed_(),_this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(fn){if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isNodeSdk)()||\"complete\"===document.readyState)fn();else{var called_1=!1,wrappedFn_1=function(){document.body?called_1||(called_1=!0,fn()):setTimeout(wrappedFn_1,Math.floor(10))};document.addEventListener?(document.addEventListener(\"DOMContentLoaded\",wrappedFn_1,!1),window.addEventListener(\"load\",wrappedFn_1,!1)):document.attachEvent&&(document.attachEvent(\"onreadystatechange\",(function(){\"complete\"===document.readyState&&wrappedFn_1()})),window.attachEvent(\"onload\",wrappedFn_1))}}((function(){if(!_this.isClosed_){_this.scriptTagHolder=new FirebaseIFrameScriptHolder((function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var _a=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__read)(args,5),command=_a[0],arg1=_a[1],arg2=_a[2];if(_this.incrementIncomingBytes_(args),_this.scriptTagHolder)if(_this.connectTimeoutTimer_&&(clearTimeout(_this.connectTimeoutTimer_),_this.connectTimeoutTimer_=null),_this.everConnected_=!0,\"start\"===command)_this.id=arg1,_this.password=arg2;else{if(\"close\"!==command)throw new Error(\"Unrecognized command received: \"+command);arg1?(_this.scriptTagHolder.sendNewPolls=!1,_this.myPacketOrderer.closeAfter(arg1,(function(){_this.onClosed_()}))):_this.onClosed_()}}),(function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var _a=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__read)(args,2),pN=_a[0],data=_a[1];_this.incrementIncomingBytes_(args),_this.myPacketOrderer.handleResponse(pN,data)}),(function(){_this.onClosed_()}),_this.urlFn);var urlParams={start:\"t\"};urlParams.ser=Math.floor(1e8*Math.random()),_this.scriptTagHolder.uniqueCallbackIdentifier&&(urlParams.cb=_this.scriptTagHolder.uniqueCallbackIdentifier),urlParams.v=\"5\",_this.transportSessionId&&(urlParams.s=_this.transportSessionId),_this.lastSessionId&&(urlParams.ls=_this.lastSessionId),_this.applicationId&&(urlParams.p=_this.applicationId),_this.appCheckToken&&(urlParams.ac=_this.appCheckToken),\"undefined\"!=typeof location&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(urlParams.r=\"f\");var connectURL=_this.urlFn(urlParams);_this.log_(\"Connecting via long-poll to \"+connectURL),_this.scriptTagHolder.addTag(connectURL,(function(){}))}}))},BrowserPollConnection.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},BrowserPollConnection.forceAllow=function(){BrowserPollConnection.forceAllow_=!0},BrowserPollConnection.forceDisallow=function(){BrowserPollConnection.forceDisallow_=!0},BrowserPollConnection.isAvailable=function(){return!(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isNodeSdk)()||!BrowserPollConnection.forceAllow_&&(BrowserPollConnection.forceDisallow_||\"undefined\"==typeof document||null==document.createElement||\"object\"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||\"object\"==typeof Windows&&\"object\"==typeof Windows.UI))},BrowserPollConnection.prototype.markConnectionHealthy=function(){},BrowserPollConnection.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},BrowserPollConnection.prototype.onClosed_=function(){this.isClosed_||(this.log_(\"Longpoll is closing itself\"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},BrowserPollConnection.prototype.close=function(){this.isClosed_||(this.log_(\"Longpoll is being closed.\"),this.shutdown_())},BrowserPollConnection.prototype.send=function(data){var dataStr=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(data);this.bytesSent+=dataStr.length,this.stats_.incrementCounter(\"bytes_sent\",dataStr.length);for(var base64data=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.base64Encode)(dataStr),dataSegs=splitStringBySize(base64data,1840),i=0;i<dataSegs.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,dataSegs.length,dataSegs[i]),this.curSegmentNum++},BrowserPollConnection.prototype.addDisconnectPingFrame=function(id,pw){if(!Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isNodeSdk)()){this.myDisconnFrame=document.createElement(\"iframe\");var urlParams={dframe:\"t\"};urlParams.id=id,urlParams.pw=pw,this.myDisconnFrame.src=this.urlFn(urlParams),this.myDisconnFrame.style.display=\"none\",document.body.appendChild(this.myDisconnFrame)}},BrowserPollConnection.prototype.incrementIncomingBytes_=function(args){var bytesReceived=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(args).length;this.bytesReceived+=bytesReceived,this.stats_.incrementCounter(\"bytes_received\",bytesReceived)},BrowserPollConnection}(),FirebaseIFrameScriptHolder=function(){function FirebaseIFrameScriptHolder(commandCB,onMessageCB,onDisconnect,urlFn){if(this.onDisconnect=onDisconnect,this.urlFn=urlFn,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isNodeSdk)())this.commandCB=commandCB,this.onMessageCB=onMessageCB;else{this.uniqueCallbackIdentifier=LUIDGenerator(),window[\"pLPCommand\"+this.uniqueCallbackIdentifier]=commandCB,window[\"pRTLPCB\"+this.uniqueCallbackIdentifier]=onMessageCB,this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();var script=\"\";this.myIFrame.src&&\"javascript:\"===this.myIFrame.src.substr(0,\"javascript:\".length)&&(script='<script>document.domain=\"'+document.domain+'\";<\\/script>');var iframeContents=\"<html><body>\"+script+\"</body></html>\";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(iframeContents),this.myIFrame.doc.close()}catch(e){log(\"frame writing exception\"),e.stack&&log(e.stack),log(e)}}}return FirebaseIFrameScriptHolder.createIFrame_=function(){var iframe=document.createElement(\"iframe\");if(iframe.style.display=\"none\",!document.body)throw\"Document body has not initialized. Wait to initialize Firebase until after the document is ready.\";document.body.appendChild(iframe);try{iframe.contentWindow.document||log(\"No IE domain setting required\")}catch(e){var domain=document.domain;iframe.src=\"javascript:void((function(){document.open();document.domain='\"+domain+\"';document.close();})())\"}return iframe.contentDocument?iframe.doc=iframe.contentDocument:iframe.contentWindow?iframe.doc=iframe.contentWindow.document:iframe.document&&(iframe.doc=iframe.document),iframe},FirebaseIFrameScriptHolder.prototype.close=function(){var _this=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML=\"\",setTimeout((function(){null!==_this.myIFrame&&(document.body.removeChild(_this.myIFrame),_this.myIFrame=null)}),Math.floor(0)));var onDisconnect=this.onDisconnect;onDisconnect&&(this.onDisconnect=null,onDisconnect())},FirebaseIFrameScriptHolder.prototype.startLongPoll=function(id,pw){for(this.myID=id,this.myPW=pw,this.alive=!0;this.newRequest_(););},FirebaseIFrameScriptHolder.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var urlParams={};urlParams.id=this.myID,urlParams.pw=this.myPW,urlParams.ser=this.currentSerial;for(var theURL=this.urlFn(urlParams),curDataString=\"\",i=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+curDataString.length<=1870;){var theSeg=this.pendingSegs.shift();curDataString=curDataString+\"&seg\"+i+\"=\"+theSeg.seg+\"&ts\"+i+\"=\"+theSeg.ts+\"&d\"+i+\"=\"+theSeg.d,i++}return this.addLongPollTag_(theURL+=curDataString,this.currentSerial),!0}return!1},FirebaseIFrameScriptHolder.prototype.enqueueSegment=function(segnum,totalsegs,data){this.pendingSegs.push({seg:segnum,ts:totalsegs,d:data}),this.alive&&this.newRequest_()},FirebaseIFrameScriptHolder.prototype.addLongPollTag_=function(url,serial){var _this=this;this.outstandingRequests.add(serial);var doNewRequest=function(){_this.outstandingRequests.delete(serial),_this.newRequest_()},keepaliveTimeout=setTimeout(doNewRequest,Math.floor(25e3));this.addTag(url,(function(){clearTimeout(keepaliveTimeout),doNewRequest()}))},FirebaseIFrameScriptHolder.prototype.addTag=function(url,loadCB){var _this=this;Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isNodeSdk)()?this.doNodeLongPoll(url,loadCB):setTimeout((function(){try{if(!_this.sendNewPolls)return;var newScript_1=_this.myIFrame.doc.createElement(\"script\");newScript_1.type=\"text/javascript\",newScript_1.async=!0,newScript_1.src=url,newScript_1.onload=newScript_1.onreadystatechange=function(){var rstate=newScript_1.readyState;rstate&&\"loaded\"!==rstate&&\"complete\"!==rstate||(newScript_1.onload=newScript_1.onreadystatechange=null,newScript_1.parentNode&&newScript_1.parentNode.removeChild(newScript_1),loadCB())},newScript_1.onerror=function(){log(\"Long-poll script failed to load: \"+url),_this.sendNewPolls=!1,_this.close()},_this.myIFrame.doc.body.appendChild(newScript_1)}catch(e){}}),Math.floor(1))},FirebaseIFrameScriptHolder}(),WebSocketImpl=null;\"undefined\"!=typeof MozWebSocket?WebSocketImpl=MozWebSocket:\"undefined\"!=typeof WebSocket&&(WebSocketImpl=WebSocket);var WebSocketConnection=function(){function WebSocketConnection(connId,repoInfo,applicationId,appCheckToken,authToken,transportSessionId,lastSessionId){this.connId=connId,this.applicationId=applicationId,this.appCheckToken=appCheckToken,this.authToken=authToken,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=statsManagerGetCollection(repoInfo),this.connURL=WebSocketConnection.connectionURL_(repoInfo,transportSessionId,lastSessionId,appCheckToken),this.nodeAdmin=repoInfo.nodeAdmin}return WebSocketConnection.connectionURL_=function(repoInfo,transportSessionId,lastSessionId,appCheckToken){var urlParams={v:\"5\"};return!Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isNodeSdk)()&&\"undefined\"!=typeof location&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(urlParams.r=\"f\"),transportSessionId&&(urlParams.s=transportSessionId),lastSessionId&&(urlParams.ls=lastSessionId),appCheckToken&&(urlParams.ac=appCheckToken),repoInfoConnectionURL(repoInfo,\"websocket\",urlParams)},WebSocketConnection.prototype.open=function(onMessage,onDisconnect){var _this=this;this.onDisconnect=onDisconnect,this.onMessage=onMessage,this.log_(\"Websocket connecting to \"+this.connURL),this.everConnected_=!1,PersistentStorage.set(\"previous_websocket_failure\",!0);try{if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isNodeSdk)()){var options={headers:{\"User-Agent\":\"Firebase/5/\"+SDK_VERSION+\"/\"+process.platform+\"/\"+(this.nodeAdmin?\"AdminNode\":\"Node\"),\"X-Firebase-GMPID\":this.applicationId||\"\"}};this.nodeAdmin?options.headers.Authorization=this.authToken||\"\":options.headers[\"X-Firebase-AppCheck\"]=this.appCheckToken||\"\";var env=process.env,proxy=0===this.connURL.indexOf(\"wss://\")?env.HTTPS_PROXY||env.https_proxy:env.HTTP_PROXY||env.http_proxy;proxy&&(options.proxy={origin:proxy}),this.mySock=new WebSocketImpl(this.connURL,[],options)}else this.mySock=new WebSocketImpl(this.connURL,[],options={headers:{\"X-Firebase-GMPID\":this.applicationId||\"\",\"X-Firebase-AppCheck\":this.appCheckToken||\"\"}})}catch(e){this.log_(\"Error instantiating WebSocket.\");var error=e.message||e.data;return error&&this.log_(error),void this.onClosed_()}this.mySock.onopen=function(){_this.log_(\"Websocket connected.\"),_this.everConnected_=!0},this.mySock.onclose=function(){_this.log_(\"Websocket connection was disconnected.\"),_this.mySock=null,_this.onClosed_()},this.mySock.onmessage=function(m){_this.handleIncomingFrame(m)},this.mySock.onerror=function(e){_this.log_(\"WebSocket error.  Closing connection.\");var error=e.message||e.data;error&&_this.log_(error),_this.onClosed_()}},WebSocketConnection.prototype.start=function(){},WebSocketConnection.forceDisallow=function(){WebSocketConnection.forceDisallow_=!0},WebSocketConnection.isAvailable=function(){var isOldAndroid=!1;if(\"undefined\"!=typeof navigator&&navigator.userAgent){var oldAndroidMatch=navigator.userAgent.match(/Android ([0-9]{0,}\\.[0-9]{0,})/);oldAndroidMatch&&oldAndroidMatch.length>1&&parseFloat(oldAndroidMatch[1])<4.4&&(isOldAndroid=!0)}return!isOldAndroid&&null!==WebSocketImpl&&!WebSocketConnection.forceDisallow_},WebSocketConnection.previouslyFailed=function(){return PersistentStorage.isInMemoryStorage||!0===PersistentStorage.get(\"previous_websocket_failure\")},WebSocketConnection.prototype.markConnectionHealthy=function(){PersistentStorage.remove(\"previous_websocket_failure\")},WebSocketConnection.prototype.appendFrame_=function(data){if(this.frames.push(data),this.frames.length===this.totalFrames){var fullMess=this.frames.join(\"\");this.frames=null;var jsonMess=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.jsonEval)(fullMess);this.onMessage(jsonMess)}},WebSocketConnection.prototype.handleNewFrameCount_=function(frameCount){this.totalFrames=frameCount,this.frames=[]},WebSocketConnection.prototype.extractFrameCount_=function(data){if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(null===this.frames,\"We already have a frame buffer\"),data.length<=6){var frameCount=Number(data);if(!isNaN(frameCount))return this.handleNewFrameCount_(frameCount),null}return this.handleNewFrameCount_(1),data},WebSocketConnection.prototype.handleIncomingFrame=function(mess){if(null!==this.mySock){var data=mess.data;if(this.bytesReceived+=data.length,this.stats_.incrementCounter(\"bytes_received\",data.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(data);else{var remainingData=this.extractFrameCount_(data);null!==remainingData&&this.appendFrame_(remainingData)}}},WebSocketConnection.prototype.send=function(data){this.resetKeepAlive();var dataStr=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(data);this.bytesSent+=dataStr.length,this.stats_.incrementCounter(\"bytes_sent\",dataStr.length);var dataSegs=splitStringBySize(dataStr,16384);dataSegs.length>1&&this.sendString_(String(dataSegs.length));for(var i=0;i<dataSegs.length;i++)this.sendString_(dataSegs[i])},WebSocketConnection.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},WebSocketConnection.prototype.onClosed_=function(){this.isClosed_||(this.log_(\"WebSocket is closing itself\"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},WebSocketConnection.prototype.close=function(){this.isClosed_||(this.log_(\"WebSocket is being closed\"),this.shutdown_())},WebSocketConnection.prototype.resetKeepAlive=function(){var _this=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){_this.mySock&&_this.sendString_(\"0\"),_this.resetKeepAlive()}),Math.floor(45e3))},WebSocketConnection.prototype.sendString_=function(str){try{this.mySock.send(str)}catch(e){this.log_(\"Exception thrown from WebSocket.send():\",e.message||e.data,\"Closing connection.\"),setTimeout(this.onClosed_.bind(this),0)}},WebSocketConnection.responsesRequiredToBeHealthy=2,WebSocketConnection.healthyTimeout=3e4,WebSocketConnection}(),TransportManager=function(){function TransportManager(repoInfo){this.initTransports_(repoInfo)}return Object.defineProperty(TransportManager,\"ALL_TRANSPORTS\",{get:function(){return[BrowserPollConnection,WebSocketConnection]},enumerable:!1,configurable:!0}),TransportManager.prototype.initTransports_=function(repoInfo){var e_1,_a,isWebSocketsAvailable=WebSocketConnection&&WebSocketConnection.isAvailable(),isSkipPollConnection=isWebSocketsAvailable&&!WebSocketConnection.previouslyFailed();if(repoInfo.webSocketOnly&&(isWebSocketsAvailable||warn(\"wss:// URL used, but browser isn't known to support websockets.  Trying anyway.\"),isSkipPollConnection=!0),isSkipPollConnection)this.transports_=[WebSocketConnection];else{var transports=this.transports_=[];try{for(var _b=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__values)(TransportManager.ALL_TRANSPORTS),_c=_b.next();!_c.done;_c=_b.next()){var transport=_c.value;transport&&transport.isAvailable()&&transports.push(transport)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}}},TransportManager.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error(\"No transports available\")},TransportManager.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},TransportManager}(),Connection=function(){function Connection(id,repoInfo_,applicationId_,appCheckToken_,authToken_,onMessage_,onReady_,onDisconnect_,onKill_,lastSessionId){this.id=id,this.repoInfo_=repoInfo_,this.applicationId_=applicationId_,this.appCheckToken_=appCheckToken_,this.authToken_=authToken_,this.onMessage_=onMessage_,this.onReady_=onReady_,this.onDisconnect_=onDisconnect_,this.onKill_=onKill_,this.lastSessionId=lastSessionId,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper(\"c:\"+this.id+\":\"),this.transportManager_=new TransportManager(repoInfo_),this.log_(\"Connection created\"),this.start_()}return Connection.prototype.start_=function(){var _this=this,conn=this.transportManager_.initialTransport();this.conn_=new conn(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=conn.responsesRequiredToBeHealthy||0;var onMessageReceived=this.connReceiver_(this.conn_),onConnectionLost=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){_this.conn_&&_this.conn_.open(onMessageReceived,onConnectionLost)}),Math.floor(0));var healthyTimeoutMS=conn.healthyTimeout||0;healthyTimeoutMS>0&&(this.healthyTimeout_=setTimeoutNonBlocking((function(){_this.healthyTimeout_=null,_this.isHealthy_||(_this.conn_&&_this.conn_.bytesReceived>102400?(_this.log_(\"Connection exceeded healthy timeout but has received \"+_this.conn_.bytesReceived+\" bytes.  Marking connection healthy.\"),_this.isHealthy_=!0,_this.conn_.markConnectionHealthy()):_this.conn_&&_this.conn_.bytesSent>10240?_this.log_(\"Connection exceeded healthy timeout but has sent \"+_this.conn_.bytesSent+\" bytes.  Leaving connection alive.\"):(_this.log_(\"Closing unhealthy connection after timeout.\"),_this.close()))}),Math.floor(healthyTimeoutMS)))},Connection.prototype.nextTransportId_=function(){return\"c:\"+this.id+\":\"+this.connectionCount++},Connection.prototype.disconnReceiver_=function(conn){var _this=this;return function(everConnected){conn===_this.conn_?_this.onConnectionLost_(everConnected):conn===_this.secondaryConn_?(_this.log_(\"Secondary connection lost.\"),_this.onSecondaryConnectionLost_()):_this.log_(\"closing an old connection\")}},Connection.prototype.connReceiver_=function(conn){var _this=this;return function(message){2!==_this.state_&&(conn===_this.rx_?_this.onPrimaryMessageReceived_(message):conn===_this.secondaryConn_?_this.onSecondaryMessageReceived_(message):_this.log_(\"message on old connection\"))}},Connection.prototype.sendRequest=function(dataMsg){this.sendData_({t:\"d\",d:dataMsg})},Connection.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_(\"cleaning up and promoting a connection: \"+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},Connection.prototype.onSecondaryControl_=function(controlData){if(\"t\"in controlData){var cmd=controlData.t;\"a\"===cmd?this.upgradeIfSecondaryHealthy_():\"r\"===cmd?(this.log_(\"Got a reset on secondary, closing it\"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):\"o\"===cmd&&(this.log_(\"got pong on secondary.\"),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},Connection.prototype.onSecondaryMessageReceived_=function(parsedData){var layer=requireKey(\"t\",parsedData),data=requireKey(\"d\",parsedData);if(\"c\"===layer)this.onSecondaryControl_(data);else{if(\"d\"!==layer)throw new Error(\"Unknown protocol layer: \"+layer);this.pendingDataMessages.push(data)}},Connection.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_(\"Secondary connection is healthy.\"),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_(\"sending ping on secondary.\"),this.secondaryConn_.send({t:\"c\",d:{t:\"p\",d:{}}}))},Connection.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_(\"sending client ack on secondary\"),this.secondaryConn_.send({t:\"c\",d:{t:\"a\",d:{}}}),this.log_(\"Ending transmission on primary\"),this.conn_.send({t:\"c\",d:{t:\"n\",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},Connection.prototype.onPrimaryMessageReceived_=function(parsedData){var layer=requireKey(\"t\",parsedData),data=requireKey(\"d\",parsedData);\"c\"===layer?this.onControl_(data):\"d\"===layer&&this.onDataMessage_(data)},Connection.prototype.onDataMessage_=function(message){this.onPrimaryResponse_(),this.onMessage_(message)},Connection.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_(\"Primary connection is healthy.\"),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},Connection.prototype.onControl_=function(controlData){var cmd=requireKey(\"t\",controlData);if(\"d\"in controlData){var payload=controlData.d;if(\"h\"===cmd)this.onHandshake_(payload);else if(\"n\"===cmd){this.log_(\"recvd end transmission on primary\"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else\"s\"===cmd?this.onConnectionShutdown_(payload):\"r\"===cmd?this.onReset_(payload):\"e\"===cmd?error(\"Server Error: \"+payload):\"o\"===cmd?(this.log_(\"got pong on primary.\"),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error(\"Unknown control packet command: \"+cmd)}},Connection.prototype.onHandshake_=function(handshake){var timestamp=handshake.ts,version=handshake.v,host=handshake.h;this.sessionId=handshake.s,this.repoInfo_.host=host,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,timestamp),\"5\"!==version&&warn(\"Protocol version mismatch detected\"),this.tryStartUpgrade_())},Connection.prototype.tryStartUpgrade_=function(){var conn=this.transportManager_.upgradeTransport();conn&&this.startUpgrade_(conn)},Connection.prototype.startUpgrade_=function(conn){var _this=this;this.secondaryConn_=new conn(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=conn.responsesRequiredToBeHealthy||0;var onMessage=this.connReceiver_(this.secondaryConn_),onDisconnect=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(onMessage,onDisconnect),setTimeoutNonBlocking((function(){_this.secondaryConn_&&(_this.log_(\"Timed out trying to upgrade.\"),_this.secondaryConn_.close())}),Math.floor(6e4))},Connection.prototype.onReset_=function(host){this.log_(\"Reset packet received.  New host: \"+host),this.repoInfo_.host=host,1===this.state_?this.close():(this.closeConnections_(),this.start_())},Connection.prototype.onConnectionEstablished_=function(conn,timestamp){var _this=this;this.log_(\"Realtime connection established.\"),this.conn_=conn,this.state_=1,this.onReady_&&(this.onReady_(timestamp,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_(\"Primary connection is healthy.\"),this.isHealthy_=!0):setTimeoutNonBlocking((function(){_this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},Connection.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_(\"sending ping on primary.\"),this.sendData_({t:\"c\",d:{t:\"p\",d:{}}}))},Connection.prototype.onSecondaryConnectionLost_=function(){var conn=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==conn&&this.rx_!==conn||this.close()},Connection.prototype.onConnectionLost_=function(everConnected){this.conn_=null,everConnected||0!==this.state_?1===this.state_&&this.log_(\"Realtime connection lost.\"):(this.log_(\"Realtime connection failed.\"),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove(\"host:\"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},Connection.prototype.onConnectionShutdown_=function(reason){this.log_(\"Connection shutdown command received. Shutting down...\"),this.onKill_&&(this.onKill_(reason),this.onKill_=null),this.onDisconnect_=null,this.close()},Connection.prototype.sendData_=function(data){if(1!==this.state_)throw\"Connection is not connected\";this.tx_.send(data)},Connection.prototype.close=function(){2!==this.state_&&(this.log_(\"Closing realtime connection.\"),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},Connection.prototype.closeConnections_=function(){this.log_(\"Shutting down all connections\"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},Connection}(),ServerActions=function(){function ServerActions(){}return ServerActions.prototype.put=function(pathString,data,onComplete,hash){},ServerActions.prototype.merge=function(pathString,data,onComplete,hash){},ServerActions.prototype.refreshAuthToken=function(token){},ServerActions.prototype.refreshAppCheckToken=function(token){},ServerActions.prototype.onDisconnectPut=function(pathString,data,onComplete){},ServerActions.prototype.onDisconnectMerge=function(pathString,data,onComplete){},ServerActions.prototype.onDisconnectCancel=function(pathString,onComplete){},ServerActions.prototype.reportStats=function(stats){},ServerActions}(),EventEmitter=function(){function EventEmitter(allowedEvents_){this.allowedEvents_=allowedEvents_,this.listeners_={},Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(Array.isArray(allowedEvents_)&&allowedEvents_.length>0,\"Requires a non-empty array\")}return EventEmitter.prototype.trigger=function(eventType){for(var varArgs=[],_i=1;_i<arguments.length;_i++)varArgs[_i-1]=arguments[_i];if(Array.isArray(this.listeners_[eventType]))for(var listeners=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__spreadArray)([],Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__read)(this.listeners_[eventType])),i=0;i<listeners.length;i++)listeners[i].callback.apply(listeners[i].context,varArgs)},EventEmitter.prototype.on=function(eventType,callback,context){this.validateEventType_(eventType),this.listeners_[eventType]=this.listeners_[eventType]||[],this.listeners_[eventType].push({callback:callback,context:context});var eventData=this.getInitialEvent(eventType);eventData&&callback.apply(context,eventData)},EventEmitter.prototype.off=function(eventType,callback,context){this.validateEventType_(eventType);for(var listeners=this.listeners_[eventType]||[],i=0;i<listeners.length;i++)if(listeners[i].callback===callback&&(!context||context===listeners[i].context))return void listeners.splice(i,1)},EventEmitter.prototype.validateEventType_=function(eventType){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(this.allowedEvents_.find((function(et){return et===eventType})),\"Unknown event: \"+eventType)},EventEmitter}(),OnlineMonitor=function(_super){function OnlineMonitor(){var _this=_super.call(this,[\"online\"])||this;return _this.online_=!0,\"undefined\"==typeof window||void 0===window.addEventListener||Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isMobileCordova)()||(window.addEventListener(\"online\",(function(){_this.online_||(_this.online_=!0,_this.trigger(\"online\",!0))}),!1),window.addEventListener(\"offline\",(function(){_this.online_&&(_this.online_=!1,_this.trigger(\"online\",!1))}),!1)),_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(OnlineMonitor,_super),OnlineMonitor.getInstance=function(){return new OnlineMonitor},OnlineMonitor.prototype.getInitialEvent=function(eventType){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\"online\"===eventType,\"Unknown event type: \"+eventType),[this.online_]},OnlineMonitor.prototype.currentlyOnline=function(){return this.online_},OnlineMonitor}(EventEmitter),Path=function(){function Path(pathOrString,pieceNum){if(void 0===pieceNum){this.pieces_=pathOrString.split(\"/\");for(var copyTo=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[copyTo]=this.pieces_[i],copyTo++);this.pieces_.length=copyTo,this.pieceNum_=0}else this.pieces_=pathOrString,this.pieceNum_=pieceNum}return Path.prototype.toString=function(){for(var pathString=\"\",i=this.pieceNum_;i<this.pieces_.length;i++)\"\"!==this.pieces_[i]&&(pathString+=\"/\"+this.pieces_[i]);return pathString||\"/\"},Path}();function newEmptyPath(){return new Path(\"\")}function pathGetFront(path){return path.pieceNum_>=path.pieces_.length?null:path.pieces_[path.pieceNum_]}function pathGetLength(path){return path.pieces_.length-path.pieceNum_}function pathPopFront(path){var pieceNum=path.pieceNum_;return pieceNum<path.pieces_.length&&pieceNum++,new Path(path.pieces_,pieceNum)}function pathGetBack(path){return path.pieceNum_<path.pieces_.length?path.pieces_[path.pieces_.length-1]:null}function pathSlice(path,begin){return void 0===begin&&(begin=0),path.pieces_.slice(path.pieceNum_+begin)}function pathParent(path){if(path.pieceNum_>=path.pieces_.length)return null;for(var pieces=[],i=path.pieceNum_;i<path.pieces_.length-1;i++)pieces.push(path.pieces_[i]);return new Path(pieces,0)}function pathChild(path,childPathObj){for(var pieces=[],i=path.pieceNum_;i<path.pieces_.length;i++)pieces.push(path.pieces_[i]);if(childPathObj instanceof Path)for(i=childPathObj.pieceNum_;i<childPathObj.pieces_.length;i++)pieces.push(childPathObj.pieces_[i]);else{var childPieces=childPathObj.split(\"/\");for(i=0;i<childPieces.length;i++)childPieces[i].length>0&&pieces.push(childPieces[i])}return new Path(pieces,0)}function pathIsEmpty(path){return path.pieceNum_>=path.pieces_.length}function newRelativePath(outerPath,innerPath){var outer=pathGetFront(outerPath),inner=pathGetFront(innerPath);if(null===outer)return innerPath;if(outer===inner)return newRelativePath(pathPopFront(outerPath),pathPopFront(innerPath));throw new Error(\"INTERNAL ERROR: innerPath (\"+innerPath+\") is not within outerPath (\"+outerPath+\")\")}function pathCompare(left,right){for(var leftKeys=pathSlice(left,0),rightKeys=pathSlice(right,0),i=0;i<leftKeys.length&&i<rightKeys.length;i++){var cmp=nameCompare(leftKeys[i],rightKeys[i]);if(0!==cmp)return cmp}return leftKeys.length===rightKeys.length?0:leftKeys.length<rightKeys.length?-1:1}function pathEquals(path,other){if(pathGetLength(path)!==pathGetLength(other))return!1;for(var i=path.pieceNum_,j=other.pieceNum_;i<=path.pieces_.length;i++,j++)if(path.pieces_[i]!==other.pieces_[j])return!1;return!0}function pathContains(path,other){var i=path.pieceNum_,j=other.pieceNum_;if(pathGetLength(path)>pathGetLength(other))return!1;for(;i<path.pieces_.length;){if(path.pieces_[i]!==other.pieces_[j])return!1;++i,++j}return!0}var ValidationPath=function(){return function(path,errorPrefix_){this.errorPrefix_=errorPrefix_,this.parts_=pathSlice(path,0),this.byteLength_=Math.max(1,this.parts_.length);for(var i=0;i<this.parts_.length;i++)this.byteLength_+=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringLength)(this.parts_[i]);validationPathCheckValid(this)}}();function validationPathCheckValid(validationPath){if(validationPath.byteLength_>768)throw new Error(validationPath.errorPrefix_+\"has a key path longer than 768 bytes (\"+validationPath.byteLength_+\").\");if(validationPath.parts_.length>32)throw new Error(validationPath.errorPrefix_+\"path specified exceeds the maximum depth that can be written (32) or object contains a cycle \"+validationPathToErrorString(validationPath))}function validationPathToErrorString(validationPath){return 0===validationPath.parts_.length?\"\":\"in property '\"+validationPath.parts_.join(\".\")+\"'\"}var __EMPTY_NODE,MAX_NODE,VisibilityMonitor=function(_super){function VisibilityMonitor(){var hidden,visibilityChange,_this=_super.call(this,[\"visible\"])||this;return\"undefined\"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(visibilityChange=\"visibilitychange\",hidden=\"hidden\"):void 0!==document.mozHidden?(visibilityChange=\"mozvisibilitychange\",hidden=\"mozHidden\"):void 0!==document.msHidden?(visibilityChange=\"msvisibilitychange\",hidden=\"msHidden\"):void 0!==document.webkitHidden&&(visibilityChange=\"webkitvisibilitychange\",hidden=\"webkitHidden\")),_this.visible_=!0,visibilityChange&&document.addEventListener(visibilityChange,(function(){var visible=!document[hidden];visible!==_this.visible_&&(_this.visible_=visible,_this.trigger(\"visible\",visible))}),!1),_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(VisibilityMonitor,_super),VisibilityMonitor.getInstance=function(){return new VisibilityMonitor},VisibilityMonitor.prototype.getInitialEvent=function(eventType){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\"visible\"===eventType,\"Unknown event type: \"+eventType),[this.visible_]},VisibilityMonitor}(EventEmitter),PersistentConnection=function(_super){function PersistentConnection(repoInfo_,applicationId_,onDataUpdate_,onConnectStatus_,onServerInfoUpdate_,authTokenProvider_,appCheckTokenProvider_,authOverride_){var _this=_super.call(this)||this;if(_this.repoInfo_=repoInfo_,_this.applicationId_=applicationId_,_this.onDataUpdate_=onDataUpdate_,_this.onConnectStatus_=onConnectStatus_,_this.onServerInfoUpdate_=onServerInfoUpdate_,_this.authTokenProvider_=authTokenProvider_,_this.appCheckTokenProvider_=appCheckTokenProvider_,_this.authOverride_=authOverride_,_this.id=PersistentConnection.nextPersistentConnectionId_++,_this.log_=logWrapper(\"p:\"+_this.id+\":\"),_this.interruptReasons_={},_this.listens=new Map,_this.outstandingPuts_=[],_this.outstandingGets_=[],_this.outstandingPutCount_=0,_this.outstandingGetCount_=0,_this.onDisconnectRequestQueue_=[],_this.connected_=!1,_this.reconnectDelay_=1e3,_this.maxReconnectDelay_=3e5,_this.securityDebugCallback_=null,_this.lastSessionId=null,_this.establishConnectionTimer_=null,_this.visible_=!1,_this.requestCBHash_={},_this.requestNumber_=0,_this.realtime_=null,_this.authToken_=null,_this.appCheckToken_=null,_this.forceTokenRefresh_=!1,_this.invalidAuthTokenCount_=0,_this.invalidAppCheckTokenCount_=0,_this.firstConnection_=!0,_this.lastConnectionAttemptTime_=null,_this.lastConnectionEstablishedTime_=null,authOverride_&&!Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isNodeSdk)())throw new Error(\"Auth override specified in options, but not supported on non Node.js platforms\");return VisibilityMonitor.getInstance().on(\"visible\",_this.onVisible_,_this),-1===repoInfo_.host.indexOf(\"fblocal\")&&OnlineMonitor.getInstance().on(\"online\",_this.onOnline_,_this),_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(PersistentConnection,_super),PersistentConnection.prototype.sendRequest=function(action,body,onResponse){var curReqNum=++this.requestNumber_,msg={r:curReqNum,a:action,b:body};this.log_(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(msg)),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(this.connected_,\"sendRequest call when we're not connected not allowed.\"),this.realtime_.sendRequest(msg),onResponse&&(this.requestCBHash_[curReqNum]=onResponse)},PersistentConnection.prototype.get=function(query){var _this=this;this.initConnection_();var deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred,request={p:query._path.toString(),q:query._queryObject},outstandingGet={action:\"g\",request:request,onComplete:function(message){var payload=message.d;\"ok\"===message.s?(_this.onDataUpdate_(request.p,payload,!1,null),deferred.resolve(payload)):deferred.reject(payload)}};this.outstandingGets_.push(outstandingGet),this.outstandingGetCount_++;var index=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var get=_this.outstandingGets_[index];void 0!==get&&outstandingGet===get&&(delete _this.outstandingGets_[index],_this.outstandingGetCount_--,0===_this.outstandingGetCount_&&(_this.outstandingGets_=[]),_this.log_(\"get \"+index+\" timed out on connection\"),deferred.reject(new Error(\"Client is offline.\")))}),3e3),this.connected_&&this.sendGet_(index),deferred.promise},PersistentConnection.prototype.listen=function(query,currentHashFn,tag,onComplete){this.initConnection_();var queryId=query._queryIdentifier,pathString=query._path.toString();this.log_(\"Listen called for \"+pathString+\" \"+queryId),this.listens.has(pathString)||this.listens.set(pathString,new Map),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(query._queryParams.isDefault()||!query._queryParams.loadsAllData(),\"listen() called for non-default but complete query\"),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!this.listens.get(pathString).has(queryId),\"listen() called twice for same path/queryId.\");var listenSpec={onComplete:onComplete,hashFn:currentHashFn,query:query,tag:tag};this.listens.get(pathString).set(queryId,listenSpec),this.connected_&&this.sendListen_(listenSpec)},PersistentConnection.prototype.sendGet_=function(index){var _this=this,get=this.outstandingGets_[index];this.sendRequest(\"g\",get.request,(function(message){delete _this.outstandingGets_[index],_this.outstandingGetCount_--,0===_this.outstandingGetCount_&&(_this.outstandingGets_=[]),get.onComplete&&get.onComplete(message)}))},PersistentConnection.prototype.sendListen_=function(listenSpec){var _this=this,query=listenSpec.query,pathString=query._path.toString(),queryId=query._queryIdentifier;this.log_(\"Listen on \"+pathString+\" for \"+queryId);var req={p:pathString};listenSpec.tag&&(req.q=query._queryObject,req.t=listenSpec.tag),req.h=listenSpec.hashFn(),this.sendRequest(\"q\",req,(function(message){var payload=message.d,status=message.s;PersistentConnection.warnOnListenWarnings_(payload,query),(_this.listens.get(pathString)&&_this.listens.get(pathString).get(queryId))===listenSpec&&(_this.log_(\"listen response\",message),\"ok\"!==status&&_this.removeListen_(pathString,queryId),listenSpec.onComplete&&listenSpec.onComplete(status,payload))}))},PersistentConnection.warnOnListenWarnings_=function(payload,query){if(payload&&\"object\"==typeof payload&&Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(payload,\"w\")){var warnings=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.safeGet)(payload,\"w\");if(Array.isArray(warnings)&&~warnings.indexOf(\"no_index\")){var indexSpec='\".indexOn\": \"'+query._queryParams.getIndex().toString()+'\"',indexPath=query._path.toString();warn(\"Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding \"+indexSpec+\" at \"+indexPath+\" to your security rules for better performance.\")}}},PersistentConnection.prototype.refreshAuthToken=function(token){this.authToken_=token,this.log_(\"Auth token refreshed\"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest(\"unauth\",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(token)},PersistentConnection.prototype.reduceReconnectDelayIfAdminCredential_=function(credential){(credential&&40===credential.length||Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isAdmin)(credential))&&(this.log_(\"Admin auth credential detected.  Reducing max reconnect time.\"),this.maxReconnectDelay_=3e4)},PersistentConnection.prototype.refreshAppCheckToken=function(token){this.appCheckToken_=token,this.log_(\"App check token refreshed\"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest(\"unappeck\",{},(function(){}))},PersistentConnection.prototype.tryAuth=function(){var _this=this;if(this.connected_&&this.authToken_){var token_1=this.authToken_,authMethod=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isValidFormat)(token_1)?\"auth\":\"gauth\",requestData={cred:token_1};null===this.authOverride_?requestData.noauth=!0:\"object\"==typeof this.authOverride_&&(requestData.authvar=this.authOverride_),this.sendRequest(authMethod,requestData,(function(res){var status=res.s,data=res.d||\"error\";_this.authToken_===token_1&&(\"ok\"===status?_this.invalidAuthTokenCount_=0:_this.onAuthRevoked_(status,data))}))}},PersistentConnection.prototype.tryAppCheck=function(){var _this=this;this.connected_&&this.appCheckToken_&&this.sendRequest(\"appcheck\",{token:this.appCheckToken_},(function(res){var status=res.s,data=res.d||\"error\";\"ok\"===status?_this.invalidAppCheckTokenCount_=0:_this.onAppCheckRevoked_(status,data)}))},PersistentConnection.prototype.unlisten=function(query,tag){var pathString=query._path.toString(),queryId=query._queryIdentifier;this.log_(\"Unlisten called for \"+pathString+\" \"+queryId),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(query._queryParams.isDefault()||!query._queryParams.loadsAllData(),\"unlisten() called for non-default but complete query\"),this.removeListen_(pathString,queryId)&&this.connected_&&this.sendUnlisten_(pathString,queryId,query._queryObject,tag)},PersistentConnection.prototype.sendUnlisten_=function(pathString,queryId,queryObj,tag){this.log_(\"Unlisten on \"+pathString+\" for \"+queryId);var req={p:pathString};tag&&(req.q=queryObj,req.t=tag),this.sendRequest(\"n\",req)},PersistentConnection.prototype.onDisconnectPut=function(pathString,data,onComplete){this.initConnection_(),this.connected_?this.sendOnDisconnect_(\"o\",pathString,data,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:\"o\",data:data,onComplete:onComplete})},PersistentConnection.prototype.onDisconnectMerge=function(pathString,data,onComplete){this.initConnection_(),this.connected_?this.sendOnDisconnect_(\"om\",pathString,data,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:\"om\",data:data,onComplete:onComplete})},PersistentConnection.prototype.onDisconnectCancel=function(pathString,onComplete){this.initConnection_(),this.connected_?this.sendOnDisconnect_(\"oc\",pathString,null,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:\"oc\",data:null,onComplete:onComplete})},PersistentConnection.prototype.sendOnDisconnect_=function(action,pathString,data,onComplete){var request={p:pathString,d:data};this.log_(\"onDisconnect \"+action,request),this.sendRequest(action,request,(function(response){onComplete&&setTimeout((function(){onComplete(response.s,response.d)}),Math.floor(0))}))},PersistentConnection.prototype.put=function(pathString,data,onComplete,hash){this.putInternal(\"p\",pathString,data,onComplete,hash)},PersistentConnection.prototype.merge=function(pathString,data,onComplete,hash){this.putInternal(\"m\",pathString,data,onComplete,hash)},PersistentConnection.prototype.putInternal=function(action,pathString,data,onComplete,hash){this.initConnection_();var request={p:pathString,d:data};void 0!==hash&&(request.h=hash),this.outstandingPuts_.push({action:action,request:request,onComplete:onComplete}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_(\"Buffering put: \"+pathString)},PersistentConnection.prototype.sendPut_=function(index){var _this=this,action=this.outstandingPuts_[index].action,request=this.outstandingPuts_[index].request,onComplete=this.outstandingPuts_[index].onComplete;this.outstandingPuts_[index].queued=this.connected_,this.sendRequest(action,request,(function(message){_this.log_(action+\" response\",message),delete _this.outstandingPuts_[index],_this.outstandingPutCount_--,0===_this.outstandingPutCount_&&(_this.outstandingPuts_=[]),onComplete&&onComplete(message.s,message.d)}))},PersistentConnection.prototype.reportStats=function(stats){var _this=this;if(this.connected_){var request={c:stats};this.log_(\"reportStats\",request),this.sendRequest(\"s\",request,(function(result){\"ok\"!==result.s&&_this.log_(\"reportStats\",\"Error sending stats: \"+result.d)}))}},PersistentConnection.prototype.onDataMessage_=function(message){if(\"r\"in message){this.log_(\"from server: \"+Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(message));var reqNum=message.r,onResponse=this.requestCBHash_[reqNum];onResponse&&(delete this.requestCBHash_[reqNum],onResponse(message.b))}else{if(\"error\"in message)throw\"A server-side error has occurred: \"+message.error;\"a\"in message&&this.onDataPush_(message.a,message.b)}},PersistentConnection.prototype.onDataPush_=function(action,body){this.log_(\"handleServerMessage\",action,body),\"d\"===action?this.onDataUpdate_(body.p,body.d,!1,body.t):\"m\"===action?this.onDataUpdate_(body.p,body.d,!0,body.t):\"c\"===action?this.onListenRevoked_(body.p,body.q):\"ac\"===action?this.onAuthRevoked_(body.s,body.d):\"apc\"===action?this.onAppCheckRevoked_(body.s,body.d):\"sd\"===action?this.onSecurityDebugPacket_(body):error(\"Unrecognized action received from server: \"+Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(action)+\"\\nAre you using the latest client?\")},PersistentConnection.prototype.onReady_=function(timestamp,sessionId){this.log_(\"connection ready\"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(timestamp),this.lastSessionId=sessionId,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},PersistentConnection.prototype.scheduleConnect_=function(timeout){var _this=this;Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!this.realtime_,\"Scheduling a connect when we're already connected/ing?\"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){_this.establishConnectionTimer_=null,_this.establishConnection_()}),Math.floor(timeout))},PersistentConnection.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},PersistentConnection.prototype.onVisible_=function(visible){visible&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_(\"Window became visible.  Reducing delay.\"),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=visible},PersistentConnection.prototype.onOnline_=function(online){online?(this.log_(\"Browser went online.\"),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_(\"Browser went offline.  Killing connection.\"),this.realtime_&&this.realtime_.close())},PersistentConnection.prototype.onRealtimeDisconnect_=function(){if(this.log_(\"data client disconnected\"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_(\"Window isn't visible.  Delaying reconnect.\"),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var timeSinceLastConnectAttempt=(new Date).getTime()-this.lastConnectionAttemptTime_,reconnectDelay=Math.max(0,this.reconnectDelay_-timeSinceLastConnectAttempt);reconnectDelay=Math.random()*reconnectDelay,this.log_(\"Trying to reconnect in \"+reconnectDelay+\"ms\"),this.scheduleConnect_(reconnectDelay),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},PersistentConnection.prototype.establishConnection_=function(){return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__awaiter)(this,void 0,void 0,(function(){var onDataMessage,onReady,onDisconnect_1,connId,lastSessionId,canceled_1,connection_1,closeFn,forceRefresh,_a,authToken,appCheckToken,error_1,_this=this;return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__generator)(this,(function(_b){switch(_b.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_(\"Making a connection attempt\"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,onDataMessage=this.onDataMessage_.bind(this),onReady=this.onReady_.bind(this),onDisconnect_1=this.onRealtimeDisconnect_.bind(this),connId=this.id+\":\"+PersistentConnection.nextConnectionId_++,lastSessionId=this.lastSessionId,canceled_1=!1,connection_1=null,this.realtime_={close:closeFn=function(){connection_1?connection_1.close():(canceled_1=!0,onDisconnect_1())},sendRequest:function(msg){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(connection_1,\"sendRequest call when we're not connected not allowed.\"),connection_1.sendRequest(msg)}},forceRefresh=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,_b.label=1;case 1:return _b.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(forceRefresh),this.appCheckTokenProvider_.getToken(forceRefresh)])];case 2:return _a=tslib__WEBPACK_IMPORTED_MODULE_3__.__read.apply(void 0,[_b.sent(),2]),authToken=_a[0],appCheckToken=_a[1],canceled_1?log(\"getToken() completed but was canceled\"):(log(\"getToken() completed. Creating connection.\"),this.authToken_=authToken&&authToken.accessToken,this.appCheckToken_=appCheckToken&&appCheckToken.token,connection_1=new Connection(connId,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,onDataMessage,onReady,onDisconnect_1,(function(reason){warn(reason+\" (\"+_this.repoInfo_.toString()+\")\"),_this.interrupt(\"server_kill\")}),lastSessionId)),[3,4];case 3:return error_1=_b.sent(),this.log_(\"Failed to get token: \"+error_1),canceled_1||(this.repoInfo_.nodeAdmin&&warn(error_1),closeFn()),[3,4];case 4:return[2]}}))}))},PersistentConnection.prototype.interrupt=function(reason){log(\"Interrupting connection for reason: \"+reason),this.interruptReasons_[reason]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},PersistentConnection.prototype.resume=function(reason){log(\"Resuming connection for reason: \"+reason),delete this.interruptReasons_[reason],Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isEmpty)(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},PersistentConnection.prototype.handleTimestamp_=function(timestamp){var delta=timestamp-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:delta})},PersistentConnection.prototype.cancelSentTransactions_=function(){for(var i=0;i<this.outstandingPuts_.length;i++){var put=this.outstandingPuts_[i];put&&\"h\"in put.request&&put.queued&&(put.onComplete&&put.onComplete(\"disconnect\"),delete this.outstandingPuts_[i],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},PersistentConnection.prototype.onListenRevoked_=function(pathString,query){var queryId;queryId=query?query.map((function(q){return ObjectToUniqueKey(q)})).join(\"$\"):\"default\";var listen=this.removeListen_(pathString,queryId);listen&&listen.onComplete&&listen.onComplete(\"permission_denied\")},PersistentConnection.prototype.removeListen_=function(pathString,queryId){var listen,normalizedPathString=new Path(pathString).toString();if(this.listens.has(normalizedPathString)){var map=this.listens.get(normalizedPathString);listen=map.get(queryId),map.delete(queryId),0===map.size&&this.listens.delete(normalizedPathString)}else listen=void 0;return listen},PersistentConnection.prototype.onAuthRevoked_=function(statusCode,explanation){log(\"Auth token revoked: \"+statusCode+\"/\"+explanation),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),\"invalid_token\"!==statusCode&&\"permission_denied\"!==statusCode||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},PersistentConnection.prototype.onAppCheckRevoked_=function(statusCode,explanation){log(\"App check token revoked: \"+statusCode+\"/\"+explanation),this.appCheckToken_=null,this.forceTokenRefresh_=!0,\"invalid_token\"!==statusCode&&\"permission_denied\"!==statusCode||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},PersistentConnection.prototype.onSecurityDebugPacket_=function(body){this.securityDebugCallback_?this.securityDebugCallback_(body):\"msg\"in body&&console.log(\"FIREBASE: \"+body.msg.replace(\"\\n\",\"\\nFIREBASE: \"))},PersistentConnection.prototype.restoreState_=function(){var e_1,_a,e_2,_b;this.tryAuth(),this.tryAppCheck();try{for(var _c=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__values)(this.listens.values()),_d=_c.next();!_d.done;_d=_c.next()){var queries=_d.value;try{for(var _e=(e_2=void 0,Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__values)(queries.values())),_f=_e.next();!_f.done;_f=_e.next())this.sendListen_(_f.value)}catch(e_2_1){e_2={error:e_2_1}}finally{try{_f&&!_f.done&&(_b=_e.return)&&_b.call(_e)}finally{if(e_2)throw e_2.error}}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_1)throw e_1.error}}for(var i=0;i<this.outstandingPuts_.length;i++)this.outstandingPuts_[i]&&this.sendPut_(i);for(;this.onDisconnectRequestQueue_.length;){var request=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(request.action,request.pathString,request.data,request.onComplete)}for(i=0;i<this.outstandingGets_.length;i++)this.outstandingGets_[i]&&this.sendGet_(i)},PersistentConnection.prototype.sendConnectStats_=function(){var stats={},clientName=\"js\";Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isNodeSdk)()&&(clientName=this.repoInfo_.nodeAdmin?\"admin_node\":\"node\"),stats[\"sdk.\"+clientName+\".\"+SDK_VERSION.replace(/\\./g,\"-\")]=1,Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isMobileCordova)()?stats[\"framework.cordova\"]=1:Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isReactNative)()&&(stats[\"framework.reactnative\"]=1),this.reportStats(stats)},PersistentConnection.prototype.shouldReconnect_=function(){var online=OnlineMonitor.getInstance().currentlyOnline();return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isEmpty)(this.interruptReasons_)&&online},PersistentConnection.nextPersistentConnectionId_=0,PersistentConnection.nextConnectionId_=0,PersistentConnection}(ServerActions),NamedNode=function(){function NamedNode(name,node){this.name=name,this.node=node}return NamedNode.Wrap=function(name,node){return new NamedNode(name,node)},NamedNode}(),Index=function(){function Index(){}return Index.prototype.getCompare=function(){return this.compare.bind(this)},Index.prototype.indexedValueChanged=function(oldNode,newNode){var oldWrapped=new NamedNode(MIN_NAME,oldNode),newWrapped=new NamedNode(MIN_NAME,newNode);return 0!==this.compare(oldWrapped,newWrapped)},Index.prototype.minPost=function(){return NamedNode.MIN},Index}(),KeyIndex=function(_super){function KeyIndex(){return null!==_super&&_super.apply(this,arguments)||this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(KeyIndex,_super),Object.defineProperty(KeyIndex,\"__EMPTY_NODE\",{get:function(){return __EMPTY_NODE},set:function(val){__EMPTY_NODE=val},enumerable:!1,configurable:!0}),KeyIndex.prototype.compare=function(a,b){return nameCompare(a.name,b.name)},KeyIndex.prototype.isDefinedOn=function(node){throw Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assertionError)(\"KeyIndex.isDefinedOn not expected to be called.\")},KeyIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!1},KeyIndex.prototype.minPost=function(){return NamedNode.MIN},KeyIndex.prototype.maxPost=function(){return new NamedNode(MAX_NAME,__EMPTY_NODE)},KeyIndex.prototype.makePost=function(indexValue,name){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\"string\"==typeof indexValue,\"KeyIndex indexValue must always be a string.\"),new NamedNode(indexValue,__EMPTY_NODE)},KeyIndex.prototype.toString=function(){return\".key\"},KeyIndex}(Index),KEY_INDEX=new KeyIndex,SortedMapIterator=function(){function SortedMapIterator(node,startKey,comparator,isReverse_,resultGenerator_){void 0===resultGenerator_&&(resultGenerator_=null),this.isReverse_=isReverse_,this.resultGenerator_=resultGenerator_,this.nodeStack_=[];for(var cmp=1;!node.isEmpty();)if(node=node,cmp=startKey?comparator(node.key,startKey):1,isReverse_&&(cmp*=-1),cmp<0)node=this.isReverse_?node.left:node.right;else{if(0===cmp){this.nodeStack_.push(node);break}this.nodeStack_.push(node),node=this.isReverse_?node.right:node.left}}return SortedMapIterator.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var result,node=this.nodeStack_.pop();if(result=this.resultGenerator_?this.resultGenerator_(node.key,node.value):{key:node.key,value:node.value},this.isReverse_)for(node=node.left;!node.isEmpty();)this.nodeStack_.push(node),node=node.right;else for(node=node.right;!node.isEmpty();)this.nodeStack_.push(node),node=node.left;return result},SortedMapIterator.prototype.hasNext=function(){return this.nodeStack_.length>0},SortedMapIterator.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var node=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(node.key,node.value):{key:node.key,value:node.value}},SortedMapIterator}(),LLRBNode=function(){function LLRBNode(key,value,color,left,right){this.key=key,this.value=value,this.color=null!=color?color:LLRBNode.RED,this.left=null!=left?left:SortedMap.EMPTY_NODE,this.right=null!=right?right:SortedMap.EMPTY_NODE}return LLRBNode.prototype.copy=function(key,value,color,left,right){return new LLRBNode(null!=key?key:this.key,null!=value?value:this.value,null!=color?color:this.color,null!=left?left:this.left,null!=right?right:this.right)},LLRBNode.prototype.count=function(){return this.left.count()+1+this.right.count()},LLRBNode.prototype.isEmpty=function(){return!1},LLRBNode.prototype.inorderTraversal=function(action){return this.left.inorderTraversal(action)||!!action(this.key,this.value)||this.right.inorderTraversal(action)},LLRBNode.prototype.reverseTraversal=function(action){return this.right.reverseTraversal(action)||action(this.key,this.value)||this.left.reverseTraversal(action)},LLRBNode.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},LLRBNode.prototype.minKey=function(){return this.min_().key},LLRBNode.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},LLRBNode.prototype.insert=function(key,value,comparator){var n=this,cmp=comparator(key,n.key);return(n=cmp<0?n.copy(null,null,null,n.left.insert(key,value,comparator),null):0===cmp?n.copy(null,value,null,null,null):n.copy(null,null,null,null,n.right.insert(key,value,comparator))).fixUp_()},LLRBNode.prototype.removeMin_=function(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;var n=this;return n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),(n=n.copy(null,null,null,n.left.removeMin_(),null)).fixUp_()},LLRBNode.prototype.remove=function(key,comparator){var n,smallest;if(comparator(key,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(key,comparator),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===comparator(key,n.key)){if(n.right.isEmpty())return SortedMap.EMPTY_NODE;smallest=n.right.min_(),n=n.copy(smallest.key,smallest.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(key,comparator))}return n.fixUp_()},LLRBNode.prototype.isRed_=function(){return this.color},LLRBNode.prototype.fixUp_=function(){var n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n},LLRBNode.prototype.moveRedLeft_=function(){var n=this.colorFlip_();return n.right.left.isRed_()&&(n=(n=(n=n.copy(null,null,null,null,n.right.rotateRight_())).rotateLeft_()).colorFlip_()),n},LLRBNode.prototype.moveRedRight_=function(){var n=this.colorFlip_();return n.left.left.isRed_()&&(n=(n=n.rotateRight_()).colorFlip_()),n},LLRBNode.prototype.rotateLeft_=function(){var nl=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,nl,null)},LLRBNode.prototype.rotateRight_=function(){var nr=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,nr)},LLRBNode.prototype.colorFlip_=function(){var left=this.left.copy(null,null,!this.left.color,null,null),right=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,left,right)},LLRBNode.prototype.checkMaxDepth_=function(){var blackDepth=this.check_();return Math.pow(2,blackDepth)<=this.count()+1},LLRBNode.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error(\"Red node has red child(\"+this.key+\",\"+this.value+\")\");if(this.right.isRed_())throw new Error(\"Right child of (\"+this.key+\",\"+this.value+\") is red\");var blackDepth=this.left.check_();if(blackDepth!==this.right.check_())throw new Error(\"Black depths differ\");return blackDepth+(this.isRed_()?0:1)},LLRBNode.RED=!0,LLRBNode.BLACK=!1,LLRBNode}(),LLRBEmptyNode=function(){function LLRBEmptyNode(){}return LLRBEmptyNode.prototype.copy=function(key,value,color,left,right){return this},LLRBEmptyNode.prototype.insert=function(key,value,comparator){return new LLRBNode(key,value,null)},LLRBEmptyNode.prototype.remove=function(key,comparator){return this},LLRBEmptyNode.prototype.count=function(){return 0},LLRBEmptyNode.prototype.isEmpty=function(){return!0},LLRBEmptyNode.prototype.inorderTraversal=function(action){return!1},LLRBEmptyNode.prototype.reverseTraversal=function(action){return!1},LLRBEmptyNode.prototype.minKey=function(){return null},LLRBEmptyNode.prototype.maxKey=function(){return null},LLRBEmptyNode.prototype.check_=function(){return 0},LLRBEmptyNode.prototype.isRed_=function(){return!1},LLRBEmptyNode}(),SortedMap=function(){function SortedMap(comparator_,root_){void 0===root_&&(root_=SortedMap.EMPTY_NODE),this.comparator_=comparator_,this.root_=root_}return SortedMap.prototype.insert=function(key,value){return new SortedMap(this.comparator_,this.root_.insert(key,value,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.remove=function(key){return new SortedMap(this.comparator_,this.root_.remove(key,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.get=function(key){for(var cmp,node=this.root_;!node.isEmpty();){if(0===(cmp=this.comparator_(key,node.key)))return node.value;cmp<0?node=node.left:cmp>0&&(node=node.right)}return null},SortedMap.prototype.getPredecessorKey=function(key){for(var cmp,node=this.root_,rightParent=null;!node.isEmpty();){if(0===(cmp=this.comparator_(key,node.key))){if(node.left.isEmpty())return rightParent?rightParent.key:null;for(node=node.left;!node.right.isEmpty();)node=node.right;return node.key}cmp<0?node=node.left:cmp>0&&(rightParent=node,node=node.right)}throw new Error(\"Attempted to find predecessor key for a nonexistent key.  What gives?\")},SortedMap.prototype.isEmpty=function(){return this.root_.isEmpty()},SortedMap.prototype.count=function(){return this.root_.count()},SortedMap.prototype.minKey=function(){return this.root_.minKey()},SortedMap.prototype.maxKey=function(){return this.root_.maxKey()},SortedMap.prototype.inorderTraversal=function(action){return this.root_.inorderTraversal(action)},SortedMap.prototype.reverseTraversal=function(action){return this.root_.reverseTraversal(action)},SortedMap.prototype.getIterator=function(resultGenerator){return new SortedMapIterator(this.root_,null,this.comparator_,!1,resultGenerator)},SortedMap.prototype.getIteratorFrom=function(key,resultGenerator){return new SortedMapIterator(this.root_,key,this.comparator_,!1,resultGenerator)},SortedMap.prototype.getReverseIteratorFrom=function(key,resultGenerator){return new SortedMapIterator(this.root_,key,this.comparator_,!0,resultGenerator)},SortedMap.prototype.getReverseIterator=function(resultGenerator){return new SortedMapIterator(this.root_,null,this.comparator_,!0,resultGenerator)},SortedMap.EMPTY_NODE=new LLRBEmptyNode,SortedMap}();function NAME_ONLY_COMPARATOR(left,right){return nameCompare(left.name,right.name)}function NAME_COMPARATOR(left,right){return nameCompare(left,right)}var __childrenNodeConstructor,nodeFromJSON,MAX_NODE$1,_defaultIndexMap,EMPTY_NODE,priorityHashText=function(priority){return\"number\"==typeof priority?\"number:\"+doubleToIEEE754String(priority):\"string:\"+priority},validatePriorityNode=function(priorityNode){if(priorityNode.isLeafNode()){var val=priorityNode.val();Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\"string\"==typeof val||\"number\"==typeof val||\"object\"==typeof val&&Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(val,\".sv\"),\"Priority must be a string or number.\")}else Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(priorityNode===MAX_NODE||priorityNode.isEmpty(),\"priority of unexpected type.\");Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(priorityNode===MAX_NODE||priorityNode.getPriority().isEmpty(),\"Priority nodes can't have a priority of their own.\")},LeafNode=function(){function LeafNode(value_,priorityNode_){void 0===priorityNode_&&(priorityNode_=LeafNode.__childrenNodeConstructor.EMPTY_NODE),this.value_=value_,this.priorityNode_=priorityNode_,this.lazyHash_=null,Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(null!=this.value_,\"LeafNode shouldn't be created with null/undefined value.\"),validatePriorityNode(this.priorityNode_)}return Object.defineProperty(LeafNode,\"__childrenNodeConstructor\",{get:function(){return __childrenNodeConstructor},set:function(val){__childrenNodeConstructor=val},enumerable:!1,configurable:!0}),LeafNode.prototype.isLeafNode=function(){return!0},LeafNode.prototype.getPriority=function(){return this.priorityNode_},LeafNode.prototype.updatePriority=function(newPriorityNode){return new LeafNode(this.value_,newPriorityNode)},LeafNode.prototype.getImmediateChild=function(childName){return\".priority\"===childName?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE},LeafNode.prototype.getChild=function(path){return pathIsEmpty(path)?this:\".priority\"===pathGetFront(path)?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE},LeafNode.prototype.hasChild=function(){return!1},LeafNode.prototype.getPredecessorChildName=function(childName,childNode){return null},LeafNode.prototype.updateImmediateChild=function(childName,newChildNode){return\".priority\"===childName?this.updatePriority(newChildNode):newChildNode.isEmpty()&&\".priority\"!==childName?this:LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(childName,newChildNode).updatePriority(this.priorityNode_)},LeafNode.prototype.updateChild=function(path,newChildNode){var front=pathGetFront(path);return null===front?newChildNode:newChildNode.isEmpty()&&\".priority\"!==front?this:(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\".priority\"!==front||1===pathGetLength(path),\".priority must be the last token in a path\"),this.updateImmediateChild(front,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(pathPopFront(path),newChildNode)))},LeafNode.prototype.isEmpty=function(){return!1},LeafNode.prototype.numChildren=function(){return 0},LeafNode.prototype.forEachChild=function(index,action){return!1},LeafNode.prototype.val=function(exportFormat){return exportFormat&&!this.getPriority().isEmpty()?{\".value\":this.getValue(),\".priority\":this.getPriority().val()}:this.getValue()},LeafNode.prototype.hash=function(){if(null===this.lazyHash_){var toHash=\"\";this.priorityNode_.isEmpty()||(toHash+=\"priority:\"+priorityHashText(this.priorityNode_.val())+\":\");var type=typeof this.value_;toHash+=type+\":\",toHash+=\"number\"===type?doubleToIEEE754String(this.value_):this.value_,this.lazyHash_=sha1(toHash)}return this.lazyHash_},LeafNode.prototype.getValue=function(){return this.value_},LeafNode.prototype.compareTo=function(other){return other===LeafNode.__childrenNodeConstructor.EMPTY_NODE?1:other instanceof LeafNode.__childrenNodeConstructor?-1:(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(other.isLeafNode(),\"Unknown node type\"),this.compareToLeafNode_(other))},LeafNode.prototype.compareToLeafNode_=function(otherLeaf){var otherLeafType=typeof otherLeaf.value_,thisLeafType=typeof this.value_,otherIndex=LeafNode.VALUE_TYPE_ORDER.indexOf(otherLeafType),thisIndex=LeafNode.VALUE_TYPE_ORDER.indexOf(thisLeafType);return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(otherIndex>=0,\"Unknown leaf type: \"+otherLeafType),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(thisIndex>=0,\"Unknown leaf type: \"+thisLeafType),otherIndex===thisIndex?\"object\"===thisLeafType?0:this.value_<otherLeaf.value_?-1:this.value_===otherLeaf.value_?0:1:thisIndex-otherIndex},LeafNode.prototype.withIndex=function(){return this},LeafNode.prototype.isIndexed=function(){return!0},LeafNode.prototype.equals=function(other){return other===this||!!other.isLeafNode()&&this.value_===other.value_&&this.priorityNode_.equals(other.priorityNode_)},LeafNode.VALUE_TYPE_ORDER=[\"object\",\"boolean\",\"number\",\"string\"],LeafNode}(),PRIORITY_INDEX=new(function(_super){function PriorityIndex(){return null!==_super&&_super.apply(this,arguments)||this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(PriorityIndex,_super),PriorityIndex.prototype.compare=function(a,b){var aPriority=a.node.getPriority(),bPriority=b.node.getPriority(),indexCmp=aPriority.compareTo(bPriority);return 0===indexCmp?nameCompare(a.name,b.name):indexCmp},PriorityIndex.prototype.isDefinedOn=function(node){return!node.getPriority().isEmpty()},PriorityIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!oldNode.getPriority().equals(newNode.getPriority())},PriorityIndex.prototype.minPost=function(){return NamedNode.MIN},PriorityIndex.prototype.maxPost=function(){return new NamedNode(MAX_NAME,new LeafNode(\"[PRIORITY-POST]\",MAX_NODE$1))},PriorityIndex.prototype.makePost=function(indexValue,name){var priorityNode=nodeFromJSON(indexValue);return new NamedNode(name,new LeafNode(\"[PRIORITY-POST]\",priorityNode))},PriorityIndex.prototype.toString=function(){return\".priority\"},PriorityIndex}(Index)),LOG_2=Math.log(2),Base12Num=function(){function Base12Num(length){this.count=parseInt(Math.log(length+1)/LOG_2,10),this.current_=this.count-1;var mask=parseInt(Array(this.count+1).join(\"1\"),2);this.bits_=length+1&mask}return Base12Num.prototype.nextBitIsOne=function(){var result=!(this.bits_&1<<this.current_);return this.current_--,result},Base12Num}(),buildChildSet=function(childList,cmp,keyFn,mapSortFn){childList.sort(cmp);var buildBalancedTree=function(low,high){var namedNode,key,length=high-low;if(0===length)return null;if(1===length)return namedNode=childList[low],key=keyFn?keyFn(namedNode):namedNode,new LLRBNode(key,namedNode.node,LLRBNode.BLACK,null,null);var middle=parseInt(length/2,10)+low,left=buildBalancedTree(low,middle),right=buildBalancedTree(middle+1,high);return namedNode=childList[middle],key=keyFn?keyFn(namedNode):namedNode,new LLRBNode(key,namedNode.node,LLRBNode.BLACK,left,right)},root=function(base12){for(var node=null,root=null,index=childList.length,buildPennant=function(chunkSize,color){var low=index-chunkSize,high=index;index-=chunkSize;var childTree=buildBalancedTree(low+1,high),namedNode=childList[low],key=keyFn?keyFn(namedNode):namedNode;attachPennant(new LLRBNode(key,namedNode.node,color,null,childTree))},attachPennant=function(pennant){node?(node.left=pennant,node=pennant):(root=pennant,node=pennant)},i=0;i<base12.count;++i){var isOne=base12.nextBitIsOne(),chunkSize=Math.pow(2,base12.count-(i+1));isOne?buildPennant(chunkSize,LLRBNode.BLACK):(buildPennant(chunkSize,LLRBNode.BLACK),buildPennant(chunkSize,LLRBNode.RED))}return root}(new Base12Num(childList.length));return new SortedMap(mapSortFn||cmp,root)},fallbackObject={},IndexMap=function(){function IndexMap(indexes_,indexSet_){this.indexes_=indexes_,this.indexSet_=indexSet_}return Object.defineProperty(IndexMap,\"Default\",{get:function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(fallbackObject&&PRIORITY_INDEX,\"ChildrenNode.ts has not been loaded\"),_defaultIndexMap=_defaultIndexMap||new IndexMap({\".priority\":fallbackObject},{\".priority\":PRIORITY_INDEX})},enumerable:!1,configurable:!0}),IndexMap.prototype.get=function(indexKey){var sortedMap=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.safeGet)(this.indexes_,indexKey);if(!sortedMap)throw new Error(\"No index defined for \"+indexKey);return sortedMap instanceof SortedMap?sortedMap:null},IndexMap.prototype.hasIndex=function(indexDefinition){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(this.indexSet_,indexDefinition.toString())},IndexMap.prototype.addIndex=function(indexDefinition,existingChildren){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(indexDefinition!==KEY_INDEX,\"KeyIndex always exists and isn't meant to be added to the IndexMap.\");for(var newIndex,childList=[],sawIndexedValue=!1,iter=existingChildren.getIterator(NamedNode.Wrap),next=iter.getNext();next;)sawIndexedValue=sawIndexedValue||indexDefinition.isDefinedOn(next.node),childList.push(next),next=iter.getNext();newIndex=sawIndexedValue?buildChildSet(childList,indexDefinition.getCompare()):fallbackObject;var indexName=indexDefinition.toString(),newIndexSet=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__assign)({},this.indexSet_);newIndexSet[indexName]=indexDefinition;var newIndexes=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__assign)({},this.indexes_);return newIndexes[indexName]=newIndex,new IndexMap(newIndexes,newIndexSet)},IndexMap.prototype.addToIndexes=function(namedNode,existingChildren){var _this=this;return new IndexMap(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.map)(this.indexes_,(function(indexedChildren,indexName){var index=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.safeGet)(_this.indexSet_,indexName);if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(index,\"Missing index implementation for \"+indexName),indexedChildren===fallbackObject){if(index.isDefinedOn(namedNode.node)){for(var childList=[],iter=existingChildren.getIterator(NamedNode.Wrap),next=iter.getNext();next;)next.name!==namedNode.name&&childList.push(next),next=iter.getNext();return childList.push(namedNode),buildChildSet(childList,index.getCompare())}return fallbackObject}var existingSnap=existingChildren.get(namedNode.name),newChildren=indexedChildren;return existingSnap&&(newChildren=newChildren.remove(new NamedNode(namedNode.name,existingSnap))),newChildren.insert(namedNode,namedNode.node)})),this.indexSet_)},IndexMap.prototype.removeFromIndexes=function(namedNode,existingChildren){return new IndexMap(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.map)(this.indexes_,(function(indexedChildren){if(indexedChildren===fallbackObject)return indexedChildren;var existingSnap=existingChildren.get(namedNode.name);return existingSnap?indexedChildren.remove(new NamedNode(namedNode.name,existingSnap)):indexedChildren})),this.indexSet_)},IndexMap}(),ChildrenNode=function(){function ChildrenNode(children_,priorityNode_,indexMap_){this.children_=children_,this.priorityNode_=priorityNode_,this.indexMap_=indexMap_,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!this.priorityNode_||this.priorityNode_.isEmpty(),\"An empty node cannot have a priority\")}return Object.defineProperty(ChildrenNode,\"EMPTY_NODE\",{get:function(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))},enumerable:!1,configurable:!0}),ChildrenNode.prototype.isLeafNode=function(){return!1},ChildrenNode.prototype.getPriority=function(){return this.priorityNode_||EMPTY_NODE},ChildrenNode.prototype.updatePriority=function(newPriorityNode){return this.children_.isEmpty()?this:new ChildrenNode(this.children_,newPriorityNode,this.indexMap_)},ChildrenNode.prototype.getImmediateChild=function(childName){if(\".priority\"===childName)return this.getPriority();var child=this.children_.get(childName);return null===child?EMPTY_NODE:child},ChildrenNode.prototype.getChild=function(path){var front=pathGetFront(path);return null===front?this:this.getImmediateChild(front).getChild(pathPopFront(path))},ChildrenNode.prototype.hasChild=function(childName){return null!==this.children_.get(childName)},ChildrenNode.prototype.updateImmediateChild=function(childName,newChildNode){if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(newChildNode,\"We should always be passing snapshot nodes\"),\".priority\"===childName)return this.updatePriority(newChildNode);var namedNode=new NamedNode(childName,newChildNode),newChildren=void 0,newIndexMap=void 0;newChildNode.isEmpty()?(newChildren=this.children_.remove(childName),newIndexMap=this.indexMap_.removeFromIndexes(namedNode,this.children_)):(newChildren=this.children_.insert(childName,newChildNode),newIndexMap=this.indexMap_.addToIndexes(namedNode,this.children_));var newPriority=newChildren.isEmpty()?EMPTY_NODE:this.priorityNode_;return new ChildrenNode(newChildren,newPriority,newIndexMap)},ChildrenNode.prototype.updateChild=function(path,newChildNode){var front=pathGetFront(path);if(null===front)return newChildNode;Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\".priority\"!==pathGetFront(path)||1===pathGetLength(path),\".priority must be the last token in a path\");var newImmediateChild=this.getImmediateChild(front).updateChild(pathPopFront(path),newChildNode);return this.updateImmediateChild(front,newImmediateChild)},ChildrenNode.prototype.isEmpty=function(){return this.children_.isEmpty()},ChildrenNode.prototype.numChildren=function(){return this.children_.count()},ChildrenNode.prototype.val=function(exportFormat){if(this.isEmpty())return null;var obj={},numKeys=0,maxKey=0,allIntegerKeys=!0;if(this.forEachChild(PRIORITY_INDEX,(function(key,childNode){obj[key]=childNode.val(exportFormat),numKeys++,allIntegerKeys&&ChildrenNode.INTEGER_REGEXP_.test(key)?maxKey=Math.max(maxKey,Number(key)):allIntegerKeys=!1})),!exportFormat&&allIntegerKeys&&maxKey<2*numKeys){var array=[];for(var key in obj)array[key]=obj[key];return array}return exportFormat&&!this.getPriority().isEmpty()&&(obj[\".priority\"]=this.getPriority().val()),obj},ChildrenNode.prototype.hash=function(){if(null===this.lazyHash_){var toHash_1=\"\";this.getPriority().isEmpty()||(toHash_1+=\"priority:\"+priorityHashText(this.getPriority().val())+\":\"),this.forEachChild(PRIORITY_INDEX,(function(key,childNode){var childHash=childNode.hash();\"\"!==childHash&&(toHash_1+=\":\"+key+\":\"+childHash)})),this.lazyHash_=\"\"===toHash_1?\"\":sha1(toHash_1)}return this.lazyHash_},ChildrenNode.prototype.getPredecessorChildName=function(childName,childNode,index){var idx=this.resolveIndex_(index);if(idx){var predecessor=idx.getPredecessorKey(new NamedNode(childName,childNode));return predecessor?predecessor.name:null}return this.children_.getPredecessorKey(childName)},ChildrenNode.prototype.getFirstChildName=function(indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){var minKey=idx.minKey();return minKey&&minKey.name}return this.children_.minKey()},ChildrenNode.prototype.getFirstChild=function(indexDefinition){var minKey=this.getFirstChildName(indexDefinition);return minKey?new NamedNode(minKey,this.children_.get(minKey)):null},ChildrenNode.prototype.getLastChildName=function(indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){var maxKey=idx.maxKey();return maxKey&&maxKey.name}return this.children_.maxKey()},ChildrenNode.prototype.getLastChild=function(indexDefinition){var maxKey=this.getLastChildName(indexDefinition);return maxKey?new NamedNode(maxKey,this.children_.get(maxKey)):null},ChildrenNode.prototype.forEachChild=function(index,action){var idx=this.resolveIndex_(index);return idx?idx.inorderTraversal((function(wrappedNode){return action(wrappedNode.name,wrappedNode.node)})):this.children_.inorderTraversal(action)},ChildrenNode.prototype.getIterator=function(indexDefinition){return this.getIteratorFrom(indexDefinition.minPost(),indexDefinition)},ChildrenNode.prototype.getIteratorFrom=function(startPost,indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx)return idx.getIteratorFrom(startPost,(function(key){return key}));for(var iterator=this.children_.getIteratorFrom(startPost.name,NamedNode.Wrap),next=iterator.peek();null!=next&&indexDefinition.compare(next,startPost)<0;)iterator.getNext(),next=iterator.peek();return iterator},ChildrenNode.prototype.getReverseIterator=function(indexDefinition){return this.getReverseIteratorFrom(indexDefinition.maxPost(),indexDefinition)},ChildrenNode.prototype.getReverseIteratorFrom=function(endPost,indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx)return idx.getReverseIteratorFrom(endPost,(function(key){return key}));for(var iterator=this.children_.getReverseIteratorFrom(endPost.name,NamedNode.Wrap),next=iterator.peek();null!=next&&indexDefinition.compare(next,endPost)>0;)iterator.getNext(),next=iterator.peek();return iterator},ChildrenNode.prototype.compareTo=function(other){return this.isEmpty()?other.isEmpty()?0:-1:other.isLeafNode()||other.isEmpty()?1:other===MAX_NODE$2?-1:0},ChildrenNode.prototype.withIndex=function(indexDefinition){if(indexDefinition===KEY_INDEX||this.indexMap_.hasIndex(indexDefinition))return this;var newIndexMap=this.indexMap_.addIndex(indexDefinition,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,newIndexMap)},ChildrenNode.prototype.isIndexed=function(index){return index===KEY_INDEX||this.indexMap_.hasIndex(index)},ChildrenNode.prototype.equals=function(other){if(other===this)return!0;if(other.isLeafNode())return!1;var otherChildrenNode=other;if(this.getPriority().equals(otherChildrenNode.getPriority())){if(this.children_.count()===otherChildrenNode.children_.count()){for(var thisIter=this.getIterator(PRIORITY_INDEX),otherIter=otherChildrenNode.getIterator(PRIORITY_INDEX),thisCurrent=thisIter.getNext(),otherCurrent=otherIter.getNext();thisCurrent&&otherCurrent;){if(thisCurrent.name!==otherCurrent.name||!thisCurrent.node.equals(otherCurrent.node))return!1;thisCurrent=thisIter.getNext(),otherCurrent=otherIter.getNext()}return null===thisCurrent&&null===otherCurrent}return!1}return!1},ChildrenNode.prototype.resolveIndex_=function(indexDefinition){return indexDefinition===KEY_INDEX?null:this.indexMap_.get(indexDefinition.toString())},ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\\d*)$/,ChildrenNode}(),MAX_NODE$2=new(function(_super){function MaxNode(){return _super.call(this,new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)||this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(MaxNode,_super),MaxNode.prototype.compareTo=function(other){return other===this?0:1},MaxNode.prototype.equals=function(other){return other===this},MaxNode.prototype.getPriority=function(){return this},MaxNode.prototype.getImmediateChild=function(childName){return ChildrenNode.EMPTY_NODE},MaxNode.prototype.isEmpty=function(){return!1},MaxNode}(ChildrenNode));function nodeFromJSON$1(json,priority){if(void 0===priority&&(priority=null),null===json)return ChildrenNode.EMPTY_NODE;if(\"object\"==typeof json&&\".priority\"in json&&(priority=json[\".priority\"]),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(null===priority||\"string\"==typeof priority||\"number\"==typeof priority||\"object\"==typeof priority&&\".sv\"in priority,\"Invalid priority type found: \"+typeof priority),\"object\"==typeof json&&\".value\"in json&&null!==json[\".value\"]&&(json=json[\".value\"]),\"object\"!=typeof json||\".sv\"in json)return new LeafNode(json,nodeFromJSON$1(priority));if(json instanceof Array){var node_1=ChildrenNode.EMPTY_NODE;return each(json,(function(key,childData){if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(json,key)&&\".\"!==key.substring(0,1)){var childNode=nodeFromJSON$1(childData);!childNode.isLeafNode()&&childNode.isEmpty()||(node_1=node_1.updateImmediateChild(key,childNode))}})),node_1.updatePriority(nodeFromJSON$1(priority))}var children_1=[],childrenHavePriority_1=!1;if(each(json,(function(key,child){if(\".\"!==key.substring(0,1)){var childNode=nodeFromJSON$1(child);childNode.isEmpty()||(childrenHavePriority_1=childrenHavePriority_1||!childNode.getPriority().isEmpty(),children_1.push(new NamedNode(key,childNode)))}})),0===children_1.length)return ChildrenNode.EMPTY_NODE;var childSet=buildChildSet(children_1,NAME_ONLY_COMPARATOR,(function(namedNode){return namedNode.name}),NAME_COMPARATOR);if(childrenHavePriority_1){var sortedChildSet=buildChildSet(children_1,PRIORITY_INDEX.getCompare());return new ChildrenNode(childSet,nodeFromJSON$1(priority),new IndexMap({\".priority\":sortedChildSet},{\".priority\":PRIORITY_INDEX}))}return new ChildrenNode(childSet,nodeFromJSON$1(priority),IndexMap.Default)}Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE$2)}}),KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE,LeafNode.__childrenNodeConstructor=ChildrenNode,MAX_NODE=MAX_NODE$2,function(val){MAX_NODE$1=val}(MAX_NODE$2),function(val){nodeFromJSON=val}(nodeFromJSON$1);var lastPushTime,lastRandChars,PathIndex=function(_super){function PathIndex(indexPath_){var _this=_super.call(this)||this;return _this.indexPath_=indexPath_,Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!pathIsEmpty(indexPath_)&&\".priority\"!==pathGetFront(indexPath_),\"Can't create PathIndex with empty path or .priority key\"),_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(PathIndex,_super),PathIndex.prototype.extractChild=function(snap){return snap.getChild(this.indexPath_)},PathIndex.prototype.isDefinedOn=function(node){return!node.getChild(this.indexPath_).isEmpty()},PathIndex.prototype.compare=function(a,b){var aChild=this.extractChild(a.node),bChild=this.extractChild(b.node),indexCmp=aChild.compareTo(bChild);return 0===indexCmp?nameCompare(a.name,b.name):indexCmp},PathIndex.prototype.makePost=function(indexValue,name){var valueNode=nodeFromJSON$1(indexValue),node=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,valueNode);return new NamedNode(name,node)},PathIndex.prototype.maxPost=function(){var node=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE$2);return new NamedNode(MAX_NAME,node)},PathIndex.prototype.toString=function(){return pathSlice(this.indexPath_,0).join(\"/\")},PathIndex}(Index),VALUE_INDEX=new(function(_super){function ValueIndex(){return null!==_super&&_super.apply(this,arguments)||this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(ValueIndex,_super),ValueIndex.prototype.compare=function(a,b){var indexCmp=a.node.compareTo(b.node);return 0===indexCmp?nameCompare(a.name,b.name):indexCmp},ValueIndex.prototype.isDefinedOn=function(node){return!0},ValueIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!oldNode.equals(newNode)},ValueIndex.prototype.minPost=function(){return NamedNode.MIN},ValueIndex.prototype.maxPost=function(){return NamedNode.MAX},ValueIndex.prototype.makePost=function(indexValue,name){var valueNode=nodeFromJSON$1(indexValue);return new NamedNode(name,valueNode)},ValueIndex.prototype.toString=function(){return\".value\"},ValueIndex}(Index)),PUSH_CHARS=\"-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz\",nextPushId=(lastPushTime=0,lastRandChars=[],function(now){var i,duplicateTime=now===lastPushTime;lastPushTime=now;var timeStampChars=new Array(8);for(i=7;i>=0;i--)timeStampChars[i]=PUSH_CHARS.charAt(now%64),now=Math.floor(now/64);Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(0===now,\"Cannot push at time == 0\");var id=timeStampChars.join(\"\");if(duplicateTime){for(i=11;i>=0&&63===lastRandChars[i];i--)lastRandChars[i]=0;lastRandChars[i]++}else for(i=0;i<12;i++)lastRandChars[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)id+=PUSH_CHARS.charAt(lastRandChars[i]);return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(20===id.length,\"nextPushId: Length should be 20.\"),id}),successor=function(key){if(\"2147483647\"===key)return\"-\";var keyAsInt=tryParseInt(key);if(null!=keyAsInt)return\"\"+(keyAsInt+1);for(var next=new Array(key.length),i_1=0;i_1<next.length;i_1++)next[i_1]=key.charAt(i_1);if(next.length<786)return next.push(\"-\"),next.join(\"\");for(var i=next.length-1;i>=0&&\"z\"===next[i];)i--;if(-1===i)return MAX_NAME;var sourcePlusOne=PUSH_CHARS.charAt(PUSH_CHARS.indexOf(next[i])+1);return next[i]=sourcePlusOne,next.slice(0,i+1).join(\"\")},predecessor=function(key){if(\"-2147483648\"===key)return MIN_NAME;var keyAsInt=tryParseInt(key);if(null!=keyAsInt)return\"\"+(keyAsInt-1);for(var next=new Array(key.length),i=0;i<next.length;i++)next[i]=key.charAt(i);return\"-\"===next[next.length-1]?1===next.length?\"2147483647\":(delete next[next.length-1],next.join(\"\")):(next[next.length-1]=PUSH_CHARS.charAt(PUSH_CHARS.indexOf(next[next.length-1])-1),next.join(\"\")+\"z\".repeat(786-next.length))};function changeValue(snapshotNode){return{type:\"value\",snapshotNode:snapshotNode}}function changeChildAdded(childName,snapshotNode){return{type:\"child_added\",snapshotNode:snapshotNode,childName:childName}}function changeChildRemoved(childName,snapshotNode){return{type:\"child_removed\",snapshotNode:snapshotNode,childName:childName}}function changeChildChanged(childName,snapshotNode,oldSnap){return{type:\"child_changed\",snapshotNode:snapshotNode,childName:childName,oldSnap:oldSnap}}var IndexedFilter=function(){function IndexedFilter(index_){this.index_=index_}return IndexedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(snap.isIndexed(this.index_),\"A node must be indexed if only a child is updated\");var oldChild=snap.getImmediateChild(key);return oldChild.getChild(affectedPath).equals(newChild.getChild(affectedPath))&&oldChild.isEmpty()===newChild.isEmpty()?snap:(null!=optChangeAccumulator&&(newChild.isEmpty()?snap.hasChild(key)?optChangeAccumulator.trackChildChange(changeChildRemoved(key,oldChild)):Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(snap.isLeafNode(),\"A child remove without an old child only makes sense on a leaf node\"):oldChild.isEmpty()?optChangeAccumulator.trackChildChange(changeChildAdded(key,newChild)):optChangeAccumulator.trackChildChange(changeChildChanged(key,newChild,oldChild))),snap.isLeafNode()&&newChild.isEmpty()?snap:snap.updateImmediateChild(key,newChild).withIndex(this.index_))},IndexedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){return null!=optChangeAccumulator&&(oldSnap.isLeafNode()||oldSnap.forEachChild(PRIORITY_INDEX,(function(key,childNode){newSnap.hasChild(key)||optChangeAccumulator.trackChildChange(changeChildRemoved(key,childNode))})),newSnap.isLeafNode()||newSnap.forEachChild(PRIORITY_INDEX,(function(key,childNode){if(oldSnap.hasChild(key)){var oldChild=oldSnap.getImmediateChild(key);oldChild.equals(childNode)||optChangeAccumulator.trackChildChange(changeChildChanged(key,childNode,oldChild))}else optChangeAccumulator.trackChildChange(changeChildAdded(key,childNode))}))),newSnap.withIndex(this.index_)},IndexedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap.isEmpty()?ChildrenNode.EMPTY_NODE:oldSnap.updatePriority(newPriority)},IndexedFilter.prototype.filtersNodes=function(){return!1},IndexedFilter.prototype.getIndexedFilter=function(){return this},IndexedFilter.prototype.getIndex=function(){return this.index_},IndexedFilter}(),RangedFilter=function(){function RangedFilter(params){this.indexedFilter_=new IndexedFilter(params.getIndex()),this.index_=params.getIndex(),this.startPost_=RangedFilter.getStartPost_(params),this.endPost_=RangedFilter.getEndPost_(params)}return RangedFilter.prototype.getStartPost=function(){return this.startPost_},RangedFilter.prototype.getEndPost=function(){return this.endPost_},RangedFilter.prototype.matches=function(node){return this.index_.compare(this.getStartPost(),node)<=0&&this.index_.compare(node,this.getEndPost())<=0},RangedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){return this.matches(new NamedNode(key,newChild))||(newChild=ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(snap,key,newChild,affectedPath,source,optChangeAccumulator)},RangedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){newSnap.isLeafNode()&&(newSnap=ChildrenNode.EMPTY_NODE);var filtered=newSnap.withIndex(this.index_);filtered=filtered.updatePriority(ChildrenNode.EMPTY_NODE);var self=this;return newSnap.forEachChild(PRIORITY_INDEX,(function(key,childNode){self.matches(new NamedNode(key,childNode))||(filtered=filtered.updateImmediateChild(key,ChildrenNode.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(oldSnap,filtered,optChangeAccumulator)},RangedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap},RangedFilter.prototype.filtersNodes=function(){return!0},RangedFilter.prototype.getIndexedFilter=function(){return this.indexedFilter_},RangedFilter.prototype.getIndex=function(){return this.index_},RangedFilter.getStartPost_=function(params){if(params.hasStart()){var startName=params.getIndexStartName();return params.getIndex().makePost(params.getIndexStartValue(),startName)}return params.getIndex().minPost()},RangedFilter.getEndPost_=function(params){if(params.hasEnd()){var endName=params.getIndexEndName();return params.getIndex().makePost(params.getIndexEndValue(),endName)}return params.getIndex().maxPost()},RangedFilter}(),LimitedFilter=function(){function LimitedFilter(params){this.rangedFilter_=new RangedFilter(params),this.index_=params.getIndex(),this.limit_=params.getLimit(),this.reverse_=!params.isViewFromLeft()}return LimitedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){return this.rangedFilter_.matches(new NamedNode(key,newChild))||(newChild=ChildrenNode.EMPTY_NODE),snap.getImmediateChild(key).equals(newChild)?snap:snap.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(snap,key,newChild,affectedPath,source,optChangeAccumulator):this.fullLimitUpdateChild_(snap,key,newChild,source,optChangeAccumulator)},LimitedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){var filtered;if(newSnap.isLeafNode()||newSnap.isEmpty())filtered=ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<newSnap.numChildren()&&newSnap.isIndexed(this.index_)){filtered=ChildrenNode.EMPTY_NODE.withIndex(this.index_);var iterator=void 0;iterator=this.reverse_?newSnap.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):newSnap.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var count=0;iterator.hasNext()&&count<this.limit_;){var next=iterator.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),next)<=0:this.index_.compare(next,this.rangedFilter_.getEndPost())<=0))break;filtered=filtered.updateImmediateChild(next.name,next.node),count++}}else{filtered=(filtered=newSnap.withIndex(this.index_)).updatePriority(ChildrenNode.EMPTY_NODE);var startPost=void 0,endPost=void 0,cmp=void 0;if(iterator=void 0,this.reverse_){iterator=filtered.getReverseIterator(this.index_),startPost=this.rangedFilter_.getEndPost(),endPost=this.rangedFilter_.getStartPost();var indexCompare_1=this.index_.getCompare();cmp=function(a,b){return indexCompare_1(b,a)}}else iterator=filtered.getIterator(this.index_),startPost=this.rangedFilter_.getStartPost(),endPost=this.rangedFilter_.getEndPost(),cmp=this.index_.getCompare();count=0;for(var foundStartPost=!1;iterator.hasNext();)next=iterator.getNext(),!foundStartPost&&cmp(startPost,next)<=0&&(foundStartPost=!0),foundStartPost&&count<this.limit_&&cmp(next,endPost)<=0?count++:filtered=filtered.updateImmediateChild(next.name,ChildrenNode.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(oldSnap,filtered,optChangeAccumulator)},LimitedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap},LimitedFilter.prototype.filtersNodes=function(){return!0},LimitedFilter.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},LimitedFilter.prototype.getIndex=function(){return this.index_},LimitedFilter.prototype.fullLimitUpdateChild_=function(snap,childKey,childSnap,source,changeAccumulator){var cmp;if(this.reverse_){var indexCmp_1=this.index_.getCompare();cmp=function(a,b){return indexCmp_1(b,a)}}else cmp=this.index_.getCompare();var oldEventCache=snap;Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(oldEventCache.numChildren()===this.limit_,\"\");var newChildNamedNode=new NamedNode(childKey,childSnap),windowBoundary=this.reverse_?oldEventCache.getFirstChild(this.index_):oldEventCache.getLastChild(this.index_),inRange=this.rangedFilter_.matches(newChildNamedNode);if(oldEventCache.hasChild(childKey)){for(var oldChildSnap=oldEventCache.getImmediateChild(childKey),nextChild=source.getChildAfterChild(this.index_,windowBoundary,this.reverse_);null!=nextChild&&(nextChild.name===childKey||oldEventCache.hasChild(nextChild.name));)nextChild=source.getChildAfterChild(this.index_,nextChild,this.reverse_);var compareNext=null==nextChild?1:cmp(nextChild,newChildNamedNode);if(inRange&&!childSnap.isEmpty()&&compareNext>=0)return null!=changeAccumulator&&changeAccumulator.trackChildChange(changeChildChanged(childKey,childSnap,oldChildSnap)),oldEventCache.updateImmediateChild(childKey,childSnap);null!=changeAccumulator&&changeAccumulator.trackChildChange(changeChildRemoved(childKey,oldChildSnap));var newEventCache=oldEventCache.updateImmediateChild(childKey,ChildrenNode.EMPTY_NODE);return null!=nextChild&&this.rangedFilter_.matches(nextChild)?(null!=changeAccumulator&&changeAccumulator.trackChildChange(changeChildAdded(nextChild.name,nextChild.node)),newEventCache.updateImmediateChild(nextChild.name,nextChild.node)):newEventCache}return childSnap.isEmpty()?snap:inRange&&cmp(windowBoundary,newChildNamedNode)>=0?(null!=changeAccumulator&&(changeAccumulator.trackChildChange(changeChildRemoved(windowBoundary.name,windowBoundary.node)),changeAccumulator.trackChildChange(changeChildAdded(childKey,childSnap))),oldEventCache.updateImmediateChild(childKey,childSnap).updateImmediateChild(windowBoundary.name,ChildrenNode.EMPTY_NODE)):snap},LimitedFilter}(),QueryParams=function(){function QueryParams(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_=\"\",this.indexStartValue_=null,this.indexStartName_=\"\",this.indexEndValue_=null,this.indexEndName_=\"\",this.index_=PRIORITY_INDEX}return QueryParams.prototype.hasStart=function(){return this.startSet_},QueryParams.prototype.hasStartAfter=function(){return this.startAfterSet_},QueryParams.prototype.hasEndBefore=function(){return this.endBeforeSet_},QueryParams.prototype.isViewFromLeft=function(){return\"\"===this.viewFrom_?this.startSet_:\"l\"===this.viewFrom_},QueryParams.prototype.getIndexStartValue=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(this.startSet_,\"Only valid if start has been set\"),this.indexStartValue_},QueryParams.prototype.getIndexStartName=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(this.startSet_,\"Only valid if start has been set\"),this.startNameSet_?this.indexStartName_:MIN_NAME},QueryParams.prototype.hasEnd=function(){return this.endSet_},QueryParams.prototype.getIndexEndValue=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(this.endSet_,\"Only valid if end has been set\"),this.indexEndValue_},QueryParams.prototype.getIndexEndName=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(this.endSet_,\"Only valid if end has been set\"),this.endNameSet_?this.indexEndName_:MAX_NAME},QueryParams.prototype.hasLimit=function(){return this.limitSet_},QueryParams.prototype.hasAnchoredLimit=function(){return this.limitSet_&&\"\"!==this.viewFrom_},QueryParams.prototype.getLimit=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(this.limitSet_,\"Only valid if limit has been set\"),this.limit_},QueryParams.prototype.getIndex=function(){return this.index_},QueryParams.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},QueryParams.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===PRIORITY_INDEX},QueryParams.prototype.copy=function(){var copy=new QueryParams;return copy.limitSet_=this.limitSet_,copy.limit_=this.limit_,copy.startSet_=this.startSet_,copy.indexStartValue_=this.indexStartValue_,copy.startNameSet_=this.startNameSet_,copy.indexStartName_=this.indexStartName_,copy.endSet_=this.endSet_,copy.indexEndValue_=this.indexEndValue_,copy.endNameSet_=this.endNameSet_,copy.indexEndName_=this.indexEndName_,copy.index_=this.index_,copy.viewFrom_=this.viewFrom_,copy},QueryParams}();function queryParamsStartAt(queryParams,indexValue,key){var newParams=queryParams.copy();return newParams.startSet_=!0,void 0===indexValue&&(indexValue=null),newParams.indexStartValue_=indexValue,null!=key?(newParams.startNameSet_=!0,newParams.indexStartName_=key):(newParams.startNameSet_=!1,newParams.indexStartName_=\"\"),newParams}function queryParamsEndAt(queryParams,indexValue,key){var newParams=queryParams.copy();return newParams.endSet_=!0,void 0===indexValue&&(indexValue=null),newParams.indexEndValue_=indexValue,void 0!==key?(newParams.endNameSet_=!0,newParams.indexEndName_=key):(newParams.endNameSet_=!1,newParams.indexEndName_=\"\"),newParams}function queryParamsOrderBy(queryParams,index){var newParams=queryParams.copy();return newParams.index_=index,newParams}function queryParamsToRestQueryStringParameters(queryParams){var orderBy,qs={};return queryParams.isDefault()||(queryParams.index_===PRIORITY_INDEX?orderBy=\"$priority\":queryParams.index_===VALUE_INDEX?orderBy=\"$value\":queryParams.index_===KEY_INDEX?orderBy=\"$key\":(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(queryParams.index_ instanceof PathIndex,\"Unrecognized index type!\"),orderBy=queryParams.index_.toString()),qs.orderBy=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(orderBy),queryParams.startSet_&&(qs.startAt=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(queryParams.indexStartValue_),queryParams.startNameSet_&&(qs.startAt+=\",\"+Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(queryParams.indexStartName_))),queryParams.endSet_&&(qs.endAt=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(queryParams.indexEndValue_),queryParams.endNameSet_&&(qs.endAt+=\",\"+Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(queryParams.indexEndName_))),queryParams.limitSet_&&(queryParams.isViewFromLeft()?qs.limitToFirst=queryParams.limit_:qs.limitToLast=queryParams.limit_)),qs}function queryParamsGetQueryObject(queryParams){var obj={};if(queryParams.startSet_&&(obj.sp=queryParams.indexStartValue_,queryParams.startNameSet_&&(obj.sn=queryParams.indexStartName_)),queryParams.endSet_&&(obj.ep=queryParams.indexEndValue_,queryParams.endNameSet_&&(obj.en=queryParams.indexEndName_)),queryParams.limitSet_){obj.l=queryParams.limit_;var viewFrom=queryParams.viewFrom_;\"\"===viewFrom&&(viewFrom=queryParams.isViewFromLeft()?\"l\":\"r\"),obj.vf=viewFrom}return queryParams.index_!==PRIORITY_INDEX&&(obj.i=queryParams.index_.toString()),obj}var ReadonlyRestClient=function(_super){function ReadonlyRestClient(repoInfo_,onDataUpdate_,authTokenProvider_,appCheckTokenProvider_){var _this=_super.call(this)||this;return _this.repoInfo_=repoInfo_,_this.onDataUpdate_=onDataUpdate_,_this.authTokenProvider_=authTokenProvider_,_this.appCheckTokenProvider_=appCheckTokenProvider_,_this.log_=logWrapper(\"p:rest:\"),_this.listens_={},_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(ReadonlyRestClient,_super),ReadonlyRestClient.prototype.reportStats=function(stats){throw new Error(\"Method not implemented.\")},ReadonlyRestClient.getListenId_=function(query,tag){return void 0!==tag?\"tag$\"+tag:(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(query._queryParams.isDefault(),\"should have a tag if it's not a default query.\"),query._path.toString())},ReadonlyRestClient.prototype.listen=function(query,currentHashFn,tag,onComplete){var _this=this,pathString=query._path.toString();this.log_(\"Listen called for \"+pathString+\" \"+query._queryIdentifier);var listenId=ReadonlyRestClient.getListenId_(query,tag),thisListen={};this.listens_[listenId]=thisListen;var queryStringParameters=queryParamsToRestQueryStringParameters(query._queryParams);this.restRequest_(pathString+\".json\",queryStringParameters,(function(error,result){var data=result;404===error&&(data=null,error=null),null===error&&_this.onDataUpdate_(pathString,data,!1,tag),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.safeGet)(_this.listens_,listenId)===thisListen&&onComplete(error?401===error?\"permission_denied\":\"rest_error:\"+error:\"ok\",null)}))},ReadonlyRestClient.prototype.unlisten=function(query,tag){var listenId=ReadonlyRestClient.getListenId_(query,tag);delete this.listens_[listenId]},ReadonlyRestClient.prototype.get=function(query){var _this=this,queryStringParameters=queryParamsToRestQueryStringParameters(query._queryParams),pathString=query._path.toString(),deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred;return this.restRequest_(pathString+\".json\",queryStringParameters,(function(error,result){var data=result;404===error&&(data=null,error=null),null===error?(_this.onDataUpdate_(pathString,data,!1,null),deferred.resolve(data)):deferred.reject(new Error(data))})),deferred.promise},ReadonlyRestClient.prototype.refreshAuthToken=function(token){},ReadonlyRestClient.prototype.restRequest_=function(pathString,queryStringParameters,callback){var _this=this;return void 0===queryStringParameters&&(queryStringParameters={}),queryStringParameters.format=\"export\",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(_a){var _b=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__read)(_a,2),authToken=_b[0],appCheckToken=_b[1];authToken&&authToken.accessToken&&(queryStringParameters.auth=authToken.accessToken),appCheckToken&&appCheckToken.token&&(queryStringParameters.ac=appCheckToken.token);var url=(_this.repoInfo_.secure?\"https://\":\"http://\")+_this.repoInfo_.host+pathString+\"?ns=\"+_this.repoInfo_.namespace+Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.querystring)(queryStringParameters);_this.log_(\"Sending REST request for \"+url);var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(callback&&4===xhr.readyState){_this.log_(\"REST Response for \"+url+\" received. status:\",xhr.status,\"response:\",xhr.responseText);var res=null;if(xhr.status>=200&&xhr.status<300){try{res=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.jsonEval)(xhr.responseText)}catch(e){warn(\"Failed to parse JSON response for \"+url+\": \"+xhr.responseText)}callback(null,res)}else 401!==xhr.status&&404!==xhr.status&&warn(\"Got unsuccessful REST response for \"+url+\" Status: \"+xhr.status),callback(xhr.status);callback=null}},xhr.open(\"GET\",url,!0),xhr.send()}))},ReadonlyRestClient}(ServerActions),SnapshotHolder=function(){function SnapshotHolder(){this.rootNode_=ChildrenNode.EMPTY_NODE}return SnapshotHolder.prototype.getNode=function(path){return this.rootNode_.getChild(path)},SnapshotHolder.prototype.updateSnapshot=function(path,newSnapshotNode){this.rootNode_=this.rootNode_.updateChild(path,newSnapshotNode)},SnapshotHolder}();function newSparseSnapshotTree(){return{value:null,children:new Map}}function sparseSnapshotTreeRemember(sparseSnapshotTree,path,data){if(pathIsEmpty(path))sparseSnapshotTree.value=data,sparseSnapshotTree.children.clear();else if(null!==sparseSnapshotTree.value)sparseSnapshotTree.value=sparseSnapshotTree.value.updateChild(path,data);else{var childKey=pathGetFront(path);sparseSnapshotTree.children.has(childKey)||sparseSnapshotTree.children.set(childKey,newSparseSnapshotTree()),sparseSnapshotTreeRemember(sparseSnapshotTree.children.get(childKey),path=pathPopFront(path),data)}}function sparseSnapshotTreeForEachTree(sparseSnapshotTree,prefixPath,func){null!==sparseSnapshotTree.value?func(prefixPath,sparseSnapshotTree.value):function(sparseSnapshotTree,func){sparseSnapshotTree.children.forEach((function(tree,key){func(key,tree)}))}(sparseSnapshotTree,(function(key,tree){sparseSnapshotTreeForEachTree(tree,new Path(prefixPath.toString()+\"/\"+key),func)}))}var StatsListener=function(){function StatsListener(collection_){this.collection_=collection_,this.last_=null}return StatsListener.prototype.get=function(){var newStats=this.collection_.get(),delta=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__assign)({},newStats);return this.last_&&each(this.last_,(function(stat,value){delta[stat]=delta[stat]-value})),this.last_=newStats,delta},StatsListener}(),StatsReporter=function(){function StatsReporter(collection,server_){this.server_=server_,this.statsToReport_={},this.statsListener_=new StatsListener(collection);var timeout=1e4+2e4*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(timeout))}return StatsReporter.prototype.reportStats_=function(){var _this=this,stats=this.statsListener_.get(),reportedStats={},haveStatsToReport=!1;each(stats,(function(stat,value){value>0&&Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(_this.statsToReport_,stat)&&(reportedStats[stat]=value,haveStatsToReport=!0)})),haveStatsToReport&&this.server_.reportStats(reportedStats),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},StatsReporter}(),OperationType=function(OperationType){return OperationType[OperationType.OVERWRITE=0]=\"OVERWRITE\",OperationType[OperationType.MERGE=1]=\"MERGE\",OperationType[OperationType.ACK_USER_WRITE=2]=\"ACK_USER_WRITE\",OperationType[OperationType.LISTEN_COMPLETE=3]=\"LISTEN_COMPLETE\",OperationType}({});function newOperationSourceServerTaggedQuery(queryId){return{fromUser:!1,fromServer:!0,queryId:queryId,tagged:!0}}var emptyChildrenSingleton,AckUserWrite=function(){function AckUserWrite(path,affectedTree,revert){this.path=path,this.affectedTree=affectedTree,this.revert=revert,this.type=OperationType.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return AckUserWrite.prototype.operationForChild=function(childName){if(pathIsEmpty(this.path)){if(null!=this.affectedTree.value)return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(this.affectedTree.children.isEmpty(),\"affectedTree should not have overlapping affected paths.\"),this;var childTree=this.affectedTree.subtree(new Path(childName));return new AckUserWrite(newEmptyPath(),childTree,this.revert)}return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(pathGetFront(this.path)===childName,\"operationForChild called for unrelated child.\"),new AckUserWrite(pathPopFront(this.path),this.affectedTree,this.revert)},AckUserWrite}(),ListenComplete=function(){function ListenComplete(source,path){this.source=source,this.path=path,this.type=OperationType.LISTEN_COMPLETE}return ListenComplete.prototype.operationForChild=function(childName){return pathIsEmpty(this.path)?new ListenComplete(this.source,newEmptyPath()):new ListenComplete(this.source,pathPopFront(this.path))},ListenComplete}(),Overwrite=function(){function Overwrite(source,path,snap){this.source=source,this.path=path,this.snap=snap,this.type=OperationType.OVERWRITE}return Overwrite.prototype.operationForChild=function(childName){return pathIsEmpty(this.path)?new Overwrite(this.source,newEmptyPath(),this.snap.getImmediateChild(childName)):new Overwrite(this.source,pathPopFront(this.path),this.snap)},Overwrite}(),Merge=function(){function Merge(source,path,children){this.source=source,this.path=path,this.children=children,this.type=OperationType.MERGE}return Merge.prototype.operationForChild=function(childName){if(pathIsEmpty(this.path)){var childTree=this.children.subtree(new Path(childName));return childTree.isEmpty()?null:childTree.value?new Overwrite(this.source,newEmptyPath(),childTree.value):new Merge(this.source,newEmptyPath(),childTree)}return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(pathGetFront(this.path)===childName,\"Can't get a merge for a child not on the path of the operation\"),new Merge(this.source,pathPopFront(this.path),this.children)},Merge.prototype.toString=function(){return\"Operation(\"+this.path+\": \"+this.source.toString()+\" merge: \"+this.children.toString()+\")\"},Merge}(),CacheNode=function(){function CacheNode(node_,fullyInitialized_,filtered_){this.node_=node_,this.fullyInitialized_=fullyInitialized_,this.filtered_=filtered_}return CacheNode.prototype.isFullyInitialized=function(){return this.fullyInitialized_},CacheNode.prototype.isFiltered=function(){return this.filtered_},CacheNode.prototype.isCompleteForPath=function(path){if(pathIsEmpty(path))return this.isFullyInitialized()&&!this.filtered_;var childKey=pathGetFront(path);return this.isCompleteForChild(childKey)},CacheNode.prototype.isCompleteForChild=function(key){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(key)},CacheNode.prototype.getNode=function(){return this.node_},CacheNode}(),EventGenerator=function(){return function(query_){this.query_=query_,this.index_=this.query_._queryParams.getIndex()}}();function eventGeneratorGenerateEventsForType(eventGenerator,events,eventType,changes,registrations,eventCache){var filteredChanges=changes.filter((function(change){return change.type===eventType}));filteredChanges.sort((function(a,b){return function(eventGenerator,a,b){if(null==a.childName||null==b.childName)throw Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assertionError)(\"Should only compare child_ events.\");var aWrapped=new NamedNode(a.childName,a.snapshotNode),bWrapped=new NamedNode(b.childName,b.snapshotNode);return eventGenerator.index_.compare(aWrapped,bWrapped)}(eventGenerator,a,b)})),filteredChanges.forEach((function(change){var materializedChange=function(eventGenerator,change,eventCache){return\"value\"===change.type||\"child_removed\"===change.type||(change.prevName=eventCache.getPredecessorChildName(change.childName,change.snapshotNode,eventGenerator.index_)),change}(eventGenerator,change,eventCache);registrations.forEach((function(registration){registration.respondsTo(change.type)&&events.push(registration.createEvent(materializedChange,eventGenerator.query_))}))}))}function newViewCache(eventCache,serverCache){return{eventCache:eventCache,serverCache:serverCache}}function viewCacheUpdateEventSnap(viewCache,eventSnap,complete,filtered){return newViewCache(new CacheNode(eventSnap,complete,filtered),viewCache.serverCache)}function viewCacheUpdateServerSnap(viewCache,serverSnap,complete,filtered){return newViewCache(viewCache.eventCache,new CacheNode(serverSnap,complete,filtered))}function viewCacheGetCompleteEventSnap(viewCache){return viewCache.eventCache.isFullyInitialized()?viewCache.eventCache.getNode():null}function viewCacheGetCompleteServerSnap(viewCache){return viewCache.serverCache.isFullyInitialized()?viewCache.serverCache.getNode():null}var ImmutableTree=function(){function ImmutableTree(value,children){void 0===children&&(emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),children=emptyChildrenSingleton),this.value=value,this.children=children}return ImmutableTree.fromObject=function(obj){var tree=new ImmutableTree(null);return each(obj,(function(childPath,childSnap){tree=tree.set(new Path(childPath),childSnap)})),tree},ImmutableTree.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},ImmutableTree.prototype.findRootMostMatchingPathAndValue=function(relativePath,predicate){if(null!=this.value&&predicate(this.value))return{path:newEmptyPath(),value:this.value};if(pathIsEmpty(relativePath))return null;var front=pathGetFront(relativePath),child=this.children.get(front);if(null!==child){var childExistingPathAndValue=child.findRootMostMatchingPathAndValue(pathPopFront(relativePath),predicate);return null!=childExistingPathAndValue?{path:pathChild(new Path(front),childExistingPathAndValue.path),value:childExistingPathAndValue.value}:null}return null},ImmutableTree.prototype.findRootMostValueAndPath=function(relativePath){return this.findRootMostMatchingPathAndValue(relativePath,(function(){return!0}))},ImmutableTree.prototype.subtree=function(relativePath){if(pathIsEmpty(relativePath))return this;var front=pathGetFront(relativePath),childTree=this.children.get(front);return null!==childTree?childTree.subtree(pathPopFront(relativePath)):new ImmutableTree(null)},ImmutableTree.prototype.set=function(relativePath,toSet){if(pathIsEmpty(relativePath))return new ImmutableTree(toSet,this.children);var front=pathGetFront(relativePath),newChild=(this.children.get(front)||new ImmutableTree(null)).set(pathPopFront(relativePath),toSet),newChildren=this.children.insert(front,newChild);return new ImmutableTree(this.value,newChildren)},ImmutableTree.prototype.remove=function(relativePath){if(pathIsEmpty(relativePath))return this.children.isEmpty()?new ImmutableTree(null):new ImmutableTree(null,this.children);var front=pathGetFront(relativePath),child=this.children.get(front);if(child){var newChild=child.remove(pathPopFront(relativePath)),newChildren=void 0;return newChildren=newChild.isEmpty()?this.children.remove(front):this.children.insert(front,newChild),null===this.value&&newChildren.isEmpty()?new ImmutableTree(null):new ImmutableTree(this.value,newChildren)}return this},ImmutableTree.prototype.get=function(relativePath){if(pathIsEmpty(relativePath))return this.value;var front=pathGetFront(relativePath),child=this.children.get(front);return child?child.get(pathPopFront(relativePath)):null},ImmutableTree.prototype.setTree=function(relativePath,newTree){if(pathIsEmpty(relativePath))return newTree;var newChildren,front=pathGetFront(relativePath),newChild=(this.children.get(front)||new ImmutableTree(null)).setTree(pathPopFront(relativePath),newTree);return newChildren=newChild.isEmpty()?this.children.remove(front):this.children.insert(front,newChild),new ImmutableTree(this.value,newChildren)},ImmutableTree.prototype.fold=function(fn){return this.fold_(newEmptyPath(),fn)},ImmutableTree.prototype.fold_=function(pathSoFar,fn){var accum={};return this.children.inorderTraversal((function(childKey,childTree){accum[childKey]=childTree.fold_(pathChild(pathSoFar,childKey),fn)})),fn(pathSoFar,this.value,accum)},ImmutableTree.prototype.findOnPath=function(path,f){return this.findOnPath_(path,newEmptyPath(),f)},ImmutableTree.prototype.findOnPath_=function(pathToFollow,pathSoFar,f){var result=!!this.value&&f(pathSoFar,this.value);if(result)return result;if(pathIsEmpty(pathToFollow))return null;var front=pathGetFront(pathToFollow),nextChild=this.children.get(front);return nextChild?nextChild.findOnPath_(pathPopFront(pathToFollow),pathChild(pathSoFar,front),f):null},ImmutableTree.prototype.foreachOnPath=function(path,f){return this.foreachOnPath_(path,newEmptyPath(),f)},ImmutableTree.prototype.foreachOnPath_=function(pathToFollow,currentRelativePath,f){if(pathIsEmpty(pathToFollow))return this;this.value&&f(currentRelativePath,this.value);var front=pathGetFront(pathToFollow),nextChild=this.children.get(front);return nextChild?nextChild.foreachOnPath_(pathPopFront(pathToFollow),pathChild(currentRelativePath,front),f):new ImmutableTree(null)},ImmutableTree.prototype.foreach=function(f){this.foreach_(newEmptyPath(),f)},ImmutableTree.prototype.foreach_=function(currentRelativePath,f){this.children.inorderTraversal((function(childName,childTree){childTree.foreach_(pathChild(currentRelativePath,childName),f)})),this.value&&f(currentRelativePath,this.value)},ImmutableTree.prototype.foreachChild=function(f){this.children.inorderTraversal((function(childName,childTree){childTree.value&&f(childName,childTree.value)}))},ImmutableTree}(),CompoundWrite=function(){function CompoundWrite(writeTree_){this.writeTree_=writeTree_}return CompoundWrite.empty=function(){return new CompoundWrite(new ImmutableTree(null))},CompoundWrite}();function compoundWriteAddWrite(compoundWrite,path,node){if(pathIsEmpty(path))return new CompoundWrite(new ImmutableTree(node));var rootmost=compoundWrite.writeTree_.findRootMostValueAndPath(path);if(null!=rootmost){var rootMostPath=rootmost.path,value=rootmost.value,relativePath=newRelativePath(rootMostPath,path);return value=value.updateChild(relativePath,node),new CompoundWrite(compoundWrite.writeTree_.set(rootMostPath,value))}var subtree=new ImmutableTree(node),newWriteTree=compoundWrite.writeTree_.setTree(path,subtree);return new CompoundWrite(newWriteTree)}function compoundWriteAddWrites(compoundWrite,path,updates){var newWrite=compoundWrite;return each(updates,(function(childKey,node){newWrite=compoundWriteAddWrite(newWrite,pathChild(path,childKey),node)})),newWrite}function compoundWriteRemoveWrite(compoundWrite,path){if(pathIsEmpty(path))return CompoundWrite.empty();var newWriteTree=compoundWrite.writeTree_.setTree(path,new ImmutableTree(null));return new CompoundWrite(newWriteTree)}function compoundWriteHasCompleteWrite(compoundWrite,path){return null!=compoundWriteGetCompleteNode(compoundWrite,path)}function compoundWriteGetCompleteNode(compoundWrite,path){var rootmost=compoundWrite.writeTree_.findRootMostValueAndPath(path);return null!=rootmost?compoundWrite.writeTree_.get(rootmost.path).getChild(newRelativePath(rootmost.path,path)):null}function compoundWriteGetCompleteChildren(compoundWrite){var children=[],node=compoundWrite.writeTree_.value;return null!=node?node.isLeafNode()||node.forEachChild(PRIORITY_INDEX,(function(childName,childNode){children.push(new NamedNode(childName,childNode))})):compoundWrite.writeTree_.children.inorderTraversal((function(childName,childTree){null!=childTree.value&&children.push(new NamedNode(childName,childTree.value))})),children}function compoundWriteChildCompoundWrite(compoundWrite,path){if(pathIsEmpty(path))return compoundWrite;var shadowingNode=compoundWriteGetCompleteNode(compoundWrite,path);return new CompoundWrite(null!=shadowingNode?new ImmutableTree(shadowingNode):compoundWrite.writeTree_.subtree(path))}function compoundWriteIsEmpty(compoundWrite){return compoundWrite.writeTree_.isEmpty()}function compoundWriteApply(compoundWrite,node){return function applySubtreeWrite(relativePath,writeTree,node){if(null!=writeTree.value)return node.updateChild(relativePath,writeTree.value);var priorityWrite_1=null;return writeTree.children.inorderTraversal((function(childKey,childTree){\".priority\"===childKey?(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(null!==childTree.value,\"Priority writes must always be leaf nodes\"),priorityWrite_1=childTree.value):node=applySubtreeWrite(pathChild(relativePath,childKey),childTree,node)})),node.getChild(relativePath).isEmpty()||null===priorityWrite_1||(node=node.updateChild(pathChild(relativePath,\".priority\"),priorityWrite_1)),node}(newEmptyPath(),compoundWrite.writeTree_,node)}function writeTreeChildWrites(writeTree,path){return newWriteTreeRef(path,writeTree)}function writeTreeRecordContainsPath_(writeRecord,path){if(writeRecord.snap)return pathContains(writeRecord.path,path);for(var childName in writeRecord.children)if(writeRecord.children.hasOwnProperty(childName)&&pathContains(pathChild(writeRecord.path,childName),path))return!0;return!1}function writeTreeDefaultFilter_(write){return write.visible}function writeTreeLayerTree_(writes,filter,treeRoot){for(var compoundWrite=CompoundWrite.empty(),i=0;i<writes.length;++i){var write=writes[i];if(filter(write)){var writePath=write.path,relativePath=void 0;if(write.snap)pathContains(treeRoot,writePath)?compoundWrite=compoundWriteAddWrite(compoundWrite,relativePath=newRelativePath(treeRoot,writePath),write.snap):pathContains(writePath,treeRoot)&&(relativePath=newRelativePath(writePath,treeRoot),compoundWrite=compoundWriteAddWrite(compoundWrite,newEmptyPath(),write.snap.getChild(relativePath)));else{if(!write.children)throw Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assertionError)(\"WriteRecord should have .snap or .children\");if(pathContains(treeRoot,writePath))compoundWrite=compoundWriteAddWrites(compoundWrite,relativePath=newRelativePath(treeRoot,writePath),write.children);else if(pathContains(writePath,treeRoot))if(pathIsEmpty(relativePath=newRelativePath(writePath,treeRoot)))compoundWrite=compoundWriteAddWrites(compoundWrite,newEmptyPath(),write.children);else{var child=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.safeGet)(write.children,pathGetFront(relativePath));if(child){var deepNode=child.getChild(pathPopFront(relativePath));compoundWrite=compoundWriteAddWrite(compoundWrite,newEmptyPath(),deepNode)}}}}}return compoundWrite}function writeTreeCalcCompleteEventCache(writeTree,treePath,completeServerCache,writeIdsToExclude,includeHiddenWrites){if(writeIdsToExclude||includeHiddenWrites){var merge=compoundWriteChildCompoundWrite(writeTree.visibleWrites,treePath);return!includeHiddenWrites&&compoundWriteIsEmpty(merge)?completeServerCache:includeHiddenWrites||null!=completeServerCache||compoundWriteHasCompleteWrite(merge,newEmptyPath())?compoundWriteApply(writeTreeLayerTree_(writeTree.allWrites,(function(write){return(write.visible||includeHiddenWrites)&&(!writeIdsToExclude||!~writeIdsToExclude.indexOf(write.writeId))&&(pathContains(write.path,treePath)||pathContains(treePath,write.path))}),treePath),completeServerCache||ChildrenNode.EMPTY_NODE):null}var shadowingNode=compoundWriteGetCompleteNode(writeTree.visibleWrites,treePath);if(null!=shadowingNode)return shadowingNode;var subMerge=compoundWriteChildCompoundWrite(writeTree.visibleWrites,treePath);return compoundWriteIsEmpty(subMerge)?completeServerCache:null!=completeServerCache||compoundWriteHasCompleteWrite(subMerge,newEmptyPath())?compoundWriteApply(subMerge,completeServerCache||ChildrenNode.EMPTY_NODE):null}function writeTreeRefCalcCompleteEventCache(writeTreeRef,completeServerCache,writeIdsToExclude,includeHiddenWrites){return writeTreeCalcCompleteEventCache(writeTreeRef.writeTree,writeTreeRef.treePath,completeServerCache,writeIdsToExclude,includeHiddenWrites)}function writeTreeRefCalcCompleteEventChildren(writeTreeRef,completeServerChildren){return function(writeTree,treePath,completeServerChildren){var completeChildren=ChildrenNode.EMPTY_NODE,topLevelSet=compoundWriteGetCompleteNode(writeTree.visibleWrites,treePath);if(topLevelSet)return topLevelSet.isLeafNode()||topLevelSet.forEachChild(PRIORITY_INDEX,(function(childName,childSnap){completeChildren=completeChildren.updateImmediateChild(childName,childSnap)})),completeChildren;if(completeServerChildren){var merge_1=compoundWriteChildCompoundWrite(writeTree.visibleWrites,treePath);return completeServerChildren.forEachChild(PRIORITY_INDEX,(function(childName,childNode){var node=compoundWriteApply(compoundWriteChildCompoundWrite(merge_1,new Path(childName)),childNode);completeChildren=completeChildren.updateImmediateChild(childName,node)})),compoundWriteGetCompleteChildren(merge_1).forEach((function(namedNode){completeChildren=completeChildren.updateImmediateChild(namedNode.name,namedNode.node)})),completeChildren}return compoundWriteGetCompleteChildren(compoundWriteChildCompoundWrite(writeTree.visibleWrites,treePath)).forEach((function(namedNode){completeChildren=completeChildren.updateImmediateChild(namedNode.name,namedNode.node)})),completeChildren}(writeTreeRef.writeTree,writeTreeRef.treePath,completeServerChildren)}function writeTreeRefCalcEventCacheAfterServerOverwrite(writeTreeRef,path,existingEventSnap,existingServerSnap){return function(writeTree,treePath,childPath,existingEventSnap,existingServerSnap){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(existingEventSnap||existingServerSnap,\"Either existingEventSnap or existingServerSnap must exist\");var path=pathChild(treePath,childPath);if(compoundWriteHasCompleteWrite(writeTree.visibleWrites,path))return null;var childMerge=compoundWriteChildCompoundWrite(writeTree.visibleWrites,path);return compoundWriteIsEmpty(childMerge)?existingServerSnap.getChild(childPath):compoundWriteApply(childMerge,existingServerSnap.getChild(childPath))}(writeTreeRef.writeTree,writeTreeRef.treePath,path,existingEventSnap,existingServerSnap)}function writeTreeRefShadowingWrite(writeTreeRef,path){return function(writeTree,path){return compoundWriteGetCompleteNode(writeTree.visibleWrites,path)}(writeTreeRef.writeTree,pathChild(writeTreeRef.treePath,path))}function writeTreeRefCalcCompleteChild(writeTreeRef,childKey,existingServerCache){return function(writeTree,treePath,childKey,existingServerSnap){var path=pathChild(treePath,childKey),shadowingNode=compoundWriteGetCompleteNode(writeTree.visibleWrites,path);return null!=shadowingNode?shadowingNode:existingServerSnap.isCompleteForChild(childKey)?compoundWriteApply(compoundWriteChildCompoundWrite(writeTree.visibleWrites,path),existingServerSnap.getNode().getImmediateChild(childKey)):null}(writeTreeRef.writeTree,writeTreeRef.treePath,childKey,existingServerCache)}function writeTreeRefChild(writeTreeRef,childName){return newWriteTreeRef(pathChild(writeTreeRef.treePath,childName),writeTreeRef.writeTree)}function newWriteTreeRef(path,writeTree){return{treePath:path,writeTree:writeTree}}var ChildChangeAccumulator=function(){function ChildChangeAccumulator(){this.changeMap=new Map}return ChildChangeAccumulator.prototype.trackChildChange=function(change){var type=change.type,childKey=change.childName;Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\"child_added\"===type||\"child_changed\"===type||\"child_removed\"===type,\"Only child changes supported for tracking\"),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\".priority\"!==childKey,\"Only non-priority child changes can be tracked.\");var oldChange=this.changeMap.get(childKey);if(oldChange){var oldType=oldChange.type;if(\"child_added\"===type&&\"child_removed\"===oldType)this.changeMap.set(childKey,changeChildChanged(childKey,change.snapshotNode,oldChange.snapshotNode));else if(\"child_removed\"===type&&\"child_added\"===oldType)this.changeMap.delete(childKey);else if(\"child_removed\"===type&&\"child_changed\"===oldType)this.changeMap.set(childKey,changeChildRemoved(childKey,oldChange.oldSnap));else if(\"child_changed\"===type&&\"child_added\"===oldType)this.changeMap.set(childKey,changeChildAdded(childKey,change.snapshotNode));else{if(\"child_changed\"!==type||\"child_changed\"!==oldType)throw Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assertionError)(\"Illegal combination of changes: \"+change+\" occurred after \"+oldChange);this.changeMap.set(childKey,changeChildChanged(childKey,change.snapshotNode,oldChange.oldSnap))}}else this.changeMap.set(childKey,change)},ChildChangeAccumulator.prototype.getChanges=function(){return Array.from(this.changeMap.values())},ChildChangeAccumulator}(),NO_COMPLETE_CHILD_SOURCE=new(function(){function NoCompleteChildSource_(){}return NoCompleteChildSource_.prototype.getCompleteChild=function(childKey){return null},NoCompleteChildSource_.prototype.getChildAfterChild=function(index,child,reverse){return null},NoCompleteChildSource_}()),WriteTreeCompleteChildSource=function(){function WriteTreeCompleteChildSource(writes_,viewCache_,optCompleteServerCache_){void 0===optCompleteServerCache_&&(optCompleteServerCache_=null),this.writes_=writes_,this.viewCache_=viewCache_,this.optCompleteServerCache_=optCompleteServerCache_}return WriteTreeCompleteChildSource.prototype.getCompleteChild=function(childKey){var node=this.viewCache_.eventCache;if(node.isCompleteForChild(childKey))return node.getNode().getImmediateChild(childKey);var serverNode=null!=this.optCompleteServerCache_?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return writeTreeRefCalcCompleteChild(this.writes_,childKey,serverNode)},WriteTreeCompleteChildSource.prototype.getChildAfterChild=function(index,child,reverse){var completeServerData=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:viewCacheGetCompleteServerSnap(this.viewCache_),nodes=function(writeTreeRef,completeServerData,startPost,count,reverse,index){return function(writeTree,treePath,completeServerData,startPost,count,reverse,index){var toIterate,merge=compoundWriteChildCompoundWrite(writeTree.visibleWrites,treePath),shadowingNode=compoundWriteGetCompleteNode(merge,newEmptyPath());if(null!=shadowingNode)toIterate=shadowingNode;else{if(null==completeServerData)return[];toIterate=compoundWriteApply(merge,completeServerData)}if((toIterate=toIterate.withIndex(index)).isEmpty()||toIterate.isLeafNode())return[];for(var nodes=[],cmp=index.getCompare(),iter=reverse?toIterate.getReverseIteratorFrom(startPost,index):toIterate.getIteratorFrom(startPost,index),next=iter.getNext();next&&nodes.length<1;)0!==cmp(next,startPost)&&nodes.push(next),next=iter.getNext();return nodes}(writeTreeRef.writeTree,writeTreeRef.treePath,completeServerData,startPost,0,reverse,index)}(this.writes_,completeServerData,child,0,reverse,index);return 0===nodes.length?null:nodes[0]},WriteTreeCompleteChildSource}();function viewProcessorGenerateEventCacheAfterServerEvent(viewProcessor,viewCache,changePath,writesCache,source,accumulator){var oldEventSnap=viewCache.eventCache;if(null!=writeTreeRefShadowingWrite(writesCache,changePath))return viewCache;var newEventCache=void 0,serverNode=void 0;if(pathIsEmpty(changePath))if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(viewCache.serverCache.isFullyInitialized(),\"If change path is empty, we must have complete server data\"),viewCache.serverCache.isFiltered()){var serverCache=viewCacheGetCompleteServerSnap(viewCache),completeEventChildren=writeTreeRefCalcCompleteEventChildren(writesCache,serverCache instanceof ChildrenNode?serverCache:ChildrenNode.EMPTY_NODE);newEventCache=viewProcessor.filter.updateFullNode(viewCache.eventCache.getNode(),completeEventChildren,accumulator)}else{var completeNode=writeTreeRefCalcCompleteEventCache(writesCache,viewCacheGetCompleteServerSnap(viewCache));newEventCache=viewProcessor.filter.updateFullNode(viewCache.eventCache.getNode(),completeNode,accumulator)}else{var childKey=pathGetFront(changePath);if(\".priority\"===childKey){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(1===pathGetLength(changePath),\"Can't have a priority with additional path components\");var oldEventNode=oldEventSnap.getNode(),updatedPriority=writeTreeRefCalcEventCacheAfterServerOverwrite(writesCache,changePath,oldEventNode,serverNode=viewCache.serverCache.getNode());newEventCache=null!=updatedPriority?viewProcessor.filter.updatePriority(oldEventNode,updatedPriority):oldEventSnap.getNode()}else{var childChangePath=pathPopFront(changePath),newEventChild=void 0;if(oldEventSnap.isCompleteForChild(childKey)){serverNode=viewCache.serverCache.getNode();var eventChildUpdate=writeTreeRefCalcEventCacheAfterServerOverwrite(writesCache,changePath,oldEventSnap.getNode(),serverNode);newEventChild=null!=eventChildUpdate?oldEventSnap.getNode().getImmediateChild(childKey).updateChild(childChangePath,eventChildUpdate):oldEventSnap.getNode().getImmediateChild(childKey)}else newEventChild=writeTreeRefCalcCompleteChild(writesCache,childKey,viewCache.serverCache);newEventCache=null!=newEventChild?viewProcessor.filter.updateChild(oldEventSnap.getNode(),childKey,newEventChild,childChangePath,source,accumulator):oldEventSnap.getNode()}}return viewCacheUpdateEventSnap(viewCache,newEventCache,oldEventSnap.isFullyInitialized()||pathIsEmpty(changePath),viewProcessor.filter.filtersNodes())}function viewProcessorApplyServerOverwrite(viewProcessor,oldViewCache,changePath,changedSnap,writesCache,completeCache,filterServerNode,accumulator){var newServerCache,oldServerSnap=oldViewCache.serverCache,serverFilter=filterServerNode?viewProcessor.filter:viewProcessor.filter.getIndexedFilter();if(pathIsEmpty(changePath))newServerCache=serverFilter.updateFullNode(oldServerSnap.getNode(),changedSnap,null);else if(serverFilter.filtersNodes()&&!oldServerSnap.isFiltered()){var newServerNode=oldServerSnap.getNode().updateChild(changePath,changedSnap);newServerCache=serverFilter.updateFullNode(oldServerSnap.getNode(),newServerNode,null)}else{var childKey=pathGetFront(changePath);if(!oldServerSnap.isCompleteForPath(changePath)&&pathGetLength(changePath)>1)return oldViewCache;var childChangePath=pathPopFront(changePath),newChildNode=oldServerSnap.getNode().getImmediateChild(childKey).updateChild(childChangePath,changedSnap);newServerCache=\".priority\"===childKey?serverFilter.updatePriority(oldServerSnap.getNode(),newChildNode):serverFilter.updateChild(oldServerSnap.getNode(),childKey,newChildNode,childChangePath,NO_COMPLETE_CHILD_SOURCE,null)}var newViewCache=viewCacheUpdateServerSnap(oldViewCache,newServerCache,oldServerSnap.isFullyInitialized()||pathIsEmpty(changePath),serverFilter.filtersNodes());return viewProcessorGenerateEventCacheAfterServerEvent(viewProcessor,newViewCache,changePath,writesCache,new WriteTreeCompleteChildSource(writesCache,newViewCache,completeCache),accumulator)}function viewProcessorApplyUserOverwrite(viewProcessor,oldViewCache,changePath,changedSnap,writesCache,completeCache,accumulator){var newViewCache,newEventCache,oldEventSnap=oldViewCache.eventCache,source=new WriteTreeCompleteChildSource(writesCache,oldViewCache,completeCache);if(pathIsEmpty(changePath))newEventCache=viewProcessor.filter.updateFullNode(oldViewCache.eventCache.getNode(),changedSnap,accumulator),newViewCache=viewCacheUpdateEventSnap(oldViewCache,newEventCache,!0,viewProcessor.filter.filtersNodes());else{var childKey=pathGetFront(changePath);if(\".priority\"===childKey)newEventCache=viewProcessor.filter.updatePriority(oldViewCache.eventCache.getNode(),changedSnap),newViewCache=viewCacheUpdateEventSnap(oldViewCache,newEventCache,oldEventSnap.isFullyInitialized(),oldEventSnap.isFiltered());else{var childChangePath=pathPopFront(changePath),oldChild=oldEventSnap.getNode().getImmediateChild(childKey),newChild=void 0;if(pathIsEmpty(childChangePath))newChild=changedSnap;else{var childNode=source.getCompleteChild(childKey);newChild=null!=childNode?\".priority\"===pathGetBack(childChangePath)&&childNode.getChild(pathParent(childChangePath)).isEmpty()?childNode:childNode.updateChild(childChangePath,changedSnap):ChildrenNode.EMPTY_NODE}newViewCache=oldChild.equals(newChild)?oldViewCache:viewCacheUpdateEventSnap(oldViewCache,viewProcessor.filter.updateChild(oldEventSnap.getNode(),childKey,newChild,childChangePath,source,accumulator),oldEventSnap.isFullyInitialized(),viewProcessor.filter.filtersNodes())}}return newViewCache}function viewProcessorCacheHasChild(viewCache,childKey){return viewCache.eventCache.isCompleteForChild(childKey)}function viewProcessorApplyMerge(viewProcessor,node,merge){return merge.foreach((function(relativePath,childNode){node=node.updateChild(relativePath,childNode)})),node}function viewProcessorApplyServerMerge(viewProcessor,viewCache,path,changedChildren,writesCache,serverCache,filterServerNode,accumulator){if(viewCache.serverCache.getNode().isEmpty()&&!viewCache.serverCache.isFullyInitialized())return viewCache;var viewMergeTree,curViewCache=viewCache;viewMergeTree=pathIsEmpty(path)?changedChildren:new ImmutableTree(null).setTree(path,changedChildren);var serverNode=viewCache.serverCache.getNode();return viewMergeTree.children.inorderTraversal((function(childKey,childTree){if(serverNode.hasChild(childKey)){var newChild=viewProcessorApplyMerge(0,viewCache.serverCache.getNode().getImmediateChild(childKey),childTree);curViewCache=viewProcessorApplyServerOverwrite(viewProcessor,curViewCache,new Path(childKey),newChild,writesCache,serverCache,filterServerNode,accumulator)}})),viewMergeTree.children.inorderTraversal((function(childKey,childMergeTree){var isUnknownDeepMerge=!viewCache.serverCache.isCompleteForChild(childKey)&&void 0===childMergeTree.value;if(!serverNode.hasChild(childKey)&&!isUnknownDeepMerge){var newChild=viewProcessorApplyMerge(0,viewCache.serverCache.getNode().getImmediateChild(childKey),childMergeTree);curViewCache=viewProcessorApplyServerOverwrite(viewProcessor,curViewCache,new Path(childKey),newChild,writesCache,serverCache,filterServerNode,accumulator)}})),curViewCache}var referenceConstructor,View=function(){function View(query_,initialViewCache){this.query_=query_,this.eventRegistrations_=[];var queryParams,params=this.query_._queryParams,indexFilter=new IndexedFilter(params.getIndex()),filter=(queryParams=params).loadsAllData()?new IndexedFilter(queryParams.getIndex()):queryParams.hasLimit()?new LimitedFilter(queryParams):new RangedFilter(queryParams);this.processor_=function(filter){return{filter:filter}}(filter);var initialServerCache=initialViewCache.serverCache,initialEventCache=initialViewCache.eventCache,serverSnap=indexFilter.updateFullNode(ChildrenNode.EMPTY_NODE,initialServerCache.getNode(),null),eventSnap=filter.updateFullNode(ChildrenNode.EMPTY_NODE,initialEventCache.getNode(),null),newServerCache=new CacheNode(serverSnap,initialServerCache.isFullyInitialized(),indexFilter.filtersNodes()),newEventCache=new CacheNode(eventSnap,initialEventCache.isFullyInitialized(),filter.filtersNodes());this.viewCache_=newViewCache(newEventCache,newServerCache),this.eventGenerator_=new EventGenerator(this.query_)}return Object.defineProperty(View.prototype,\"query\",{get:function(){return this.query_},enumerable:!1,configurable:!0}),View}();function viewGetCompleteServerCache(view,path){var cache=viewCacheGetCompleteServerSnap(view.viewCache_);return cache&&(view.query._queryParams.loadsAllData()||!pathIsEmpty(path)&&!cache.getImmediateChild(pathGetFront(path)).isEmpty())?cache.getChild(path):null}function viewIsEmpty(view){return 0===view.eventRegistrations_.length}function viewRemoveEventRegistration(view,eventRegistration,cancelError){var cancelEvents=[];if(cancelError){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(null==eventRegistration,\"A cancel should cancel all event registrations.\");var path_1=view.query._path;view.eventRegistrations_.forEach((function(registration){var maybeEvent=registration.createCancelEvent(cancelError,path_1);maybeEvent&&cancelEvents.push(maybeEvent)}))}if(eventRegistration){for(var remaining=[],i=0;i<view.eventRegistrations_.length;++i){var existing=view.eventRegistrations_[i];if(existing.matches(eventRegistration)){if(eventRegistration.hasAnyCallback()){remaining=remaining.concat(view.eventRegistrations_.slice(i+1));break}}else remaining.push(existing)}view.eventRegistrations_=remaining}else view.eventRegistrations_=[];return cancelEvents}function viewApplyOperation(view,operation,writesCache,completeServerCache){operation.type===OperationType.MERGE&&null!==operation.source.queryId&&(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(viewCacheGetCompleteServerSnap(view.viewCache_),\"We should always have a full cache before handling merges\"),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(viewCacheGetCompleteEventSnap(view.viewCache_),\"Missing event cache, even though we have a server cache\"));var viewProcessor,viewCache,oldViewCache=view.viewCache_,result=function(viewProcessor,oldViewCache,operation,writesCache,completeCache){var newViewCache,filterServerNode,accumulator=new ChildChangeAccumulator;if(operation.type===OperationType.OVERWRITE){var overwrite=operation;overwrite.source.fromUser?newViewCache=viewProcessorApplyUserOverwrite(viewProcessor,oldViewCache,overwrite.path,overwrite.snap,writesCache,completeCache,accumulator):(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(overwrite.source.fromServer,\"Unknown source.\"),filterServerNode=overwrite.source.tagged||oldViewCache.serverCache.isFiltered()&&!pathIsEmpty(overwrite.path),newViewCache=viewProcessorApplyServerOverwrite(viewProcessor,oldViewCache,overwrite.path,overwrite.snap,writesCache,completeCache,filterServerNode,accumulator))}else if(operation.type===OperationType.MERGE){var merge=operation;merge.source.fromUser?newViewCache=function(viewProcessor,viewCache,path,changedChildren,writesCache,serverCache,accumulator){var curViewCache=viewCache;return changedChildren.foreach((function(relativePath,childNode){var writePath=pathChild(path,relativePath);viewProcessorCacheHasChild(viewCache,pathGetFront(writePath))&&(curViewCache=viewProcessorApplyUserOverwrite(viewProcessor,curViewCache,writePath,childNode,writesCache,serverCache,accumulator))})),changedChildren.foreach((function(relativePath,childNode){var writePath=pathChild(path,relativePath);viewProcessorCacheHasChild(viewCache,pathGetFront(writePath))||(curViewCache=viewProcessorApplyUserOverwrite(viewProcessor,curViewCache,writePath,childNode,writesCache,serverCache,accumulator))})),curViewCache}(viewProcessor,oldViewCache,merge.path,merge.children,writesCache,completeCache,accumulator):(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(merge.source.fromServer,\"Unknown source.\"),filterServerNode=merge.source.tagged||oldViewCache.serverCache.isFiltered(),newViewCache=viewProcessorApplyServerMerge(viewProcessor,oldViewCache,merge.path,merge.children,writesCache,completeCache,filterServerNode,accumulator))}else if(operation.type===OperationType.ACK_USER_WRITE){var ackUserWrite=operation;newViewCache=ackUserWrite.revert?function(viewProcessor,viewCache,path,writesCache,completeServerCache,accumulator){var complete;if(null!=writeTreeRefShadowingWrite(writesCache,path))return viewCache;var source=new WriteTreeCompleteChildSource(writesCache,viewCache,completeServerCache),oldEventCache=viewCache.eventCache.getNode(),newEventCache=void 0;if(pathIsEmpty(path)||\".priority\"===pathGetFront(path)){var newNode=void 0;if(viewCache.serverCache.isFullyInitialized())newNode=writeTreeRefCalcCompleteEventCache(writesCache,viewCacheGetCompleteServerSnap(viewCache));else{var serverChildren=viewCache.serverCache.getNode();Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(serverChildren instanceof ChildrenNode,\"serverChildren would be complete if leaf node\"),newNode=writeTreeRefCalcCompleteEventChildren(writesCache,serverChildren)}newEventCache=viewProcessor.filter.updateFullNode(oldEventCache,newNode=newNode,accumulator)}else{var childKey=pathGetFront(path),newChild=writeTreeRefCalcCompleteChild(writesCache,childKey,viewCache.serverCache);null==newChild&&viewCache.serverCache.isCompleteForChild(childKey)&&(newChild=oldEventCache.getImmediateChild(childKey)),(newEventCache=null!=newChild?viewProcessor.filter.updateChild(oldEventCache,childKey,newChild,pathPopFront(path),source,accumulator):viewCache.eventCache.getNode().hasChild(childKey)?viewProcessor.filter.updateChild(oldEventCache,childKey,ChildrenNode.EMPTY_NODE,pathPopFront(path),source,accumulator):oldEventCache).isEmpty()&&viewCache.serverCache.isFullyInitialized()&&(complete=writeTreeRefCalcCompleteEventCache(writesCache,viewCacheGetCompleteServerSnap(viewCache))).isLeafNode()&&(newEventCache=viewProcessor.filter.updateFullNode(newEventCache,complete,accumulator))}return complete=viewCache.serverCache.isFullyInitialized()||null!=writeTreeRefShadowingWrite(writesCache,newEmptyPath()),viewCacheUpdateEventSnap(viewCache,newEventCache,complete,viewProcessor.filter.filtersNodes())}(viewProcessor,oldViewCache,ackUserWrite.path,writesCache,completeCache,accumulator):function(viewProcessor,viewCache,ackPath,affectedTree,writesCache,completeCache,accumulator){if(null!=writeTreeRefShadowingWrite(writesCache,ackPath))return viewCache;var filterServerNode=viewCache.serverCache.isFiltered(),serverCache=viewCache.serverCache;if(null!=affectedTree.value){if(pathIsEmpty(ackPath)&&serverCache.isFullyInitialized()||serverCache.isCompleteForPath(ackPath))return viewProcessorApplyServerOverwrite(viewProcessor,viewCache,ackPath,serverCache.getNode().getChild(ackPath),writesCache,completeCache,filterServerNode,accumulator);if(pathIsEmpty(ackPath)){var changedChildren_1=new ImmutableTree(null);return serverCache.getNode().forEachChild(KEY_INDEX,(function(name,node){changedChildren_1=changedChildren_1.set(new Path(name),node)})),viewProcessorApplyServerMerge(viewProcessor,viewCache,ackPath,changedChildren_1,writesCache,completeCache,filterServerNode,accumulator)}return viewCache}var changedChildren_2=new ImmutableTree(null);return affectedTree.foreach((function(mergePath,value){var serverCachePath=pathChild(ackPath,mergePath);serverCache.isCompleteForPath(serverCachePath)&&(changedChildren_2=changedChildren_2.set(mergePath,serverCache.getNode().getChild(serverCachePath)))})),viewProcessorApplyServerMerge(viewProcessor,viewCache,ackPath,changedChildren_2,writesCache,completeCache,filterServerNode,accumulator)}(viewProcessor,oldViewCache,ackUserWrite.path,ackUserWrite.affectedTree,writesCache,completeCache,accumulator)}else{if(operation.type!==OperationType.LISTEN_COMPLETE)throw Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assertionError)(\"Unknown operation type: \"+operation.type);newViewCache=function(viewProcessor,viewCache,path,writesCache,accumulator){var oldServerNode=viewCache.serverCache;return viewProcessorGenerateEventCacheAfterServerEvent(viewProcessor,viewCacheUpdateServerSnap(viewCache,oldServerNode.getNode(),oldServerNode.isFullyInitialized()||pathIsEmpty(path),oldServerNode.isFiltered()),path,writesCache,NO_COMPLETE_CHILD_SOURCE,accumulator)}(viewProcessor,oldViewCache,operation.path,writesCache,accumulator)}var changes=accumulator.getChanges();return function(oldViewCache,newViewCache,accumulator){var eventSnap=newViewCache.eventCache;if(eventSnap.isFullyInitialized()){var isLeafOrEmpty=eventSnap.getNode().isLeafNode()||eventSnap.getNode().isEmpty(),oldCompleteSnap=viewCacheGetCompleteEventSnap(oldViewCache);(accumulator.length>0||!oldViewCache.eventCache.isFullyInitialized()||isLeafOrEmpty&&!eventSnap.getNode().equals(oldCompleteSnap)||!eventSnap.getNode().getPriority().equals(oldCompleteSnap.getPriority()))&&accumulator.push(changeValue(viewCacheGetCompleteEventSnap(newViewCache)))}}(oldViewCache,newViewCache,changes),{viewCache:newViewCache,changes:changes}}(view.processor_,oldViewCache,operation,writesCache,completeServerCache);return viewProcessor=view.processor_,viewCache=result.viewCache,Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(viewCache.eventCache.getNode().isIndexed(viewProcessor.filter.getIndex()),\"Event snap not indexed\"),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(viewCache.serverCache.getNode().isIndexed(viewProcessor.filter.getIndex()),\"Server snap not indexed\"),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(result.viewCache.serverCache.isFullyInitialized()||!oldViewCache.serverCache.isFullyInitialized(),\"Once a server snap is complete, it should never go back\"),view.viewCache_=result.viewCache,viewGenerateEventsForChanges_(view,result.changes,result.viewCache.eventCache.getNode(),null)}function viewGenerateEventsForChanges_(view,changes,eventCache,eventRegistration){return function(eventGenerator,changes,eventCache,eventRegistrations){var events=[],moves=[];return changes.forEach((function(change){\"child_changed\"===change.type&&eventGenerator.index_.indexedValueChanged(change.oldSnap,change.snapshotNode)&&moves.push({type:\"child_moved\",snapshotNode:change.snapshotNode,childName:change.childName})})),eventGeneratorGenerateEventsForType(eventGenerator,events,\"child_removed\",changes,eventRegistrations,eventCache),eventGeneratorGenerateEventsForType(eventGenerator,events,\"child_added\",changes,eventRegistrations,eventCache),eventGeneratorGenerateEventsForType(eventGenerator,events,\"child_moved\",moves,eventRegistrations,eventCache),eventGeneratorGenerateEventsForType(eventGenerator,events,\"child_changed\",changes,eventRegistrations,eventCache),eventGeneratorGenerateEventsForType(eventGenerator,events,\"value\",changes,eventRegistrations,eventCache),events}(view.eventGenerator_,changes,eventCache,eventRegistration?[eventRegistration]:view.eventRegistrations_)}var referenceConstructor$1,SyncPoint=function(){return function(){this.views=new Map}}();function syncPointApplyOperation(syncPoint,operation,writesCache,optCompleteServerCache){var e_1,_a,queryId=operation.source.queryId;if(null!==queryId){var view=syncPoint.views.get(queryId);return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(null!=view,\"SyncTree gave us an op for an invalid query.\"),viewApplyOperation(view,operation,writesCache,optCompleteServerCache)}var events=[];try{for(var _b=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__values)(syncPoint.views.values()),_c=_b.next();!_c.done;_c=_b.next())events=events.concat(viewApplyOperation(view=_c.value,operation,writesCache,optCompleteServerCache))}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}return events}function syncPointGetView(syncPoint,query,writesCache,serverCache,serverCacheComplete){var view=syncPoint.views.get(query._queryIdentifier);if(!view){var eventCache=writeTreeRefCalcCompleteEventCache(writesCache,serverCacheComplete?serverCache:null),eventCacheComplete=!1;eventCache?eventCacheComplete=!0:serverCache instanceof ChildrenNode?(eventCache=writeTreeRefCalcCompleteEventChildren(writesCache,serverCache),eventCacheComplete=!1):(eventCache=ChildrenNode.EMPTY_NODE,eventCacheComplete=!1);var viewCache=newViewCache(new CacheNode(eventCache,eventCacheComplete,!1),new CacheNode(serverCache,serverCacheComplete,!1));return new View(query,viewCache)}return view}function syncPointGetQueryViews(syncPoint){var e_3,_a,result=[];try{for(var _b=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__values)(syncPoint.views.values()),_c=_b.next();!_c.done;_c=_b.next()){var view=_c.value;view.query._queryParams.loadsAllData()||result.push(view)}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_3)throw e_3.error}}return result}function syncPointGetCompleteServerCache(syncPoint,path){var e_4,_a,serverCache=null;try{for(var _b=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__values)(syncPoint.views.values()),_c=_b.next();!_c.done;_c=_b.next())serverCache=serverCache||viewGetCompleteServerCache(_c.value,path)}catch(e_4_1){e_4={error:e_4_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_4)throw e_4.error}}return serverCache}function syncPointViewForQuery(syncPoint,query){return query._queryParams.loadsAllData()?syncPointGetCompleteView(syncPoint):syncPoint.views.get(query._queryIdentifier)}function syncPointViewExistsForQuery(syncPoint,query){return null!=syncPointViewForQuery(syncPoint,query)}function syncPointHasCompleteView(syncPoint){return null!=syncPointGetCompleteView(syncPoint)}function syncPointGetCompleteView(syncPoint){var e_5,_a;try{for(var _b=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__values)(syncPoint.views.values()),_c=_b.next();!_c.done;_c=_b.next()){var view=_c.value;if(view.query._queryParams.loadsAllData())return view}}catch(e_5_1){e_5={error:e_5_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_5)throw e_5.error}}return null}var syncTreeNextQueryTag_=1,SyncTree=function(){return function(listenProvider_){this.listenProvider_=listenProvider_,this.syncPointTree_=new ImmutableTree(null),this.pendingWriteTree_={visibleWrites:CompoundWrite.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}();function syncTreeApplyUserOverwrite(syncTree,path,newData,writeId,visible){return function(writeTree,path,snap,writeId,visible){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(writeId>writeTree.lastWriteId,\"Stacking an older write on top of newer ones\"),void 0===visible&&(visible=!0),writeTree.allWrites.push({path:path,snap:snap,writeId:writeId,visible:visible}),visible&&(writeTree.visibleWrites=compoundWriteAddWrite(writeTree.visibleWrites,path,snap)),writeTree.lastWriteId=writeId}(syncTree.pendingWriteTree_,path,newData,writeId,visible),visible?syncTreeApplyOperationToSyncPoints_(syncTree,new Overwrite({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},path,newData)):[]}function syncTreeAckUserWrite(syncTree,writeId,revert){void 0===revert&&(revert=!1);var write=function(writeTree,writeId){for(var i=0;i<writeTree.allWrites.length;i++){var record=writeTree.allWrites[i];if(record.writeId===writeId)return record}return null}(syncTree.pendingWriteTree_,writeId);if(function(writeTree,writeId){var idx=writeTree.allWrites.findIndex((function(s){return s.writeId===writeId}));Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(idx>=0,\"removeWrite called with nonexistent writeId.\");var writeToRemove=writeTree.allWrites[idx];writeTree.allWrites.splice(idx,1);for(var removedWriteWasVisible=writeToRemove.visible,removedWriteOverlapsWithOtherWrites=!1,i=writeTree.allWrites.length-1;removedWriteWasVisible&&i>=0;){var currentWrite=writeTree.allWrites[i];currentWrite.visible&&(i>=idx&&writeTreeRecordContainsPath_(currentWrite,writeToRemove.path)?removedWriteWasVisible=!1:pathContains(writeToRemove.path,currentWrite.path)&&(removedWriteOverlapsWithOtherWrites=!0)),i--}return!!removedWriteWasVisible&&(removedWriteOverlapsWithOtherWrites?(function(writeTree){writeTree.visibleWrites=writeTreeLayerTree_(writeTree.allWrites,writeTreeDefaultFilter_,newEmptyPath()),writeTree.lastWriteId=writeTree.allWrites.length>0?writeTree.allWrites[writeTree.allWrites.length-1].writeId:-1}(writeTree),!0):(writeToRemove.snap?writeTree.visibleWrites=compoundWriteRemoveWrite(writeTree.visibleWrites,writeToRemove.path):each(writeToRemove.children,(function(childName){writeTree.visibleWrites=compoundWriteRemoveWrite(writeTree.visibleWrites,pathChild(writeToRemove.path,childName))})),!0))}(syncTree.pendingWriteTree_,writeId)){var affectedTree_1=new ImmutableTree(null);return null!=write.snap?affectedTree_1=affectedTree_1.set(newEmptyPath(),!0):each(write.children,(function(pathString){affectedTree_1=affectedTree_1.set(new Path(pathString),!0)})),syncTreeApplyOperationToSyncPoints_(syncTree,new AckUserWrite(write.path,affectedTree_1,revert))}return[]}function syncTreeApplyServerOverwrite(syncTree,path,newData){return syncTreeApplyOperationToSyncPoints_(syncTree,new Overwrite({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},path,newData))}function syncTreeRemoveEventRegistration(syncTree,query,eventRegistration,cancelError){var path=query._path,maybeSyncPoint=syncTree.syncPointTree_.get(path),cancelEvents=[];if(maybeSyncPoint&&(\"default\"===query._queryIdentifier||syncPointViewExistsForQuery(maybeSyncPoint,query))){var removedAndEvents=function(syncPoint,query,eventRegistration,cancelError){var e_2,_a,queryId=query._queryIdentifier,removed=[],cancelEvents=[],hadCompleteView=syncPointHasCompleteView(syncPoint);if(\"default\"===queryId)try{for(var _b=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__values)(syncPoint.views.entries()),_c=_b.next();!_c.done;_c=_b.next()){var view,_d=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__read)(_c.value,2),viewQueryId=_d[0];cancelEvents=cancelEvents.concat(viewRemoveEventRegistration(view=_d[1],eventRegistration,cancelError)),viewIsEmpty(view)&&(syncPoint.views.delete(viewQueryId),view.query._queryParams.loadsAllData()||removed.push(view.query))}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_2)throw e_2.error}}else(view=syncPoint.views.get(queryId))&&(cancelEvents=cancelEvents.concat(viewRemoveEventRegistration(view,eventRegistration,cancelError)),viewIsEmpty(view)&&(syncPoint.views.delete(queryId),view.query._queryParams.loadsAllData()||removed.push(view.query)));return hadCompleteView&&!syncPointHasCompleteView(syncPoint)&&removed.push(new(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(referenceConstructor,\"Reference.ts has not been loaded\"),referenceConstructor)(query._repo,query._path)),{removed:removed,events:cancelEvents}}(maybeSyncPoint,query,eventRegistration,cancelError);0===maybeSyncPoint.views.size&&(syncTree.syncPointTree_=syncTree.syncPointTree_.remove(path));var removed=removedAndEvents.removed;cancelEvents=removedAndEvents.events;var removingDefault=-1!==removed.findIndex((function(query){return query._queryParams.loadsAllData()})),covered=syncTree.syncPointTree_.findOnPath(path,(function(relativePath,parentSyncPoint){return syncPointHasCompleteView(parentSyncPoint)}));if(removingDefault&&!covered){var subtree=syncTree.syncPointTree_.subtree(path);if(!subtree.isEmpty())for(var newViews=function(subtree){return subtree.fold((function(relativePath,maybeChildSyncPoint,childMap){if(maybeChildSyncPoint&&syncPointHasCompleteView(maybeChildSyncPoint))return[syncPointGetCompleteView(maybeChildSyncPoint)];var views_1=[];return maybeChildSyncPoint&&(views_1=syncPointGetQueryViews(maybeChildSyncPoint)),each(childMap,(function(_key,childViews){views_1=views_1.concat(childViews)})),views_1}))}(subtree),i=0;i<newViews.length;++i){var view=newViews[i],newQuery=view.query,listener=syncTreeCreateListenerForView_(syncTree,view);syncTree.listenProvider_.startListening(syncTreeQueryForListening_(newQuery),syncTreeTagForQuery_(syncTree,newQuery),listener.hashFn,listener.onComplete)}}!covered&&removed.length>0&&!cancelError&&(removingDefault?syncTree.listenProvider_.stopListening(syncTreeQueryForListening_(query),null):removed.forEach((function(queryToRemove){var tagToRemove=syncTree.queryToTagMap.get(syncTreeMakeQueryKey_(queryToRemove));syncTree.listenProvider_.stopListening(syncTreeQueryForListening_(queryToRemove),tagToRemove)}))),function(syncTree,queries){for(var j=0;j<queries.length;++j){var removedQuery=queries[j];if(!removedQuery._queryParams.loadsAllData()){var removedQueryKey=syncTreeMakeQueryKey_(removedQuery),removedQueryTag=syncTree.queryToTagMap.get(removedQueryKey);syncTree.queryToTagMap.delete(removedQueryKey),syncTree.tagToQueryMap.delete(removedQueryTag)}}}(syncTree,removed)}return cancelEvents}function syncTreeAddEventRegistration(syncTree,query,eventRegistration){var path=query._path,serverCache=null,foundAncestorDefaultView=!1;syncTree.syncPointTree_.foreachOnPath(path,(function(pathToSyncPoint,sp){var relativePath=newRelativePath(pathToSyncPoint,path);serverCache=serverCache||syncPointGetCompleteServerCache(sp,relativePath),foundAncestorDefaultView=foundAncestorDefaultView||syncPointHasCompleteView(sp)}));var serverCacheComplete,syncPoint=syncTree.syncPointTree_.get(path);syncPoint?(foundAncestorDefaultView=foundAncestorDefaultView||syncPointHasCompleteView(syncPoint),serverCache=serverCache||syncPointGetCompleteServerCache(syncPoint,newEmptyPath())):(syncPoint=new SyncPoint,syncTree.syncPointTree_=syncTree.syncPointTree_.set(path,syncPoint)),null!=serverCache?serverCacheComplete=!0:(serverCacheComplete=!1,serverCache=ChildrenNode.EMPTY_NODE,syncTree.syncPointTree_.subtree(path).foreachChild((function(childName,childSyncPoint){var completeCache=syncPointGetCompleteServerCache(childSyncPoint,newEmptyPath());completeCache&&(serverCache=serverCache.updateImmediateChild(childName,completeCache))})));var viewAlreadyExists=syncPointViewExistsForQuery(syncPoint,query);if(!viewAlreadyExists&&!query._queryParams.loadsAllData()){var queryKey=syncTreeMakeQueryKey_(query);Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!syncTree.queryToTagMap.has(queryKey),\"View does not exist, but we have a tag\");var tag=syncTreeNextQueryTag_++;syncTree.queryToTagMap.set(queryKey,tag),syncTree.tagToQueryMap.set(tag,queryKey)}var events=function(syncPoint,query,eventRegistration,writesCache,serverCache,serverCacheComplete){var view=syncPointGetView(syncPoint,query,writesCache,serverCache,serverCacheComplete);return syncPoint.views.has(query._queryIdentifier)||syncPoint.views.set(query._queryIdentifier,view),function(view,eventRegistration){view.eventRegistrations_.push(eventRegistration)}(view,eventRegistration),function(view,registration){var eventSnap=view.viewCache_.eventCache,initialChanges=[];return eventSnap.getNode().isLeafNode()||eventSnap.getNode().forEachChild(PRIORITY_INDEX,(function(key,childNode){initialChanges.push(changeChildAdded(key,childNode))})),eventSnap.isFullyInitialized()&&initialChanges.push(changeValue(eventSnap.getNode())),viewGenerateEventsForChanges_(view,initialChanges,eventSnap.getNode(),registration)}(view,eventRegistration)}(syncPoint,query,eventRegistration,writeTreeChildWrites(syncTree.pendingWriteTree_,path),serverCache,serverCacheComplete);if(!viewAlreadyExists&&!foundAncestorDefaultView){var view=syncPointViewForQuery(syncPoint,query);events=events.concat(function(syncTree,query,view){var path=query._path,tag=syncTreeTagForQuery_(syncTree,query),listener=syncTreeCreateListenerForView_(syncTree,view),events=syncTree.listenProvider_.startListening(syncTreeQueryForListening_(query),tag,listener.hashFn,listener.onComplete),subtree=syncTree.syncPointTree_.subtree(path);if(tag)Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!syncPointHasCompleteView(subtree.value),\"If we're adding a query, it shouldn't be shadowed\");else for(var queriesToStop=subtree.fold((function(relativePath,maybeChildSyncPoint,childMap){if(!pathIsEmpty(relativePath)&&maybeChildSyncPoint&&syncPointHasCompleteView(maybeChildSyncPoint))return[syncPointGetCompleteView(maybeChildSyncPoint).query];var queries_1=[];return maybeChildSyncPoint&&(queries_1=queries_1.concat(syncPointGetQueryViews(maybeChildSyncPoint).map((function(view){return view.query})))),each(childMap,(function(_key,childQueries){queries_1=queries_1.concat(childQueries)})),queries_1})),i=0;i<queriesToStop.length;++i){var queryToStop=queriesToStop[i];syncTree.listenProvider_.stopListening(syncTreeQueryForListening_(queryToStop),syncTreeTagForQuery_(syncTree,queryToStop))}return events}(syncTree,query,view))}return events}function syncTreeCalcCompleteEventCache(syncTree,path,writeIdsToExclude){var writeTree=syncTree.pendingWriteTree_,serverCache=syncTree.syncPointTree_.findOnPath(path,(function(pathSoFar,syncPoint){var serverCache=syncPointGetCompleteServerCache(syncPoint,newRelativePath(pathSoFar,path));if(serverCache)return serverCache}));return writeTreeCalcCompleteEventCache(writeTree,path,serverCache,writeIdsToExclude,!0)}function syncTreeApplyOperationToSyncPoints_(syncTree,operation){return function syncTreeApplyOperationHelper_(operation,syncPointTree,serverCache,writesCache){if(pathIsEmpty(operation.path))return function syncTreeApplyOperationDescendantsHelper_(operation,syncPointTree,serverCache,writesCache){var syncPoint=syncPointTree.get(newEmptyPath());null==serverCache&&null!=syncPoint&&(serverCache=syncPointGetCompleteServerCache(syncPoint,newEmptyPath()));var events=[];return syncPointTree.children.inorderTraversal((function(childName,childTree){var childServerCache=serverCache?serverCache.getImmediateChild(childName):null,childWritesCache=writeTreeRefChild(writesCache,childName),childOperation=operation.operationForChild(childName);childOperation&&(events=events.concat(syncTreeApplyOperationDescendantsHelper_(childOperation,childTree,childServerCache,childWritesCache)))})),syncPoint&&(events=events.concat(syncPointApplyOperation(syncPoint,operation,writesCache,serverCache))),events}(operation,syncPointTree,serverCache,writesCache);var syncPoint=syncPointTree.get(newEmptyPath());null==serverCache&&null!=syncPoint&&(serverCache=syncPointGetCompleteServerCache(syncPoint,newEmptyPath()));var events=[],childName=pathGetFront(operation.path),childOperation=operation.operationForChild(childName),childTree=syncPointTree.children.get(childName);if(childTree&&childOperation){var childServerCache=serverCache?serverCache.getImmediateChild(childName):null,childWritesCache=writeTreeRefChild(writesCache,childName);events=events.concat(syncTreeApplyOperationHelper_(childOperation,childTree,childServerCache,childWritesCache))}return syncPoint&&(events=events.concat(syncPointApplyOperation(syncPoint,operation,writesCache,serverCache))),events}(operation,syncTree.syncPointTree_,null,writeTreeChildWrites(syncTree.pendingWriteTree_,newEmptyPath()))}function syncTreeCreateListenerForView_(syncTree,view){var query=view.query,tag=syncTreeTagForQuery_(syncTree,query);return{hashFn:function(){return(function(view){return view.viewCache_.serverCache.getNode()}(view)||ChildrenNode.EMPTY_NODE).hash()},onComplete:function(status){if(\"ok\"===status)return tag?function(syncTree,path,tag){var queryKey=syncTreeQueryKeyForTag_(syncTree,tag);if(queryKey){var r=syncTreeParseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=newRelativePath(queryPath,path);return syncTreeApplyTaggedOperation_(syncTree,queryPath,new ListenComplete(newOperationSourceServerTaggedQuery(queryId),relativePath))}return[]}(syncTree,query._path,tag):function(syncTree,path){return syncTreeApplyOperationToSyncPoints_(syncTree,new ListenComplete({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},path))}(syncTree,query._path);var error=function(code,query){var reason=\"Unknown Error\";\"too_big\"===code?reason=\"The data requested exceeds the maximum size that can be accessed with a single request.\":\"permission_denied\"===code?reason=\"Client doesn't have permission to access the desired data.\":\"unavailable\"===code&&(reason=\"The service is unavailable\");var error=new Error(code+\" at \"+query._path.toString()+\": \"+reason);return error.code=code.toUpperCase(),error}(status,query);return syncTreeRemoveEventRegistration(syncTree,query,null,error)}}}function syncTreeTagForQuery_(syncTree,query){var queryKey=syncTreeMakeQueryKey_(query);return syncTree.queryToTagMap.get(queryKey)}function syncTreeMakeQueryKey_(query){return query._path.toString()+\"$\"+query._queryIdentifier}function syncTreeQueryKeyForTag_(syncTree,tag){return syncTree.tagToQueryMap.get(tag)}function syncTreeParseQueryKey_(queryKey){var splitIndex=queryKey.indexOf(\"$\");return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(-1!==splitIndex&&splitIndex<queryKey.length-1,\"Bad queryKey.\"),{queryId:queryKey.substr(splitIndex+1),path:new Path(queryKey.substr(0,splitIndex))}}function syncTreeApplyTaggedOperation_(syncTree,queryPath,operation){var syncPoint=syncTree.syncPointTree_.get(queryPath);return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(syncPoint,\"Missing sync point for query tag that we're tracking\"),syncPointApplyOperation(syncPoint,operation,writeTreeChildWrites(syncTree.pendingWriteTree_,queryPath),null)}function syncTreeQueryForListening_(query){return query._queryParams.loadsAllData()&&!query._queryParams.isDefault()?new(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(referenceConstructor$1,\"Reference.ts has not been loaded\"),referenceConstructor$1)(query._repo,query._path):query}var ExistingValueProvider=function(){function ExistingValueProvider(node_){this.node_=node_}return ExistingValueProvider.prototype.getImmediateChild=function(childName){return new ExistingValueProvider(this.node_.getImmediateChild(childName))},ExistingValueProvider.prototype.node=function(){return this.node_},ExistingValueProvider}(),DeferredValueProvider=function(){function DeferredValueProvider(syncTree,path){this.syncTree_=syncTree,this.path_=path}return DeferredValueProvider.prototype.getImmediateChild=function(childName){var childPath=pathChild(this.path_,childName);return new DeferredValueProvider(this.syncTree_,childPath)},DeferredValueProvider.prototype.node=function(){return syncTreeCalcCompleteEventCache(this.syncTree_,this.path_)},DeferredValueProvider}(),resolveDeferredLeafValue=function(value,existingVal,serverValues){return value&&\"object\"==typeof value?(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(\".sv\"in value,\"Unexpected leaf node or priority contents\"),\"string\"==typeof value[\".sv\"]?resolveScalarDeferredValue(value[\".sv\"],existingVal,serverValues):\"object\"==typeof value[\".sv\"]?resolveComplexDeferredValue(value[\".sv\"],existingVal):void Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!1,\"Unexpected server value: \"+JSON.stringify(value,null,2))):value},resolveScalarDeferredValue=function(op,existing,serverValues){switch(op){case\"timestamp\":return serverValues.timestamp;default:Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!1,\"Unexpected server value: \"+op)}},resolveComplexDeferredValue=function(op,existing,unused){op.hasOwnProperty(\"increment\")||Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!1,\"Unexpected server value: \"+JSON.stringify(op,null,2));var delta=op.increment;\"number\"!=typeof delta&&Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!1,\"Unexpected increment value: \"+delta);var existingNode=existing.node();if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(null!=existingNode,\"Expected ChildrenNode.EMPTY_NODE for nulls\"),!existingNode.isLeafNode())return delta;var existingVal=existingNode.getValue();return\"number\"!=typeof existingVal?delta:existingVal+delta},resolveDeferredValueTree=function(path,node,syncTree,serverValues){return resolveDeferredValue(node,new DeferredValueProvider(syncTree,path),serverValues)},resolveDeferredValueSnapshot=function(node,existing,serverValues){return resolveDeferredValue(node,new ExistingValueProvider(existing),serverValues)};function resolveDeferredValue(node,existingVal,serverValues){var newNode,rawPri=node.getPriority().val(),priority=resolveDeferredLeafValue(rawPri,existingVal.getImmediateChild(\".priority\"),serverValues);if(node.isLeafNode()){var leafNode=node,value=resolveDeferredLeafValue(leafNode.getValue(),existingVal,serverValues);return value!==leafNode.getValue()||priority!==leafNode.getPriority().val()?new LeafNode(value,nodeFromJSON$1(priority)):node}var childrenNode=node;return newNode=childrenNode,priority!==childrenNode.getPriority().val()&&(newNode=newNode.updatePriority(new LeafNode(priority))),childrenNode.forEachChild(PRIORITY_INDEX,(function(childName,childNode){var newChildNode=resolveDeferredValue(childNode,existingVal.getImmediateChild(childName),serverValues);newChildNode!==childNode&&(newNode=newNode.updateImmediateChild(childName,newChildNode))})),newNode}var Tree=function(){return function(name,parent,node){void 0===name&&(name=\"\"),void 0===parent&&(parent=null),void 0===node&&(node={children:{},childCount:0}),this.name=name,this.parent=parent,this.node=node}}();function treeSubTree(tree,pathObj){for(var path=pathObj instanceof Path?pathObj:new Path(pathObj),child=tree,next=pathGetFront(path);null!==next;){var childNode=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.safeGet)(child.node.children,next)||{children:{},childCount:0};child=new Tree(next,child,childNode),next=pathGetFront(path=pathPopFront(path))}return child}function treeGetValue(tree){return tree.node.value}function treeSetValue(tree,value){tree.node.value=value,function treeUpdateParents(tree){null!==tree.parent&&function(tree,childName,child){var childEmpty=function(tree){return void 0===treeGetValue(tree)&&!treeHasChildren(tree)}(child),childExists=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(tree.node.children,childName);childEmpty&&childExists?(delete tree.node.children[childName],tree.node.childCount--,treeUpdateParents(tree)):childEmpty||childExists||(tree.node.children[childName]=child.node,tree.node.childCount++,treeUpdateParents(tree))}(tree.parent,tree.name,tree)}(tree)}function treeHasChildren(tree){return tree.node.childCount>0}function treeForEachChild(tree,action){each(tree.node.children,(function(child,childTree){action(new Tree(child,tree,childTree))}))}function treeGetPath(tree){return new Path(null===tree.parent?tree.name:treeGetPath(tree.parent)+\"/\"+tree.name)}var INVALID_KEY_REGEX_=/[\\[\\].#$\\/\\u0000-\\u001F\\u007F]/,INVALID_PATH_REGEX_=/[\\[\\].#$\\u0000-\\u001F\\u007F]/,isValidKey=function(key){return\"string\"==typeof key&&0!==key.length&&!INVALID_KEY_REGEX_.test(key)},isValidPathString=function(pathString){return\"string\"==typeof pathString&&0!==pathString.length&&!INVALID_PATH_REGEX_.test(pathString)},isValidPriority=function(priority){return null===priority||\"string\"==typeof priority||\"number\"==typeof priority&&!isInvalidJSONNumber(priority)||priority&&\"object\"==typeof priority&&Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(priority,\".sv\")},validateFirebaseDataArg=function(fnName,value,path,optional){optional&&void 0===value||validateFirebaseData(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(fnName,\"value\"),value,path)},validateFirebaseData=function(errorPrefix,data,path_){var path=path_ instanceof Path?new ValidationPath(path_,errorPrefix):path_;if(void 0===data)throw new Error(errorPrefix+\"contains undefined \"+validationPathToErrorString(path));if(\"function\"==typeof data)throw new Error(errorPrefix+\"contains a function \"+validationPathToErrorString(path)+\" with contents = \"+data.toString());if(isInvalidJSONNumber(data))throw new Error(errorPrefix+\"contains \"+data.toString()+\" \"+validationPathToErrorString(path));if(\"string\"==typeof data&&data.length>10485760/3&&Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringLength)(data)>10485760)throw new Error(errorPrefix+\"contains a string greater than 10485760 utf8 bytes \"+validationPathToErrorString(path)+\" ('\"+data.substring(0,50)+\"...')\");if(data&&\"object\"==typeof data){var hasDotValue_1=!1,hasActualChild_1=!1;if(each(data,(function(key,value){if(\".value\"===key)hasDotValue_1=!0;else if(\".priority\"!==key&&\".sv\"!==key&&(hasActualChild_1=!0,!isValidKey(key)))throw new Error(errorPrefix+\" contains an invalid key (\"+key+\") \"+validationPathToErrorString(path)+'.  Keys must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"');var validationPath,last;!function(validationPath,child){validationPath.parts_.length>0&&(validationPath.byteLength_+=1),validationPath.parts_.push(child),validationPath.byteLength_+=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringLength)(child),validationPathCheckValid(validationPath)}(path,key),validateFirebaseData(errorPrefix,value,path),last=(validationPath=path).parts_.pop(),validationPath.byteLength_-=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringLength)(last),validationPath.parts_.length>0&&(validationPath.byteLength_-=1)})),hasDotValue_1&&hasActualChild_1)throw new Error(errorPrefix+' contains \".value\" child '+validationPathToErrorString(path)+\" in addition to actual children.\")}},validateFirebaseMergeDataArg=function(fnName,data,path,optional){if(!optional||void 0!==data){var errorPrefix$1=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(fnName,\"values\");if(!data||\"object\"!=typeof data||Array.isArray(data))throw new Error(errorPrefix$1+\" must be an object containing the children to replace.\");var mergePaths=[];each(data,(function(key,value){var curPath=new Path(key);if(validateFirebaseData(errorPrefix$1,value,pathChild(path,curPath)),\".priority\"===pathGetBack(curPath)&&!isValidPriority(value))throw new Error(errorPrefix$1+\"contains an invalid value for '\"+curPath.toString()+\"', which must be a valid Firebase priority (a string, finite number, server value, or null).\");mergePaths.push(curPath)})),function(errorPrefix,mergePaths){var i,curPath;for(i=0;i<mergePaths.length;i++)for(var keys=pathSlice(curPath=mergePaths[i]),j=0;j<keys.length;j++)if(\".priority\"===keys[j]&&j===keys.length-1);else if(!isValidKey(keys[j]))throw new Error(errorPrefix+\"contains an invalid key (\"+keys[j]+\") in path \"+curPath.toString()+'. Keys must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"');mergePaths.sort(pathCompare);var prevPath=null;for(i=0;i<mergePaths.length;i++){if(curPath=mergePaths[i],null!==prevPath&&pathContains(prevPath,curPath))throw new Error(errorPrefix+\"contains a path \"+prevPath.toString()+\" that is ancestor of another path \"+curPath.toString());prevPath=curPath}}(errorPrefix$1,mergePaths)}},validatePriority=function(fnName,priority,optional){if(!optional||void 0!==priority){if(isInvalidJSONNumber(priority))throw new Error(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(fnName,\"priority\")+\"is \"+priority.toString()+\", but must be a valid Firebase priority (a string, finite number, server value, or null).\");if(!isValidPriority(priority))throw new Error(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(fnName,\"priority\")+\"must be a valid Firebase priority (a string, finite number, server value, or null).\")}},validateEventType=function(fnName,eventType,optional){if(!optional||void 0!==eventType)switch(eventType){case\"value\":case\"child_added\":case\"child_removed\":case\"child_changed\":case\"child_moved\":break;default:throw new Error(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(fnName,\"eventType\")+'must be a valid event type = \"value\", \"child_added\", \"child_removed\", \"child_changed\", or \"child_moved\".')}},validateKey=function(fnName,argumentName,key,optional){if(!(optional&&void 0===key||isValidKey(key)))throw new Error(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(fnName,argumentName)+'was an invalid key = \"'+key+'\".  Firebase keys must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\").')},validatePathString=function(fnName,argumentName,pathString,optional){if(!(optional&&void 0===pathString||isValidPathString(pathString)))throw new Error(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(fnName,argumentName)+'was an invalid path = \"'+pathString+'\". Paths must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\"')},validateWritablePath=function(fnName,path){if(\".info\"===pathGetFront(path))throw new Error(fnName+\" failed = Can't modify data under /.info/\")},validateUrl=function(fnName,parsedUrl){var pathString=parsedUrl.path.toString();if(\"string\"!=typeof parsedUrl.repoInfo.host||0===parsedUrl.repoInfo.host.length||!isValidKey(parsedUrl.repoInfo.namespace)&&\"localhost\"!==parsedUrl.repoInfo.host.split(\":\")[0]||0!==pathString.length&&!function(pathString){return pathString&&(pathString=pathString.replace(/^\\/*\\.info(\\/|$)/,\"/\")),isValidPathString(pathString)}(pathString))throw new Error(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(fnName,\"url\")+'must be a valid firebase URL and the path can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\".')},validateBoolean=function(fnName,argumentName,bool,optional){if((!optional||void 0!==bool)&&\"boolean\"!=typeof bool)throw new Error(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(fnName,argumentName)+\"must be a boolean.\")},EventQueue=function(){return function(){this.eventLists_=[],this.recursionDepth_=0}}();function eventQueueQueueEvents(eventQueue,eventDataList){for(var currList=null,i=0;i<eventDataList.length;i++){var data=eventDataList[i],path=data.getPath();null===currList||pathEquals(path,currList.path)||(eventQueue.eventLists_.push(currList),currList=null),null===currList&&(currList={events:[],path:path}),currList.events.push(data)}currList&&eventQueue.eventLists_.push(currList)}function eventQueueRaiseEventsAtPath(eventQueue,path,eventDataList){eventQueueQueueEvents(eventQueue,eventDataList),eventQueueRaiseQueuedEventsMatchingPredicate(eventQueue,(function(eventPath){return pathEquals(eventPath,path)}))}function eventQueueRaiseEventsForChangedPath(eventQueue,changedPath,eventDataList){eventQueueQueueEvents(eventQueue,eventDataList),eventQueueRaiseQueuedEventsMatchingPredicate(eventQueue,(function(eventPath){return pathContains(eventPath,changedPath)||pathContains(changedPath,eventPath)}))}function eventQueueRaiseQueuedEventsMatchingPredicate(eventQueue,predicate){eventQueue.recursionDepth_++;for(var sentAll=!0,i=0;i<eventQueue.eventLists_.length;i++){var eventList=eventQueue.eventLists_[i];eventList&&(predicate(eventList.path)?(eventListRaise(eventQueue.eventLists_[i]),eventQueue.eventLists_[i]=null):sentAll=!1)}sentAll&&(eventQueue.eventLists_=[]),eventQueue.recursionDepth_--}function eventListRaise(eventList){for(var i=0;i<eventList.events.length;i++){var eventData=eventList.events[i];if(null!==eventData){eventList.events[i]=null;var eventFn=eventData.getEventRunner();logger&&log(\"event: \"+eventData.toString()),exceptionGuard(eventFn)}}}var Repo=function(){function Repo(repoInfo_,forceRestClient_,authTokenProvider_,appCheckProvider_){this.repoInfo_=repoInfo_,this.forceRestClient_=forceRestClient_,this.authTokenProvider_=authTokenProvider_,this.appCheckProvider_=appCheckProvider_,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=newSparseSnapshotTree(),this.transactionQueueTree_=new Tree,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return Repo.prototype.toString=function(){return(this.repoInfo_.secure?\"https://\":\"http://\")+this.repoInfo_.host},Repo}();function repoServerTime(repo){var offset=repo.infoData_.getNode(new Path(\".info/serverTimeOffset\")).val()||0;return(new Date).getTime()+offset}function repoGenerateServerValues(repo){return(values=(values={timestamp:repoServerTime(repo)})||{}).timestamp=values.timestamp||(new Date).getTime(),values;var values}function repoOnDataUpdate(repo,pathString,data,isMerge,tag){repo.dataUpdateCount++;var path=new Path(pathString);data=repo.interceptServerDataCallback_?repo.interceptServerDataCallback_(pathString,data):data;var events=[];if(tag)if(isMerge){var taggedChildren=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.map)(data,(function(raw){return nodeFromJSON$1(raw)}));events=function(syncTree,path,changedChildren,tag){var queryKey=syncTreeQueryKeyForTag_(syncTree,tag);if(queryKey){var r=syncTreeParseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=newRelativePath(queryPath,path),changeTree=ImmutableTree.fromObject(changedChildren);return syncTreeApplyTaggedOperation_(syncTree,queryPath,new Merge(newOperationSourceServerTaggedQuery(queryId),relativePath,changeTree))}return[]}(repo.serverSyncTree_,path,taggedChildren,tag)}else{var taggedSnap=nodeFromJSON$1(data);events=function(syncTree,path,snap,tag){var queryKey=syncTreeQueryKeyForTag_(syncTree,tag);if(null!=queryKey){var r=syncTreeParseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=newRelativePath(queryPath,path);return syncTreeApplyTaggedOperation_(syncTree,queryPath,new Overwrite(newOperationSourceServerTaggedQuery(queryId),relativePath,snap))}return[]}(repo.serverSyncTree_,path,taggedSnap,tag)}else if(isMerge){var changedChildren=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.map)(data,(function(raw){return nodeFromJSON$1(raw)}));events=function(syncTree,path,changedChildren){var changeTree=ImmutableTree.fromObject(changedChildren);return syncTreeApplyOperationToSyncPoints_(syncTree,new Merge({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},path,changeTree))}(repo.serverSyncTree_,path,changedChildren)}else{var snap=nodeFromJSON$1(data);events=syncTreeApplyServerOverwrite(repo.serverSyncTree_,path,snap)}var affectedPath=path;events.length>0&&(affectedPath=repoRerunTransactions(repo,path)),eventQueueRaiseEventsForChangedPath(repo.eventQueue_,affectedPath,events)}function repoOnConnectStatus(repo,connectStatus){repoUpdateInfo(repo,\"connected\",connectStatus),!1===connectStatus&&function(repo){repoLog(repo,\"onDisconnectEvents\");var serverValues=repoGenerateServerValues(repo),resolvedOnDisconnectTree=newSparseSnapshotTree();sparseSnapshotTreeForEachTree(repo.onDisconnect_,newEmptyPath(),(function(path,node){var resolved=resolveDeferredValueTree(path,node,repo.serverSyncTree_,serverValues);sparseSnapshotTreeRemember(resolvedOnDisconnectTree,path,resolved)}));var events=[];sparseSnapshotTreeForEachTree(resolvedOnDisconnectTree,newEmptyPath(),(function(path,snap){events=events.concat(syncTreeApplyServerOverwrite(repo.serverSyncTree_,path,snap));var affectedPath=repoAbortTransactions(repo,path);repoRerunTransactions(repo,affectedPath)})),repo.onDisconnect_=newSparseSnapshotTree(),eventQueueRaiseEventsForChangedPath(repo.eventQueue_,newEmptyPath(),events)}(repo)}function repoUpdateInfo(repo,pathString,value){var path=new Path(\"/.info/\"+pathString),newNode=nodeFromJSON$1(value);repo.infoData_.updateSnapshot(path,newNode);var events=syncTreeApplyServerOverwrite(repo.infoSyncTree_,path,newNode);eventQueueRaiseEventsForChangedPath(repo.eventQueue_,path,events)}function repoGetNextWriteId(repo){return repo.nextWriteId_++}function repoSetWithPriority(repo,path,newVal,newPriority,onComplete){repoLog(repo,\"set\",{path:path.toString(),value:newVal,priority:newPriority});var serverValues=repoGenerateServerValues(repo),newNodeUnresolved=nodeFromJSON$1(newVal,newPriority),existing=syncTreeCalcCompleteEventCache(repo.serverSyncTree_,path),newNode=resolveDeferredValueSnapshot(newNodeUnresolved,existing,serverValues),writeId=repoGetNextWriteId(repo),events=syncTreeApplyUserOverwrite(repo.serverSyncTree_,path,newNode,writeId,!0);eventQueueQueueEvents(repo.eventQueue_,events),repo.server_.put(path.toString(),newNodeUnresolved.val(!0),(function(status,errorReason){var success=\"ok\"===status;success||warn(\"set at \"+path+\" failed: \"+status);var clearEvents=syncTreeAckUserWrite(repo.serverSyncTree_,writeId,!success);eventQueueRaiseEventsForChangedPath(repo.eventQueue_,path,clearEvents),repoCallOnCompleteCallback(0,onComplete,status,errorReason)}));var affectedPath=repoAbortTransactions(repo,path);repoRerunTransactions(repo,affectedPath),eventQueueRaiseEventsForChangedPath(repo.eventQueue_,affectedPath,[])}function repoOnDisconnectSet(repo,path,value,onComplete){var newNode=nodeFromJSON$1(value);repo.server_.onDisconnectPut(path.toString(),newNode.val(!0),(function(status,errorReason){\"ok\"===status&&sparseSnapshotTreeRemember(repo.onDisconnect_,path,newNode),repoCallOnCompleteCallback(0,onComplete,status,errorReason)}))}function repoRemoveEventCallbackForQuery(repo,query,eventRegistration){var events;events=\".info\"===pathGetFront(query._path)?syncTreeRemoveEventRegistration(repo.infoSyncTree_,query,eventRegistration):syncTreeRemoveEventRegistration(repo.serverSyncTree_,query,eventRegistration),eventQueueRaiseEventsAtPath(repo.eventQueue_,query._path,events)}function repoInterrupt(repo){repo.persistentConnection_&&repo.persistentConnection_.interrupt(\"repo_interrupt\")}function repoLog(repo){for(var varArgs=[],_i=1;_i<arguments.length;_i++)varArgs[_i-1]=arguments[_i];var prefix=\"\";repo.persistentConnection_&&(prefix=repo.persistentConnection_.id+\":\"),log.apply(void 0,Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__spreadArray)([prefix],Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__read)(varArgs)))}function repoCallOnCompleteCallback(repo,callback,status,errorReason){callback&&exceptionGuard((function(){if(\"ok\"===status)callback(null);else{var code=(status||\"error\").toUpperCase(),message=code;errorReason&&(message+=\": \"+errorReason);var error=new Error(message);error.code=code,callback(error)}}))}function repoGetLatestState(repo,path,excludeSets){return syncTreeCalcCompleteEventCache(repo.serverSyncTree_,path,excludeSets)||ChildrenNode.EMPTY_NODE}function repoSendReadyTransactions(repo,node){if(void 0===node&&(node=repo.transactionQueueTree_),node||repoPruneCompletedTransactionsBelowNode(repo,node),treeGetValue(node)){var queue=repoBuildTransactionQueue(repo,node);Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(queue.length>0,\"Sending zero length transaction queue\"),queue.every((function(transaction){return 0===transaction.status}))&&function(repo,path,queue){for(var setsToIgnore=queue.map((function(txn){return txn.currentWriteId})),latestState=repoGetLatestState(repo,path,setsToIgnore),snapToSend=latestState,latestHash=latestState.hash(),i=0;i<queue.length;i++){var txn=queue[i];Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(0===txn.status,\"tryToSendTransactionQueue_: items in queue should all be run.\"),txn.status=1,txn.retryCount++;var relativePath=newRelativePath(path,txn.path);snapToSend=snapToSend.updateChild(relativePath,txn.currentOutputSnapshotRaw)}var dataToSend=snapToSend.val(!0),pathToSend=path;repo.server_.put(pathToSend.toString(),dataToSend,(function(status){repoLog(repo,\"transaction put response\",{path:pathToSend.toString(),status:status});var events=[];if(\"ok\"===status){for(var callbacks=[],_loop_1=function(i){queue[i].status=2,events=events.concat(syncTreeAckUserWrite(repo.serverSyncTree_,queue[i].currentWriteId)),queue[i].onComplete&&callbacks.push((function(){return queue[i].onComplete(null,!0,queue[i].currentOutputSnapshotResolved)})),queue[i].unwatcher()},i=0;i<queue.length;i++)_loop_1(i);for(repoPruneCompletedTransactionsBelowNode(repo,treeSubTree(repo.transactionQueueTree_,path)),repoSendReadyTransactions(repo,repo.transactionQueueTree_),eventQueueRaiseEventsForChangedPath(repo.eventQueue_,path,events),i=0;i<callbacks.length;i++)exceptionGuard(callbacks[i])}else{if(\"datastale\"===status)for(i=0;i<queue.length;i++)queue[i].status=3===queue[i].status?4:0;else for(warn(\"transaction at \"+pathToSend.toString()+\" failed: \"+status),i=0;i<queue.length;i++)queue[i].status=4,queue[i].abortReason=status;repoRerunTransactions(repo,path)}}),latestHash)}(repo,treeGetPath(node),queue)}else treeHasChildren(node)&&treeForEachChild(node,(function(childNode){repoSendReadyTransactions(repo,childNode)}))}function repoRerunTransactions(repo,changedPath){var rootMostTransactionNode=repoGetAncestorTransactionNode(repo,changedPath),path=treeGetPath(rootMostTransactionNode);return function(repo,queue,path){if(0!==queue.length){for(var callbacks=[],events=[],setsToIgnore=queue.filter((function(q){return 0===q.status})).map((function(q){return q.currentWriteId})),_loop_2=function(i){var abortReason,transaction=queue[i],relativePath=newRelativePath(path,transaction.path),abortTransaction=!1;if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(null!==relativePath,\"rerunTransactionsUnderNode_: relativePath should not be null.\"),4===transaction.status)abortTransaction=!0,abortReason=transaction.abortReason,events=events.concat(syncTreeAckUserWrite(repo.serverSyncTree_,transaction.currentWriteId,!0));else if(0===transaction.status)if(transaction.retryCount>=25)abortTransaction=!0,abortReason=\"maxretry\",events=events.concat(syncTreeAckUserWrite(repo.serverSyncTree_,transaction.currentWriteId,!0));else{var currentNode=repoGetLatestState(repo,transaction.path,setsToIgnore);transaction.currentInputSnapshot=currentNode;var newData=queue[i].update(currentNode.val());if(void 0!==newData){validateFirebaseData(\"transaction failed: Data returned \",newData,transaction.path);var newDataNode=nodeFromJSON$1(newData);\"object\"==typeof newData&&null!=newData&&Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(newData,\".priority\")||(newDataNode=newDataNode.updatePriority(currentNode.getPriority()));var oldWriteId=transaction.currentWriteId,serverValues=repoGenerateServerValues(repo),newNodeResolved=resolveDeferredValueSnapshot(newDataNode,currentNode,serverValues);transaction.currentOutputSnapshotRaw=newDataNode,transaction.currentOutputSnapshotResolved=newNodeResolved,transaction.currentWriteId=repoGetNextWriteId(repo),setsToIgnore.splice(setsToIgnore.indexOf(oldWriteId),1),events=(events=events.concat(syncTreeApplyUserOverwrite(repo.serverSyncTree_,transaction.path,newNodeResolved,transaction.currentWriteId,transaction.applyLocally))).concat(syncTreeAckUserWrite(repo.serverSyncTree_,oldWriteId,!0))}else abortTransaction=!0,abortReason=\"nodata\",events=events.concat(syncTreeAckUserWrite(repo.serverSyncTree_,transaction.currentWriteId,!0))}eventQueueRaiseEventsForChangedPath(repo.eventQueue_,path,events),events=[],abortTransaction&&(queue[i].status=2,setTimeout(queue[i].unwatcher,Math.floor(0)),queue[i].onComplete&&callbacks.push(\"nodata\"===abortReason?function(){return queue[i].onComplete(null,!1,queue[i].currentInputSnapshot)}:function(){return queue[i].onComplete(new Error(abortReason),!1,null)}))},i=0;i<queue.length;i++)_loop_2(i);for(repoPruneCompletedTransactionsBelowNode(repo,repo.transactionQueueTree_),i=0;i<callbacks.length;i++)exceptionGuard(callbacks[i]);repoSendReadyTransactions(repo,repo.transactionQueueTree_)}}(repo,repoBuildTransactionQueue(repo,rootMostTransactionNode),path),path}function repoGetAncestorTransactionNode(repo,path){var front,transactionNode=repo.transactionQueueTree_;for(front=pathGetFront(path);null!==front&&void 0===treeGetValue(transactionNode);)transactionNode=treeSubTree(transactionNode,front),front=pathGetFront(path=pathPopFront(path));return transactionNode}function repoBuildTransactionQueue(repo,transactionNode){var transactionQueue=[];return function repoAggregateTransactionQueuesForNode(repo,node,queue){var nodeQueue=treeGetValue(node);if(nodeQueue)for(var i=0;i<nodeQueue.length;i++)queue.push(nodeQueue[i]);treeForEachChild(node,(function(child){repoAggregateTransactionQueuesForNode(repo,child,queue)}))}(repo,transactionNode,transactionQueue),transactionQueue.sort((function(a,b){return a.order-b.order})),transactionQueue}function repoPruneCompletedTransactionsBelowNode(repo,node){var queue=treeGetValue(node);if(queue){for(var to=0,from=0;from<queue.length;from++)2!==queue[from].status&&(queue[to]=queue[from],to++);queue.length=to,treeSetValue(node,queue.length>0?queue:void 0)}treeForEachChild(node,(function(childNode){repoPruneCompletedTransactionsBelowNode(repo,childNode)}))}function repoAbortTransactions(repo,path){var affectedPath=treeGetPath(repoGetAncestorTransactionNode(repo,path)),transactionNode=treeSubTree(repo.transactionQueueTree_,path);return function(tree,action,includeSelf){for(var node=tree.parent;null!==node;){if(action(node))return!0;node=node.parent}}(transactionNode,(function(node){repoAbortTransactionsOnNode(repo,node)})),repoAbortTransactionsOnNode(repo,transactionNode),function treeForEachDescendant(tree,action,includeSelf,childrenFirst){includeSelf&&!childrenFirst&&action(tree),treeForEachChild(tree,(function(child){treeForEachDescendant(child,action,!0,childrenFirst)})),includeSelf&&childrenFirst&&action(tree)}(transactionNode,(function(node){repoAbortTransactionsOnNode(repo,node)})),affectedPath}function repoAbortTransactionsOnNode(repo,node){var queue=treeGetValue(node);if(queue){for(var callbacks=[],events=[],lastSent=-1,i=0;i<queue.length;i++)3===queue[i].status||(1===queue[i].status?(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(lastSent===i-1,\"All SENT items should be at beginning of queue.\"),lastSent=i,queue[i].status=3,queue[i].abortReason=\"set\"):(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(0===queue[i].status,\"Unexpected transaction status in abort\"),queue[i].unwatcher(),events=events.concat(syncTreeAckUserWrite(repo.serverSyncTree_,queue[i].currentWriteId,!0)),queue[i].onComplete&&callbacks.push(queue[i].onComplete.bind(null,new Error(\"set\"),!1,null))));for(-1===lastSent?treeSetValue(node,void 0):queue.length=lastSent+1,eventQueueRaiseEventsForChangedPath(repo.eventQueue_,treeGetPath(node),events),i=0;i<callbacks.length;i++)exceptionGuard(callbacks[i])}}var parseRepoInfo=function(dataURL,nodeAdmin){var parsedUrl=parseDatabaseURL(dataURL),namespace=parsedUrl.namespace;return\"firebase.com\"===parsedUrl.domain&&fatal(parsedUrl.host+\" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead\"),namespace&&\"undefined\"!==namespace||\"localhost\"===parsedUrl.domain||fatal(\"Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com\"),parsedUrl.secure||\"undefined\"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf(\"https:\")&&warn(\"Insecure Firebase access from a secure page. Please use https in calls to new Firebase().\"),{repoInfo:new RepoInfo(parsedUrl.host,parsedUrl.secure,namespace,nodeAdmin,\"ws\"===parsedUrl.scheme||\"wss\"===parsedUrl.scheme,\"\",namespace!==parsedUrl.subdomain),path:new Path(parsedUrl.pathString)}},parseDatabaseURL=function(dataURL){var host=\"\",domain=\"\",subdomain=\"\",pathString=\"\",namespace=\"\",secure=!0,scheme=\"https\",port=443;if(\"string\"==typeof dataURL){var colonInd=dataURL.indexOf(\"//\");colonInd>=0&&(scheme=dataURL.substring(0,colonInd-1),dataURL=dataURL.substring(colonInd+2));var slashInd=dataURL.indexOf(\"/\");-1===slashInd&&(slashInd=dataURL.length);var questionMarkInd=dataURL.indexOf(\"?\");-1===questionMarkInd&&(questionMarkInd=dataURL.length),host=dataURL.substring(0,Math.min(slashInd,questionMarkInd)),slashInd<questionMarkInd&&(pathString=function(pathString){for(var pathStringDecoded=\"\",pieces=pathString.split(\"/\"),i=0;i<pieces.length;i++)if(pieces[i].length>0){var piece=pieces[i];try{piece=decodeURIComponent(piece.replace(/\\+/g,\" \"))}catch(e){}pathStringDecoded+=\"/\"+piece}return pathStringDecoded}(dataURL.substring(slashInd,questionMarkInd)));var queryParams=function(queryString){var e_1,_a,results={};\"?\"===queryString.charAt(0)&&(queryString=queryString.substring(1));try{for(var _b=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__values)(queryString.split(\"&\")),_c=_b.next();!_c.done;_c=_b.next()){var segment=_c.value;if(0!==segment.length){var kv=segment.split(\"=\");2===kv.length?results[decodeURIComponent(kv[0])]=decodeURIComponent(kv[1]):warn(\"Invalid query segment '\"+segment+\"' in query '\"+queryString+\"'\")}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}return results}(dataURL.substring(Math.min(dataURL.length,questionMarkInd)));(colonInd=host.indexOf(\":\"))>=0?(secure=\"https\"===scheme||\"wss\"===scheme,port=parseInt(host.substring(colonInd+1),10)):colonInd=host.length;var hostWithoutPort=host.slice(0,colonInd);if(\"localhost\"===hostWithoutPort.toLowerCase())domain=\"localhost\";else if(hostWithoutPort.split(\".\").length<=2)domain=hostWithoutPort;else{var dotInd=host.indexOf(\".\");subdomain=host.substring(0,dotInd).toLowerCase(),domain=host.substring(dotInd+1),namespace=subdomain}\"ns\"in queryParams&&(namespace=queryParams.ns)}return{host:host,port:port,domain:domain,subdomain:subdomain,secure:secure,scheme:scheme,pathString:pathString,namespace:namespace}},DataEvent=function(){function DataEvent(eventType,eventRegistration,snapshot,prevName){this.eventType=eventType,this.eventRegistration=eventRegistration,this.snapshot=snapshot,this.prevName=prevName}return DataEvent.prototype.getPath=function(){var ref=this.snapshot.ref;return\"value\"===this.eventType?ref._path:ref.parent._path},DataEvent.prototype.getEventType=function(){return this.eventType},DataEvent.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},DataEvent.prototype.toString=function(){return this.getPath().toString()+\":\"+this.eventType+\":\"+Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(this.snapshot.exportVal())},DataEvent}(),CancelEvent=function(){function CancelEvent(eventRegistration,error,path){this.eventRegistration=eventRegistration,this.error=error,this.path=path}return CancelEvent.prototype.getPath=function(){return this.path},CancelEvent.prototype.getEventType=function(){return\"cancel\"},CancelEvent.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},CancelEvent.prototype.toString=function(){return this.path.toString()+\":cancel\"},CancelEvent}(),CallbackContext=function(){function CallbackContext(snapshotCallback,cancelCallback){this.snapshotCallback=snapshotCallback,this.cancelCallback=cancelCallback}return CallbackContext.prototype.onValue=function(expDataSnapshot,previousChildName){this.snapshotCallback.call(null,expDataSnapshot,previousChildName)},CallbackContext.prototype.onCancel=function(error){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(this.hasCancelCallback,\"Raising a cancel event on a listener with no cancel callback\"),this.cancelCallback.call(null,error)},Object.defineProperty(CallbackContext.prototype,\"hasCancelCallback\",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),CallbackContext.prototype.matches=function(other){return this.snapshotCallback===other.snapshotCallback||this.snapshotCallback.userCallback===other.snapshotCallback.userCallback&&this.snapshotCallback.context===other.snapshotCallback.context},CallbackContext}(),OnDisconnect=function(){function OnDisconnect(_repo,_path){this._repo=_repo,this._path=_path}return OnDisconnect.prototype.cancel=function(){var repo,path,onComplete,deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred;return repo=this._repo,path=this._path,onComplete=deferred.wrapCallback((function(){})),repo.server_.onDisconnectCancel(path.toString(),(function(status,errorReason){\"ok\"===status&&function sparseSnapshotTreeForget(sparseSnapshotTree,path){if(pathIsEmpty(path))return sparseSnapshotTree.value=null,sparseSnapshotTree.children.clear(),!0;if(null!==sparseSnapshotTree.value){if(sparseSnapshotTree.value.isLeafNode())return!1;var value=sparseSnapshotTree.value;return sparseSnapshotTree.value=null,value.forEachChild(PRIORITY_INDEX,(function(key,tree){sparseSnapshotTreeRemember(sparseSnapshotTree,new Path(key),tree)})),sparseSnapshotTreeForget(sparseSnapshotTree,path)}if(sparseSnapshotTree.children.size>0){var childKey=pathGetFront(path);return path=pathPopFront(path),sparseSnapshotTree.children.has(childKey)&&sparseSnapshotTreeForget(sparseSnapshotTree.children.get(childKey),path)&&sparseSnapshotTree.children.delete(childKey),0===sparseSnapshotTree.children.size}return!0}(repo.onDisconnect_,path),repoCallOnCompleteCallback(0,onComplete,status,errorReason)})),deferred.promise},OnDisconnect.prototype.remove=function(){validateWritablePath(\"OnDisconnect.remove\",this._path);var deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred;return repoOnDisconnectSet(this._repo,this._path,null,deferred.wrapCallback((function(){}))),deferred.promise},OnDisconnect.prototype.set=function(value){validateWritablePath(\"OnDisconnect.set\",this._path),validateFirebaseDataArg(\"OnDisconnect.set\",value,this._path,!1);var deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred;return repoOnDisconnectSet(this._repo,this._path,value,deferred.wrapCallback((function(){}))),deferred.promise},OnDisconnect.prototype.setWithPriority=function(value,priority){validateWritablePath(\"OnDisconnect.setWithPriority\",this._path),validateFirebaseDataArg(\"OnDisconnect.setWithPriority\",value,this._path,!1),validatePriority(\"OnDisconnect.setWithPriority\",priority,!1);var deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred;return function(repo,path,value,priority,onComplete){var newNode=nodeFromJSON$1(value,priority);repo.server_.onDisconnectPut(path.toString(),newNode.val(!0),(function(status,errorReason){\"ok\"===status&&sparseSnapshotTreeRemember(repo.onDisconnect_,path,newNode),repoCallOnCompleteCallback(0,onComplete,status,errorReason)}))}(this._repo,this._path,value,priority,deferred.wrapCallback((function(){}))),deferred.promise},OnDisconnect.prototype.update=function(values){validateWritablePath(\"OnDisconnect.update\",this._path),validateFirebaseMergeDataArg(\"OnDisconnect.update\",values,this._path,!1);var deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred;return function(repo,path,childrenToMerge,onComplete){if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isEmpty)(childrenToMerge))return log(\"onDisconnect().update() called with empty data.  Don't do anything.\"),void repoCallOnCompleteCallback(0,onComplete,\"ok\",void 0);repo.server_.onDisconnectMerge(path.toString(),childrenToMerge,(function(status,errorReason){\"ok\"===status&&each(childrenToMerge,(function(childName,childNode){var newChildNode=nodeFromJSON$1(childNode);sparseSnapshotTreeRemember(repo.onDisconnect_,pathChild(path,childName),newChildNode)})),repoCallOnCompleteCallback(0,onComplete,status,errorReason)}))}(this._repo,this._path,values,deferred.wrapCallback((function(){}))),deferred.promise},OnDisconnect}(),QueryImpl=function(){function QueryImpl(_repo,_path,_queryParams,_orderByCalled){this._repo=_repo,this._path=_path,this._queryParams=_queryParams,this._orderByCalled=_orderByCalled}return Object.defineProperty(QueryImpl.prototype,\"key\",{get:function(){return pathIsEmpty(this._path)?null:pathGetBack(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(QueryImpl.prototype,\"ref\",{get:function(){return new ReferenceImpl(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(QueryImpl.prototype,\"_queryIdentifier\",{get:function(){var obj=queryParamsGetQueryObject(this._queryParams),id=ObjectToUniqueKey(obj);return\"{}\"===id?\"default\":id},enumerable:!1,configurable:!0}),Object.defineProperty(QueryImpl.prototype,\"_queryObject\",{get:function(){return queryParamsGetQueryObject(this._queryParams)},enumerable:!1,configurable:!0}),QueryImpl.prototype.isEqual=function(other){if(!((other=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(other))instanceof QueryImpl))return!1;var sameRepo=this._repo===other._repo,samePath=pathEquals(this._path,other._path);return sameRepo&&samePath&&this._queryIdentifier===other._queryIdentifier},QueryImpl.prototype.toJSON=function(){return this.toString()},QueryImpl.prototype.toString=function(){return this._repo.toString()+function(path){for(var pathString=\"\",i=path.pieceNum_;i<path.pieces_.length;i++)\"\"!==path.pieces_[i]&&(pathString+=\"/\"+encodeURIComponent(String(path.pieces_[i])));return pathString||\"/\"}(this._path)},QueryImpl}();function validateNoPreviousOrderByCall(query,fnName){if(!0===query._orderByCalled)throw new Error(fnName+\": You can't combine multiple orderBy calls.\")}function validateQueryEndpoints(params){var startNode=null,endNode=null;if(params.hasStart()&&(startNode=params.getIndexStartValue()),params.hasEnd()&&(endNode=params.getIndexEndValue()),params.getIndex()===KEY_INDEX){var tooManyArgsError=\"Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().\",wrongArgTypeError=\"Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.\";if(params.hasStart()){if(params.getIndexStartName()!==MIN_NAME)throw new Error(tooManyArgsError);if(\"string\"!=typeof startNode)throw new Error(wrongArgTypeError)}if(params.hasEnd()){if(params.getIndexEndName()!==MAX_NAME)throw new Error(tooManyArgsError);if(\"string\"!=typeof endNode)throw new Error(wrongArgTypeError)}}else if(params.getIndex()===PRIORITY_INDEX){if(null!=startNode&&!isValidPriority(startNode)||null!=endNode&&!isValidPriority(endNode))throw new Error(\"Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).\")}else if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(params.getIndex()instanceof PathIndex||params.getIndex()===VALUE_INDEX,\"unknown index type.\"),null!=startNode&&\"object\"==typeof startNode||null!=endNode&&\"object\"==typeof endNode)throw new Error(\"Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.\")}function validateLimit(params){if(params.hasStart()&&params.hasEnd()&&params.hasLimit()&&!params.hasAnchoredLimit())throw new Error(\"Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.\")}var ReferenceImpl=function(_super){function ReferenceImpl(repo,path){return _super.call(this,repo,path,new QueryParams,!1)||this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(ReferenceImpl,_super),Object.defineProperty(ReferenceImpl.prototype,\"parent\",{get:function(){var parentPath=pathParent(this._path);return null===parentPath?null:new ReferenceImpl(this._repo,parentPath)},enumerable:!1,configurable:!0}),Object.defineProperty(ReferenceImpl.prototype,\"root\",{get:function(){for(var ref=this;null!==ref.parent;)ref=ref.parent;return ref},enumerable:!1,configurable:!0}),ReferenceImpl}(QueryImpl),DataSnapshot=function(){function DataSnapshot(_node,ref,_index){this._node=_node,this.ref=ref,this._index=_index}return Object.defineProperty(DataSnapshot.prototype,\"priority\",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(DataSnapshot.prototype,\"key\",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(DataSnapshot.prototype,\"size\",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),DataSnapshot.prototype.child=function(path){var childPath=new Path(path),childRef=child(this.ref,path);return new DataSnapshot(this._node.getChild(childPath),childRef,PRIORITY_INDEX)},DataSnapshot.prototype.exists=function(){return!this._node.isEmpty()},DataSnapshot.prototype.exportVal=function(){return this._node.val(!0)},DataSnapshot.prototype.forEach=function(action){var _this=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(key,node){return action(new DataSnapshot(node,child(_this.ref,key),PRIORITY_INDEX))}))},DataSnapshot.prototype.hasChild=function(path){var childPath=new Path(path);return!this._node.getChild(childPath).isEmpty()},DataSnapshot.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},DataSnapshot.prototype.toJSON=function(){return this.exportVal()},DataSnapshot.prototype.val=function(){return this._node.val()},DataSnapshot}();function ref(db,path){return(db=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(db))._checkNotDeleted(\"ref\"),void 0!==path?child(db._root,path):db._root}function refFromURL(db,url){(db=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(db))._checkNotDeleted(\"refFromURL\");var parsedURL=parseRepoInfo(url,db._repo.repoInfo_.nodeAdmin);validateUrl(\"refFromURL\",parsedURL);var repoInfo=parsedURL.repoInfo;return db._repo.repoInfo_.isCustomHost()||repoInfo.host===db._repo.repoInfo_.host||fatal(\"refFromURL: Host name does not match the current database: (found \"+repoInfo.host+\" but expected \"+db._repo.repoInfo_.host+\")\"),ref(db,parsedURL.path.toString())}function child(parent,path){var pathString;return null===pathGetFront((parent=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(parent))._path)?((pathString=path)&&(pathString=pathString.replace(/^\\/*\\.info(\\/|$)/,\"/\")),validatePathString(\"child\",\"path\",pathString,!1)):validatePathString(\"child\",\"path\",path,!1),new ReferenceImpl(parent._repo,pathChild(parent._path,path))}function push(parent,value){parent=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(parent),validateWritablePath(\"push\",parent._path),validateFirebaseDataArg(\"push\",value,parent._path,!0);var promise,now=repoServerTime(parent._repo),name=nextPushId(now),thennablePushRef=child(parent,name),pushRef=child(parent,name);return promise=null!=value?set(pushRef,value).then((function(){return pushRef})):Promise.resolve(pushRef),thennablePushRef.then=promise.then.bind(promise),thennablePushRef.catch=promise.then.bind(promise,void 0),thennablePushRef}function remove(ref){return validateWritablePath(\"remove\",ref._path),set(ref,null)}function set(ref,value){ref=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(ref),validateWritablePath(\"set\",ref._path),validateFirebaseDataArg(\"set\",value,ref._path,!1);var deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred;return repoSetWithPriority(ref._repo,ref._path,value,null,deferred.wrapCallback((function(){}))),deferred.promise}function setPriority(ref,priority){ref=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(ref),validateWritablePath(\"setPriority\",ref._path),validatePriority(\"setPriority\",priority,!1);var deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred;return repoSetWithPriority(ref._repo,pathChild(ref._path,\".priority\"),priority,null,deferred.wrapCallback((function(){}))),deferred.promise}function setWithPriority(ref,value,priority){if(validateWritablePath(\"setWithPriority\",ref._path),validateFirebaseDataArg(\"setWithPriority\",value,ref._path,!1),validatePriority(\"setWithPriority\",priority,!1),\".length\"===ref.key||\".keys\"===ref.key)throw\"setWithPriority failed: \"+ref.key+\" is a read-only object.\";var deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred;return repoSetWithPriority(ref._repo,ref._path,value,priority,deferred.wrapCallback((function(){}))),deferred.promise}function update(ref,values){validateFirebaseMergeDataArg(\"update\",values,ref._path,!1);var deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred;return function(repo,path,childrenToMerge,onComplete){repoLog(repo,\"update\",{path:path.toString(),value:childrenToMerge});var empty=!0,serverValues=repoGenerateServerValues(repo),changedChildren={};if(each(childrenToMerge,(function(changedKey,changedValue){empty=!1,changedChildren[changedKey]=resolveDeferredValueTree(pathChild(path,changedKey),nodeFromJSON$1(changedValue),repo.serverSyncTree_,serverValues)})),empty)log(\"update() called with empty data.  Don't do anything.\"),repoCallOnCompleteCallback(0,onComplete,\"ok\",void 0);else{var writeId_1=repoGetNextWriteId(repo),events=function(syncTree,path,changedChildren,writeId){!function(writeTree,path,changedChildren,writeId){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(writeId>writeTree.lastWriteId,\"Stacking an older merge on top of newer ones\"),writeTree.allWrites.push({path:path,children:changedChildren,writeId:writeId,visible:!0}),writeTree.visibleWrites=compoundWriteAddWrites(writeTree.visibleWrites,path,changedChildren),writeTree.lastWriteId=writeId}(syncTree.pendingWriteTree_,path,changedChildren,writeId);var changeTree=ImmutableTree.fromObject(changedChildren);return syncTreeApplyOperationToSyncPoints_(syncTree,new Merge({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},path,changeTree))}(repo.serverSyncTree_,path,changedChildren,writeId_1);eventQueueQueueEvents(repo.eventQueue_,events),repo.server_.merge(path.toString(),childrenToMerge,(function(status,errorReason){var success=\"ok\"===status;success||warn(\"update at \"+path+\" failed: \"+status);var clearEvents=syncTreeAckUserWrite(repo.serverSyncTree_,writeId_1,!success),affectedPath=clearEvents.length>0?repoRerunTransactions(repo,path):path;eventQueueRaiseEventsForChangedPath(repo.eventQueue_,affectedPath,clearEvents),repoCallOnCompleteCallback(0,onComplete,status,errorReason)})),each(childrenToMerge,(function(changedPath){var affectedPath=repoAbortTransactions(repo,pathChild(path,changedPath));repoRerunTransactions(repo,affectedPath)})),eventQueueRaiseEventsForChangedPath(repo.eventQueue_,path,[])}}(ref._repo,ref._path,values,deferred.wrapCallback((function(){}))),deferred.promise}var ValueEventRegistration=function(){function ValueEventRegistration(callbackContext){this.callbackContext=callbackContext}return ValueEventRegistration.prototype.respondsTo=function(eventType){return\"value\"===eventType},ValueEventRegistration.prototype.createEvent=function(change,query){var index=query._queryParams.getIndex();return new DataEvent(\"value\",this,new DataSnapshot(change.snapshotNode,new ReferenceImpl(query._repo,query._path),index))},ValueEventRegistration.prototype.getEventRunner=function(eventData){var _this=this;return\"cancel\"===eventData.getEventType()?function(){return _this.callbackContext.onCancel(eventData.error)}:function(){return _this.callbackContext.onValue(eventData.snapshot,null)}},ValueEventRegistration.prototype.createCancelEvent=function(error,path){return this.callbackContext.hasCancelCallback?new CancelEvent(this,error,path):null},ValueEventRegistration.prototype.matches=function(other){return other instanceof ValueEventRegistration&&(!other.callbackContext||!this.callbackContext||other.callbackContext.matches(this.callbackContext))},ValueEventRegistration.prototype.hasAnyCallback=function(){return null!==this.callbackContext},ValueEventRegistration}(),ChildEventRegistration=function(){function ChildEventRegistration(eventType,callbackContext){this.eventType=eventType,this.callbackContext=callbackContext}return ChildEventRegistration.prototype.respondsTo=function(eventType){var eventToCheck=\"children_added\"===eventType?\"child_added\":eventType;return this.eventType===(\"children_removed\"===eventToCheck?\"child_removed\":eventToCheck)},ChildEventRegistration.prototype.createCancelEvent=function(error,path){return this.callbackContext.hasCancelCallback?new CancelEvent(this,error,path):null},ChildEventRegistration.prototype.createEvent=function(change,query){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(null!=change.childName,\"Child events should have a childName.\");var childRef=child(new ReferenceImpl(query._repo,query._path),change.childName),index=query._queryParams.getIndex();return new DataEvent(change.type,this,new DataSnapshot(change.snapshotNode,childRef,index),change.prevName)},ChildEventRegistration.prototype.getEventRunner=function(eventData){var _this=this;return\"cancel\"===eventData.getEventType()?function(){return _this.callbackContext.onCancel(eventData.error)}:function(){return _this.callbackContext.onValue(eventData.snapshot,eventData.prevName)}},ChildEventRegistration.prototype.matches=function(other){return other instanceof ChildEventRegistration&&this.eventType===other.eventType&&(!this.callbackContext||!other.callbackContext||this.callbackContext.matches(other.callbackContext))},ChildEventRegistration.prototype.hasAnyCallback=function(){return!!this.callbackContext},ChildEventRegistration}();function addEventListener(query,eventType,callback,cancelCallbackOrListenOptions,options){var cancelCallback;if(\"object\"==typeof cancelCallbackOrListenOptions&&(cancelCallback=void 0,options=cancelCallbackOrListenOptions),\"function\"==typeof cancelCallbackOrListenOptions&&(cancelCallback=cancelCallbackOrListenOptions),options&&options.onlyOnce){var userCallback_1=callback,onceCallback=function(dataSnapshot,previousChildName){repoRemoveEventCallbackForQuery(query._repo,query,container),userCallback_1(dataSnapshot,previousChildName)};onceCallback.userCallback=callback.userCallback,onceCallback.context=callback.context,callback=onceCallback}var callbackContext=new CallbackContext(callback,cancelCallback||void 0),container=\"value\"===eventType?new ValueEventRegistration(callbackContext):new ChildEventRegistration(eventType,callbackContext);return function(repo,query,eventRegistration){var events;events=\".info\"===pathGetFront(query._path)?syncTreeAddEventRegistration(repo.infoSyncTree_,query,eventRegistration):syncTreeAddEventRegistration(repo.serverSyncTree_,query,eventRegistration),eventQueueRaiseEventsAtPath(repo.eventQueue_,query._path,events)}(query._repo,query,container),function(){return repoRemoveEventCallbackForQuery(query._repo,query,container)}}function onValue(query,callback,cancelCallbackOrListenOptions,options){return addEventListener(query,\"value\",callback,cancelCallbackOrListenOptions,options)}function onChildAdded(query,callback,cancelCallbackOrListenOptions,options){return addEventListener(query,\"child_added\",callback,cancelCallbackOrListenOptions,options)}function onChildChanged(query,callback,cancelCallbackOrListenOptions,options){return addEventListener(query,\"child_changed\",callback,cancelCallbackOrListenOptions,options)}function onChildMoved(query,callback,cancelCallbackOrListenOptions,options){return addEventListener(query,\"child_moved\",callback,cancelCallbackOrListenOptions,options)}function onChildRemoved(query,callback,cancelCallbackOrListenOptions,options){return addEventListener(query,\"child_removed\",callback,cancelCallbackOrListenOptions,options)}function off(query,eventType,callback){var container=null,expCallback=callback?new CallbackContext(callback):null;\"value\"===eventType?container=new ValueEventRegistration(expCallback):eventType&&(container=new ChildEventRegistration(eventType,expCallback)),repoRemoveEventCallbackForQuery(query._repo,query,container)}var QueryConstraint=function(){return function(){}}(),QueryEndAtConstraint=function(_super){function QueryEndAtConstraint(_value,_key){var _this=_super.call(this)||this;return _this._value=_value,_this._key=_key,_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryEndAtConstraint,_super),QueryEndAtConstraint.prototype._apply=function(query){validateFirebaseDataArg(\"endAt\",this._value,query._path,!0);var newParams=queryParamsEndAt(query._queryParams,this._value,this._key);if(validateLimit(newParams),validateQueryEndpoints(newParams),query._queryParams.hasEnd())throw new Error(\"endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).\");return new QueryImpl(query._repo,query._path,newParams,query._orderByCalled)},QueryEndAtConstraint}(QueryConstraint);function endAt(value,key){return validateKey(\"endAt\",\"key\",key,!0),new QueryEndAtConstraint(value,key)}var QueryEndBeforeConstraint=function(_super){function QueryEndBeforeConstraint(_value,_key){var _this=_super.call(this)||this;return _this._value=_value,_this._key=_key,_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryEndBeforeConstraint,_super),QueryEndBeforeConstraint.prototype._apply=function(query){validateFirebaseDataArg(\"endBefore\",this._value,query._path,!1);var queryParams,indexValue,key,params,newParams=(indexValue=this._value,key=this._key,(queryParams=query._queryParams).index_===KEY_INDEX?(\"string\"==typeof indexValue&&(indexValue=predecessor(indexValue)),params=queryParamsEndAt(queryParams,indexValue,key)):params=queryParamsEndAt(queryParams,indexValue,null==key?MIN_NAME:predecessor(key)),params.endBeforeSet_=!0,params);if(validateLimit(newParams),validateQueryEndpoints(newParams),query._queryParams.hasEnd())throw new Error(\"endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).\");return new QueryImpl(query._repo,query._path,newParams,query._orderByCalled)},QueryEndBeforeConstraint}(QueryConstraint);function endBefore(value,key){return validateKey(\"endBefore\",\"key\",key,!0),new QueryEndBeforeConstraint(value,key)}var QueryStartAtConstraint=function(_super){function QueryStartAtConstraint(_value,_key){var _this=_super.call(this)||this;return _this._value=_value,_this._key=_key,_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryStartAtConstraint,_super),QueryStartAtConstraint.prototype._apply=function(query){validateFirebaseDataArg(\"startAt\",this._value,query._path,!0);var newParams=queryParamsStartAt(query._queryParams,this._value,this._key);if(validateLimit(newParams),validateQueryEndpoints(newParams),query._queryParams.hasStart())throw new Error(\"startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).\");return new QueryImpl(query._repo,query._path,newParams,query._orderByCalled)},QueryStartAtConstraint}(QueryConstraint);function startAt(value,key){return void 0===value&&(value=null),validateKey(\"startAt\",\"key\",key,!0),new QueryStartAtConstraint(value,key)}var QueryStartAfterConstraint=function(_super){function QueryStartAfterConstraint(_value,_key){var _this=_super.call(this)||this;return _this._value=_value,_this._key=_key,_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryStartAfterConstraint,_super),QueryStartAfterConstraint.prototype._apply=function(query){validateFirebaseDataArg(\"startAfter\",this._value,query._path,!1);var queryParams,indexValue,key,params,newParams=(indexValue=this._value,key=this._key,(queryParams=query._queryParams).index_===KEY_INDEX?(\"string\"==typeof indexValue&&(indexValue=successor(indexValue)),params=queryParamsStartAt(queryParams,indexValue,key)):params=queryParamsStartAt(queryParams,indexValue,null==key?MAX_NAME:successor(key)),params.startAfterSet_=!0,params);if(validateLimit(newParams),validateQueryEndpoints(newParams),query._queryParams.hasStart())throw new Error(\"startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).\");return new QueryImpl(query._repo,query._path,newParams,query._orderByCalled)},QueryStartAfterConstraint}(QueryConstraint);function startAfter(value,key){return validateKey(\"startAfter\",\"key\",key,!0),new QueryStartAfterConstraint(value,key)}var QueryLimitToFirstConstraint=function(_super){function QueryLimitToFirstConstraint(_limit){var _this=_super.call(this)||this;return _this._limit=_limit,_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryLimitToFirstConstraint,_super),QueryLimitToFirstConstraint.prototype._apply=function(query){if(query._queryParams.hasLimit())throw new Error(\"limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).\");return new QueryImpl(query._repo,query._path,(newLimit=this._limit,(newParams=query._queryParams.copy()).limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_=\"l\",newParams),query._orderByCalled);var newLimit,newParams},QueryLimitToFirstConstraint}(QueryConstraint);function limitToFirst(limit){if(\"number\"!=typeof limit||Math.floor(limit)!==limit||limit<=0)throw new Error(\"limitToFirst: First argument must be a positive integer.\");return new QueryLimitToFirstConstraint(limit)}var QueryLimitToLastConstraint=function(_super){function QueryLimitToLastConstraint(_limit){var _this=_super.call(this)||this;return _this._limit=_limit,_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryLimitToLastConstraint,_super),QueryLimitToLastConstraint.prototype._apply=function(query){if(query._queryParams.hasLimit())throw new Error(\"limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).\");return new QueryImpl(query._repo,query._path,(newLimit=this._limit,(newParams=query._queryParams.copy()).limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_=\"r\",newParams),query._orderByCalled);var newLimit,newParams},QueryLimitToLastConstraint}(QueryConstraint);function limitToLast(limit){if(\"number\"!=typeof limit||Math.floor(limit)!==limit||limit<=0)throw new Error(\"limitToLast: First argument must be a positive integer.\");return new QueryLimitToLastConstraint(limit)}var QueryOrderByChildConstraint=function(_super){function QueryOrderByChildConstraint(_path){var _this=_super.call(this)||this;return _this._path=_path,_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryOrderByChildConstraint,_super),QueryOrderByChildConstraint.prototype._apply=function(query){validateNoPreviousOrderByCall(query,\"orderByChild\");var parsedPath=new Path(this._path);if(pathIsEmpty(parsedPath))throw new Error(\"orderByChild: cannot pass in empty path. Use orderByValue() instead.\");var index=new PathIndex(parsedPath),newParams=queryParamsOrderBy(query._queryParams,index);return validateQueryEndpoints(newParams),new QueryImpl(query._repo,query._path,newParams,!0)},QueryOrderByChildConstraint}(QueryConstraint);function orderByChild(path){if(\"$key\"===path)throw new Error('orderByChild: \"$key\" is invalid.  Use orderByKey() instead.');if(\"$priority\"===path)throw new Error('orderByChild: \"$priority\" is invalid.  Use orderByPriority() instead.');if(\"$value\"===path)throw new Error('orderByChild: \"$value\" is invalid.  Use orderByValue() instead.');return validatePathString(\"orderByChild\",\"path\",path,!1),new QueryOrderByChildConstraint(path)}var QueryOrderByKeyConstraint=function(_super){function QueryOrderByKeyConstraint(){return null!==_super&&_super.apply(this,arguments)||this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryOrderByKeyConstraint,_super),QueryOrderByKeyConstraint.prototype._apply=function(query){validateNoPreviousOrderByCall(query,\"orderByKey\");var newParams=queryParamsOrderBy(query._queryParams,KEY_INDEX);return validateQueryEndpoints(newParams),new QueryImpl(query._repo,query._path,newParams,!0)},QueryOrderByKeyConstraint}(QueryConstraint);function orderByKey(){return new QueryOrderByKeyConstraint}var QueryOrderByPriorityConstraint=function(_super){function QueryOrderByPriorityConstraint(){return null!==_super&&_super.apply(this,arguments)||this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryOrderByPriorityConstraint,_super),QueryOrderByPriorityConstraint.prototype._apply=function(query){validateNoPreviousOrderByCall(query,\"orderByPriority\");var newParams=queryParamsOrderBy(query._queryParams,PRIORITY_INDEX);return validateQueryEndpoints(newParams),new QueryImpl(query._repo,query._path,newParams,!0)},QueryOrderByPriorityConstraint}(QueryConstraint);function orderByPriority(){return new QueryOrderByPriorityConstraint}var QueryOrderByValueConstraint=function(_super){function QueryOrderByValueConstraint(){return null!==_super&&_super.apply(this,arguments)||this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryOrderByValueConstraint,_super),QueryOrderByValueConstraint.prototype._apply=function(query){validateNoPreviousOrderByCall(query,\"orderByValue\");var newParams=queryParamsOrderBy(query._queryParams,VALUE_INDEX);return validateQueryEndpoints(newParams),new QueryImpl(query._repo,query._path,newParams,!0)},QueryOrderByValueConstraint}(QueryConstraint);function orderByValue(){return new QueryOrderByValueConstraint}var QueryEqualToValueConstraint=function(_super){function QueryEqualToValueConstraint(_value,_key){var _this=_super.call(this)||this;return _this._value=_value,_this._key=_key,_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(QueryEqualToValueConstraint,_super),QueryEqualToValueConstraint.prototype._apply=function(query){if(validateFirebaseDataArg(\"equalTo\",this._value,query._path,!1),query._queryParams.hasStart())throw new Error(\"equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).\");if(query._queryParams.hasEnd())throw new Error(\"equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).\");return new QueryEndAtConstraint(this._value,this._key)._apply(new QueryStartAtConstraint(this._value,this._key)._apply(query))},QueryEqualToValueConstraint}(QueryConstraint);function equalTo(value,key){return validateKey(\"equalTo\",\"key\",key,!0),new QueryEqualToValueConstraint(value,key)}function query(query){for(var e_1,_a,queryConstraints=[],_i=1;_i<arguments.length;_i++)queryConstraints[_i-1]=arguments[_i];var queryImpl=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(query);try{for(var queryConstraints_1=Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__values)(queryConstraints),queryConstraints_1_1=queryConstraints_1.next();!queryConstraints_1_1.done;queryConstraints_1_1=queryConstraints_1.next()){var constraint=queryConstraints_1_1.value;queryImpl=constraint._apply(queryImpl)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{queryConstraints_1_1&&!queryConstraints_1_1.done&&(_a=queryConstraints_1.return)&&_a.call(queryConstraints_1)}finally{if(e_1)throw e_1.error}}return queryImpl}!function(val){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!referenceConstructor,\"__referenceConstructor has already been defined\"),referenceConstructor=val}(ReferenceImpl),function(val){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(!referenceConstructor$1,\"__referenceConstructor has already been defined\"),referenceConstructor$1=val}(ReferenceImpl);var repos={},useRestClient=!1;function repoManagerDatabaseFromApp(app,authProvider,appCheckProvider,url,nodeAdmin){var dbUrl=url||app.options.databaseURL;void 0===dbUrl&&(app.options.projectId||fatal(\"Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp().\"),log(\"Using default host for project \",app.options.projectId),dbUrl=app.options.projectId+\"-default-rtdb.firebaseio.com\");var isEmulator,parsedUrl=parseRepoInfo(dbUrl,nodeAdmin),repoInfo=parsedUrl.repoInfo,dbEmulatorHost=void 0;\"undefined\"!=typeof process&&(dbEmulatorHost=process.env.FIREBASE_DATABASE_EMULATOR_HOST),dbEmulatorHost?(isEmulator=!0,repoInfo=(parsedUrl=parseRepoInfo(dbUrl=\"http://\"+dbEmulatorHost+\"?ns=\"+repoInfo.namespace,nodeAdmin)).repoInfo):isEmulator=!parsedUrl.repoInfo.secure;var authTokenProvider=nodeAdmin&&isEmulator?new EmulatorTokenProvider(EmulatorTokenProvider.OWNER):new FirebaseAuthTokenProvider(app.name,app.options,authProvider);validateUrl(\"Invalid Firebase Database URL\",parsedUrl),pathIsEmpty(parsedUrl.path)||fatal(\"Database URL must point to the root of a Firebase Database (not including a child path).\");var repo=function(repoInfo,app,authTokenProvider,appCheckProvider){var appRepos=repos[app.name];appRepos||(repos[app.name]=appRepos={});var repo=appRepos[repoInfo.toURLString()];return repo&&fatal(\"Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.\"),repo=new Repo(repoInfo,useRestClient,authTokenProvider,appCheckProvider),appRepos[repoInfo.toURLString()]=repo,repo}(repoInfo,app,authTokenProvider,new AppCheckTokenProvider(app.name,appCheckProvider));return new FirebaseDatabase(repo,app)}var FirebaseDatabase=function(){function FirebaseDatabase(_repoInternal,app){this._repoInternal=_repoInternal,this.app=app,this.type=\"database\",this._instanceStarted=!1}return Object.defineProperty(FirebaseDatabase.prototype,\"_repo\",{get:function(){return this._instanceStarted||(function(repo,appId,authOverride){if(repo.stats_=statsManagerGetCollection(repo.repoInfo_),repo.forceRestClient_||(\"object\"==typeof window&&window.navigator&&window.navigator.userAgent||\"\").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)repo.server_=new ReadonlyRestClient(repo.repoInfo_,(function(pathString,data,isMerge,tag){repoOnDataUpdate(repo,pathString,data,isMerge,tag)}),repo.authTokenProvider_,repo.appCheckProvider_),setTimeout((function(){return repoOnConnectStatus(repo,!0)}),0);else{if(null!=authOverride){if(\"object\"!=typeof authOverride)throw new Error(\"Only objects are supported for option databaseAuthVariableOverride\");try{Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(authOverride)}catch(e){throw new Error(\"Invalid authOverride provided: \"+e)}}repo.persistentConnection_=new PersistentConnection(repo.repoInfo_,appId,(function(pathString,data,isMerge,tag){repoOnDataUpdate(repo,pathString,data,isMerge,tag)}),(function(connectStatus){repoOnConnectStatus(repo,connectStatus)}),(function(updates){!function(repo,updates){each(updates,(function(key,value){repoUpdateInfo(repo,key,value)}))}(repo,updates)}),repo.authTokenProvider_,repo.appCheckProvider_,authOverride),repo.server_=repo.persistentConnection_}var creatorFunction,hashString;repo.authTokenProvider_.addTokenChangeListener((function(token){repo.server_.refreshAuthToken(token)})),repo.appCheckProvider_.addTokenChangeListener((function(result){repo.server_.refreshAppCheckToken(result.token)})),repo.statsReporter_=(creatorFunction=function(){return new StatsReporter(repo.stats_,repo.server_)},hashString=repo.repoInfo_.toString(),reporters[hashString]||(reporters[hashString]=creatorFunction()),reporters[hashString]),repo.infoData_=new SnapshotHolder,repo.infoSyncTree_=new SyncTree({startListening:function(query,tag,currentHashFn,onComplete){var infoEvents=[],node=repo.infoData_.getNode(query._path);return node.isEmpty()||(infoEvents=syncTreeApplyServerOverwrite(repo.infoSyncTree_,query._path,node),setTimeout((function(){onComplete(\"ok\")}),0)),infoEvents},stopListening:function(){}}),repoUpdateInfo(repo,\"connected\",!1),repo.serverSyncTree_=new SyncTree({startListening:function(query,tag,currentHashFn,onComplete){return repo.server_.listen(query,currentHashFn,tag,(function(status,data){var events=onComplete(status,data);eventQueueRaiseEventsForChangedPath(repo.eventQueue_,query._path,events)})),[]},stopListening:function(query,tag){repo.server_.unlisten(query,tag)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(FirebaseDatabase.prototype,\"_root\",{get:function(){return this._rootInternal||(this._rootInternal=new ReferenceImpl(this._repo,newEmptyPath())),this._rootInternal},enumerable:!1,configurable:!0}),FirebaseDatabase.prototype._delete=function(){var repo,appName,appRepos;return this._checkNotDeleted(\"delete\"),repo=this._repo,(appRepos=repos[appName=this.app.name])&&appRepos[repo.key]===repo||fatal(\"Database \"+appName+\"(\"+repo.repoInfo_+\") has already been deleted.\"),repoInterrupt(repo),delete appRepos[repo.key],this._repoInternal=null,this._rootInternal=null,Promise.resolve()},FirebaseDatabase.prototype._checkNotDeleted=function(apiName){null===this._rootInternal&&fatal(\"Cannot call \"+apiName+\" on a deleted database.\")},FirebaseDatabase}();function goOffline(db){(db=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(db))._checkNotDeleted(\"goOffline\"),repoInterrupt(db._repo)}function goOnline(db){var repo;(db=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(db))._checkNotDeleted(\"goOnline\"),(repo=db._repo).persistentConnection_&&repo.persistentConnection_.resume(\"repo_interrupt\")}var SERVER_TIMESTAMP={\".sv\":\"timestamp\"},TransactionResult=function(){function TransactionResult(committed,snapshot){this.committed=committed,this.snapshot=snapshot}return TransactionResult.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},TransactionResult}();function runTransaction(ref,transactionUpdate,options){var _a;if(ref=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(ref),validateWritablePath(\"Reference.transaction\",ref._path),\".length\"===ref.key||\".keys\"===ref.key)throw\"Reference.transaction failed: \"+ref.key+\" is a read-only object.\";var applyLocally=null===(_a=null==options?void 0:options.applyLocally)||void 0===_a||_a,deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred,unwatcher=onValue(ref,(function(){}));return function(repo,path,transactionUpdate,onComplete,unwatcher,applyLocally){repoLog(repo,\"transaction on \"+path);var transaction={path:path,update:transactionUpdate,onComplete:function(error,committed,node){var dataSnapshot=null;error?deferred.reject(error):(dataSnapshot=new DataSnapshot(node,new ReferenceImpl(ref._repo,ref._path),PRIORITY_INDEX),deferred.resolve(new TransactionResult(committed,dataSnapshot)))},status:null,order:LUIDGenerator(),applyLocally:applyLocally,retryCount:0,unwatcher:unwatcher,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},currentState=repoGetLatestState(repo,path,void 0);transaction.currentInputSnapshot=currentState;var newVal=transaction.update(currentState.val());if(void 0===newVal)transaction.unwatcher(),transaction.currentOutputSnapshotRaw=null,transaction.currentOutputSnapshotResolved=null,transaction.onComplete&&transaction.onComplete(null,!1,transaction.currentInputSnapshot);else{validateFirebaseData(\"transaction failed: Data returned \",newVal,transaction.path),transaction.status=0;var queueNode=treeSubTree(repo.transactionQueueTree_,path),nodeQueue=treeGetValue(queueNode)||[];nodeQueue.push(transaction),treeSetValue(queueNode,nodeQueue);var priorityForNode=void 0;\"object\"==typeof newVal&&null!==newVal&&Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.contains)(newVal,\".priority\")?(priorityForNode=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.safeGet)(newVal,\".priority\"),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.assert)(isValidPriority(priorityForNode),\"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.\")):priorityForNode=(syncTreeCalcCompleteEventCache(repo.serverSyncTree_,path)||ChildrenNode.EMPTY_NODE).getPriority().val();var serverValues=repoGenerateServerValues(repo),newNodeUnresolved=nodeFromJSON$1(newVal,priorityForNode),newNode=resolveDeferredValueSnapshot(newNodeUnresolved,currentState,serverValues);transaction.currentOutputSnapshotRaw=newNodeUnresolved,transaction.currentOutputSnapshotResolved=newNode,transaction.currentWriteId=repoGetNextWriteId(repo);var events=syncTreeApplyUserOverwrite(repo.serverSyncTree_,path,newNode,transaction.currentWriteId,transaction.applyLocally);eventQueueRaiseEventsForChangedPath(repo.eventQueue_,path,events),repoSendReadyTransactions(repo,repo.transactionQueueTree_)}}(ref._repo,ref._path,transactionUpdate,0,unwatcher,applyLocally),deferred.promise}var OnDisconnect$1=function(){function OnDisconnect(_delegate){this._delegate=_delegate}return OnDisconnect.prototype.cancel=function(onComplete){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"OnDisconnect.cancel\",0,1,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"OnDisconnect.cancel\",\"onComplete\",onComplete,!0);var result=this._delegate.cancel();return onComplete&&result.then((function(){return onComplete(null)}),(function(error){return onComplete(error)})),result},OnDisconnect.prototype.remove=function(onComplete){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"OnDisconnect.remove\",0,1,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"OnDisconnect.remove\",\"onComplete\",onComplete,!0);var result=this._delegate.remove();return onComplete&&result.then((function(){return onComplete(null)}),(function(error){return onComplete(error)})),result},OnDisconnect.prototype.set=function(value,onComplete){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"OnDisconnect.set\",1,2,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"OnDisconnect.set\",\"onComplete\",onComplete,!0);var result=this._delegate.set(value);return onComplete&&result.then((function(){return onComplete(null)}),(function(error){return onComplete(error)})),result},OnDisconnect.prototype.setWithPriority=function(value,priority,onComplete){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"OnDisconnect.setWithPriority\",2,3,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"OnDisconnect.setWithPriority\",\"onComplete\",onComplete,!0);var result=this._delegate.setWithPriority(value,priority);return onComplete&&result.then((function(){return onComplete(null)}),(function(error){return onComplete(error)})),result},OnDisconnect.prototype.update=function(objectToMerge,onComplete){if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"OnDisconnect.update\",1,2,arguments.length),Array.isArray(objectToMerge)){for(var newObjectToMerge={},i=0;i<objectToMerge.length;++i)newObjectToMerge[\"\"+i]=objectToMerge[i];objectToMerge=newObjectToMerge,warn(\"Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.\")}Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"OnDisconnect.update\",\"onComplete\",onComplete,!0);var result=this._delegate.update(objectToMerge);return onComplete&&result.then((function(){return onComplete(null)}),(function(error){return onComplete(error)})),result},OnDisconnect}(),TransactionResult$1=function(){function TransactionResult(committed,snapshot){this.committed=committed,this.snapshot=snapshot}return TransactionResult.prototype.toJSON=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"TransactionResult.toJSON\",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},TransactionResult}(),DataSnapshot$1=function(){function DataSnapshot(_database,_delegate){this._database=_database,this._delegate=_delegate}return DataSnapshot.prototype.val=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.val\",0,0,arguments.length),this._delegate.val()},DataSnapshot.prototype.exportVal=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.exportVal\",0,0,arguments.length),this._delegate.exportVal()},DataSnapshot.prototype.toJSON=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.toJSON\",0,1,arguments.length),this._delegate.toJSON()},DataSnapshot.prototype.exists=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.exists\",0,0,arguments.length),this._delegate.exists()},DataSnapshot.prototype.child=function(path){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.child\",0,1,arguments.length),path=String(path),validatePathString(\"DataSnapshot.child\",\"path\",path,!1),new DataSnapshot(this._database,this._delegate.child(path))},DataSnapshot.prototype.hasChild=function(path){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.hasChild\",1,1,arguments.length),validatePathString(\"DataSnapshot.hasChild\",\"path\",path,!1),this._delegate.hasChild(path)},DataSnapshot.prototype.getPriority=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.getPriority\",0,0,arguments.length),this._delegate.priority},DataSnapshot.prototype.forEach=function(action){var _this=this;return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.forEach\",1,1,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"DataSnapshot.forEach\",\"action\",action,!1),this._delegate.forEach((function(expDataSnapshot){return action(new DataSnapshot(_this._database,expDataSnapshot))}))},DataSnapshot.prototype.hasChildren=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.hasChildren\",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(DataSnapshot.prototype,\"key\",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),DataSnapshot.prototype.numChildren=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.numChildren\",0,0,arguments.length),this._delegate.size},DataSnapshot.prototype.getRef=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"DataSnapshot.ref\",0,0,arguments.length),new Reference(this._database,this._delegate.ref)},Object.defineProperty(DataSnapshot.prototype,\"ref\",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),DataSnapshot}(),Query=function(){function Query(database,_delegate){this.database=database,this._delegate=_delegate}return Query.prototype.on=function(eventType,callback,cancelCallbackOrContext,context){var _a,_this=this;Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.on\",2,4,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Query.on\",\"callback\",callback,!1);var ret=Query.getCancelAndContextArgs_(\"Query.on\",cancelCallbackOrContext,context),valueCallback=function(expSnapshot,previousChildName){callback.call(ret.context,new DataSnapshot$1(_this.database,expSnapshot),previousChildName)};valueCallback.userCallback=callback,valueCallback.context=ret.context;var cancelCallback=null===(_a=ret.cancel)||void 0===_a?void 0:_a.bind(ret.context);switch(eventType){case\"value\":return onValue(this._delegate,valueCallback,cancelCallback),callback;case\"child_added\":return onChildAdded(this._delegate,valueCallback,cancelCallback),callback;case\"child_removed\":return onChildRemoved(this._delegate,valueCallback,cancelCallback),callback;case\"child_changed\":return onChildChanged(this._delegate,valueCallback,cancelCallback),callback;case\"child_moved\":return onChildMoved(this._delegate,valueCallback,cancelCallback),callback;default:throw new Error(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(\"Query.on\",\"eventType\")+'must be a valid event type = \"value\", \"child_added\", \"child_removed\", \"child_changed\", or \"child_moved\".')}},Query.prototype.off=function(eventType,callback,context){if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.off\",0,3,arguments.length),validateEventType(\"Query.off\",eventType,!0),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Query.off\",\"callback\",callback,!0),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateContextObject)(\"Query.off\",\"context\",context,!0),callback){var valueCallback=function(){};valueCallback.userCallback=callback,valueCallback.context=context,off(this._delegate,eventType,valueCallback)}else off(this._delegate,eventType)},Query.prototype.get=function(){var _this=this;return function(query){return function(repo,query){var cached=function(syncTree,query){var path=query._path,serverCache=null;syncTree.syncPointTree_.foreachOnPath(path,(function(pathToSyncPoint,sp){var relativePath=newRelativePath(pathToSyncPoint,path);serverCache=serverCache||syncPointGetCompleteServerCache(sp,relativePath)}));var syncPoint=syncTree.syncPointTree_.get(path);syncPoint?serverCache=serverCache||syncPointGetCompleteServerCache(syncPoint,newEmptyPath()):(syncPoint=new SyncPoint,syncTree.syncPointTree_=syncTree.syncPointTree_.set(path,syncPoint));var serverCacheComplete=null!=serverCache,serverCacheNode=serverCacheComplete?new CacheNode(serverCache,!0,!1):null;return viewCacheGetCompleteEventSnap(syncPointGetView(syncPoint,query,writeTreeChildWrites(syncTree.pendingWriteTree_,query._path),serverCacheComplete?serverCacheNode.getNode():ChildrenNode.EMPTY_NODE,serverCacheComplete).viewCache_)}(repo.serverSyncTree_,query);return null!=cached?Promise.resolve(cached):repo.server_.get(query).then((function(payload){var node=nodeFromJSON$1(payload),events=syncTreeApplyServerOverwrite(repo.serverSyncTree_,query._path,node);return eventQueueRaiseEventsAtPath(repo.eventQueue_,query._path,events),Promise.resolve(node)}),(function(err){return repoLog(repo,\"get for query \"+Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.stringify)(query)+\" failed: \"+err),Promise.reject(new Error(err))}))}((query=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(query))._repo,query).then((function(node){return new DataSnapshot(node,new ReferenceImpl(query._repo,query._path),query._queryParams.getIndex())}))}(this._delegate).then((function(expSnapshot){return new DataSnapshot$1(_this.database,expSnapshot)}))},Query.prototype.once=function(eventType,callback,failureCallbackOrContext,context){var _this=this;Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.once\",1,4,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Query.once\",\"callback\",callback,!0);var ret=Query.getCancelAndContextArgs_(\"Query.once\",failureCallbackOrContext,context),deferred=new _firebase_util__WEBPACK_IMPORTED_MODULE_2__.Deferred,valueCallback=function(expSnapshot,previousChildName){var result=new DataSnapshot$1(_this.database,expSnapshot);callback&&callback.call(ret.context,result,previousChildName),deferred.resolve(result)};valueCallback.userCallback=callback,valueCallback.context=ret.context;var cancelCallback=function(error){ret.cancel&&ret.cancel.call(ret.context,error),deferred.reject(error)};switch(eventType){case\"value\":onValue(this._delegate,valueCallback,cancelCallback,{onlyOnce:!0});break;case\"child_added\":onChildAdded(this._delegate,valueCallback,cancelCallback,{onlyOnce:!0});break;case\"child_removed\":onChildRemoved(this._delegate,valueCallback,cancelCallback,{onlyOnce:!0});break;case\"child_changed\":onChildChanged(this._delegate,valueCallback,cancelCallback,{onlyOnce:!0});break;case\"child_moved\":onChildMoved(this._delegate,valueCallback,cancelCallback,{onlyOnce:!0});break;default:throw new Error(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(\"Query.once\",\"eventType\")+'must be a valid event type = \"value\", \"child_added\", \"child_removed\", \"child_changed\", or \"child_moved\".')}return deferred.promise},Query.prototype.limitToFirst=function(limit){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.limitToFirst\",1,1,arguments.length),new Query(this.database,query(this._delegate,limitToFirst(limit)))},Query.prototype.limitToLast=function(limit){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.limitToLast\",1,1,arguments.length),new Query(this.database,query(this._delegate,limitToLast(limit)))},Query.prototype.orderByChild=function(path){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.orderByChild\",1,1,arguments.length),new Query(this.database,query(this._delegate,orderByChild(path)))},Query.prototype.orderByKey=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.orderByKey\",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByKey()))},Query.prototype.orderByPriority=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.orderByPriority\",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByPriority()))},Query.prototype.orderByValue=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.orderByValue\",0,0,arguments.length),new Query(this.database,query(this._delegate,orderByValue()))},Query.prototype.startAt=function(value,name){return void 0===value&&(value=null),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.startAt\",0,2,arguments.length),new Query(this.database,query(this._delegate,startAt(value,name)))},Query.prototype.startAfter=function(value,name){return void 0===value&&(value=null),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.startAfter\",0,2,arguments.length),new Query(this.database,query(this._delegate,startAfter(value,name)))},Query.prototype.endAt=function(value,name){return void 0===value&&(value=null),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.endAt\",0,2,arguments.length),new Query(this.database,query(this._delegate,endAt(value,name)))},Query.prototype.endBefore=function(value,name){return void 0===value&&(value=null),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.endBefore\",0,2,arguments.length),new Query(this.database,query(this._delegate,endBefore(value,name)))},Query.prototype.equalTo=function(value,name){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.equalTo\",1,2,arguments.length),new Query(this.database,query(this._delegate,equalTo(value,name)))},Query.prototype.toString=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.toString\",0,0,arguments.length),this._delegate.toString()},Query.prototype.toJSON=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.toJSON\",0,1,arguments.length),this._delegate.toJSON()},Query.prototype.isEqual=function(other){if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Query.isEqual\",1,1,arguments.length),!(other instanceof Query)){var error=\"Query.isEqual failed: First argument must be an instance of firebase.database.Query.\";throw new Error(error)}return this._delegate.isEqual(other._delegate)},Query.getCancelAndContextArgs_=function(fnName,cancelOrContext,context){var ret={cancel:void 0,context:void 0};if(cancelOrContext&&context)ret.cancel=cancelOrContext,Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(fnName,\"cancel\",ret.cancel,!0),ret.context=context,Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateContextObject)(fnName,\"context\",ret.context,!0);else if(cancelOrContext)if(\"object\"==typeof cancelOrContext&&null!==cancelOrContext)ret.context=cancelOrContext;else{if(\"function\"!=typeof cancelOrContext)throw new Error(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.errorPrefix)(fnName,\"cancelOrContext\")+\" must either be a cancel callback or a context object.\");ret.cancel=cancelOrContext}return ret},Object.defineProperty(Query.prototype,\"ref\",{get:function(){return new Reference(this.database,new ReferenceImpl(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),Query}(),Reference=function(_super){function Reference(database,_delegate){var _this=_super.call(this,database,new QueryImpl(_delegate._repo,_delegate._path,new QueryParams,!1))||this;return _this.database=database,_this._delegate=_delegate,_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(Reference,_super),Reference.prototype.getKey=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.key\",0,0,arguments.length),this._delegate.key},Reference.prototype.child=function(pathString){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.child\",1,1,arguments.length),\"number\"==typeof pathString&&(pathString=String(pathString)),new Reference(this.database,child(this._delegate,pathString))},Reference.prototype.getParent=function(){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.parent\",0,0,arguments.length);var parent=this._delegate.parent;return parent?new Reference(this.database,parent):null},Reference.prototype.getRoot=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.root\",0,0,arguments.length),new Reference(this.database,this._delegate.root)},Reference.prototype.set=function(newVal,onComplete){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.set\",1,2,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Reference.set\",\"onComplete\",onComplete,!0);var result=set(this._delegate,newVal);return onComplete&&result.then((function(){return onComplete(null)}),(function(error){return onComplete(error)})),result},Reference.prototype.update=function(values,onComplete){if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.update\",1,2,arguments.length),Array.isArray(values)){for(var newObjectToMerge={},i=0;i<values.length;++i)newObjectToMerge[\"\"+i]=values[i];values=newObjectToMerge,warn(\"Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.\")}validateWritablePath(\"Reference.update\",this._delegate._path),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Reference.update\",\"onComplete\",onComplete,!0);var result=update(this._delegate,values);return onComplete&&result.then((function(){return onComplete(null)}),(function(error){return onComplete(error)})),result},Reference.prototype.setWithPriority=function(newVal,newPriority,onComplete){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.setWithPriority\",2,3,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Reference.setWithPriority\",\"onComplete\",onComplete,!0);var result=setWithPriority(this._delegate,newVal,newPriority);return onComplete&&result.then((function(){return onComplete(null)}),(function(error){return onComplete(error)})),result},Reference.prototype.remove=function(onComplete){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.remove\",0,1,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Reference.remove\",\"onComplete\",onComplete,!0);var result=remove(this._delegate);return onComplete&&result.then((function(){return onComplete(null)}),(function(error){return onComplete(error)})),result},Reference.prototype.transaction=function(transactionUpdate,onComplete,applyLocally){var _this=this;Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.transaction\",1,3,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Reference.transaction\",\"transactionUpdate\",transactionUpdate,!1),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Reference.transaction\",\"onComplete\",onComplete,!0),validateBoolean(\"Reference.transaction\",\"applyLocally\",applyLocally,!0);var result=runTransaction(this._delegate,transactionUpdate,{applyLocally:applyLocally}).then((function(transactionResult){return new TransactionResult$1(transactionResult.committed,new DataSnapshot$1(_this.database,transactionResult.snapshot))}));return onComplete&&result.then((function(transactionResult){return onComplete(null,transactionResult.committed,transactionResult.snapshot)}),(function(error){return onComplete(error,!1,null)})),result},Reference.prototype.setPriority=function(priority,onComplete){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.setPriority\",1,2,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Reference.setPriority\",\"onComplete\",onComplete,!0);var result=setPriority(this._delegate,priority);return onComplete&&result.then((function(){return onComplete(null)}),(function(error){return onComplete(error)})),result},Reference.prototype.push=function(value,onComplete){var _this=this;Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"Reference.push\",0,2,arguments.length),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateCallback)(\"Reference.push\",\"onComplete\",onComplete,!0);var expPromise=push(this._delegate,value),promise=expPromise.then((function(expRef){return new Reference(_this.database,expRef)}));onComplete&&promise.then((function(){return onComplete(null)}),(function(error){return onComplete(error)}));var result=new Reference(this.database,expPromise);return result.then=promise.then.bind(promise),result.catch=promise.catch.bind(promise,void 0),result},Reference.prototype.onDisconnect=function(){return validateWritablePath(\"Reference.onDisconnect\",this._delegate._path),new OnDisconnect$1(new OnDisconnect(this._delegate._repo,this._delegate._path))},Object.defineProperty(Reference.prototype,\"key\",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(Reference.prototype,\"parent\",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(Reference.prototype,\"root\",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),Reference}(Query),Database=function(){function Database(_delegate,app){var _this=this;this._delegate=_delegate,this.app=app,this.INTERNAL={delete:function(){return _this._delegate._delete()}}}return Database.prototype.useEmulator=function(host,port,options){void 0===options&&(options={}),function(db,host,port,options){void 0===options&&(options={}),(db=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.getModularInstance)(db))._checkNotDeleted(\"useEmulator\"),db._instanceStarted&&fatal(\"Cannot call useEmulator() after instance has already been initialized.\");var repo=db._repoInternal,tokenProvider=void 0;if(repo.repoInfo_.nodeAdmin)options.mockUserToken&&fatal('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the \"firebase\" package instead of \"firebase-admin\".'),tokenProvider=new EmulatorTokenProvider(EmulatorTokenProvider.OWNER);else if(options.mockUserToken){var token=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.createMockUserToken)(options.mockUserToken,db.app.options.projectId);tokenProvider=new EmulatorTokenProvider(token)}!function(repo,host,port,tokenProvider){repo.repoInfo_=new RepoInfo(host+\":\"+port,!1,repo.repoInfo_.namespace,repo.repoInfo_.webSocketOnly,repo.repoInfo_.nodeAdmin,repo.repoInfo_.persistenceKey,repo.repoInfo_.includeNamespaceInQueryParams),tokenProvider&&(repo.authTokenProvider_=tokenProvider)}(repo,host,port,tokenProvider)}(this._delegate,host,port,options)},Database.prototype.ref=function(path){if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"database.ref\",0,1,arguments.length),path instanceof Reference){var childRef=refFromURL(this._delegate,path.toString());return new Reference(this,childRef)}return childRef=ref(this._delegate,path),new Reference(this,childRef)},Database.prototype.refFromURL=function(url){var apiName=\"database.refFromURL\";Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(apiName,1,1,arguments.length);var childRef=refFromURL(this._delegate,url);return new Reference(this,childRef)},Database.prototype.goOffline=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"database.goOffline\",0,0,arguments.length),goOffline(this._delegate)},Database.prototype.goOnline=function(){return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.validateArgCount)(\"database.goOnline\",0,0,arguments.length),goOnline(this._delegate)},Database.ServerValue={TIMESTAMP:SERVER_TIMESTAMP,increment:function(delta){return function(delta){return{\".sv\":{increment:delta}}}(delta)}},Database}(),INTERNAL=Object.freeze({__proto__:null,forceLongPolling:function(){WebSocketConnection.forceDisallow(),BrowserPollConnection.forceAllow()},forceWebSockets:function(){BrowserPollConnection.forceDisallow()},isWebSocketsAvailable:function(){return WebSocketConnection.isAvailable()},setSecurityDebugCallback:function(ref,callback){ref._delegate._repo.persistentConnection_.securityDebugCallback_=callback},stats:function(ref,showDelta){!function(repo,showDelta){if(void 0===showDelta&&(showDelta=!1),\"undefined\"!=typeof console){var stats;showDelta?(repo.statsListener_||(repo.statsListener_=new StatsListener(repo.stats_)),stats=repo.statsListener_.get()):stats=repo.stats_.get();var longestName=Object.keys(stats).reduce((function(previousValue,currentValue){return Math.max(currentValue.length,previousValue)}),0);each(stats,(function(stat,value){for(var paddedStat=stat,i=stat.length;i<longestName+2;i++)paddedStat+=\" \";console.log(paddedStat+value)}))}}(ref._delegate._repo,showDelta)},statsIncrementCounter:function(ref,metric){!function(repo,metric){repo.stats_.incrementCounter(metric),repo.statsReporter_.statsToReport_[metric]=!0}(ref._delegate._repo,metric)},dataUpdateCount:function(ref){return ref._delegate._repo.dataUpdateCount},interceptServerData:function(ref,callback){return function(repo,callback){repo.interceptServerDataCallback_=callback}(ref._delegate._repo,callback)},initStandalone:function(_a){var app=_a.app,url=_a.url,customAuthImpl=_a.customAuthImpl,namespace=_a.namespace,_b=_a.nodeAdmin,nodeAdmin=void 0!==_b&&_b;setSDKVersion(_a.version);var authProvider=new _firebase_component__WEBPACK_IMPORTED_MODULE_1__.Provider(\"auth-internal\",new _firebase_component__WEBPACK_IMPORTED_MODULE_1__.ComponentContainer(\"database-standalone\"));return authProvider.setComponent(new _firebase_component__WEBPACK_IMPORTED_MODULE_1__.Component(\"auth-internal\",(function(){return customAuthImpl}),\"PRIVATE\")),{instance:new Database(repoManagerDatabaseFromApp(app,authProvider,void 0,url,nodeAdmin),app),namespace:namespace}}}),DataConnection=PersistentConnection;PersistentConnection.prototype.simpleListen=function(pathString,onComplete){this.sendRequest(\"q\",{p:pathString},onComplete)},PersistentConnection.prototype.echo=function(data,onEcho){this.sendRequest(\"echo\",{d:data},onEcho)};var TEST_ACCESS=Object.freeze({__proto__:null,DataConnection:DataConnection,RealTimeConnection:Connection,hijackHash:function(newHash){var oldPut=PersistentConnection.prototype.put;return PersistentConnection.prototype.put=function(pathString,data,onComplete,hash){void 0!==hash&&(hash=newHash()),oldPut.call(this,pathString,data,onComplete,hash)},function(){PersistentConnection.prototype.put=oldPut}},ConnectionTarget:RepoInfo,queryIdentifier:function(query){return query._delegate._queryIdentifier},forceRestClient:function(forceRestClient){!function(forceRestClient){useRestClient=forceRestClient}(forceRestClient)}}),ServerValue=Database.ServerValue;!function(instance){setSDKVersion(instance.SDK_VERSION);var namespace=instance.INTERNAL.registerComponent(new _firebase_component__WEBPACK_IMPORTED_MODULE_1__.Component(\"database\",(function(container,_a){var url=_a.instanceIdentifier,app=container.getProvider(\"app\").getImmediate(),authProvider=container.getProvider(\"auth-internal\"),appCheckProvider=container.getProvider(\"app-check-internal\");return new Database(repoManagerDatabaseFromApp(app,authProvider,appCheckProvider,url),app)}),\"PUBLIC\").setServiceProps({Reference:Reference,Query:Query,Database:Database,DataSnapshot:DataSnapshot$1,enableLogging:enableLogging,INTERNAL:INTERNAL,ServerValue:ServerValue,TEST_ACCESS:TEST_ACCESS}).setMultipleInstances(!0));instance.registerVersion(\"@firebase/database\",\"0.10.1\"),Object(_firebase_util__WEBPACK_IMPORTED_MODULE_2__.isNodeSdk)()&&(module.exports=namespace)}(_firebase_app__WEBPACK_IMPORTED_MODULE_0__.default)}).call(this,__webpack_require__(\"3UD+\")(module))},\"X8/r\":function(module,exports,__webpack_require__){\"use strict\";var firebase=__webpack_require__(\"zIRd\"),component=__webpack_require__(\"/6Yf\"),tslib=__webpack_require__(\"mrSG\"),util=__webpack_require__(\"qOnz\"),logger$1=__webpack_require__(\"q/0M\");function _interopDefaultLegacy(e){return e&&\"object\"==typeof e&&\"default\"in e?e:{default:e}}var _a,firebase__default=_interopDefaultLegacy(firebase),ERRORS=((_a={})[\"already-activated\"]=\"You are trying to activate AppCheck for FirebaseApp {$appName}, while it is already activated. AppCheck can only be activated once.\",_a[\"use-before-activation\"]=\"AppCheck is being used before activate() is called for FirebaseApp {$appName}. Please make sure you call activate() before instantiating other Firebase services.\",_a[\"fetch-network-error\"]=\"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.\",_a[\"fetch-parse-error\"]=\"Fetch client could not parse response. Original error: {$originalErrorMessage}.\",_a[\"fetch-status-error\"]=\"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.\",_a[\"storage-open\"]=\"Error thrown when opening storage. Original error: {$originalErrorMessage}.\",_a[\"storage-get\"]=\"Error thrown when reading from storage. Original error: {$originalErrorMessage}.\",_a[\"storage-set\"]=\"Error thrown when writing to storage. Original error: {$originalErrorMessage}.\",_a[\"recaptcha-error\"]=\"ReCAPTCHA error.\",_a),ERROR_FACTORY=new util.ErrorFactory(\"appCheck\",\"AppCheck\",ERRORS),APP_CHECK_STATES=new Map,DEFAULT_STATE={activated:!1,tokenListeners:[]},DEBUG_STATE={enabled:!1};function getState(app){return APP_CHECK_STATES.get(app)||DEFAULT_STATE}function setState(app,state){APP_CHECK_STATES.set(app,state)}function getDebugState(){return DEBUG_STATE}function getRecaptcha(){return self.grecaptcha}function ensureActivated(app){if(!getState(app).activated)throw ERROR_FACTORY.create(\"use-before-activation\",{appName:app.name})}function getToken(app){return tslib.__awaiter(this,void 0,void 0,(function(){var recaptcha;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return ensureActivated(app),[4,getState(app).reCAPTCHAState.initialized.promise];case 1:return recaptcha=_a.sent(),[2,new Promise((function(resolve,_reject){var reCAPTCHAState=getState(app).reCAPTCHAState;recaptcha.ready((function(){resolve(recaptcha.execute(reCAPTCHAState.widgetId,{action:\"fire_app_check\"}))}))}))]}}))}))}function renderInvisibleWidget(app,siteKey,grecaptcha,container){var widgetId=grecaptcha.render(container,{sitekey:siteKey,size:\"invisible\"}),state=getState(app);setState(app,tslib.__assign(tslib.__assign({},state),{reCAPTCHAState:tslib.__assign(tslib.__assign({},state.reCAPTCHAState),{widgetId:widgetId})}))}var BASE_ENDPOINT=\"https://content-firebaseappcheck.googleapis.com/v1beta\",Refresher=function(){function Refresher(operation,retryPolicy,getWaitDuration,lowerBound,upperBound){if(this.operation=operation,this.retryPolicy=retryPolicy,this.getWaitDuration=getWaitDuration,this.lowerBound=lowerBound,this.upperBound=upperBound,this.pending=null,this.nextErrorWaitInterval=lowerBound,lowerBound>upperBound)throw new Error(\"Proactive refresh lower bound greater than upper bound!\")}return Refresher.prototype.start=function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((function(){}))},Refresher.prototype.stop=function(){this.pending&&(this.pending.reject(\"cancelled\"),this.pending=null)},Refresher.prototype.isRunning=function(){return!!this.pending},Refresher.prototype.process=function(hasSucceeded){return tslib.__awaiter(this,void 0,void 0,(function(){var error_1;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:this.stop(),_a.label=1;case 1:return _a.trys.push([1,6,,7]),this.pending=new util.Deferred,[4,(ms=this.getNextRun(hasSucceeded),new Promise((function(resolve){setTimeout(resolve,ms)})))];case 2:return _a.sent(),this.pending.resolve(),[4,this.pending.promise];case 3:return _a.sent(),this.pending=new util.Deferred,[4,this.operation()];case 4:return _a.sent(),this.pending.resolve(),[4,this.pending.promise];case 5:return _a.sent(),this.process(!0).catch((function(){})),[3,7];case 6:return error_1=_a.sent(),this.retryPolicy(error_1)?this.process(!1).catch((function(){})):this.stop(),[3,7];case 7:return[2]}var ms}))}))},Refresher.prototype.getNextRun=function(hasSucceeded){if(hasSucceeded)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var currentErrorWaitInterval=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),currentErrorWaitInterval},Refresher}();function exchangeToken(_a,platformLoggerProvider){var url=_a.url,body=_a.body;return tslib.__awaiter(this,void 0,void 0,(function(){var headers,platformLogger,options,response,originalError_1,responseBody,originalError_2,match,timeToLiveAsNumber,now;return tslib.__generator(this,(function(_b){switch(_b.label){case 0:headers={\"Content-Type\":\"application/json\"},(platformLogger=platformLoggerProvider.getImmediate({optional:!0}))&&(headers[\"X-Firebase-Client\"]=platformLogger.getPlatformInfoString()),options={method:\"POST\",body:JSON.stringify(body),headers:headers},_b.label=1;case 1:return _b.trys.push([1,3,,4]),[4,fetch(url,options)];case 2:return response=_b.sent(),[3,4];case 3:throw originalError_1=_b.sent(),ERROR_FACTORY.create(\"fetch-network-error\",{originalErrorMessage:originalError_1.message});case 4:if(200!==response.status)throw ERROR_FACTORY.create(\"fetch-status-error\",{httpStatus:response.status});_b.label=5;case 5:return _b.trys.push([5,7,,8]),[4,response.json()];case 6:return responseBody=_b.sent(),[3,8];case 7:throw originalError_2=_b.sent(),ERROR_FACTORY.create(\"fetch-parse-error\",{originalErrorMessage:originalError_2.message});case 8:if(!(match=responseBody.ttl.match(/^([\\d.]+)(s)$/))||!match[2]||isNaN(Number(match[1])))throw ERROR_FACTORY.create(\"fetch-parse-error\",{originalErrorMessage:\"ttl field (timeToLive) is not in standard Protobuf Duration format: \"+responseBody.ttl});return timeToLiveAsNumber=1e3*Number(match[1]),now=Date.now(),[2,{token:responseBody.attestationToken,expireTimeMillis:now+timeToLiveAsNumber,issuedAtTimeMillis:now}]}}))}))}function getExchangeRecaptchaTokenRequest(app,reCAPTCHAToken){var _a=app.options;return{url:BASE_ENDPOINT+\"/projects/\"+_a.projectId+\"/apps/\"+_a.appId+\":exchangeRecaptchaToken?key=\"+_a.apiKey,body:{recaptcha_token:reCAPTCHAToken}}}function getExchangeDebugTokenRequest(app,debugToken){var _a=app.options;return{url:BASE_ENDPOINT+\"/projects/\"+_a.projectId+\"/apps/\"+_a.appId+\":exchangeDebugToken?key=\"+_a.apiKey,body:{debug_token:debugToken}}}var STORE_NAME=\"firebase-app-check-store\",dbPromise=null;function getDBPromise(){return dbPromise||(dbPromise=new Promise((function(resolve,reject){try{var request=indexedDB.open(\"firebase-app-check-database\",1);request.onsuccess=function(event){resolve(event.target.result)},request.onerror=function(event){var _a;reject(ERROR_FACTORY.create(\"storage-open\",{originalErrorMessage:null===(_a=event.target.error)||void 0===_a?void 0:_a.message}))},request.onupgradeneeded=function(event){var db=event.target.result;switch(event.oldVersion){case 0:db.createObjectStore(STORE_NAME,{keyPath:\"compositeKey\"})}}}catch(e){reject(ERROR_FACTORY.create(\"storage-open\",{originalErrorMessage:e.message}))}})))}function readTokenFromIndexedDB(app){return read(computeKey(app))}function write(key,value){return tslib.__awaiter(this,void 0,void 0,(function(){var db,transaction,store,request;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,getDBPromise()];case 1:return db=_a.sent(),transaction=db.transaction(STORE_NAME,\"readwrite\"),store=transaction.objectStore(STORE_NAME),request=store.put({compositeKey:key,value:value}),[2,new Promise((function(resolve,reject){request.onsuccess=function(_event){resolve()},transaction.onerror=function(event){var _a;reject(ERROR_FACTORY.create(\"storage-set\",{originalErrorMessage:null===(_a=event.target.error)||void 0===_a?void 0:_a.message}))}}))]}}))}))}function read(key){return tslib.__awaiter(this,void 0,void 0,(function(){var db,transaction,store,request;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return[4,getDBPromise()];case 1:return db=_a.sent(),transaction=db.transaction(STORE_NAME,\"readonly\"),store=transaction.objectStore(STORE_NAME),request=store.get(key),[2,new Promise((function(resolve,reject){request.onsuccess=function(event){var result=event.target.result;resolve(result?result.value:void 0)},transaction.onerror=function(event){var _a;reject(ERROR_FACTORY.create(\"storage-get\",{originalErrorMessage:null===(_a=event.target.error)||void 0===_a?void 0:_a.message}))}}))]}}))}))}function computeKey(app){return app.options.appId+\"-\"+app.name}var logger=new logger$1.Logger(\"@firebase/app-check\");function readTokenFromStorage(app){return tslib.__awaiter(this,void 0,void 0,(function(){var token,e_1;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:if(!util.isIndexedDBAvailable())return[3,5];token=void 0,_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,readTokenFromIndexedDB(app)];case 2:return token=_a.sent(),[3,4];case 3:return e_1=_a.sent(),logger.warn(\"Failed to read token from indexeddb. Error: \"+e_1),[3,4];case 4:return[2,token];case 5:return[2,void 0]}}))}))}function writeTokenToStorage(app,token){return util.isIndexedDBAvailable()?function(app,token){return write(computeKey(app),token)}(app,token).catch((function(e){logger.warn(\"Failed to write token to indexeddb. Error: \"+e)})):Promise.resolve()}function isDebugMode(){return getDebugState().enabled}function getDebugToken(){return tslib.__awaiter(this,void 0,void 0,(function(){var state;return tslib.__generator(this,(function(_a){if((state=getDebugState()).enabled&&state.token)return[2,state.token.promise];throw Error(\"\\n            Can't get debug token in production mode.\\n        \")}))}))}var defaultTokenErrorData={error:\"UNKNOWN_ERROR\"};function getToken$1(app,platformLoggerProvider,forceRefresh){return void 0===forceRefresh&&(forceRefresh=!1),tslib.__awaiter(this,void 0,void 0,(function(){var _a,_b,_c,state,token,error,cachedToken,customToken,issuedAtTimeSeconds,issuedAtTimeMillis,attestedClaimsToken,e_1,interopTokenResult;return tslib.__generator(this,(function(_d){switch(_d.label){case 0:return ensureActivated(app),isDebugMode()?(_a=exchangeToken,_b=getExchangeDebugTokenRequest,_c=[app],[4,getDebugToken()]):[3,3];case 1:return[4,_a.apply(void 0,[_b.apply(void 0,_c.concat([_d.sent()])),platformLoggerProvider])];case 2:return[2,{token:_d.sent().token}];case 3:return state=getState(app),error=void 0,(token=state.token)?[3,5]:[4,readTokenFromStorage(app)];case 4:(cachedToken=_d.sent())&&isValid(cachedToken)&&(token=cachedToken,setState(app,tslib.__assign(tslib.__assign({},state),{token:token})),notifyTokenListeners(app,{token:token.token})),_d.label=5;case 5:if(!forceRefresh&&token&&isValid(token))return[2,{token:token.token}];_d.label=6;case 6:return _d.trys.push([6,12,,13]),state.customProvider?[4,state.customProvider.getToken()]:[3,8];case 7:return customToken=_d.sent(),issuedAtTimeSeconds=util.issuedAtTime(customToken.token),issuedAtTimeMillis=null!==issuedAtTimeSeconds&&issuedAtTimeSeconds<Date.now()&&issuedAtTimeSeconds>0?1e3*issuedAtTimeSeconds:Date.now(),token=tslib.__assign(tslib.__assign({},customToken),{issuedAtTimeMillis:issuedAtTimeMillis}),[3,11];case 8:return[4,getToken(app).catch((function(_e){throw ERROR_FACTORY.create(\"recaptcha-error\")}))];case 9:return attestedClaimsToken=_d.sent(),[4,exchangeToken(getExchangeRecaptchaTokenRequest(app,attestedClaimsToken),platformLoggerProvider)];case 10:token=_d.sent(),_d.label=11;case 11:return[3,13];case 12:return e_1=_d.sent(),logger.error(e_1),error=e_1,[3,13];case 13:return token?[3,14]:(interopTokenResult=function(error){return{token:(tokenErrorData=defaultTokenErrorData,util.base64.encodeString(JSON.stringify(tokenErrorData),!1)),error:error};var tokenErrorData}(error),[3,16]);case 14:return interopTokenResult={token:token.token},setState(app,tslib.__assign(tslib.__assign({},state),{token:token})),[4,writeTokenToStorage(app,token)];case 15:_d.sent(),_d.label=16;case 16:return notifyTokenListeners(app,interopTokenResult),[2,interopTokenResult]}}))}))}function notifyTokenListeners(app,token){for(var _i=0,listeners_1=getState(app).tokenListeners;_i<listeners_1.length;_i++){var listener=listeners_1[_i];try{listener(token)}catch(e){}}}function isValid(token){return token.expireTimeMillis-Date.now()>0}!function(firebase){firebase.INTERNAL.registerComponent(new component.Component(\"appCheck\",(function(container){return app=container.getProvider(\"app\").getImmediate(),{activate:function(siteKeyOrProvider,isTokenAutoRefreshEnabled){return function(app,siteKeyOrProvider,isTokenAutoRefreshEnabled){var state=getState(app);if(state.activated)throw ERROR_FACTORY.create(\"already-activated\",{appName:app.name});var newState=tslib.__assign(tslib.__assign({},state),{activated:!0});\"string\"==typeof siteKeyOrProvider?newState.siteKey=siteKeyOrProvider:newState.customProvider=siteKeyOrProvider,newState.isTokenAutoRefreshEnabled=void 0===isTokenAutoRefreshEnabled?app.automaticDataCollectionEnabled:isTokenAutoRefreshEnabled,setState(app,newState),newState.siteKey&&function(app,siteKey){var state=getState(app),initialized=new util.Deferred;setState(app,tslib.__assign(tslib.__assign({},state),{reCAPTCHAState:{initialized:initialized}}));var divId=\"fire_app_check_\"+app.name,invisibleDiv=document.createElement(\"div\");invisibleDiv.id=divId,invisibleDiv.style.display=\"none\",document.body.appendChild(invisibleDiv);var onload,script,grecaptcha=getRecaptcha();return grecaptcha?grecaptcha.ready((function(){renderInvisibleWidget(app,siteKey,grecaptcha,divId),initialized.resolve(grecaptcha)})):(onload=function(){var grecaptcha=getRecaptcha();if(!grecaptcha)throw new Error(\"no recaptcha\");grecaptcha.ready((function(){renderInvisibleWidget(app,siteKey,grecaptcha,divId),initialized.resolve(grecaptcha)}))},(script=document.createElement(\"script\")).src=\"https://www.google.com/recaptcha/api.js\",script.onload=onload,document.head.appendChild(script)),initialized.promise}(app,newState.siteKey).catch((function(){}))}(app,siteKeyOrProvider,isTokenAutoRefreshEnabled)},setTokenAutoRefreshEnabled:function(isTokenAutoRefreshEnabled){return function(app,isTokenAutoRefreshEnabled){var state=getState(app);state.tokenRefresher&&(!0===isTokenAutoRefreshEnabled?state.tokenRefresher.start():state.tokenRefresher.stop()),setState(app,tslib.__assign(tslib.__assign({},state),{isTokenAutoRefreshEnabled:isTokenAutoRefreshEnabled}))}(app,isTokenAutoRefreshEnabled)}};var app}),\"PUBLIC\").setInstantiationMode(\"EXPLICIT\").setInstanceCreatedCallback((function(container,_instanceIdentifier,_instance){container.getProvider(\"app-check-internal\").initialize()}))),firebase.INTERNAL.registerComponent(new component.Component(\"app-check-internal\",(function(container){return app=container.getProvider(\"app\").getImmediate(),platformLoggerProvider=container.getProvider(\"platform-logger\"),{getToken:function(forceRefresh){return getToken$1(app,platformLoggerProvider,forceRefresh)},addTokenListener:function(listener){return function(app,platformLoggerProvider,listener){var state=getState(app),newState=tslib.__assign(tslib.__assign({},state),{tokenListeners:tslib.__spreadArray(tslib.__spreadArray([],state.tokenListeners),[listener])});if(isDebugMode()){var debugState=getDebugState();debugState.enabled&&debugState.token&&debugState.token.promise.then((function(token){return listener({token:token})})).catch((function(){}))}else{if(!newState.tokenRefresher){var tokenRefresher=function(app,platformLoggerProvider){var _this=this;return new Refresher((function(){return tslib.__awaiter(_this,void 0,void 0,(function(){var result;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:return getState(app).token?[3,2]:[4,getToken$1(app,platformLoggerProvider)];case 1:return result=_a.sent(),[3,4];case 2:return[4,getToken$1(app,platformLoggerProvider,!0)];case 3:result=_a.sent(),_a.label=4;case 4:if(result.error)throw result.error;return[2]}}))}))}),(function(){return!0}),(function(){var state=getState(app);if(state.token){var nextRefreshTimeMillis=state.token.issuedAtTimeMillis+.5*(state.token.expireTimeMillis-state.token.issuedAtTimeMillis)+3e5;return nextRefreshTimeMillis=Math.min(nextRefreshTimeMillis,state.token.expireTimeMillis-3e5),Math.max(0,nextRefreshTimeMillis-Date.now())}return 0}),3e4,96e4)}(app,platformLoggerProvider);newState.tokenRefresher=tokenRefresher}if(newState.tokenRefresher.isRunning()||!0!==state.isTokenAutoRefreshEnabled||newState.tokenRefresher.start(),state.token&&isValid(state.token)){var validToken_1=state.token;Promise.resolve().then((function(){return listener({token:validToken_1.token})})).catch((function(){}))}}setState(app,newState)}(app,platformLoggerProvider,listener)},removeTokenListener:function(listener){return function(app,listener){var state=getState(app),newListeners=state.tokenListeners.filter((function(l){return l!==listener}));0===newListeners.length&&state.tokenRefresher&&state.tokenRefresher.isRunning()&&state.tokenRefresher.stop(),setState(app,tslib.__assign(tslib.__assign({},state),{tokenListeners:newListeners}))}(app,listener)}};var app,platformLoggerProvider}),\"PUBLIC\").setInstantiationMode(\"EXPLICIT\")),firebase.registerVersion(\"@firebase/app-check\",\"0.1.1\")}(firebase__default.default),function(){var globals=util.getGlobal();if(\"string\"==typeof globals.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===globals.FIREBASE_APPCHECK_DEBUG_TOKEN){var debugState=getDebugState();debugState.enabled=!0;var deferredToken=new util.Deferred;debugState.token=deferredToken,deferredToken.resolve(\"string\"==typeof globals.FIREBASE_APPCHECK_DEBUG_TOKEN?globals.FIREBASE_APPCHECK_DEBUG_TOKEN:function(){return tslib.__awaiter(this,void 0,void 0,(function(){var existingDebugToken,newToken;return tslib.__generator(this,(function(_a){switch(_a.label){case 0:existingDebugToken=void 0,_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,read(\"debug-token\")];case 2:return existingDebugToken=_a.sent(),[3,4];case 3:return _a.sent(),[3,4];case 4:return existingDebugToken?[2,existingDebugToken]:((token=newToken=\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,(function(c){var r=16*Math.random()|0;return(\"x\"===c?r:3&r|8).toString(16)})),write(\"debug-token\",token)).catch((function(e){return logger.warn(\"Failed to persist debug token to indexeddb. Error: \"+e)})),console.log(\"AppCheck debug token: \"+newToken+\". You will need to whitelist it in the Firebase console for it to work\"),[2,newToken])}var token}))}))}())}}()},eTA4:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.d(__webpack_exports__,\"a\",(function(){return calling_service_CallingService}));var index_esm=__webpack_require__(\"zIRd\");(function(){var k,aa=\"function\"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ca=function(a){a=[\"object\"==typeof window&&window,\"object\"==typeof self&&self,\"object\"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}return globalThis}(this);function ea(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function fa(a){var b=\"undefined\"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:ea(a)}}!function(a,b){if(b){var c=ca;a=a.split(\".\");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={}),c=c[e]}(b=b(d=c[a=a[a.length-1]]))!=d&&null!=b&&aa(c,a,{configurable:!0,writable:!0,value:b})}}(\"Promise\",(function(a){function b(g){this.b=0,this.c=void 0,this.a=[];var h=this.f();try{g(h.resolve,h.reject)}catch(m){h.reject(m)}}function c(){this.a=null}function d(g){return g instanceof b?g:new b((function(h){h(g)}))}if(a)return a;c.prototype.b=function(g){if(null==this.a){this.a=[];var h=this;this.c((function(){h.g()}))}this.a.push(g)};var e=ca.setTimeout;c.prototype.c=function(g){e(g,0)},c.prototype.g=function(){for(;this.a&&this.a.length;){var g=this.a;this.a=[];for(var h=0;h<g.length;++h){var m=g[h];g[h]=null;try{m()}catch(p){this.f(p)}}}this.a=null},c.prototype.f=function(g){this.c((function(){throw g}))},b.prototype.f=function(){function g(p){return function(v){m||(m=!0,p.call(h,v))}}var h=this,m=!1;return{resolve:g(this.m),reject:g(this.g)}},b.prototype.m=function(g){if(g===this)this.g(new TypeError(\"A Promise cannot resolve to itself\"));else if(g instanceof b)this.s(g);else{a:switch(typeof g){case\"object\":var h=null!=g;break a;case\"function\":h=!0;break a;default:h=!1}h?this.v(g):this.h(g)}},b.prototype.v=function(g){var h=void 0;try{h=g.then}catch(m){return void this.g(m)}\"function\"==typeof h?this.u(h,g):this.h(g)},b.prototype.g=function(g){this.i(2,g)},b.prototype.h=function(g){this.i(1,g)},b.prototype.i=function(g,h){if(0!=this.b)throw Error(\"Cannot settle(\"+g+\", \"+h+\"): Promise already settled in state\"+this.b);this.b=g,this.c=h,this.l()},b.prototype.l=function(){if(null!=this.a){for(var g=0;g<this.a.length;++g)f.b(this.a[g]);this.a=null}};var f=new c;return b.prototype.s=function(g){var h=this.f();g.Qa(h.resolve,h.reject)},b.prototype.u=function(g,h){var m=this.f();try{g.call(h,m.resolve,m.reject)}catch(p){m.reject(p)}},b.prototype.then=function(g,h){function m(A,Q){return\"function\"==typeof A?function(ya){try{p(A(ya))}catch(zd){v(zd)}}:Q}var p,v,B=new b((function(A,Q){p=A,v=Q}));return this.Qa(m(g,p),m(h,v)),B},b.prototype.catch=function(g){return this.then(void 0,g)},b.prototype.Qa=function(g,h){function m(){switch(p.b){case 1:g(p.c);break;case 2:h(p.c);break;default:throw Error(\"Unexpected state: \"+p.b)}}var p=this;null==this.a?f.b(m):this.a.push(m)},b.resolve=d,b.reject=function(g){return new b((function(h,m){m(g)}))},b.race=function(g){return new b((function(h,m){for(var p=fa(g),v=p.next();!v.done;v=p.next())d(v.value).Qa(h,m)}))},b.all=function(g){var h=fa(g),m=h.next();return m.done?d([]):new b((function(p,v){function B(ya){return function(zd){A[ya]=zd,0==--Q&&p(A)}}var A=[],Q=0;do{A.push(void 0),Q++,d(m.value).Qa(B(A.length-1),v),m=h.next()}while(!m.done)}))},b}));var ha=ha||{},l=this||self,ia=/^[\\w+/_-]+[=]{0,2}$/,ja=null;function ka(a){return(a=a.querySelector&&a.querySelector(\"script[nonce]\"))&&(a=a.nonce||a.getAttribute(\"nonce\"))&&ia.test(a)?a:\"\"}function la(){}function ma(a){var b=typeof a;return\"object\"!=b?b:a?Array.isArray(a)?\"array\":b:\"null\"}function na(a){var b=ma(a);return\"array\"==b||\"object\"==b&&\"number\"==typeof a.length}function oa(a){return\"function\"==ma(a)}function n(a){var b=typeof a;return\"object\"==b&&null!=a||\"function\"==b}function pa(a){return Object.prototype.hasOwnProperty.call(a,qa)&&a[qa]||(a[qa]=++ra)}var qa=\"closure_uid_\"+(1e9*Math.random()>>>0),ra=0;function sa(a,b,c){return a.call.apply(a.bind,arguments)}function ta(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,d),a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function q(a,b,c){return(q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?sa:ta).apply(null,arguments)}function ua(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();return d.push.apply(d,arguments),a.apply(this,d)}}var va=Date.now;function r(a,b){function c(){}c.prototype=b.prototype,a.ab=b.prototype,a.prototype=new c,a.prototype.constructor=a}function wa(a){return a}function t(a,b,c){this.code=xa+a,this.message=b||za[a]||\"\",this.a=c||null}function Aa(a){var b=a&&a.code;return b?new t(b.substring(xa.length),a.message,a.serverResponse):null}r(t,Error),t.prototype.w=function(){var a={code:this.code,message:this.message};return this.a&&(a.serverResponse=this.a),a},t.prototype.toJSON=function(){return this.w()};var Da,xa=\"auth/\",za={\"admin-restricted-operation\":\"This operation is restricted to administrators only.\",\"argument-error\":\"\",\"app-not-authorized\":\"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.\",\"app-not-installed\":\"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.\",\"captcha-check-failed\":\"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.\",\"code-expired\":\"The SMS code has expired. Please re-send the verification code to try again.\",\"cordova-not-ready\":\"Cordova framework is not ready.\",\"cors-unsupported\":\"This browser is not supported.\",\"credential-already-in-use\":\"This credential is already associated with a different user account.\",\"custom-token-mismatch\":\"The custom token corresponds to a different audience.\",\"requires-recent-login\":\"This operation is sensitive and requires recent authentication. Log in again before retrying this request.\",\"dynamic-link-not-activated\":\"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.\",\"email-change-needs-verification\":\"Multi-factor users must always have a verified email.\",\"email-already-in-use\":\"The email address is already in use by another account.\",\"expired-action-code\":\"The action code has expired. \",\"cancelled-popup-request\":\"This operation has been cancelled due to another conflicting popup being opened.\",\"internal-error\":\"An internal error has occurred.\",\"invalid-app-credential\":\"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.\",\"invalid-app-id\":\"The mobile app identifier is not registed for the current project.\",\"invalid-user-token\":\"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.\",\"invalid-auth-event\":\"An internal error has occurred.\",\"invalid-verification-code\":\"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.\",\"invalid-continue-uri\":\"The continue URL provided in the request is invalid.\",\"invalid-cordova-configuration\":\"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.\",\"invalid-custom-token\":\"The custom token format is incorrect. Please check the documentation.\",\"invalid-dynamic-link-domain\":\"The provided dynamic link domain is not configured or authorized for the current project.\",\"invalid-email\":\"The email address is badly formatted.\",\"invalid-api-key\":\"Your API key is invalid, please check you have copied it correctly.\",\"invalid-cert-hash\":\"The SHA-1 certificate hash provided is invalid.\",\"invalid-credential\":\"The supplied auth credential is malformed or has expired.\",\"invalid-message-payload\":\"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.\",\"invalid-multi-factor-session\":\"The request does not contain a valid proof of first factor successful sign-in.\",\"invalid-oauth-provider\":\"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.\",\"invalid-oauth-client-id\":\"The OAuth client ID provided is either invalid or does not match the specified API key.\",\"unauthorized-domain\":\"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.\",\"invalid-action-code\":\"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.\",\"wrong-password\":\"The password is invalid or the user does not have a password.\",\"invalid-persistence-type\":\"The specified persistence type is invalid. It can only be local, session or none.\",\"invalid-phone-number\":\"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].\",\"invalid-provider-id\":\"The specified provider ID is invalid.\",\"invalid-recipient-email\":\"The email corresponding to this action failed to send as the provided recipient email address is invalid.\",\"invalid-sender\":\"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.\",\"invalid-verification-id\":\"The verification ID used to create the phone auth credential is invalid.\",\"invalid-tenant-id\":\"The Auth instance's tenant ID is invalid.\",\"multi-factor-info-not-found\":\"The user does not have a second factor matching the identifier provided.\",\"multi-factor-auth-required\":\"Proof of ownership of a second factor is required to complete sign-in.\",\"missing-android-pkg-name\":\"An Android Package Name must be provided if the Android App is required to be installed.\",\"auth-domain-config-required\":\"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.\",\"missing-app-credential\":\"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.\",\"missing-verification-code\":\"The phone auth credential was created with an empty SMS verification code.\",\"missing-continue-uri\":\"A continue URL must be provided in the request.\",\"missing-iframe-start\":\"An internal error has occurred.\",\"missing-ios-bundle-id\":\"An iOS Bundle ID must be provided if an App Store ID is provided.\",\"missing-multi-factor-info\":\"No second factor identifier is provided.\",\"missing-multi-factor-session\":\"The request is missing proof of first factor successful sign-in.\",\"missing-or-invalid-nonce\":\"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.\",\"missing-phone-number\":\"To send verification codes, provide a phone number for the recipient.\",\"missing-verification-id\":\"The phone auth credential was created with an empty verification ID.\",\"app-deleted\":\"This instance of FirebaseApp has been deleted.\",\"account-exists-with-different-credential\":\"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.\",\"network-request-failed\":\"A network error (such as timeout, interrupted connection or unreachable host) has occurred.\",\"no-auth-event\":\"An internal error has occurred.\",\"no-such-provider\":\"User was not linked to an account with the given provider.\",\"null-user\":\"A null user object was provided as the argument for an operation which requires a non-null user object.\",\"operation-not-allowed\":\"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.\",\"operation-not-supported-in-this-environment\":'This operation is not supported in the environment this application is running on. \"location.protocol\" must be http, https or chrome-extension and web storage must be enabled.',\"popup-blocked\":\"Unable to establish a connection with the popup. It may have been blocked by the browser.\",\"popup-closed-by-user\":\"The popup has been closed by the user before finalizing the operation.\",\"provider-already-linked\":\"User can only be linked to one identity for the given provider.\",\"quota-exceeded\":\"The project's quota for this operation has been exceeded.\",\"redirect-cancelled-by-user\":\"The redirect operation has been cancelled by the user before finalizing.\",\"redirect-operation-pending\":\"A redirect sign-in operation is already pending.\",\"rejected-credential\":\"The request contains malformed or mismatching credentials.\",\"second-factor-already-in-use\":\"The second factor is already enrolled on this account.\",\"maximum-second-factor-count-exceeded\":\"The maximum allowed number of second factors on a user has been exceeded.\",\"tenant-id-mismatch\":\"The provided tenant ID does not match the Auth instance's tenant ID\",timeout:\"The operation has timed out.\",\"user-token-expired\":\"The user's credential is no longer valid. The user must sign in again.\",\"too-many-requests\":\"We have blocked all requests from this device due to unusual activity. Try again later.\",\"unauthorized-continue-uri\":\"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.\",\"unsupported-first-factor\":\"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.\",\"unsupported-persistence-type\":\"The current environment does not support the specified persistence type.\",\"unsupported-tenant-operation\":\"This operation is not supported in a multi-tenant context.\",\"unverified-email\":\"The operation requires a verified email.\",\"user-cancelled\":\"The user did not grant your application the permissions it requested.\",\"user-not-found\":\"There is no user record corresponding to this identifier. The user may have been deleted.\",\"user-disabled\":\"The user account has been disabled by an administrator.\",\"user-mismatch\":\"The supplied credentials do not correspond to the previously signed in user.\",\"user-signed-out\":\"\",\"weak-password\":\"The password must be 6 characters long or more.\",\"web-storage-unsupported\":\"This browser is not supported or 3rd party cookies and data may be disabled.\"},Ba={ld:{Ta:\"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/\",Za:\"https://staging-securetoken.sandbox.googleapis.com/v1/token\",Wa:\"https://staging-identitytoolkit.sandbox.googleapis.com/v2/\",id:\"b\"},sd:{Ta:\"https://www.googleapis.com/identitytoolkit/v3/relyingparty/\",Za:\"https://securetoken.googleapis.com/v1/token\",Wa:\"https://identitytoolkit.googleapis.com/v2/\",id:\"p\"},ud:{Ta:\"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/\",Za:\"https://staging-securetoken.sandbox.googleapis.com/v1/token\",Wa:\"https://staging-identitytoolkit.sandbox.googleapis.com/v2/\",id:\"s\"},vd:{Ta:\"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/\",Za:\"https://test-securetoken.sandbox.googleapis.com/v1/token\",Wa:\"https://test-identitytoolkit.sandbox.googleapis.com/v2/\",id:\"t\"}};function Ca(a){for(var b in Ba)if(Ba[b].id===a)return{firebaseEndpoint:(a=Ba[b]).Ta,secureTokenEndpoint:a.Za,identityPlatformEndpoint:a.Wa};return null}function Ea(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}}function u(a){if(Error.captureStackTrace)Error.captureStackTrace(this,u);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}function Fa(a,b){for(var c=\"\",d=(a=a.split(\"%s\")).length-1,e=0;e<d;e++)c+=a[e]+(e<b.length?b[e]:\"%s\");u.call(this,c+a[d])}function Ga(a,b){throw new Fa(\"Failure\"+(a?\": \"+a:\"\"),Array.prototype.slice.call(arguments,1))}function Ha(a,b){this.c=a,this.f=b,this.b=0,this.a=null}function Ia(a,b){a.f(b),100>a.b&&(a.b++,b.next=a.a,a.a=b)}function Ja(){this.b=this.a=null}Da=Ca(\"__EID__\")?\"__EID__\":void 0,r(u,Error),u.prototype.name=\"CustomError\",r(Fa,u),Fa.prototype.name=\"AssertionError\",Ha.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next,a.next=null}else a=this.c();return a};var La=new Ha((function(){return new Ka}),(function(a){a.reset()}));function Ma(){var a=Na,b=null;return a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null),b}function Ka(){this.next=this.b=this.a=null}Ja.prototype.add=function(a,b){var c=La.get();c.set(a,b),this.b?this.b.next=c:this.a=c,this.b=c},Ka.prototype.set=function(a,b){this.a=a,this.b=b,this.next=null},Ka.prototype.reset=function(){this.next=this.b=this.a=null};var Oa=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if(\"string\"==typeof a)return\"string\"!=typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},w=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=\"string\"==typeof a?a.split(\"\"):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Qa=Array.prototype.filter?function(a,b){return Array.prototype.filter.call(a,b,void 0)}:function(a,b){for(var c=a.length,d=[],e=0,f=\"string\"==typeof a?a.split(\"\"):a,g=0;g<c;g++)if(g in f){var h=f[g];b.call(void 0,h,g,a)&&(d[e++]=h)}return d},Ra=Array.prototype.map?function(a,b){return Array.prototype.map.call(a,b,void 0)}:function(a,b){for(var c=a.length,d=Array(c),e=\"string\"==typeof a?a.split(\"\"):a,f=0;f<c;f++)f in e&&(d[f]=b.call(void 0,e[f],f,a));return d},Sa=Array.prototype.some?function(a,b){return Array.prototype.some.call(a,b,void 0)}:function(a,b){for(var c=a.length,d=\"string\"==typeof a?a.split(\"\"):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a))return!0;return!1};function Va(a,b){return 0<=Oa(a,b)}function Wa(a,b){var c;return(c=0<=(b=Oa(a,b)))&&Array.prototype.splice.call(a,b,1),c}function Xa(a,b){!function(a,b){for(var c=\"string\"==typeof a?a.split(\"\"):a,d=a.length-1;0<=d;--d)d in c&&b.call(void 0,c[d],d,a)}(a,(function(d,e){b.call(void 0,d,e,a)&&Array.prototype.splice.call(a,e,1)}))}function Ya(a){return Array.prototype.concat.apply([],arguments)}function Za(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}var ib,$a=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(a)[1]},ab=/&/g,bb=/</g,cb=/>/g,db=/\"/g,eb=/'/g,fb=/\\x00/g,gb=/[\\x00&<>\"']/;function x(a,b){return-1!=a.indexOf(b)}function hb(a,b){return a<b?-1:a>b?1:0}a:{var jb=l.navigator;if(jb){var kb=jb.userAgent;if(kb){ib=kb;break a}}ib=\"\"}function y(a){return x(ib,a)}function lb(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function mb(a){for(var b in a)return!1;return!0}function nb(a){var c,b={};for(c in a)b[c]=a[c];return b}var ob=\"constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf\".split(\" \");function z(a,b){for(var c,d,e=1;e<arguments.length;e++){for(c in d=arguments[e])a[c]=d[c];for(var f=0;f<ob.length;f++)c=ob[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function pb(a,b){a:{try{var c=a&&a.ownerDocument,d=c&&(c.defaultView||c.parentWindow);if((d=d||l).Element&&d.Location){var e=d;break a}}catch(g){}e=null}if(e&&void 0!==e[b]&&(!a||!(a instanceof e[b])&&(a instanceof e.Location||a instanceof e.Element))){if(n(a))try{var f=a.constructor.displayName||a.constructor.name||Object.prototype.toString.call(a)}catch(g){f=\"<object could not be stringified>\"}else f=void 0===a?\"undefined\":null===a?\"null\":typeof a;Ga(\"Argument is not a %s (or a non-Element, non-Location mock); got: %s\",b,f)}}function qb(a,b){this.a=a===rb&&b||\"\",this.b=sb}function tb(a){return a instanceof qb&&a.constructor===qb&&a.b===sb?a.a:(Ga(\"expected object of type Const, got '\"+a+\"'\"),\"type_error:Const\")}qb.prototype.sa=!0,qb.prototype.ra=function(){return this.a},qb.prototype.toString=function(){return\"Const{\"+this.a+\"}\"};var ub,sb={},rb={};function vb(){if(void 0===ub){var a=null,b=l.trustedTypes;if(b&&b.createPolicy){try{a=b.createPolicy(\"goog#html\",{createHTML:wa,createScript:wa,createScriptURL:wa})}catch(c){l.console&&l.console.error(c.message)}ub=a}else ub=a}return ub}function wb(a,b){this.a=b===xb?a:\"\"}function yb(a){return a instanceof wb&&a.constructor===wb?a.a:(Ga(\"expected object of type TrustedResourceUrl, got '\"+a+\"' of type \"+ma(a)),\"type_error:TrustedResourceUrl\")}function zb(a,b){var c=tb(a);if(!Ab.test(c))throw Error(\"Invalid TrustedResourceUrl format: \"+c);return function(a){var b=vb();return new wb(a=b?b.createScriptURL(a):a,xb)}(a=c.replace(Bb,(function(d,e){if(!Object.prototype.hasOwnProperty.call(b,e))throw Error('Found marker, \"'+e+'\", in format string, \"'+c+'\", but no valid label mapping found in args: '+JSON.stringify(b));return(d=b[e])instanceof qb?tb(d):encodeURIComponent(String(d))})))}wb.prototype.sa=!0,wb.prototype.ra=function(){return this.a.toString()},wb.prototype.toString=function(){return\"TrustedResourceUrl{\"+this.a+\"}\"};var Bb=/%{(\\w+)}/g,Ab=/^((https:)?\\/\\/[0-9a-z.:[\\]-]+\\/|\\/[^/\\\\]|[^:/\\\\%]+\\/|[^:/\\\\%]*[?#]|about:blank#)/i,xb={};function C(a,b){this.a=b===Db?a:\"\"}function Eb(a){return a instanceof C&&a.constructor===C?a.a:(Ga(\"expected object of type SafeUrl, got '\"+a+\"' of type \"+ma(a)),\"type_error:SafeUrl\")}C.prototype.sa=!0,C.prototype.ra=function(){return this.a.toString()},C.prototype.toString=function(){return\"SafeUrl{\"+this.a+\"}\"};var Fb=/^(?:audio\\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\\/\\w+|image\\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\\/csv|video\\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\\w+=(?:\\w+|\"[\\w;,= ]+\"))*$/i,Gb=/^data:(.*);base64,[a-z0-9+\\/]+=*$/i,Hb=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ib(a){if(a instanceof C)return a;if(a=\"object\"==typeof a&&a.sa?a.ra():String(a),Hb.test(a))a=new C(a,Db);else{var b=(a=(a=String(a)).replace(/(%0A|%0D)/g,\"\")).match(Gb);a=b&&Fb.test(b[1])?new C(a,Db):null}return a}function Jb(a){return a instanceof C?a:(a=\"object\"==typeof a&&a.sa?a.ra():String(a),Hb.test(a)||(a=\"about:invalid#zClosurez\"),new C(a,Db))}var Db={},Kb=new C(\"about:invalid#zClosurez\",Db);function Lb(a,b,c){this.a=c===Mb?a:\"\"}Lb.prototype.sa=!0,Lb.prototype.ra=function(){return this.a.toString()},Lb.prototype.toString=function(){return\"SafeHtml{\"+this.a+\"}\"};var Mb={};function Pb(a,b,c,d){return a=a instanceof C?a:Jb(a),b=b||l,c=c instanceof qb?tb(c):c||\"\",b.open(Eb(a),c,d,void 0)}function Qb(a,b){for(var c=a.split(\"%s\"),d=\"\",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join(\"%s\")}function Rb(a){return gb.test(a)&&(-1!=a.indexOf(\"&\")&&(a=a.replace(ab,\"&amp;\")),-1!=a.indexOf(\"<\")&&(a=a.replace(bb,\"&lt;\")),-1!=a.indexOf(\">\")&&(a=a.replace(cb,\"&gt;\")),-1!=a.indexOf('\"')&&(a=a.replace(db,\"&quot;\")),-1!=a.indexOf(\"'\")&&(a=a.replace(eb,\"&#39;\")),-1!=a.indexOf(\"\\0\")&&(a=a.replace(fb,\"&#0;\"))),a}function Sb(a){return Sb[\" \"](a),a}Sb[\" \"]=la;var bc,a,Vb=y(\"Opera\"),Wb=y(\"Trident\")||y(\"MSIE\"),Xb=y(\"Edge\"),Yb=Xb||Wb,Zb=y(\"Gecko\")&&!(x(ib.toLowerCase(),\"webkit\")&&!y(\"Edge\"))&&!(y(\"Trident\")||y(\"MSIE\"))&&!y(\"Edge\"),$b=x(ib.toLowerCase(),\"webkit\")&&!y(\"Edge\");function ac(){var a=l.document;return a?a.documentMode:void 0}a:{var cc=\"\",dc=(a=ib,Zb?/rv:([^\\);]+)(\\)|;)/.exec(a):Xb?/Edge\\/([\\d\\.]+)/.exec(a):Wb?/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a):$b?/WebKit\\/(\\S+)/.exec(a):Vb?/(?:Version)[ \\/]?(\\S+)/.exec(a):void 0);if(dc&&(cc=dc?dc[1]:\"\"),Wb){var ec=ac();if(null!=ec&&ec>parseFloat(cc)){bc=String(ec);break a}}bc=cc}var Ub={};function fc(a){return function(a,b){var c=Ub;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b()}(a,(function(){for(var b=0,c=$a(String(bc)).split(\".\"),d=$a(String(a)).split(\".\"),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||\"\",h=d[f]||\"\";do{if(g=/(\\d*)(\\D*)(.*)/.exec(g)||[\"\",\"\",\"\",\"\"],h=/(\\d*)(\\D*)(.*)/.exec(h)||[\"\",\"\",\"\",\"\"],0==g[0].length&&0==h[0].length)break;b=hb(0==g[1].length?0:parseInt(g[1],10),0==h[1].length?0:parseInt(h[1],10))||hb(0==g[2].length,0==h[2].length)||hb(g[2],h[2]),g=g[3],h=h[3]}while(0==b)}return 0<=b}))}var ic=l.document&&Wb&&(ac()||parseInt(bc,10))||void 0;try{new self.OffscreenCanvas(0,0).getContext(\"2d\")}catch(a){}var jc=!Wb||9<=Number(ic);function kc(a){var b=document;return\"string\"==typeof a?b.getElementById(a):a}function lc(a,b){lb(b,(function(c,d){c&&\"object\"==typeof c&&c.sa&&(c=c.ra()),\"style\"==d?a.style.cssText=c:\"class\"==d?a.className=c:\"for\"==d?a.htmlFor=c:mc.hasOwnProperty(d)?a.setAttribute(mc[d],c):0==d.lastIndexOf(\"aria-\",0)||0==d.lastIndexOf(\"data-\",0)?a.setAttribute(d,c):a[d]=c}))}var rc,uc,mc={cellpadding:\"cellPadding\",cellspacing:\"cellSpacing\",colspan:\"colSpan\",frameborder:\"frameBorder\",height:\"height\",maxlength:\"maxLength\",nonce:\"nonce\",role:\"role\",rowspan:\"rowSpan\",type:\"type\",usemap:\"useMap\",valign:\"vAlign\",width:\"width\"};function pc(a,b,c){function d(h){h&&b.appendChild(\"string\"==typeof h?a.createTextNode(h):h)}for(var e=2;e<c.length;e++){var f=c[e];if(!na(f)||n(f)&&0<f.nodeType)d(f);else{a:{if(f&&\"number\"==typeof f.length){if(n(f)){var g=\"function\"==typeof f.item||\"string\"==typeof f.item;break a}if(oa(f)){g=\"function\"==typeof f.item;break a}}g=!1}w(g?Za(f):f,d)}}}function oc(a,b){return b=String(b),\"application/xhtml+xml\"===a.contentType&&(b=b.toLowerCase()),a.createElement(b)}function qc(a){l.setTimeout((function(){throw a}),0)}function tc(a,b){uc||function(){if(l.Promise&&l.Promise.resolve){var a=l.Promise.resolve(void 0);uc=function(){a.then(xc)}}else uc=function(){var b=xc;!oa(l.setImmediate)||l.Window&&l.Window.prototype&&!y(\"Edge\")&&l.Window.prototype.setImmediate==l.setImmediate?(rc||(rc=function(){var a=l.MessageChannel;if(void 0===a&&\"undefined\"!=typeof window&&window.postMessage&&window.addEventListener&&!y(\"Presto\")&&(a=function(){var e=oc(document,\"IFRAME\");e.style.display=\"none\",document.documentElement.appendChild(e);var f=e.contentWindow;(e=f.document).open(),e.close();var g=\"callImmediate\"+Math.random(),h=\"file:\"==f.location.protocol?\"*\":f.location.protocol+\"//\"+f.location.host;e=q((function(m){\"*\"!=h&&m.origin!=h||m.data!=g||this.port1.onmessage()}),this),f.addEventListener(\"message\",e,!1),this.port1={},this.port2={postMessage:function(){f.postMessage(g,h)}}}),void 0!==a&&!y(\"Trident\")&&!y(\"MSIE\")){var b=new a,c={},d=c;return b.port1.onmessage=function(){if(void 0!==c.next){var e=(c=c.next).Gb;c.Gb=null,e()}},function(e){d.next={Gb:e},d=d.next,b.port2.postMessage(0)}}return function(e){l.setTimeout(e,0)}}()),rc(b)):l.setImmediate(b)}}(),wc||(uc(),wc=!0),Na.add(a,b)}var wc=!1,Na=new Ja;function xc(){for(var a;a=Ma();){try{a.a.call(a.b)}catch(b){qc(b)}Ia(La,a)}wc=!1}function D(a,b){if(this.a=yc,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,a!=la)try{var c=this;a.call(b,(function(d){zc(c,Ac,d)}),(function(d){if(!(d instanceof Bc))try{if(d instanceof Error)throw d;throw Error(\"Promise rejected.\")}catch(e){}zc(c,Cc,d)}))}catch(d){zc(this,Cc,d)}}var yc=0,Ac=2,Cc=3;function Dc(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Dc.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ec=new Ha((function(){return new Dc}),(function(a){a.reset()}));function Fc(a,b,c){var d=Ec.get();return d.g=a,d.b=b,d.f=c,d}function E(a){if(a instanceof D)return a;var b=new D(la);return zc(b,Ac,a),b}function F(a){return new D((function(b,c){c(a)}))}function Gc(a,b,c){Hc(a,b,c,null)||tc(ua(b,a))}function Jc(a){return new D((function(b){var c=a.length,d=[];if(c)for(var e=function(h,m,p){c--,d[h]=m?{Pb:!0,value:p}:{Pb:!1,reason:p},0==c&&b(d)},f=0;f<a.length;f++)Gc(a[f],ua(e,f,!0),ua(e,f,!1));else b(d)}))}function Lc(a,b){a.b||a.a!=Ac&&a.a!=Cc||Pc(a),a.f?a.f.next=b:a.b=b,a.f=b}function Kc(a,b,c,d){var e=Fc(null,null,null);return e.a=new D((function(f,g){e.g=b?function(h){try{var m=b.call(d,h);f(m)}catch(p){g(p)}}:f,e.b=c?function(h){try{var m=c.call(d,h);void 0===m&&h instanceof Bc?g(h):f(m)}catch(p){g(p)}}:g})),e.a.c=a,Lc(a,e),e.a}function zc(a,b,c){a.a==yc&&(a===c&&(b=Cc,c=new TypeError(\"Promise cannot resolve to itself\")),a.a=1,Hc(c,a.$c,a.ad,a)||(a.i=c,a.a=b,a.c=null,Pc(a),b!=Cc||c instanceof Bc||function(a,b){a.g=!0,tc((function(){a.g&&Tc.call(null,b)}))}(a,c)))}function Hc(a,b,c,d){if(a instanceof D)return Lc(a,Fc(b||la,c||null,d)),!0;if(Ea(a))return a.then(b,c,d),!0;if(n(a))try{var e=a.then;if(oa(e))return function(a,b,c,d,e){function f(m){h||(h=!0,d.call(e,m))}var h=!1;try{b.call(a,(function(m){h||(h=!0,c.call(e,m))}),f)}catch(m){f(m)}}(a,e,b,c,d),!0}catch(f){return c.call(d,f),!0}return!1}function Pc(a){a.h||(a.h=!0,tc(a.gc,a))}function Nc(a){var b=null;return a.b&&(a.b=(b=a.b).next,b.next=null),a.b||(a.f=null),b}function Oc(a,b,c,d){if(c==Cc&&b.b&&!b.c)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,Sc(b,c,d);else try{b.c?b.g.call(b.f):Sc(b,c,d)}catch(e){Tc.call(null,e)}Ia(Ec,b)}function Sc(a,b,c){b==Ac?a.g.call(a.f,c):a.b&&a.b.call(a.f,c)}D.prototype.then=function(a,b,c){return Kc(this,oa(a)?a:null,oa(b)?b:null,c)},D.prototype.$goog_Thenable=!0,(k=D.prototype).oa=function(a,b){return(a=Fc(a,a,b)).c=!0,Lc(this,a),this},k.o=function(a,b){return Kc(this,null,a,b)},k.cancel=function(a){if(this.a==yc){var b=new Bc(a);tc((function(){!function Mc(a,b){if(a.a==yc)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.c||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.a==yc&&1==d?Mc(c,b):(f?((d=f).next==c.f&&(c.f=d),d.next=d.next.next):Nc(c),Oc(c,e,Cc,b)))}a.c=null}else zc(a,Cc,b)}(this,b)}),this)}},k.$c=function(a){this.a=yc,zc(this,Ac,a)},k.ad=function(a){this.a=yc,zc(this,Cc,a)},k.gc=function(){for(var a;a=Nc(this);)Oc(this,a,this.a,this.i);this.h=!1};var Tc=qc;function Bc(a){u.call(this,a)}function Uc(){0!=Vc&&(Wc[pa(this)]=this),this.xa=this.xa,this.pa=this.pa}r(Bc,u),Bc.prototype.name=\"cancel\";var Vc=0,Wc={};function Xc(a){if(!a.xa&&(a.xa=!0,a.Da(),0!=Vc)){var b=pa(a);if(0!=Vc&&a.pa&&0<a.pa.length)throw Error(a+\" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.\");delete Wc[b]}}Uc.prototype.xa=!1,Uc.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Yc=Object.freeze||function(a){return a},Zc=!Wb||9<=Number(ic),$c=Wb&&!fc(\"9\"),ad=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},\"passive\",{get:function(){a=!0}});try{l.addEventListener(\"test\",la,b),l.removeEventListener(\"test\",la,b)}catch(c){}return a}();function G(a,b){this.type=a,this.b=this.target=b,this.defaultPrevented=!1}function bd(a,b){if(G.call(this,a?a.type:\"\"),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=\"\",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType=\"\",this.a=null,a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.b=b,b=a.relatedTarget){if(Zb){a:{try{Sb(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else\"mouseover\"==c?b=a.fromElement:\"mouseout\"==c&&(b=a.toElement);this.relatedTarget=b,d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||\"\",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=\"string\"==typeof a.pointerType?a.pointerType:cd[a.pointerType]||\"\",this.a=a,a.defaultPrevented&&this.preventDefault()}}G.prototype.preventDefault=function(){this.defaultPrevented=!0},r(bd,G);var cd=Yc({2:\"touch\",3:\"pen\",4:\"mouse\"});bd.prototype.preventDefault=function(){bd.ab.preventDefault.call(this);var a=this.a;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,$c)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(b){}},bd.prototype.g=function(){return this.a};var dd=\"closure_listenable_\"+(1e6*Math.random()|0),ed=0;function fd(a,b,c,d,e){this.listener=a,this.proxy=null,this.src=b,this.type=c,this.capture=!!d,this.Va=e,this.key=++ed,this.va=this.Pa=!1}function gd(a){a.va=!0,a.listener=null,a.proxy=null,a.src=null,a.Va=null}function hd(a){this.src=a,this.a={},this.b=0}function jd(a,b){var c=b.type;c in a.a&&Wa(a.a[c],b)&&(gd(b),0==a.a[c].length&&(delete a.a[c],a.b--))}function id(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.va&&f.listener==b&&f.capture==!!c&&f.Va==d)return e}return-1}hd.prototype.add=function(a,b,c,d,e){var f=a.toString();(a=this.a[f])||(a=this.a[f]=[],this.b++);var g=id(a,b,d,e);return-1<g?(b=a[g],c||(b.Pa=!1)):((b=new fd(b,this.src,f,!!d,e)).Pa=c,a.push(b)),b};var kd=\"closure_lm_\"+(1e6*Math.random()|0),ld={};function nd(a,b,c,d,e){if(d&&d.once)od(a,b,c,d,e);else if(Array.isArray(b))for(var f=0;f<b.length;f++)nd(a,b[f],c,d,e);else c=pd(c),a&&a[dd]?qd(a,b,c,n(d)?!!d.capture:!!d,e):rd(a,b,c,!1,d,e)}function rd(a,b,c,d,e,f){if(!b)throw Error(\"Invalid event type\");var g=n(e)?!!e.capture:!!e,h=sd(a);if(h||(a[kd]=h=new hd(a)),!(c=h.add(b,c,d,g,f)).proxy)if(d=function(){var a=vd,b=Zc?function(c){return a.call(b.src,b.listener,c)}:function(c){if(!(c=a.call(b.src,b.listener,c)))return c};return b}(),c.proxy=d,d.src=a,d.listener=c,a.addEventListener)ad||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(ud(b.toString()),d);else{if(!a.addListener||!a.removeListener)throw Error(\"addEventListener and attachEvent are unavailable.\");a.addListener(d)}}function od(a,b,c,d,e){if(Array.isArray(b))for(var f=0;f<b.length;f++)od(a,b[f],c,d,e);else c=pd(c),a&&a[dd]?wd(a,b,c,n(d)?!!d.capture:!!d,e):rd(a,b,c,!0,d,e)}function xd(a,b,c,d,e){if(Array.isArray(b))for(var f=0;f<b.length;f++)xd(a,b[f],c,d,e);else d=n(d)?!!d.capture:!!d,c=pd(c),a&&a[dd]?(a=a.v,(b=String(b).toString())in a.a&&-1<(c=id(f=a.a[b],c,d,e))&&(gd(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--))):a&&(a=sd(a))&&(b=a.a[b.toString()],a=-1,b&&(a=id(b,c,d,e)),(c=-1<a?b[a]:null)&&yd(c))}function yd(a){if(\"number\"!=typeof a&&a&&!a.va){var b=a.src;if(b&&b[dd])jd(b.v,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(ud(c),d):b.addListener&&b.removeListener&&b.removeListener(d),(c=sd(b))?(jd(c,a),0==c.b&&(c.src=null,b[kd]=null)):gd(a)}}}function ud(a){return a in ld?ld[a]:ld[a]=\"on\"+a}function Ad(a,b,c,d){var e=!0;if((a=sd(a))&&(b=a.a[b.toString()]))for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.va&&(f=Bd(f,d),e=e&&!1!==f)}return e}function Bd(a,b){var c=a.listener,d=a.Va||a.src;return a.Pa&&yd(a),c.call(d,b)}function vd(a,b){if(a.va)return!0;if(!Zc){if(!b)a:{b=[\"window\",\"event\"];for(var c=l,d=0;d<b.length;d++)if(null==(c=c[b[d]])){b=null;break a}b=c}if(b=new bd(d=b,this),c=!0,!(0>d.keyCode||null!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}(e||null==d.returnValue)&&(d.returnValue=!0)}for(d=[],e=b.b;e;e=e.parentNode)d.push(e);for(a=a.type,e=d.length-1;0<=e;e--){b.b=d[e];var f=Ad(d[e],a,!0,b);c=c&&f}for(e=0;e<d.length;e++)b.b=d[e],f=Ad(d[e],a,!1,b),c=c&&f}return c}return Bd(a,new bd(b,this))}function sd(a){return(a=a[kd])instanceof hd?a:null}var Cd=\"__closure_events_fn_\"+(1e9*Math.random()>>>0);function pd(a){return oa(a)?a:(a[Cd]||(a[Cd]=function(b){return a.handleEvent(b)}),a[Cd])}function H(){Uc.call(this),this.v=new hd(this),this.ac=this,this.gb=null}function qd(a,b,c,d,e){a.v.add(String(b),c,!1,d,e)}function wd(a,b,c,d,e){a.v.add(String(b),c,!0,d,e)}function Dd(a,b,c,d){if(!(b=a.v.a[String(b)]))return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.va&&g.capture==c){var h=g.listener,m=g.Va||g.src;g.Pa&&jd(a.v,g),e=!1!==h.call(m,d)&&e}}return e&&!d.defaultPrevented}function Ed(a,b,c){if(oa(a))c&&(a=q(a,c));else{if(!a||\"function\"!=typeof a.handleEvent)throw Error(\"Invalid listener argument\");a=q(a.handleEvent,a)}return 2147483647<Number(b)?-1:l.setTimeout(a,b||0)}function Fd(a){var b=null;return new D((function(c,d){-1==(b=Ed((function(){c(void 0)}),a))&&d(Error(\"Failed to schedule timer.\"))})).o((function(c){throw l.clearTimeout(b),c}))}function Gd(a){if(a.W&&\"function\"==typeof a.W)return a.W();if(\"string\"==typeof a)return a.split(\"\");if(na(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}for(d in b=[],c=0,a)b[c++]=a[d];return b}function Hd(a){if(a.Y&&\"function\"==typeof a.Y)return a.Y();if(!a.W||\"function\"!=typeof a.W){if(na(a)||\"string\"==typeof a){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}for(var d in b=[],c=0,a)b[c++]=d;return b}}function Jd(a,b){this.b={},this.a=[],this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error(\"Uneven number of arguments\");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a)if(a instanceof Jd)for(c=a.Y(),d=0;d<c.length;d++)this.set(c[d],a.get(c[d]));else for(d in a)this.set(d,a[d])}function Kd(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Ld(a.b,d)&&(a.a[c++]=d),b++}a.a.length=c}if(a.c!=a.a.length){var e={};for(c=b=0;b<a.a.length;)Ld(e,d=a.a[b])||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}function Ld(a,b){return Object.prototype.hasOwnProperty.call(a,b)}r(H,Uc),H.prototype[dd]=!0,H.prototype.addEventListener=function(a,b,c,d){nd(this,a,b,c,d)},H.prototype.removeEventListener=function(a,b,c,d){xd(this,a,b,c,d)},H.prototype.dispatchEvent=function(a){var b,c=this.gb;if(c)for(b=[];c;c=c.gb)b.push(c);c=this.ac;var d=a.type||a;if(\"string\"==typeof a)a=new G(a,c);else if(a instanceof G)a.target=a.target||c;else{var e=a;z(a=new G(d,c),e)}if(e=!0,b)for(var f=b.length-1;0<=f;f--){var g=a.b=b[f];e=Dd(g,d,!0,a)&&e}if(e=Dd(g=a.b=c,d,!0,a)&&e,e=Dd(g,d,!1,a)&&e,b)for(f=0;f<b.length;f++)e=Dd(g=a.b=b[f],d,!1,a)&&e;return e},H.prototype.Da=function(){if(H.ab.Da.call(this),this.v){var c,a=this.v;for(c in a.a){for(var d=a.a[c],e=0;e<d.length;e++)gd(d[e]);delete a.a[c],a.b--}}this.gb=null},(k=Jd.prototype).W=function(){Kd(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a},k.Y=function(){return Kd(this),this.a.concat()},k.clear=function(){this.b={},this.c=this.a.length=0},k.get=function(a,b){return Ld(this.b,a)?this.b[a]:b},k.set=function(a,b){Ld(this.b,a)||(this.c++,this.a.push(a)),this.b[a]=b},k.forEach=function(a,b){for(var c=this.Y(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};var Md=/^(?:([^:/?#.]+):)?(?:\\/\\/(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$/;function Od(a,b){var c;this.a=this.l=this.c=\"\",this.g=null,this.h=this.f=\"\",this.i=!1,a instanceof Od?(this.i=void 0!==b?b:a.i,Pd(this,a.c),this.l=a.l,this.a=a.a,Qd(this,a.g),this.f=a.f,Rd(this,Sd(a.b)),this.h=a.h):a&&(c=String(a).match(Md))?(this.i=!!b,Pd(this,c[1]||\"\",!0),this.l=Td(c[2]||\"\"),this.a=Td(c[3]||\"\",!0),Qd(this,c[4]),this.f=Td(c[5]||\"\",!0),Rd(this,c[6]||\"\",!0),this.h=Td(c[7]||\"\")):(this.i=!!b,this.b=new Ud(null,this.i))}function Pd(a,b,c){a.c=c?Td(b,!0):b,a.c&&(a.c=a.c.replace(/:$/,\"\"))}function Qd(a,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error(\"Bad port number \"+b);a.g=b}else a.g=null}function Rd(a,b,c){b instanceof Ud?(a.b=b,function(a,b){b&&!a.f&&(ee(a),a.c=null,a.a.forEach((function(c,d){var e=d.toLowerCase();d!=e&&(ie(this,d),ge(this,e,c))}),a)),a.f=b}(a.b,a.i)):(c||(b=Vd(b,ae)),a.b=new Ud(b,a.i))}function I(a,b,c){a.b.set(b,c)}function be(a,b){return a.b.get(b)}function J(a){return a instanceof Od?new Od(a):new Od(a,void 0)}function ce(a,b,c,d){var e=new Od(null,void 0);return a&&Pd(e,a),b&&(e.a=b),c&&Qd(e,c),d&&(e.f=d),e}function Td(a,b){return a?b?decodeURI(a.replace(/%25/g,\"%2525\")):decodeURIComponent(a):\"\"}function Vd(a,b,c){return\"string\"==typeof a?(a=encodeURI(a).replace(b,de),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),a):null}function de(a){return\"%\"+((a=a.charCodeAt(0))>>4&15).toString(16)+(15&a).toString(16)}Od.prototype.toString=function(){var a=[],b=this.c;b&&a.push(Vd(b,Wd,!0),\":\");var c=this.a;return(c||\"file\"==b)&&(a.push(\"//\"),(b=this.l)&&a.push(Vd(b,Wd,!0),\"@\"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),null!=(c=this.g)&&a.push(\":\",String(c))),(c=this.f)&&(this.a&&\"/\"!=c.charAt(0)&&a.push(\"/\"),a.push(Vd(c,\"/\"==c.charAt(0)?Xd:Yd,!0))),(c=this.b.toString())&&a.push(\"?\",c),(c=this.h)&&a.push(\"#\",Vd(c,Zd)),a.join(\"\")},Od.prototype.resolve=function(a){var b=new Od(this),c=!!a.c;c?Pd(b,a.c):c=!!a.l,c?b.l=a.l:c=!!a.a,c?b.a=a.a:c=null!=a.g;var d=a.f;if(c)Qd(b,a.g);else if(c=!!a.f){if(\"/\"!=d.charAt(0))if(this.a&&!this.f)d=\"/\"+d;else{var e=b.f.lastIndexOf(\"/\");-1!=e&&(d=b.f.substr(0,e+1)+d)}if(\"..\"==(e=d)||\".\"==e)d=\"\";else if(x(e,\"./\")||x(e,\"/.\")){d=0==e.lastIndexOf(\"/\",0),e=e.split(\"/\");for(var f=[],g=0;g<e.length;){var h=e[g++];\".\"==h?d&&g==e.length&&f.push(\"\"):\"..\"==h?((1<f.length||1==f.length&&\"\"!=f[0])&&f.pop(),d&&g==e.length&&f.push(\"\")):(f.push(h),d=!0)}d=f.join(\"/\")}else d=e}return c?b.f=d:c=\"\"!==a.b.toString(),c?Rd(b,Sd(a.b)):c=!!a.h,c&&(b.h=a.h),b};var Wd=/[#\\/\\?@]/g,Yd=/[#\\?:]/g,Xd=/[#\\?]/g,ae=/[#\\?@]/g,Zd=/#/g;function Ud(a,b){this.b=this.a=null,this.c=a||null,this.f=!!b}function ee(a){a.a||(a.a=new Jd,a.b=0,a.c&&function(a,b){if(a){a=a.split(\"&\");for(var c=0;c<a.length;c++){var d=a[c].indexOf(\"=\"),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\\+/g,\" \")):\"\")}}}(a.c,(function(b,c){a.add(decodeURIComponent(b.replace(/\\+/g,\" \")),c)})))}function fe(a){var b=Hd(a);if(void 0===b)throw Error(\"Keys are undefined\");var c=new Ud(null,void 0);a=Gd(a);for(var d=0;d<b.length;d++){var e=b[d],f=a[d];Array.isArray(f)?ge(c,e,f):c.add(e,f)}return c}function ie(a,b){ee(a),b=he(a,b),Ld(a.a.b,b)&&(a.c=null,a.b-=a.a.get(b).length,Ld((a=a.a).b,b)&&(delete a.b[b],a.c--,a.a.length>2*a.c&&Kd(a)))}function je(a,b){return ee(a),b=he(a,b),Ld(a.a.b,b)}function ge(a,b,c){ie(a,b),0<c.length&&(a.c=null,a.a.set(he(a,b),Za(c)),a.b+=c.length)}function Sd(a){var b=new Ud;return b.c=a.c,a.a&&(b.a=new Jd(a.a),b.b=a.b),b}function he(a,b){return b=String(b),a.f&&(b=b.toLowerCase()),b}function ke(a){var b=[];return function le(a,b,c){if(null==b)c.push(\"null\");else{if(\"object\"==typeof b){if(Array.isArray(b)){var d=b;b=d.length,c.push(\"[\");for(var e=\"\",f=0;f<b;f++)c.push(e),le(a,d[f],c),e=\",\";return void c.push(\"]\")}if(!(b instanceof String||b instanceof Number||b instanceof Boolean)){for(d in c.push(\"{\"),e=\"\",b)Object.prototype.hasOwnProperty.call(b,d)&&\"function\"!=typeof(f=b[d])&&(c.push(e),ne(d,c),c.push(\":\"),le(a,f,c),e=\",\");return void c.push(\"}\")}b=b.valueOf()}switch(typeof b){case\"string\":ne(b,c);break;case\"number\":c.push(isFinite(b)&&!isNaN(b)?String(b):\"null\");break;case\"boolean\":c.push(String(b));break;case\"function\":c.push(\"null\");break;default:throw Error(\"Unknown type: \"+typeof b)}}}(new me,a,b),b.join(\"\")}function me(){}(k=Ud.prototype).add=function(a,b){ee(this),this.c=null,a=he(this,a);var c=this.a.get(a);return c||this.a.set(a,c=[]),c.push(b),this.b+=1,this},k.clear=function(){this.a=this.c=null,this.b=0},k.forEach=function(a,b){ee(this),this.a.forEach((function(c,d){w(c,(function(e){a.call(b,e,d,this)}),this)}),this)},k.Y=function(){ee(this);for(var a=this.a.W(),b=this.a.Y(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c},k.W=function(a){ee(this);var b=[];if(\"string\"==typeof a)je(this,a)&&(b=Ya(b,this.a.get(he(this,a))));else{a=this.a.W();for(var c=0;c<a.length;c++)b=Ya(b,a[c])}return b},k.set=function(a,b){return ee(this),this.c=null,je(this,a=he(this,a))&&(this.b-=this.a.get(a).length),this.a.set(a,[b]),this.b+=1,this},k.get=function(a,b){return a&&0<(a=this.W(a)).length?String(a[0]):b},k.toString=function(){if(this.c)return this.c;if(!this.a)return\"\";for(var a=[],b=this.a.Y(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.W(d);for(var f=0;f<d.length;f++){var g=e;\"\"!==d[f]&&(g+=\"=\"+encodeURIComponent(String(d[f]))),a.push(g)}}return this.c=a.join(\"&\")};var oe={'\"':'\\\\\"',\"\\\\\":\"\\\\\\\\\",\"/\":\"\\\\/\",\"\\b\":\"\\\\b\",\"\\f\":\"\\\\f\",\"\\n\":\"\\\\n\",\"\\r\":\"\\\\r\",\"\\t\":\"\\\\t\",\"\\v\":\"\\\\u000b\"},pe=/\\uffff/.test(\"￿\")?/[\\\\\"\\x00-\\x1f\\x7f-\\uffff]/g:/[\\\\\"\\x00-\\x1f\\x7f-\\xff]/g;function ne(a,b){b.push('\"',a.replace(pe,(function(c){var d=oe[c];return d||(d=\"\\\\u\"+(65536|c.charCodeAt(0)).toString(16).substr(1),oe[c]=d),d})),'\"')}function qe(){var a=K();return Wb&&!!ic&&11==ic||/Edge\\/\\d+/.test(a)}function re(){return l.window&&l.window.location.href||self&&self.location&&self.location.href||\"\"}function se(a,b){b=b||l.window;var c=\"about:blank\";a&&(c=Eb(Ib(a)||Kb)),b.location.href=c}function xe(a){return!!((a=(a||K()).toLowerCase()).match(/android/)||a.match(/webos/)||a.match(/iphone|ipad|ipod/)||a.match(/blackberry/)||a.match(/windows phone/)||a.match(/iemobile/))}function ye(a){a=a||l.window;try{a.close()}catch(b){}}function ze(a,b,c){var d=Math.floor(1e9*Math.random()).toString();b=b||500,c=c||600;var e=(window.screen.availHeight-c)/2,f=(window.screen.availWidth-b)/2;for(g in b={width:b,height:c,top:0<e?e:0,left:0<f?f:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},c=K().toLowerCase(),d&&(b.target=d,x(c,\"crios/\")&&(b.target=\"_blank\")),ve(K())==Ae&&(a=a||\"http://localhost\",b.scrollbars=!0),c=a||\"\",(a=b)||(a={}),d=window,b=c instanceof C?c:Ib(void 0!==c.href?c.href:String(c))||Kb,c=a.target||c.target,e=[],a)switch(g){case\"width\":case\"height\":case\"top\":case\"left\":e.push(g+\"=\"+a[g]);break;case\"target\":case\"noopener\":case\"noreferrer\":break;default:e.push(g+\"=\"+(a[g]?1:0))}var g=e.join(\",\");if((y(\"iPhone\")&&!y(\"iPod\")&&!y(\"iPad\")||y(\"iPad\")||y(\"iPod\"))&&d.navigator&&d.navigator.standalone&&c&&\"_self\"!=c?(pb(g=oc(document,\"A\"),\"HTMLAnchorElement\"),b=b instanceof C?b:Jb(b),g.href=Eb(b),g.setAttribute(\"target\",c),a.noreferrer&&g.setAttribute(\"rel\",\"noreferrer\"),(a=document.createEvent(\"MouseEvent\")).initMouseEvent(\"click\",!0,!0,d,1),g.dispatchEvent(a),g={}):a.noreferrer?(g=Pb(\"\",d,c,g),a=Eb(b),g&&(Yb&&x(a,\";\")&&(a=\"'\"+a.replace(/'/g,\"%27\")+\"'\"),g.opener=null,a='<meta name=\"referrer\" content=\"no-referrer\"><meta http-equiv=\"refresh\" content=\"0; url='+Rb(a)+'\">',a=new Lb(a=(d=vb())?d.createHTML(a):a,null,Mb),d=g.document)&&(d.write(function(a){return a instanceof Lb&&a.constructor===Lb?a.a:(Ga(\"expected object of type SafeHtml, got '\"+a+\"' of type \"+ma(a)),\"type_error:SafeHtml\")}(a)),d.close())):(g=Pb(b,d,c,g))&&a.noopener&&(g.opener=null),g)try{g.focus()}catch(h){}return g}var Ce=/^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/,De=/^[^@]+@[^@]+$/;function Ee(){var a=null;return new D((function(b){\"complete\"==l.document.readyState?b():(a=function(){b()},od(window,\"load\",a))})).o((function(b){throw xd(window,\"load\",a),b}))}function Ge(a){return a=a||K(),!(\"file:\"!==He()&&\"ionic:\"!==He()||!a.toLowerCase().match(/iphone|ipad|ipod|android/))}function Ie(){var a=l.window;try{return!(!a||a==a.top)}catch(b){return!1}}function Je(){return void 0!==l.WorkerGlobalScope&&\"function\"==typeof l.importScripts}function Ke(){return index_esm.default.INTERNAL.hasOwnProperty(\"reactNative\")?\"ReactNative\":index_esm.default.INTERNAL.hasOwnProperty(\"node\")?\"Node\":Je()?\"Worker\":\"Browser\"}function Le(){var a=Ke();return\"ReactNative\"===a||\"Node\"===a}var Ae=\"Firefox\";function ve(a){var b=a.toLowerCase();return x(b,\"opera/\")||x(b,\"opr/\")||x(b,\"opios/\")?\"Opera\":x(b,\"iemobile\")?\"IEMobile\":x(b,\"msie\")||x(b,\"trident/\")?\"IE\":x(b,\"edge/\")?\"Edge\":x(b,\"firefox/\")?Ae:x(b,\"silk/\")?\"Silk\":x(b,\"blackberry\")?\"Blackberry\":x(b,\"webos\")?\"Webos\":!x(b,\"safari/\")||x(b,\"chrome/\")||x(b,\"crios/\")||x(b,\"android\")?!x(b,\"chrome/\")&&!x(b,\"crios/\")||x(b,\"edge/\")?x(b,\"android\")?\"Android\":(a=a.match(/([a-zA-Z\\d\\.]+)\\/[a-zA-Z\\d\\.]*$/))&&2==a.length?a[1]:\"Other\":\"Chrome\":\"Safari\"}var Ne={md:\"FirebaseCore-web\",od:\"FirebaseUI-web\"};function Oe(a,b){b=b||[];var e,c=[],d={};for(e in Ne)d[Ne[e]]=!0;for(e=0;e<b.length;e++)void 0!==d[b[e]]&&(delete d[b[e]],c.push(b[e]));return c.sort(),(b=c).length||(b=[\"FirebaseCore-web\"]),\"Browser\"===(c=Ke())?c=ve(d=K()):\"Worker\"===c&&(c=ve(d=K())+\"-\"+c),c+\"/JsCore/\"+a+\"/\"+b.join(\",\")}function K(){return l.navigator&&l.navigator.userAgent||\"\"}function L(a,b){a=a.split(\".\"),b=b||l;for(var c=0;c<a.length&&\"object\"==typeof b&&null!=b;c++)b=b[a[c]];return c!=a.length&&(b=void 0),b}function Pe(){try{var a=l.localStorage,b=Qe();if(a)return a.setItem(b,\"1\"),a.removeItem(b),!qe()||!!l.indexedDB}catch(c){return Je()&&!!l.indexedDB}return!1}function Re(){return(Se()||\"chrome-extension:\"===He()||Ge())&&!Le()&&Pe()&&!Je()}function Se(){return\"http:\"===He()||\"https:\"===He()}function He(){return l.location&&l.location.protocol||null}function Te(a){return!xe(a=a||K())&&ve(a)!=Ae}function Ue(a){return void 0===a?null:ke(a)}function Ve(a){var c,b={};for(c in a)a.hasOwnProperty(c)&&null!=a[c]&&(b[c]=a[c]);return b}function We(a){if(null!==a)return JSON.parse(a)}function Qe(a){return a||Math.floor(1e9*Math.random()).toString()}function Xe(a){return\"Safari\"!=ve(a=a||K())&&!a.toLowerCase().match(/iphone|ipad|ipod/)}function Ye(){var a=l.___jsl;if(a&&a.H)for(var b in a.H)if(a.H[b].r=a.H[b].r||[],a.H[b].L=a.H[b].L||[],a.H[b].r=a.H[b].L.concat(),a.CP)for(var c=0;c<a.CP.length;c++)a.CP[c]=null}function Ze(a,b){if(a>b)throw Error(\"Short delay should be less than long delay!\");this.a=a,this.c=b,a=K(),b=Ke(),this.b=xe(a)||\"ReactNative\"===b}function $e(){var a=l.document;return!a||void 0===a.visibilityState||\"visible\"==a.visibilityState}function bf(a){try{var b=new Date(parseInt(a,10));if(!isNaN(b.getTime())&&!/[^0-9]/.test(a))return b.toUTCString()}catch(c){}return null}function cf(){return!(!L(\"fireauth.oauthhelper\",l)&&!L(\"fireauth.iframe\",l))}Ze.prototype.get=function(){var a=l.navigator;return!a||\"boolean\"!=typeof a.onLine||!Se()&&\"chrome-extension:\"!==He()&&void 0===a.connection||a.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var hf,ff={};function gf(a){ff[a]||(ff[a]=!0,\"undefined\"!=typeof console&&\"function\"==typeof console.warn&&console.warn(a))}try{var jf={};Object.defineProperty(jf,\"abcd\",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(jf,\"abcd\",{configurable:!0,enumerable:!0,value:2}),hf=2==jf.abcd}catch(a){hf=!1}function M(a,b,c){hf?Object.defineProperty(a,b,{configurable:!0,enumerable:!0,value:c}):a[b]=c}function N(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&M(a,c,b[c])}function kf(a){var b={};return N(b,a),b}function nf(a){var b=a;if(\"object\"==typeof a&&null!=a)for(var c in b=\"length\"in a?[]:{},a)M(b,c,nf(a[c]));return b}function of(a){var b=a&&(a[pf]?\"phone\":null);if(!(b&&a&&a[qf]))throw new t(\"internal-error\",\"Internal assert: invalid MultiFactorInfo object\");M(this,\"uid\",a[qf]),M(this,\"displayName\",a[rf]||null);var c=null;a[sf]&&(c=new Date(a[sf]).toUTCString()),M(this,\"enrollmentTime\",c),M(this,\"factorId\",b)}function tf(a){try{var b=new uf(a)}catch(c){b=null}return b}of.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var rf=\"displayName\",sf=\"enrolledAt\",qf=\"mfaEnrollmentId\",pf=\"phoneInfo\";function uf(a){of.call(this,a),M(this,\"phoneNumber\",a[pf])}function vf(a){var b={},c=a[wf],d=a[xf],e=a[yf];if(a=tf(a[zf]),!e||e!=Af&&e!=Bf&&!c||e==Bf&&!d||e==Cf&&!a)throw Error(\"Invalid checkActionCode response!\");e==Bf?(b[Df]=c||null,b[Ef]=c||null,b[Ff]=d):(b[Df]=d||null,b[Ef]=d||null,b[Ff]=c||null),b[Gf]=a||null,M(this,Hf,e),M(this,If,nf(b))}r(uf,of),uf.prototype.w=function(){var a=uf.ab.w.call(this);return a.phoneNumber=this.phoneNumber,a};var Cf=\"REVERT_SECOND_FACTOR_ADDITION\",Af=\"EMAIL_SIGNIN\",Bf=\"VERIFY_AND_CHANGE_EMAIL\",wf=\"email\",zf=\"mfaInfo\",xf=\"newEmail\",yf=\"requestType\",Ff=\"email\",Df=\"fromEmail\",Gf=\"multiFactorInfo\",Ef=\"previousEmail\",If=\"data\",Hf=\"operation\";function Jf(a){var b=be(a=J(a),Kf)||null,c=be(a,Lf)||null,d=be(a,Mf)||null;if(d=d&&Nf[d]||null,!b||!c||!d)throw new t(\"argument-error\",Kf+\", \"+Lf+\"and \"+Mf+\" are required in a valid action code URL.\");N(this,{apiKey:b,operation:d,code:c,continueUrl:be(a,Of)||null,languageCode:be(a,Pf)||null,tenantId:be(a,Qf)||null})}var Kf=\"apiKey\",Lf=\"oobCode\",Of=\"continueUrl\",Pf=\"languageCode\",Mf=\"mode\",Qf=\"tenantId\",Nf={recoverEmail:\"RECOVER_EMAIL\",resetPassword:\"PASSWORD_RESET\",revertSecondFactorAddition:Cf,signIn:Af,verifyAndChangeEmail:Bf,verifyEmail:\"VERIFY_EMAIL\"};function Rf(a){try{return new Jf(a)}catch(b){return null}}function Sf(a){var b=a[Tf];if(void 0===b)throw new t(\"missing-continue-uri\");if(\"string\"!=typeof b||\"string\"==typeof b&&!b.length)throw new t(\"invalid-continue-uri\");this.h=b,this.b=this.a=null,this.g=!1;var c=a[Uf];if(c&&\"object\"==typeof c){b=c[Vf];var d=c[Wf];if(c=c[Xf],\"string\"==typeof b&&b.length){if(this.a=b,void 0!==d&&\"boolean\"!=typeof d)throw new t(\"argument-error\",Wf+\" property must be a boolean when specified.\");if(this.g=!!d,void 0!==c&&(\"string\"!=typeof c||\"string\"==typeof c&&!c.length))throw new t(\"argument-error\",Xf+\" property must be a non empty string when specified.\");this.b=c||null}else{if(void 0!==b)throw new t(\"argument-error\",Vf+\" property must be a non empty string when specified.\");if(void 0!==d||void 0!==c)throw new t(\"missing-android-pkg-name\")}}else if(void 0!==c)throw new t(\"argument-error\",Uf+\" property must be a non null object when specified.\");if(this.f=null,(b=a[Yf])&&\"object\"==typeof b){if(\"string\"==typeof(b=b[Zf])&&b.length)this.f=b;else if(void 0!==b)throw new t(\"argument-error\",Zf+\" property must be a non empty string when specified.\")}else if(void 0!==b)throw new t(\"argument-error\",Yf+\" property must be a non null object when specified.\");if(void 0!==(b=a[$f])&&\"boolean\"!=typeof b)throw new t(\"argument-error\",$f+\" property must be a boolean when specified.\");if(this.c=!!b,void 0!==(a=a[ag])&&(\"string\"!=typeof a||\"string\"==typeof a&&!a.length))throw new t(\"argument-error\",ag+\" property must be a non empty string when specified.\");this.i=a||null}var Uf=\"android\",ag=\"dynamicLinkDomain\",$f=\"handleCodeInApp\",Yf=\"iOS\",Tf=\"url\",Wf=\"installApp\",Xf=\"minimumVersion\",Vf=\"packageName\",Zf=\"bundleId\";function bg(a){var b={};for(var c in b.continueUrl=a.h,b.canHandleCodeInApp=a.c,(b.androidPackageName=a.a)&&(b.androidMinimumVersion=a.b,b.androidInstallApp=a.g),b.iOSBundleId=a.f,b.dynamicLinkDomain=a.i,b)null===b[c]&&delete b[c];return b}var dg=null;function hg(a){var b=ig(a);if(!(b&&b.sub&&b.iss&&b.aud&&b.exp))throw Error(\"Invalid JWT\");this.h=a,this.a=b.exp,this.i=b.sub,a=Date.now()/1e3,this.g=b.iat||(a>this.a?this.a:a),this.b=b.provider_id||b.firebase&&b.firebase.sign_in_provider||null,this.f=b.firebase&&b.firebase.tenant||null,this.c=!!b.is_anonymous||\"anonymous\"==this.b}function jg(a){try{return new hg(a)}catch(b){return null}}function ig(a){if(!a)return null;if(3!=(a=a.split(\".\")).length)return null;for(var b=(4-(a=a[1]).length%4)%4,c=0;c<b;c++)a+=\".\";try{var d=function(a){var b=[];return function(a,b){function c(m){for(;d<a.length;){var p=a.charAt(d++),v=dg[p];if(null!=v)return v;if(!/^[\\s\\xa0]*$/.test(p))throw Error(\"Unknown base64 encoding at char: \"+p)}return m}!function(){if(!dg){dg={};for(var a=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\".split(\"\"),b=[\"+/=\",\"+/\",\"-_=\",\"-_.\",\"-_\"],c=0;5>c;c++)for(var d=a.concat(b[c].split(\"\")),e=0;e<d.length;e++){var f=d[e];void 0===dg[f]&&(dg[f]=e)}}}();for(var d=0;;){var e=c(-1),f=c(0),g=c(64),h=c(64);if(64===h&&-1===e)break;b(e<<2|f>>4),64!=g&&(b(f<<4&240|g>>2),64!=h&&b(g<<6&192|h))}}(a,(function(c){b.push(c)})),b}(a);for(a=[],c=b=0;b<d.length;){var e=d[b++];if(128>e)a[c++]=String.fromCharCode(e);else if(191<e&&224>e){var f=d[b++];a[c++]=String.fromCharCode((31&e)<<6|63&f)}else if(239<e&&365>e){f=d[b++];var g=d[b++],m=((7&e)<<18|(63&f)<<12|(63&g)<<6|63&d[b++])-65536;a[c++]=String.fromCharCode(55296+(m>>10)),a[c++]=String.fromCharCode(56320+(1023&m))}else f=d[b++],g=d[b++],a[c++]=String.fromCharCode((15&e)<<12|(63&f)<<6|63&g)}return JSON.parse(a.join(\"\"))}catch(p){}return null}hg.prototype.T=function(){return this.f},hg.prototype.l=function(){return this.c},hg.prototype.toString=function(){return this.h};var kg=\"oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version\".split(\" \"),lg=[\"client_id\",\"response_type\",\"scope\",\"redirect_uri\",\"state\"],mg={nd:{Ja:\"locale\",ua:700,ta:600,fa:\"facebook.com\",Xa:lg},pd:{Ja:null,ua:500,ta:750,fa:\"github.com\",Xa:lg},qd:{Ja:\"hl\",ua:515,ta:680,fa:\"google.com\",Xa:lg},wd:{Ja:\"lang\",ua:485,ta:705,fa:\"twitter.com\",Xa:kg},kd:{Ja:\"locale\",ua:640,ta:600,fa:\"apple.com\",Xa:[]}};function ng(a){for(var b in mg)if(mg[b].fa==a)return mg[b];return null}function og(a){var b={};b[\"facebook.com\"]=pg,b[\"google.com\"]=qg,b[\"github.com\"]=rg,b[\"twitter.com\"]=sg;var c=a&&a[tg];try{if(c)return b[c]?new b[c](a):new ug(a);if(void 0!==a[vg])return new wg(a)}catch(d){}return null}var vg=\"idToken\",tg=\"providerId\";function wg(a){var b=a[tg];if(!b&&a[vg]){var c=jg(a[vg]);c&&c.b&&(b=c.b)}if(!b)throw Error(\"Invalid additional user info!\");\"anonymous\"!=b&&\"custom\"!=b||(b=null),c=!1,void 0!==a.isNewUser?c=!!a.isNewUser:\"identitytoolkit#SignupNewUserResponse\"===a.kind&&(c=!0),M(this,\"providerId\",b),M(this,\"isNewUser\",c)}function ug(a){wg.call(this,a),M(this,\"profile\",nf((a=We(a.rawUserInfo||\"{}\"))||{}))}function pg(a){if(ug.call(this,a),\"facebook.com\"!=this.providerId)throw Error(\"Invalid provider ID!\")}function rg(a){if(ug.call(this,a),\"github.com\"!=this.providerId)throw Error(\"Invalid provider ID!\");M(this,\"username\",this.profile&&this.profile.login||null)}function qg(a){if(ug.call(this,a),\"google.com\"!=this.providerId)throw Error(\"Invalid provider ID!\")}function sg(a){if(ug.call(this,a),\"twitter.com\"!=this.providerId)throw Error(\"Invalid provider ID!\");M(this,\"username\",a.screenName||null)}function xg(a){var b=J(a),c=be(b,\"link\"),d=be(J(c),\"link\");return b=be(b,\"deep_link_id\"),be(J(b),\"link\")||b||d||c||a}function yg(a,b){if(!a&&!b)throw new t(\"internal-error\",\"Internal assert: no raw session string available\");if(a&&b)throw new t(\"internal-error\",\"Internal assert: unable to determine the session type\");this.a=a||null,this.b=b||null,this.type=this.a?zg:Ag}r(ug,wg),r(pg,ug),r(rg,ug),r(qg,ug),r(sg,ug);var zg=\"enroll\",Ag=\"signin\";function Bg(){}function Cg(a,b){return a.then((function(c){if(c[Dg]){var d=jg(c[Dg]);if(!d||b!=d.i)throw new t(\"user-mismatch\");return c}throw new t(\"user-mismatch\")})).o((function(c){throw c&&c.code&&c.code==xa+\"user-not-found\"?new t(\"user-mismatch\"):c}))}function Eg(a,b){if(!b)throw new t(\"internal-error\",\"failed to construct a credential\");this.a=b,M(this,\"providerId\",a),M(this,\"signInMethod\",a)}function Gg(a){return{pendingToken:a.a,requestUri:\"http://localhost\"}}function Jg(a){if(a&&a.providerId&&a.signInMethod&&0==a.providerId.indexOf(\"saml.\")&&a.pendingToken)try{return new Eg(a.providerId,a.pendingToken)}catch(b){}return null}function Kg(a,b,c){if(this.a=null,b.idToken||b.accessToken)b.idToken&&M(this,\"idToken\",b.idToken),b.accessToken&&M(this,\"accessToken\",b.accessToken),b.nonce&&!b.pendingToken&&M(this,\"nonce\",b.nonce),b.pendingToken&&(this.a=b.pendingToken);else{if(!b.oauthToken||!b.oauthTokenSecret)throw new t(\"internal-error\",\"failed to construct a credential\");M(this,\"accessToken\",b.oauthToken),M(this,\"secret\",b.oauthTokenSecret)}M(this,\"providerId\",a),M(this,\"signInMethod\",c)}function Lg(a){var b={};return a.idToken&&(b.id_token=a.idToken),a.accessToken&&(b.access_token=a.accessToken),a.secret&&(b.oauth_token_secret=a.secret),b.providerId=a.providerId,a.nonce&&!a.a&&(b.nonce=a.nonce),b={postBody:fe(b).toString(),requestUri:\"http://localhost\"},a.a&&(delete b.postBody,b.pendingToken=a.a),b}function Mg(a){if(a&&a.providerId&&a.signInMethod){var b={idToken:a.oauthIdToken,accessToken:a.oauthTokenSecret?null:a.oauthAccessToken,oauthTokenSecret:a.oauthTokenSecret,oauthToken:a.oauthTokenSecret&&a.oauthAccessToken,nonce:a.nonce,pendingToken:a.pendingToken};try{return new Kg(a.providerId,b,a.signInMethod)}catch(c){}}return null}function Ng(a,b){this.Qc=b||[],N(this,{providerId:a,isOAuthProvider:!0}),this.Ib={},this.pb=(ng(a)||{}).Ja||null,this.ob=null}function Og(a){if(\"string\"!=typeof a||0!=a.indexOf(\"saml.\"))throw new t(\"argument-error\",'SAML provider IDs must be prefixed with \"saml.\"');Ng.call(this,a,[])}function Pg(a){Ng.call(this,a,lg),this.a=[]}function Qg(){Pg.call(this,\"facebook.com\")}function Rg(a){if(!a)throw new t(\"argument-error\",\"credential failed: expected 1 argument (the OAuth access token).\");var b=a;return n(a)&&(b=a.accessToken),(new Qg).credential({accessToken:b})}function Sg(){Pg.call(this,\"github.com\")}function Tg(a){if(!a)throw new t(\"argument-error\",\"credential failed: expected 1 argument (the OAuth access token).\");var b=a;return n(a)&&(b=a.accessToken),(new Sg).credential({accessToken:b})}function Ug(){Pg.call(this,\"google.com\"),this.Ca(\"profile\")}function Vg(a,b){var c=a;return n(a)&&(c=a.idToken,b=a.accessToken),(new Ug).credential({idToken:c,accessToken:b})}function Wg(){Ng.call(this,\"twitter.com\",kg)}function Xg(a,b){var c=a;if(n(c)||(c={oauthToken:a,oauthTokenSecret:b}),!c.oauthToken||!c.oauthTokenSecret)throw new t(\"argument-error\",\"credential failed: expected 2 arguments (the OAuth access token and secret).\");return new Kg(\"twitter.com\",c,\"twitter.com\")}function Yg(a,b,c){this.a=a,this.f=b,M(this,\"providerId\",\"password\"),M(this,\"signInMethod\",c===Zg.EMAIL_LINK_SIGN_IN_METHOD?Zg.EMAIL_LINK_SIGN_IN_METHOD:Zg.EMAIL_PASSWORD_SIGN_IN_METHOD)}function dh(a){return a&&a.email&&a.password?new Yg(a.email,a.password,a.signInMethod):null}function Zg(){N(this,{providerId:\"password\",isOAuthProvider:!1})}function eh(a,b){if(!(b=fh(b)))throw new t(\"argument-error\",\"Invalid email link!\");return new Yg(a,b.code,Zg.EMAIL_LINK_SIGN_IN_METHOD)}function fh(a){return(a=Rf(a=xg(a)))&&a.operation===Af?a:null}function gh(a){if(!(a.eb&&a.cb||a.La&&a.ea))throw new t(\"internal-error\");this.a=a,M(this,\"providerId\",\"phone\"),this.fa=\"phone\",M(this,\"signInMethod\",\"phone\")}function kh(a){if(a&&\"phone\"===a.providerId&&(a.verificationId&&a.verificationCode||a.temporaryProof&&a.phoneNumber)){var b={};return w([\"verificationId\",\"verificationCode\",\"temporaryProof\",\"phoneNumber\"],(function(c){a[c]&&(b[c]=a[c])})),new gh(b)}return null}function hh(a){return a.a.La&&a.a.ea?{temporaryProof:a.a.La,phoneNumber:a.a.ea}:{sessionInfo:a.a.eb,code:a.a.cb}}function lh(a){try{this.a=a||index_esm.default.auth()}catch(b){throw new t(\"argument-error\",\"Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().\")}N(this,{providerId:\"phone\",isOAuthProvider:!1})}function ph(a,b){if(!a)throw new t(\"missing-verification-id\");if(!b)throw new t(\"missing-verification-code\");return new gh({eb:a,cb:b})}function qh(a){if(a.temporaryProof&&a.phoneNumber)return new gh({La:a.temporaryProof,ea:a.phoneNumber});var b=a&&a.providerId;if(!b||\"password\"===b)return null;var c=a&&a.oauthAccessToken,d=a&&a.oauthTokenSecret,e=a&&a.nonce,f=a&&a.oauthIdToken,g=a&&a.pendingToken;try{switch(b){case\"google.com\":return Vg(f,c);case\"facebook.com\":return Rg(c);case\"github.com\":return Tg(c);case\"twitter.com\":return Xg(c,d);default:return c||d||f||g?g?0==b.indexOf(\"saml.\")?new Eg(b,g):new Kg(b,{pendingToken:g,idToken:a.oauthIdToken,accessToken:a.oauthAccessToken},b):new Pg(b).credential({idToken:f,accessToken:c,rawNonce:e}):null}}catch(h){return null}}function rh(a){if(!a.isOAuthProvider)throw new t(\"invalid-oauth-provider\")}function sh(a,b,c,d,e,f,g){if(this.c=a,this.b=b||null,this.g=c||null,this.f=d||null,this.i=f||null,this.h=g||null,this.a=e||null,!this.g&&!this.a)throw new t(\"invalid-auth-event\");if(this.g&&this.a)throw new t(\"invalid-auth-event\");if(this.g&&!this.f)throw new t(\"invalid-auth-event\")}function th(a){return(a=a||{}).type?new sh(a.type,a.eventId,a.urlResponse,a.sessionId,a.error&&Aa(a.error),a.postBody,a.tenantId):null}function uh(){this.b=null,this.a=[]}yg.prototype.Ha=function(){return E(this.a?this.a:this.b)},yg.prototype.w=function(){return this.type==zg?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},Bg.prototype.ka=function(){},Bg.prototype.b=function(){},Bg.prototype.c=function(){},Bg.prototype.w=function(){},Eg.prototype.ka=function(a){return Fg(a,Gg(this))},Eg.prototype.b=function(a,b){var c=Gg(this);return c.idToken=b,Hg(a,c)},Eg.prototype.c=function(a,b){return Cg(Ig(a,Gg(this)),b)},Eg.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},Kg.prototype.ka=function(a){return Fg(a,Lg(this))},Kg.prototype.b=function(a,b){var c=Lg(this);return c.idToken=b,Hg(a,c)},Kg.prototype.c=function(a,b){return Cg(Ig(a,Lg(this)),b)},Kg.prototype.w=function(){var a={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(a.oauthIdToken=this.idToken),this.accessToken&&(a.oauthAccessToken=this.accessToken),this.secret&&(a.oauthTokenSecret=this.secret),this.nonce&&(a.nonce=this.nonce),this.a&&(a.pendingToken=this.a),a},Ng.prototype.Ka=function(a){return this.Ib=nb(a),this},r(Og,Ng),r(Pg,Ng),Pg.prototype.Ca=function(a){return Va(this.a,a)||this.a.push(a),this},Pg.prototype.Qb=function(){return Za(this.a)},Pg.prototype.credential=function(a,b){var c;if(!(c=n(a)?{idToken:a.idToken||null,accessToken:a.accessToken||null,nonce:a.rawNonce||null}:{idToken:a||null,accessToken:b||null}).idToken&&!c.accessToken)throw new t(\"argument-error\",\"credential failed: must provide the ID token and/or the access token.\");return new Kg(this.providerId,c,this.providerId)},r(Qg,Pg),M(Qg,\"PROVIDER_ID\",\"facebook.com\"),M(Qg,\"FACEBOOK_SIGN_IN_METHOD\",\"facebook.com\"),r(Sg,Pg),M(Sg,\"PROVIDER_ID\",\"github.com\"),M(Sg,\"GITHUB_SIGN_IN_METHOD\",\"github.com\"),r(Ug,Pg),M(Ug,\"PROVIDER_ID\",\"google.com\"),M(Ug,\"GOOGLE_SIGN_IN_METHOD\",\"google.com\"),r(Wg,Ng),M(Wg,\"PROVIDER_ID\",\"twitter.com\"),M(Wg,\"TWITTER_SIGN_IN_METHOD\",\"twitter.com\"),Yg.prototype.ka=function(a){return this.signInMethod==Zg.EMAIL_LINK_SIGN_IN_METHOD?O(a,$g,{email:this.a,oobCode:this.f}):O(a,ah,{email:this.a,password:this.f})},Yg.prototype.b=function(a,b){return this.signInMethod==Zg.EMAIL_LINK_SIGN_IN_METHOD?O(a,bh,{idToken:b,email:this.a,oobCode:this.f}):O(a,ch,{idToken:b,email:this.a,password:this.f})},Yg.prototype.c=function(a,b){return Cg(this.ka(a),b)},Yg.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},N(Zg,{PROVIDER_ID:\"password\"}),N(Zg,{EMAIL_LINK_SIGN_IN_METHOD:\"emailLink\"}),N(Zg,{EMAIL_PASSWORD_SIGN_IN_METHOD:\"password\"}),gh.prototype.ka=function(a){return a.fb(hh(this))},gh.prototype.b=function(a,b){var c=hh(this);return c.idToken=b,O(a,ih,c)},gh.prototype.c=function(a,b){var c=hh(this);return c.operation=\"REAUTH\",Cg(a=O(a,jh,c),b)},gh.prototype.w=function(){var a={providerId:\"phone\"};return this.a.eb&&(a.verificationId=this.a.eb),this.a.cb&&(a.verificationCode=this.a.cb),this.a.La&&(a.temporaryProof=this.a.La),this.a.ea&&(a.phoneNumber=this.a.ea),a},lh.prototype.fb=function(a,b){var c=this.a.a;return E(b.verify()).then((function(d){if(\"string\"!=typeof d)throw new t(\"argument-error\",\"An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.\");switch(b.type){case\"recaptcha\":var e=n(a)?a.session:null,f=n(a)?a.phoneNumber:a;return(e&&e.type==zg?e.Ha().then((function(h){return function(a,b){return O(a,oj,b).then((function(c){return c.phoneSessionInfo.sessionInfo}))}(c,{idToken:h,phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:d}})})):e&&e.type==Ag?e.Ha().then((function(h){return function(a,b){return O(a,qj,b).then((function(c){return c.phoneResponseInfo.sessionInfo}))}(c,{mfaPendingCredential:h,mfaEnrollmentId:a.multiFactorHint&&a.multiFactorHint.uid||a.multiFactorUid,phoneSignInInfo:{recaptchaToken:d}})})):function(a,b){return O(a,mj,b)}(c,{phoneNumber:f,recaptchaToken:d})).then((function(h){return\"function\"==typeof b.reset&&b.reset(),h}),(function(h){throw\"function\"==typeof b.reset&&b.reset(),h}));default:throw new t(\"argument-error\",'Only firebase.auth.ApplicationVerifiers with type=\"recaptcha\" are currently supported.')}}))},N(lh,{PROVIDER_ID:\"phone\"}),N(lh,{PHONE_SIGN_IN_METHOD:\"phone\"}),sh.prototype.getUid=function(){var a=[];return a.push(this.c),this.b&&a.push(this.b),this.f&&a.push(this.f),this.h&&a.push(this.h),a.join(\"-\")},sh.prototype.T=function(){return this.h},sh.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Ch,vh=null;function xh(a){var b=\"unauthorized-domain\",c=void 0,d=J(a);a=d.a,\"chrome-extension\"==(d=d.c)?c=Qb(\"This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.\",a):\"http\"==d||\"https\"==d?c=Qb(\"This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.\",a):b=\"operation-not-supported-in-this-environment\",t.call(this,b,c)}function yh(a,b,c){t.call(this,a,c),(a=b||{}).Jb&&M(this,\"email\",a.Jb),a.ea&&M(this,\"phoneNumber\",a.ea),a.credential&&M(this,\"credential\",a.credential),a.Zb&&M(this,\"tenantId\",a.Zb)}function zh(a){if(a.code){var b=a.code||\"\";0==b.indexOf(xa)&&(b=b.substring(xa.length));var c={credential:qh(a),Zb:a.tenantId};if(a.email)c.Jb=a.email;else if(a.phoneNumber)c.ea=a.phoneNumber;else if(!c.credential)return new t(b,a.message||void 0);return new yh(b,c,a.message)}return null}function Ah(){}function Dh(){}function Eh(a){if(!a.f&&\"undefined\"==typeof XMLHttpRequest&&\"undefined\"!=typeof ActiveXObject){for(var b=[\"MSXML2.XMLHTTP.6.0\",\"MSXML2.XMLHTTP.3.0\",\"MSXML2.XMLHTTP\",\"Microsoft.XMLHTTP\"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.f=d}catch(e){}}throw Error(\"Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed\")}return a.f}function Fh(){}function Gh(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response=\"\",this.status=-1,this.statusText=\"\",this.a.onload=q(this.qc,this),this.a.onerror=q(this.Sb,this),this.a.onprogress=q(this.rc,this),this.a.ontimeout=q(this.vc,this)}function Hh(a,b){a.readyState=b,a.onreadystatechange&&a.onreadystatechange()}function Ih(a,b,c){this.reset(a,b,c,void 0,void 0)}function Kh(a){this.f=a,this.b=this.c=this.a=null}function Lh(a,b){this.name=a,this.value=b}r(xh,t),r(yh,t),yh.prototype.w=function(){var a={code:this.code,message:this.message};this.email&&(a.email=this.email),this.phoneNumber&&(a.phoneNumber=this.phoneNumber),this.tenantId&&(a.tenantId=this.tenantId);var b=this.credential&&this.credential.w();return b&&z(a,b),a},yh.prototype.toJSON=function(){return this.w()},Ah.prototype.c=null,r(Dh,Ah),Dh.prototype.a=function(){var a=Eh(this);return a?new ActiveXObject(a):new XMLHttpRequest},Dh.prototype.b=function(){var a={};return Eh(this)&&(a[0]=!0,a[1]=!0),a},Ch=new Dh,r(Fh,Ah),Fh.prototype.a=function(){var a=new XMLHttpRequest;if(\"withCredentials\"in a)return a;if(\"undefined\"!=typeof XDomainRequest)return new Gh;throw Error(\"Unsupported browser\")},Fh.prototype.b=function(){return{}},(k=Gh.prototype).open=function(a,b,c){if(null!=c&&!c)throw Error(\"Only async requests are supported.\");this.a.open(a,b)},k.send=function(a){if(a){if(\"string\"!=typeof a)throw Error(\"Only string data is supported\");this.a.send(a)}else this.a.send()},k.abort=function(){this.a.abort()},k.setRequestHeader=function(){},k.getResponseHeader=function(a){return\"content-type\"==a.toLowerCase()?this.a.contentType:\"\"},k.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Hh(this,4)},k.Sb=function(){this.status=500,this.response=this.responseText=\"\",Hh(this,4)},k.vc=function(){this.Sb()},k.rc=function(){this.status=200,Hh(this,1)},k.getAllResponseHeaders=function(){return\"content-type: \"+this.a.contentType},Ih.prototype.a=null,Ih.prototype.reset=function(a,b,c,d,e){d||va(),delete this.a},Lh.prototype.toString=function(){return this.name};var Mh=new Lh(\"SEVERE\",1e3),Nh=new Lh(\"WARNING\",900),Oh=new Lh(\"CONFIG\",700),Ph=new Lh(\"FINE\",500);Kh.prototype.log=function(a,b,c){if(a.value>=function Qh(a){return a.c?a.c:a.a?Qh(a.a):(Ga(\"Root logger has no level set.\"),null)}(this).value)for(oa(b)&&(b=b()),a=new Ih(a,String(b),this.f),c&&(a.a=c),c=this;c;)c=c.a};var Rh={},Sh=null;function Th(a){var b;if(Sh||(Sh=new Kh(\"\"),Rh[\"\"]=Sh,Sh.c=Oh),!(b=Rh[a])){b=new Kh(a);var c=a.lastIndexOf(\".\"),d=a.substr(c+1);(c=Th(a.substr(0,c))).b||(c.b={}),c.b[d]=b,b.a=c,Rh[a]=b}return b}function Uh(a,b){a&&a.log(Ph,b,void 0)}function Vh(a){this.f=a}function Wh(a){H.call(this),this.u=a,this.h=void 0,this.readyState=Xh,this.status=0,this.responseType=this.responseText=this.response=this.statusText=\"\",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s=\"GET\",this.f=\"\",this.a=!1,this.i=Th(\"goog.net.FetchXmlHttp\"),this.m=this.c=this.g=null}r(Vh,Ah),Vh.prototype.a=function(){return new Wh(this.f)},Vh.prototype.b=function(a){return function(){return a}}({}),r(Wh,H);var Xh=0;function $h(a){a.c.read().then(a.pc.bind(a)).catch(a.Ua.bind(a))}function Zh(a){a.readyState=4,a.g=null,a.c=null,a.m=null,Yh(a)}function Yh(a){a.onreadystatechange&&a.onreadystatechange.call(a)}function ai(a){H.call(this),this.headers=new Jd,this.D=a||null,this.c=!1,this.C=this.a=null,this.h=this.R=this.l=\"\",this.f=this.O=this.i=this.J=!1,this.g=0,this.s=null,this.m=bi,this.u=this.S=!1}(k=Wh.prototype).open=function(a,b){if(this.readyState!=Xh)throw this.abort(),Error(\"Error reopening a connection\");this.s=a,this.f=b,this.readyState=1,Yh(this)},k.send=function(a){if(1!=this.readyState)throw this.abort(),Error(\"need to call open() first. \");this.a=!0;var b={headers:this.l,method:this.s,credentials:this.h,cache:void 0};a&&(b.body=a),this.u.fetch(new Request(this.f,b)).then(this.uc.bind(this),this.Ua.bind(this))},k.abort=function(){this.response=this.responseText=\"\",this.l=new Headers,this.status=0,this.c&&this.c.cancel(\"Request was aborted.\"),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Zh(this)),this.readyState=Xh},k.uc=function(a){this.a&&(this.g=a,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=a.headers,this.readyState=2,Yh(this)),this.a&&(this.readyState=3,Yh(this),this.a&&(\"arraybuffer\"===this.responseType?a.arrayBuffer().then(this.sc.bind(this),this.Ua.bind(this)):void 0!==l.ReadableStream&&\"body\"in a?(this.response=this.responseText=\"\",this.c=a.body.getReader(),this.m=new TextDecoder,$h(this)):a.text().then(this.tc.bind(this),this.Ua.bind(this)))))},k.pc=function(a){if(this.a){var b=this.m.decode(a.value?a.value:new Uint8Array(0),{stream:!a.done});b&&(this.response=this.responseText+=b),a.done?Zh(this):Yh(this),3==this.readyState&&$h(this)}},k.tc=function(a){this.a&&(this.response=this.responseText=a,Zh(this))},k.sc=function(a){this.a&&(this.response=a,Zh(this))},k.Ua=function(a){var b=this.i;b&&b.log(Nh,\"Failed to fetch url \"+this.f,a instanceof Error?a:Error(a)),this.a&&Zh(this)},k.setRequestHeader=function(a,b){this.l.append(a,b)},k.getResponseHeader=function(a){return this.b?this.b.get(a.toLowerCase())||\"\":((a=this.i)&&a.log(Nh,\"Attempting to get response header but no headers have been received for url: \"+this.f,void 0),\"\")},k.getAllResponseHeaders=function(){if(!this.b){var a=this.i;return a&&a.log(Nh,\"Attempting to get all response headers but no headers have been received for url: \"+this.f,void 0),\"\"}a=[];for(var b=this.b.entries(),c=b.next();!c.done;)a.push((c=c.value)[0]+\": \"+c[1]),c=b.next();return a.join(\"\\r\\n\")},Object.defineProperty(Wh.prototype,\"withCredentials\",{get:function(){return\"include\"===this.h},set:function(a){this.h=a?\"include\":\"same-origin\"}}),r(ai,H);var bi=\"\";ai.prototype.b=Th(\"goog.net.XhrIo\");var ci=/^https?$/i,di=[\"POST\",\"PUT\"];function Ua(a){return\"content-type\"==a.toLowerCase()}function gi(a,b){a.c=!1,a.a&&(a.f=!0,a.a.abort(),a.f=!1),a.h=b,ji(a),ki(a)}function ji(a){a.J||(a.J=!0,a.dispatchEvent(\"complete\"),a.dispatchEvent(\"error\"))}function li(a){if(a.c&&void 0!==ha)if(a.C[1]&&4==mi(a)&&2==ni(a))Uh(a.b,fi(a,\"Local request error detected and ignored\"));else if(a.i&&4==mi(a))Ed(a.Vb,0,a);else if(a.dispatchEvent(\"readystatechange\"),4==mi(a)){Uh(a.b,fi(a,\"Request complete\")),a.c=!1;try{var d,b=ni(a);a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break a;default:c=!1}if(!(d=c)){var e;if(e=0===b){var f=String(a.l).match(Md)[1]||null;if(!f&&l.self&&l.self.location){var g=l.self.location.protocol;f=g.substr(0,g.length-1)}e=!ci.test(f?f.toLowerCase():\"\")}d=e}if(d)a.dispatchEvent(\"complete\"),a.dispatchEvent(\"success\");else{try{var h=2<mi(a)?a.a.statusText:\"\"}catch(m){Uh(a.b,\"Can not get status: \"+m.message),h=\"\"}a.h=h+\" [\"+ni(a)+\"]\",ji(a)}}finally{ki(a)}}}function ki(a,b){if(a.a){hi(a);var c=a.a,d=a.C[0]?la:null;a.a=null,a.C=null,b||a.dispatchEvent(\"ready\");try{c.onreadystatechange=d}catch(e){(a=a.b)&&a.log(Mh,\"Problem encountered resetting onreadystatechange: \"+e.message,void 0)}}}function hi(a){a.a&&a.u&&(a.a.ontimeout=null),a.s&&(l.clearTimeout(a.s),a.s=null)}function mi(a){return a.a?a.a.readyState:0}function ni(a){try{return 2<mi(a)?a.a.status:-1}catch(b){return-1}}function fi(a,b){return b+\" [\"+a.R+\" \"+a.l+\" \"+ni(a)+\"]\"}function pi(a){var b=qi;this.g=[],this.u=b,this.s=a||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function ti(a,b,c){a.a=!0,a.c=c,a.f=!b,ui(a)}function si(a){if(a.a){if(!a.v)throw new vi(a);a.v=!1}}function xi(a,b,c,d){a.g.push([b,c,d]),a.a&&ui(a)}function yi(a){return Sa(a.g,(function(b){return oa(b[1])}))}function ui(a){if(a.h&&a.a&&yi(a)){var b=a.h,c=zi[b];c&&(l.clearTimeout(c.a),delete zi[b]),a.h=0}a.b&&(a.b.l--,delete a.b),b=a.c;for(var d=c=!1;a.g.length&&!a.i;){var e=a.g.shift(),f=e[0],g=e[1];if(e=e[2],f=a.f?g:f)try{var h=f.call(e||a.s,b);void 0!==h&&(a.f=a.f&&(h==b||h instanceof Error),a.c=b=h),(Ea(b)||\"function\"==typeof l.Promise&&b instanceof l.Promise)&&(d=!0,a.i=!0)}catch(m){b=m,a.f=!0,yi(a)||(c=!0)}}a.c=b,d&&(h=q(a.m,a,!0),d=q(a.m,a,!1),b instanceof pi?(xi(b,h,d),b.C=!0):b.then(h,d)),c&&(b=new Ai(b),zi[b.a]=b,a.h=b.a)}function vi(){u.call(this)}function ri(){u.call(this)}function Ai(a){this.a=l.setTimeout(q(this.c,this),0),this.b=a}(k=ai.prototype).Ma=function(){void 0!==ha&&this.a&&(this.h=\"Timed out after \"+this.g+\"ms, aborting\",Uh(this.b,fi(this,this.h)),this.dispatchEvent(\"timeout\"),this.abort(8))},k.abort=function(){this.a&&this.c&&(Uh(this.b,fi(this,\"Aborting\")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent(\"complete\"),this.dispatchEvent(\"abort\"),ki(this))},k.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ki(this,!0)),ai.ab.Da.call(this)},k.Vb=function(){this.xa||(this.O||this.i||this.f?li(this):this.Jc())},k.Jc=function(){li(this)},k.getResponse=function(){try{if(!this.a)return null;if(\"response\"in this.a)return this.a.response;switch(this.m){case bi:case\"text\":return this.a.responseText;case\"arraybuffer\":if(\"mozResponseArrayBuffer\"in this.a)return this.a.mozResponseArrayBuffer}var a=this.b;return a&&a.log(Mh,\"Response type \"+this.m+\" is not supported on this browser\",void 0),null}catch(b){return Uh(this.b,\"Can not get response: \"+b.message),null}},pi.prototype.cancel=function(a){if(this.a)this.c instanceof pi&&this.c.cancel();else{if(this.b){var b=this.b;delete this.b,a?b.cancel(a):(b.l--,0>=b.l&&b.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(a=new ri(this),si(this),ti(this,!1,a))}},pi.prototype.m=function(a,b){this.i=!1,ti(this,a,b)},pi.prototype.then=function(a,b,c){var d,e,f=new D((function(g,h){d=g,e=h}));return xi(this,d,(function(g){g instanceof ri?f.cancel():e(g)})),f.then(a,b,c)},pi.prototype.$goog_Thenable=!0,r(vi,u),vi.prototype.message=\"Deferred has already fired\",vi.prototype.name=\"AlreadyCalledError\",r(ri,u),ri.prototype.message=\"Deferred was canceled\",ri.prototype.name=\"CanceledError\",Ai.prototype.c=function(){throw delete zi[this.a],this.b};var zi={};function Bi(a){var b={},c=b.document||document,d=yb(a).toString(),e=oc(document,\"SCRIPT\"),f={Wb:e,Ma:void 0},g=new pi(f),h=null,m=null!=b.timeout?b.timeout:5e3;return 0<m&&(h=window.setTimeout((function(){Ci(e,!0);var p=new Di(Ei,\"Timeout reached for loading script \"+d);si(g),ti(g,!1,p)}),m),f.Ma=h),e.onload=e.onreadystatechange=function(){e.readyState&&\"loaded\"!=e.readyState&&\"complete\"!=e.readyState||(Ci(e,b.xd||!1,h),si(g),ti(g,!0,null))},e.onerror=function(){Ci(e,!0,h);var p=new Di(Fi,\"Error while loading script \"+d);si(g),ti(g,!1,p)},z(f=b.attributes||{},{type:\"text/javascript\",charset:\"UTF-8\"}),lc(e,f),function(a,b){pb(a,\"HTMLScriptElement\"),a.src=yb(b),(b=a.ownerDocument&&a.ownerDocument.defaultView)&&b!=l?b=ka(b.document):(null===ja&&(ja=ka(l.document)),b=ja),b&&a.setAttribute(\"nonce\",b)}(e,a),function(a){var b;return(b=(a||document).getElementsByTagName(\"HEAD\"))&&0!=b.length?b[0]:a.documentElement}(c).appendChild(e),g}function qi(){if(this&&this.Wb){var a=this.Wb;a&&\"SCRIPT\"==a.tagName&&Ci(a,!0,this.Ma)}}function Ci(a,b,c){null!=c&&l.clearTimeout(c),a.onload=la,a.onerror=la,a.onreadystatechange=la,b&&window.setTimeout((function(){a&&a.parentNode&&a.parentNode.removeChild(a)}),0)}var Fi=0,Ei=1;function Di(a,b){var c=\"Jsloader error (code #\"+a+\")\";b&&(c+=\": \"+b),u.call(this,c),this.code=a}function Hi(a){this.f=a}function Ii(a,b,c){if(this.c=a,this.l=(a=b||{}).secureTokenEndpoint||\"https://securetoken.googleapis.com/v1/token\",this.m=a.secureTokenTimeout||Ji,this.g=nb(a.secureTokenHeaders||Ki),this.h=a.firebaseEndpoint||\"https://www.googleapis.com/identitytoolkit/v3/relyingparty/\",this.i=a.identityPlatformEndpoint||\"https://identitytoolkit.googleapis.com/v2/\",this.v=a.firebaseTimeout||Li,this.a=nb(a.firebaseHeaders||Mi),c&&(this.a[\"X-Client-Version\"]=c,this.g[\"X-Client-Version\"]=c),c=\"Node\"==Ke(),!(c=l.XMLHttpRequest||c&&index_esm.default.INTERNAL.node&&index_esm.default.INTERNAL.node.XMLHttpRequest)&&!Je())throw new t(\"internal-error\",\"The XMLHttpRequest compatibility library was not found.\");this.f=void 0,this.f=Je()?new Vh(self):Le()?new Hi(c):new Fh,this.b=null}r(Di,u),r(Hi,Ah),Hi.prototype.a=function(){return new this.f},Hi.prototype.b=function(){return{}};var Ni,Dg=\"idToken\",Ji=new Ze(3e4,6e4),Ki={\"Content-Type\":\"application/x-www-form-urlencoded\"},Li=new Ze(3e4,6e4),Mi={\"Content-Type\":\"application/json\"};function Oi(a,b){b?a.a[\"X-Firebase-Locale\"]=b:delete a.a[\"X-Firebase-Locale\"]}function Pi(a,b){b&&(a.l=Qi(\"https://securetoken.googleapis.com/v1/token\",b),a.h=Qi(\"https://www.googleapis.com/identitytoolkit/v3/relyingparty/\",b),a.i=Qi(\"https://identitytoolkit.googleapis.com/v2/\",b))}function Qi(a,b){return a=J(a),b=J(b.url),a.f=a.a+a.f,Pd(a,b.c),a.a=b.a,Qd(a,b.g),a.toString()}function Ri(a,b){b?(a.a[\"X-Client-Version\"]=b,a.g[\"X-Client-Version\"]=b):(delete a.a[\"X-Client-Version\"],delete a.g[\"X-Client-Version\"])}function Si(a,b,c,d,e,f,g){(function(){var a=K();return!((a=\"Chrome\"!=ve(a)?null:(a=a.match(/\\sChrome\\/(\\d+)/i))&&2==a.length?parseInt(a[1],10):null)&&30>a||Wb&&ic&&!(9<ic))})()||Je()?a=q(a.u,a):(Ni||(Ni=new D((function(h,m){!function(a,b){((window.gapi||{}).client||{}).request?a():(l[Vi]=function(){((window.gapi||{}).client||{}).request?a():b(Error(\"CORS_UNSUPPORTED\"))},function(a,b){xi(a,null,b,void 0)}(Bi(zb(Ui,{onload:Vi})),(function(){b(Error(\"CORS_UNSUPPORTED\"))})))}(h,m)}))),a=q(a.s,a)),a(b,c,d,e,f,g)}Ii.prototype.T=function(){return this.b},Ii.prototype.u=function(a,b,c,d,e,f){if(Je()&&(void 0===l.fetch||void 0===l.Headers||void 0===l.Request))throw new t(\"operation-not-supported-in-this-environment\",\"fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.\");var g=new ai(this.f);if(f){g.g=Math.max(0,f);var h=setTimeout((function(){g.dispatchEvent(\"timeout\")}),f)}qd(g,\"complete\",(function(){h&&clearTimeout(h);var m=null;try{m=JSON.parse(function(a){try{return a.a?a.a.responseText:\"\"}catch(b){return Uh(a.b,\"Can not get responseText: \"+b.message),\"\"}}(this))||null}catch(p){m=null}b&&b(m)})),wd(g,\"ready\",(function(){h&&clearTimeout(h),Xc(this)})),wd(g,\"timeout\",(function(){h&&clearTimeout(h),Xc(this),b&&b(null)})),function(a,b,c,d,e){if(a.a)throw Error(\"[goog.net.XhrIo] Object is active with another request=\"+a.l+\"; newUri=\"+b);c=c?c.toUpperCase():\"GET\",a.l=b,a.h=\"\",a.R=c,a.J=!1,a.c=!0,a.a=a.D?a.D.a():Ch.a(),a.C=function(a){return a.c||(a.c=a.b())}(a.D?a.D:Ch),a.a.onreadystatechange=q(a.Vb,a);try{Uh(a.b,fi(a,\"Opening Xhr\")),a.O=!0,a.a.open(c,String(b),!0),a.O=!1}catch(g){return Uh(a.b,fi(a,\"Error opening Xhr: \"+g.message)),void gi(a,g)}b=d||\"\";var f=new Jd(a.headers);e&&function(a,b){if(a.forEach&&\"function\"==typeof a.forEach)a.forEach(b,void 0);else if(na(a)||\"string\"==typeof a)w(a,b,void 0);else for(var c=Hd(a),d=Gd(a),e=d.length,f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}(e,(function(g,h){f.set(h,g)})),e=function(a){a:{for(var b=Ua,c=a.length,d=\"string\"==typeof a?a.split(\"\"):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:\"string\"==typeof a?a.charAt(b):a[b]}(f.Y()),d=l.FormData&&b instanceof l.FormData,!Va(di,c)||e||d||f.set(\"Content-Type\",\"application/x-www-form-urlencoded;charset=utf-8\"),f.forEach((function(g,h){this.a.setRequestHeader(h,g)}),a),a.m&&(a.a.responseType=a.m),\"withCredentials\"in a.a&&a.a.withCredentials!==a.S&&(a.a.withCredentials=a.S);try{hi(a),0<a.g&&(a.u=function(a){return Wb&&fc(9)&&\"number\"==typeof a.timeout&&void 0!==a.ontimeout}(a.a),Uh(a.b,fi(a,\"Will abort after \"+a.g+\"ms if incomplete, xhr2 \"+a.u)),a.u?(a.a.timeout=a.g,a.a.ontimeout=q(a.Ma,a)):a.s=Ed(a.Ma,a.g,a)),Uh(a.b,fi(a,\"Sending request\")),a.i=!0,a.a.send(b),a.i=!1}catch(g){Uh(a.b,fi(a,\"Send error: \"+g.message)),gi(a,g)}}(g,a,c,d,e)};var Ui=new qb(rb,\"https://apis.google.com/js/client.js?onload=%{onload}\"),Vi=\"__fcb\"+Math.floor(1e6*Math.random()).toString();function Zi(a){if(\"string\"!=typeof(a=a.email)||!De.test(a))throw new t(\"invalid-email\")}function $i(a){\"email\"in a&&Zi(a)}function P(a){if(!a[Dg]){if(a.mfaPendingCredential)throw new t(\"multi-factor-auth-required\",null,nb(a));throw new t(\"internal-error\")}}function ej(a){if(a.phoneNumber||a.temporaryProof){if(!a.phoneNumber||!a.temporaryProof)throw new t(\"internal-error\")}else{if(!a.sessionInfo)throw new t(\"missing-verification-id\");if(!a.code)throw new t(\"missing-verification-code\")}}Ii.prototype.s=function(a,b,c,d,e){var f=this;Ni.then((function(){window.gapi.client.setApiKey(f.c);var g=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:a,method:c,body:d,headers:e,authType:\"none\",callback:function(h){window.gapi.auth.setToken(g),b&&b(h)}})})).o((function(g){b&&b({error:{message:g&&g.message||\"CORS_UNSUPPORTED\"}})}))},Ii.prototype.zb=function(){return O(this,fj,{})},Ii.prototype.Bb=function(a,b){return O(this,gj,{idToken:a,email:b})},Ii.prototype.Cb=function(a,b){return O(this,ch,{idToken:a,password:b})};var hj={displayName:\"DISPLAY_NAME\",photoUrl:\"PHOTO_URL\"};function pj(a){if(!a.phoneVerificationInfo)throw new t(\"internal-error\");if(!a.phoneVerificationInfo.sessionInfo)throw new t(\"missing-verification-id\");if(!a.phoneVerificationInfo.code)throw new t(\"missing-verification-code\")}function tj(a){if(!a.requestUri||!a.sessionId&&!a.postBody&&!a.pendingToken)throw new t(\"internal-error\")}function uj(a,b){return b.oauthIdToken&&b.providerId&&0==b.providerId.indexOf(\"oidc.\")&&!b.pendingToken&&(a.sessionId?b.nonce=a.sessionId:a.postBody&&je(a=new Ud(a.postBody),\"nonce\")&&(b.nonce=a.get(\"nonce\"))),b}function vj(a){var b=null;if(a.needConfirmation?(a.code=\"account-exists-with-different-credential\",b=zh(a)):\"FEDERATED_USER_ID_ALREADY_LINKED\"==a.errorMessage?(a.code=\"credential-already-in-use\",b=zh(a)):\"EMAIL_EXISTS\"==a.errorMessage?(a.code=\"email-already-in-use\",b=zh(a)):a.errorMessage&&(b=wj(a.errorMessage)),b)throw b;P(a)}function Fg(a,b){return b.returnIdpCredential=!0,O(a,xj,b)}function Hg(a,b){return b.returnIdpCredential=!0,O(a,yj,b)}function Ig(a,b){return b.returnIdpCredential=!0,b.autoCreate=!1,O(a,zj,b)}function Aj(a){if(!a.oobCode)throw new t(\"invalid-action-code\")}(k=Ii.prototype).Db=function(a,b){var c={idToken:a},d=[];return lb(hj,(function(e,f){var g=b[f];null===g?d.push(e):f in b&&(c[f]=g)})),d.length&&(c.deleteAttribute=d),O(this,gj,c)},k.vb=function(a,b){return z(a={requestType:\"PASSWORD_RESET\",email:a},b),O(this,ij,a)},k.wb=function(a,b){return z(a={requestType:\"EMAIL_SIGNIN\",email:a},b),O(this,jj,a)},k.ub=function(a,b){return z(a={requestType:\"VERIFY_EMAIL\",idToken:a},b),O(this,kj,a)},k.Eb=function(a,b,c){return z(a={requestType:\"VERIFY_AND_CHANGE_EMAIL\",idToken:a,newEmail:b},c),O(this,lj,a)},k.fb=function(a){return O(this,nj,a)},k.nb=function(a,b){return O(this,Bj,{oobCode:a,newPassword:b})},k.Ra=function(a){return O(this,Cj,{oobCode:a})},k.jb=function(a){return O(this,Dj,{oobCode:a})};var Dj={endpoint:\"setAccountInfo\",A:Aj,Z:\"email\",B:!0},Cj={endpoint:\"resetPassword\",A:Aj,G:function(a){var b=a.requestType;if(!b||!a.email&&\"EMAIL_SIGNIN\"!=b&&\"VERIFY_AND_CHANGE_EMAIL\"!=b)throw new t(\"internal-error\")},B:!0},Ej={endpoint:\"signupNewUser\",A:function(a){if(Zi(a),!a.password)throw new t(\"weak-password\")},G:P,V:!0,B:!0},bj={endpoint:\"createAuthUri\",B:!0},Fj={endpoint:\"deleteAccount\",N:[\"idToken\"]},sj={endpoint:\"setAccountInfo\",N:[\"idToken\",\"deleteProvider\"],A:function(a){if(!Array.isArray(a.deleteProvider))throw new t(\"internal-error\")}},$g={endpoint:\"emailLinkSignin\",N:[\"email\",\"oobCode\"],A:Zi,G:P,V:!0,B:!0},bh={endpoint:\"emailLinkSignin\",N:[\"idToken\",\"email\",\"oobCode\"],A:Zi,G:P,V:!0},Gj={endpoint:\"accounts/mfaEnrollment:finalize\",N:[\"idToken\",\"phoneVerificationInfo\"],A:pj,G:P,B:!0,Na:!0},Hj={endpoint:\"accounts/mfaSignIn:finalize\",N:[\"mfaPendingCredential\",\"phoneVerificationInfo\"],A:pj,G:P,B:!0,Na:!0},Ij={endpoint:\"getAccountInfo\"},jj={endpoint:\"getOobConfirmationCode\",N:[\"requestType\"],A:function(a){if(\"EMAIL_SIGNIN\"!=a.requestType)throw new t(\"internal-error\");Zi(a)},Z:\"email\",B:!0},kj={endpoint:\"getOobConfirmationCode\",N:[\"idToken\",\"requestType\"],A:function(a){if(\"VERIFY_EMAIL\"!=a.requestType)throw new t(\"internal-error\")},Z:\"email\",B:!0},lj={endpoint:\"getOobConfirmationCode\",N:[\"idToken\",\"newEmail\",\"requestType\"],A:function(a){if(\"VERIFY_AND_CHANGE_EMAIL\"!=a.requestType)throw new t(\"internal-error\")},Z:\"email\",B:!0},ij={endpoint:\"getOobConfirmationCode\",N:[\"requestType\"],A:function(a){if(\"PASSWORD_RESET\"!=a.requestType)throw new t(\"internal-error\");Zi(a)},Z:\"email\",B:!0},dj={lb:!0,endpoint:\"getProjectConfig\",Ub:\"GET\"},Jj={lb:!0,endpoint:\"getRecaptchaParam\",Ub:\"GET\",G:function(a){if(!a.recaptchaSiteKey)throw new t(\"internal-error\")}},Bj={endpoint:\"resetPassword\",A:Aj,Z:\"email\",B:!0},mj={endpoint:\"sendVerificationCode\",N:[\"phoneNumber\",\"recaptchaToken\"],Z:\"sessionInfo\",B:!0},gj={endpoint:\"setAccountInfo\",N:[\"idToken\"],A:$i,V:!0},ch={endpoint:\"setAccountInfo\",N:[\"idToken\"],A:function(a){if($i(a),!a.password)throw new t(\"weak-password\")},G:P,V:!0},fj={endpoint:\"signupNewUser\",G:P,V:!0,B:!0},oj={endpoint:\"accounts/mfaEnrollment:start\",N:[\"idToken\",\"phoneEnrollmentInfo\"],A:function(a){if(!a.phoneEnrollmentInfo)throw new t(\"internal-error\");if(!a.phoneEnrollmentInfo.phoneNumber)throw new t(\"missing-phone-number\");if(!a.phoneEnrollmentInfo.recaptchaToken)throw new t(\"missing-app-credential\")},G:function(a){if(!a.phoneSessionInfo||!a.phoneSessionInfo.sessionInfo)throw new t(\"internal-error\")},B:!0,Na:!0},qj={endpoint:\"accounts/mfaSignIn:start\",N:[\"mfaPendingCredential\",\"mfaEnrollmentId\",\"phoneSignInInfo\"],A:function(a){if(!a.phoneSignInInfo||!a.phoneSignInInfo.recaptchaToken)throw new t(\"missing-app-credential\")},G:function(a){if(!a.phoneResponseInfo||!a.phoneResponseInfo.sessionInfo)throw new t(\"internal-error\")},B:!0,Na:!0},xj={endpoint:\"verifyAssertion\",A:tj,Ya:uj,G:vj,V:!0,B:!0},zj={endpoint:\"verifyAssertion\",A:tj,Ya:uj,G:function(a){if(a.errorMessage&&\"USER_NOT_FOUND\"==a.errorMessage)throw new t(\"user-not-found\");if(a.errorMessage)throw wj(a.errorMessage);P(a)},V:!0,B:!0},yj={endpoint:\"verifyAssertion\",A:function(a){if(tj(a),!a.idToken)throw new t(\"internal-error\")},Ya:uj,G:vj,V:!0},Kj={endpoint:\"verifyCustomToken\",A:function(a){if(!a.token)throw new t(\"invalid-custom-token\")},G:P,V:!0,B:!0},ah={endpoint:\"verifyPassword\",A:function(a){if(Zi(a),!a.password)throw new t(\"wrong-password\")},G:P,V:!0,B:!0},nj={endpoint:\"verifyPhoneNumber\",A:ej,G:P,B:!0},ih={endpoint:\"verifyPhoneNumber\",A:function(a){if(!a.idToken)throw new t(\"internal-error\");ej(a)},G:function(a){if(a.temporaryProof)throw a.code=\"credential-already-in-use\",zh(a);P(a)}},jh={Hb:{USER_NOT_FOUND:\"user-not-found\"},endpoint:\"verifyPhoneNumber\",A:ej,G:P,B:!0},Lj={endpoint:\"accounts/mfaEnrollment:withdraw\",N:[\"idToken\",\"mfaEnrollmentId\"],G:function(a){if(!!a[Dg]^!!a.refreshToken)throw new t(\"internal-error\")},B:!0,Na:!0};function O(a,b,c){if(!function(a,b){if(!b||!b.length)return!0;if(!a)return!1;for(var c=0;c<b.length;c++){var d=a[b[c]];if(null==d||\"\"===d)return!1}return!0}(c,b.N))return F(new t(\"internal-error\"));var f,d=!!b.Na,e=b.Ub||\"POST\";return E(c).then(b.A).then((function(){return b.V&&(c.returnSecureToken=!0),b.B&&a.b&&void 0===c.tenantId&&(c.tenantId=a.b),function(a,b,c,d,e,f,g){var h=J(b+c);I(h,\"key\",a.c),g&&I(h,\"cb\",Date.now().toString());var m=\"GET\"==d;if(m)for(var p in e)e.hasOwnProperty(p)&&I(h,p,e[p]);return new D((function(v,B){Si(a,h.toString(),(function(A){A?A.error?B(Xi(A,f||{})):v(A):B(new t(\"network-request-failed\"))}),d,m?void 0:ke(Ve(e)),a.a,a.v.get())}))}(a,d?a.i:a.h,b.endpoint,e,c,b.Hb,b.lb||!1)})).then((function(g){return f=g,b.Ya?b.Ya(c,f):f})).then(b.G).then((function(){if(!b.Z)return f;if(!(b.Z in f))throw new t(\"internal-error\");return f[b.Z]}))}function wj(a){return Xi({error:{errors:[{message:a}],code:400,message:a}})}function Xi(a,b){var c=(a.error&&a.error.errors&&a.error.errors[0]||{}).reason||\"\",d={keyInvalid:\"invalid-api-key\",ipRefererBlocked:\"app-not-authorized\"};if(c=d[c]?new t(d[c]):null)return c;for(var e in c=a.error&&a.error.message||\"\",z(d={INVALID_CUSTOM_TOKEN:\"invalid-custom-token\",CREDENTIAL_MISMATCH:\"custom-token-mismatch\",MISSING_CUSTOM_TOKEN:\"internal-error\",INVALID_IDENTIFIER:\"invalid-email\",MISSING_CONTINUE_URI:\"internal-error\",INVALID_EMAIL:\"invalid-email\",INVALID_PASSWORD:\"wrong-password\",USER_DISABLED:\"user-disabled\",MISSING_PASSWORD:\"internal-error\",EMAIL_EXISTS:\"email-already-in-use\",PASSWORD_LOGIN_DISABLED:\"operation-not-allowed\",INVALID_IDP_RESPONSE:\"invalid-credential\",INVALID_PENDING_TOKEN:\"invalid-credential\",FEDERATED_USER_ID_ALREADY_LINKED:\"credential-already-in-use\",MISSING_OR_INVALID_NONCE:\"missing-or-invalid-nonce\",INVALID_MESSAGE_PAYLOAD:\"invalid-message-payload\",INVALID_RECIPIENT_EMAIL:\"invalid-recipient-email\",INVALID_SENDER:\"invalid-sender\",EMAIL_NOT_FOUND:\"user-not-found\",RESET_PASSWORD_EXCEED_LIMIT:\"too-many-requests\",EXPIRED_OOB_CODE:\"expired-action-code\",INVALID_OOB_CODE:\"invalid-action-code\",MISSING_OOB_CODE:\"internal-error\",INVALID_PROVIDER_ID:\"invalid-provider-id\",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:\"requires-recent-login\",INVALID_ID_TOKEN:\"invalid-user-token\",TOKEN_EXPIRED:\"user-token-expired\",USER_NOT_FOUND:\"user-token-expired\",CORS_UNSUPPORTED:\"cors-unsupported\",DYNAMIC_LINK_NOT_ACTIVATED:\"dynamic-link-not-activated\",INVALID_APP_ID:\"invalid-app-id\",TOO_MANY_ATTEMPTS_TRY_LATER:\"too-many-requests\",WEAK_PASSWORD:\"weak-password\",OPERATION_NOT_ALLOWED:\"operation-not-allowed\",USER_CANCELLED:\"user-cancelled\",CAPTCHA_CHECK_FAILED:\"captcha-check-failed\",INVALID_APP_CREDENTIAL:\"invalid-app-credential\",INVALID_CODE:\"invalid-verification-code\",INVALID_PHONE_NUMBER:\"invalid-phone-number\",INVALID_SESSION_INFO:\"invalid-verification-id\",INVALID_TEMPORARY_PROOF:\"invalid-credential\",MISSING_APP_CREDENTIAL:\"missing-app-credential\",MISSING_CODE:\"missing-verification-code\",MISSING_PHONE_NUMBER:\"missing-phone-number\",MISSING_SESSION_INFO:\"missing-verification-id\",QUOTA_EXCEEDED:\"quota-exceeded\",SESSION_EXPIRED:\"code-expired\",REJECTED_CREDENTIAL:\"rejected-credential\",INVALID_CONTINUE_URI:\"invalid-continue-uri\",MISSING_ANDROID_PACKAGE_NAME:\"missing-android-pkg-name\",MISSING_IOS_BUNDLE_ID:\"missing-ios-bundle-id\",UNAUTHORIZED_DOMAIN:\"unauthorized-continue-uri\",INVALID_DYNAMIC_LINK_DOMAIN:\"invalid-dynamic-link-domain\",INVALID_OAUTH_CLIENT_ID:\"invalid-oauth-client-id\",INVALID_CERT_HASH:\"invalid-cert-hash\",UNSUPPORTED_TENANT_OPERATION:\"unsupported-tenant-operation\",INVALID_TENANT_ID:\"invalid-tenant-id\",TENANT_ID_MISMATCH:\"tenant-id-mismatch\",ADMIN_ONLY_OPERATION:\"admin-restricted-operation\",INVALID_MFA_PENDING_CREDENTIAL:\"invalid-multi-factor-session\",MFA_ENROLLMENT_NOT_FOUND:\"multi-factor-info-not-found\",MISSING_MFA_PENDING_CREDENTIAL:\"missing-multi-factor-session\",MISSING_MFA_ENROLLMENT_ID:\"missing-multi-factor-info\",EMAIL_CHANGE_NEEDS_VERIFICATION:\"email-change-needs-verification\",SECOND_FACTOR_EXISTS:\"second-factor-already-in-use\",SECOND_FACTOR_LIMIT_EXCEEDED:\"maximum-second-factor-count-exceeded\",UNSUPPORTED_FIRST_FACTOR:\"unsupported-first-factor\",UNVERIFIED_EMAIL:\"unverified-email\"},b||{}),b=(b=c.match(/^[^\\s]+\\s*:\\s*([\\s\\S]*)$/))&&1<b.length?b[1]:void 0,d)if(0===c.indexOf(e))return new t(d[e],b);return!b&&a&&(b=Ue(a)),new t(\"internal-error\",b)}function Mj(a){this.b=a,this.a=null,this.rb=function(a){return(Uj||(Uj=new D((function(a,b){function c(){Ye(),L(\"gapi.load\")(\"gapi.iframes\",{callback:a,ontimeout:function(){Ye(),b(Error(\"Network Error\"))},timeout:Tj.get()})}if(L(\"gapi.iframes.Iframe\"))a();else if(L(\"gapi.load\"))c();else{var d=\"__iframefcb\"+Math.floor(1e6*Math.random()).toString();l[d]=function(){L(\"gapi.load\")?c():b(Error(\"Network Error\"))},E(Bi(d=zb(Sj,{onload:d}))).o((function(){b(Error(\"Network Error\"))}))}})).o((function(a){throw Uj=null,a})))).then((function(){return new D((function(b,c){L(\"gapi.iframes.getContext\")().open({where:document.body,url:a.b,messageHandlersFilter:L(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"),attributes:{style:{position:\"absolute\",top:\"-100px\",width:\"1px\",height:\"1px\"}},dontclear:!0},(function(d){function e(){clearTimeout(f),b()}a.a=d,a.a.restyle({setHideOnLeave:!1});var f=setTimeout((function(){c(Error(\"Network Error\"))}),Pj.get());d.ping(e).then(e,(function(){c(Error(\"Network Error\"))}))}))}))}))}(this)}var Sj=new qb(rb,\"https://apis.google.com/js/api.js?onload=%{onload}\"),Tj=new Ze(3e4,6e4),Pj=new Ze(5e3,15e3),Uj=null;function Vj(a,b,c,d){this.l=a,this.h=b,this.i=c,this.g=d,this.f=null,a=this.g?ce((a=J(this.g.url)).c,a.a,a.g,\"/emulator/auth/iframe\"):ce(\"https\",this.l,null,\"/__/auth/iframe\"),this.a=a,I(this.a,\"apiKey\",this.h),I(this.a,\"appName\",this.i),this.b=null,this.c=[]}function Wj(a,b,c,d,e,f){this.u=a,this.s=b,this.c=c,this.m=d,this.v=f,this.i=this.g=this.l=null,this.a=e,this.h=this.f=null}function Xj(a){try{return index_esm.default.app(a).auth().Ga()}catch(b){return[]}}function Yj(a,b,c,d,e,f){this.s=a,this.g=b,this.b=c,this.f=f,this.c=d||null,this.i=e||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function Zj(a){var b=re();return function(a){return O(a,dj,{}).then((function(b){return b.authorizedDomains||[]}))}(a).then((function(c){a:{var d=J(b),e=d.c;d=d.a;for(var f=0;f<c.length;f++){var g=c[f],h=d,m=e;if(0==g.indexOf(\"chrome-extension://\")?h=J(g).a==h&&\"chrome-extension\"==m:\"http\"!=m&&\"https\"!=m?h=!1:Ce.test(g)?h=h==g:(g=g.split(\".\").join(\"\\\\.\"),h=new RegExp(\"^(.+\\\\.\"+g+\"|\"+g+\")$\",\"i\").test(h)),h){c=!0;break a}}c=!1}if(!c)throw new xh(re())}))}function ak(a){return a.m||(a.m=Ee().then((function(){if(!a.u){var b=a.c,c=a.i,d=Xj(a.b),e=new Vj(a.s,a.g,a.b,a.f);e.f=b,e.b=c,e.c=Za(d||[]),a.u=e.toString()}a.v=new Mj(a.u),function(a){if(!a.v)throw Error(\"IfcHandler must be initialized!\");!function(a,b){a.rb.then((function(){a.a.register(\"authEvent\",b,L(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"))}))}(a.v,(function(b){var c={};if(b&&b.authEvent){var d=!1;for(b=th(b.authEvent),c=0;c<a.h.length;c++)d=a.h[c](b)||d;return(c={}).status=d?\"ACK\":\"ERROR\",E(c)}return c.status=\"ERROR\",E(c)}))}(a)}))),a.m}function dk(a){return a.l||(a.C=a.c?Oe(a.c,Xj(a.b)):null,a.l=new Ii(a.g,Ca(a.i),a.C),a.f&&Pi(a.l,a.f)),a.l}function ek(a,b,c,d,e,f,g,h,m,p,v,B){return(a=new Wj(a,b,c,d,e,B)).l=f,a.g=g,a.i=h,a.b=nb(m||null),a.f=p,a.yb(v).toString()}function fk(a){if(this.a=a||index_esm.default.INTERNAL.reactNative&&index_esm.default.INTERNAL.reactNative.AsyncStorage,!this.a)throw new t(\"internal-error\",\"The React Native compatibility library was not found.\");this.type=\"asyncStorage\"}function gk(a){this.b=a,this.a={},this.f=q(this.c,this)}Vj.prototype.toString=function(){return this.f?I(this.a,\"v\",this.f):ie(this.a.b,\"v\"),this.b?I(this.a,\"eid\",this.b):ie(this.a.b,\"eid\"),this.c.length?I(this.a,\"fw\",this.c.join(\",\")):ie(this.a.b,\"fw\"),this.a.toString()},Wj.prototype.yb=function(a){return this.h=a,this},Wj.prototype.toString=function(){if(this.v){var a=J(this.v.url);a=ce(a.c,a.a,a.g,\"/emulator/auth/handler\")}else a=ce(\"https\",this.u,null,\"/__/auth/handler\");if(I(a,\"apiKey\",this.s),I(a,\"appName\",this.c),I(a,\"authType\",this.m),this.a.isOAuthProvider){var b=this.a;try{var c=index_esm.default.app(this.c).auth().la()}catch(h){c=null}for(var d in b.ob=c,I(a,\"providerId\",this.a.providerId),b=Ve((c=this.a).Ib))b[d]=b[d].toString();d=c.Qc,b=nb(b);for(var e=0;e<d.length;e++){var f=d[e];f in b&&delete b[f]}c.pb&&c.ob&&!b[c.pb]&&(b[c.pb]=c.ob),mb(b)||I(a,\"customParameters\",Ue(b))}if(\"function\"==typeof this.a.Qb&&(c=this.a.Qb()).length&&I(a,\"scopes\",c.join(\",\")),this.l?I(a,\"redirectUrl\",this.l):ie(a.b,\"redirectUrl\"),this.g?I(a,\"eventId\",this.g):ie(a.b,\"eventId\"),this.i?I(a,\"v\",this.i):ie(a.b,\"v\"),this.b)for(var g in this.b)this.b.hasOwnProperty(g)&&!be(a,g)&&I(a,g,this.b[g]);return this.h?I(a,\"tid\",this.h):ie(a.b,\"tid\"),this.f?I(a,\"eid\",this.f):ie(a.b,\"eid\"),(g=Xj(this.c)).length&&I(a,\"fw\",g.join(\",\")),a.toString()},(k=Yj.prototype).Ob=function(a,b,c){var d=new t(\"popup-closed-by-user\"),e=new t(\"web-storage-unsupported\"),f=this,g=!1;return this.ma().then((function(){(function(a){var b={type:\"webStorageSupport\"};return ak(a).then((function(){return function(a,b){return a.rb.then((function(){return new D((function(c){a.a.send(b.type,b,c,L(\"gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER\"))}))}))}(a.v,b)})).then((function(c){if(c&&c.length&&void 0!==c[0].webStorageSupport)return c[0].webStorageSupport;throw Error()}))})(f).then((function(h){h||(a&&ye(a),b(e),g=!0)}))})).o((function(){})).then((function(){if(!g)return function(a){return new D((function(b){return function c(){Fd(2e3).then((function(){if(a&&!a.closed)return c();b()}))}()}))}(a)})).then((function(){if(!g)return Fd(c).then((function(){b(d)}))}))},k.Xb=function(){var a=K();return!Te(a)&&!Xe(a)},k.Tb=function(){return!1},k.Mb=function(a,b,c,d,e,f,g,h){if(!a)return F(new t(\"popup-blocked\"));if(g&&!Te())return this.ma().o((function(p){ye(a),e(p)})),d(),E();this.a||(this.a=Zj(dk(this)));var m=this;return this.a.then((function(){var p=m.ma().o((function(v){throw ye(a),e(v),v}));return d(),p})).then((function(){rh(c),g||se(ek(m.s,m.g,m.b,b,c,null,f,m.c,void 0,m.i,h,m.f),a)})).o((function(p){throw\"auth/network-request-failed\"==p.code&&(m.a=null),p}))},k.Nb=function(a,b,c,d){this.a||(this.a=Zj(dk(this)));var e=this;return this.a.then((function(){rh(b),se(ek(e.s,e.g,e.b,a,b,re(),c,e.c,void 0,e.i,d,e.f))})).o((function(f){throw\"auth/network-request-failed\"==f.code&&(e.a=null),f}))},k.ma=function(){var a=this;return ak(this).then((function(){return a.v.rb})).o((function(){throw a.a=null,new t(\"network-request-failed\")}))},k.$b=function(){return!0},k.Ea=function(a){this.h.push(a)},k.Sa=function(a){Xa(this.h,(function(b){return b==a}))},(k=fk.prototype).get=function(a){return E(this.a.getItem(a)).then((function(b){return b&&We(b)}))},k.set=function(a,b){return E(this.a.setItem(a,Ue(b)))},k.U=function(a){return E(this.a.removeItem(a))},k.ca=function(){},k.ia=function(){};var rk,hk=[];function jk(a,b,c){mb(a.a)&&a.b.addEventListener(\"message\",a.f),void 0===a.a[b]&&(a.a[b]=[]),a.a[b].push(c)}function kk(a){this.a=a}function lk(a){this.c=a,this.b=!1,this.a=[]}function mk(a,b,c,d){var e,g,h,m,f=c||{},p=null;if(a.b)return F(Error(\"connection_unavailable\"));var v=d?800:50,B=\"undefined\"!=typeof MessageChannel?new MessageChannel:null;return new D((function(A,Q){B?(e=Math.floor(Math.random()*Math.pow(10,20)).toString(),B.port1.start(),h=setTimeout((function(){Q(Error(\"unsupported_event\"))}),v),a.a.push(p={messageChannel:B,onMessage:g=function(ya){ya.data.eventId===e&&(\"ack\"===ya.data.status?(clearTimeout(h),m=setTimeout((function(){Q(Error(\"timeout\"))}),3e3)):\"done\"===ya.data.status?(clearTimeout(m),void 0!==ya.data.response?A(ya.data.response):Q(Error(\"unknown_error\"))):(clearTimeout(h),clearTimeout(m),Q(Error(\"invalid_response\"))))}}),B.port1.addEventListener(\"message\",g),a.c.postMessage({eventType:b,eventId:e,data:f},[B.port2])):Q(Error(\"connection_unavailable\"))})).then((function(A){return nk(a,p),A})).o((function(A){throw nk(a,p),A}))}function nk(a,b){if(b){var c=b.messageChannel;c&&(c.port1.removeEventListener(\"message\",b.onMessage),c.port1.close()),Xa(a.a,(function(e){return e==b}))}}function ok(){if(!pk())throw new t(\"web-storage-unsupported\");this.c={},this.a=[],this.b=0,this.m=l.indexedDB,this.type=\"indexedDB\",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var a=this;Je()&&self?(this.v=function(){var a=Je()?self:null;if(w(hk,(function(c){c.b==a&&(b=c)})),!b){var b=new gk(a);hk.push(b)}return b}(),jk(this.v,\"keyChanged\",(function(b,c){return qk(a).then((function(d){return 0<d.length&&w(a.a,(function(e){e(d)})),{keyProcessed:Va(d,c.key)}}))})),jk(this.v,\"ping\",(function(){return E([\"keyChanged\"])}))):function(){var a=l.navigator;return a&&a.serviceWorker?E().then((function(){return a.serviceWorker.ready})).then((function(b){return b.active||null})).o((function(){return null})):E(null)}().then((function(b){(a.h=b)&&(a.g=new lk(new kk(b)),mk(a.g,\"ping\",null,!0).then((function(c){c[0].fulfilled&&Va(c[0].value,\"keyChanged\")&&(a.s=!0)})).o((function(){})))}))}function uk(a){return a.i||(a.i=function tk(a){return new D((function(b,c){var d=a.m.open(\"firebaseLocalStorageDb\",1);d.onerror=function(e){try{e.preventDefault()}catch(f){}c(Error(e.target.error))},d.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore(\"firebaseLocalStorage\",{keyPath:\"fbase_key\"})}catch(f){c(f)}},d.onsuccess=function(e){(e=e.target.result).objectStoreNames.contains(\"firebaseLocalStorage\")?b(e):function(a){return new D((function(b,c){var d=a.m.deleteDatabase(\"firebaseLocalStorageDb\");d.onsuccess=function(){b()},d.onerror=function(e){c(Error(e.target.error))}}))}(a).then((function(){return tk(a)})).then((function(f){b(f)})).o((function(f){c(f)}))}}))}(a)),a.i}function vk(a,b){var d=0;return new D((function c(e,f){uk(a).then(b).then(e).o((function(g){if(!(3<++d))return uk(a).then((function(h){return h.close(),a.i=void 0,c(e,f)})).o((function(h){f(h)}));f(g)}))}))}function pk(){try{return!!l.indexedDB}catch(a){return!1}}function wk(a){return a.objectStore(\"firebaseLocalStorage\")}function xk(a,b){return a.transaction([\"firebaseLocalStorage\"],b?\"readwrite\":\"readonly\")}function yk(a){return new D((function(b,c){a.onsuccess=function(d){d&&d.target?b(d.target.result):b()},a.onerror=function(d){c(d.target.error)}}))}function zk(a,b){return a.g&&a.h&&function(){var a=l.navigator;return a&&a.serviceWorker&&a.serviceWorker.controller||null}()===a.h?mk(a.g,\"keyChanged\",{key:b},a.s).then((function(){})).o((function(){})):E()}function qk(a){return uk(a).then((function(b){var c=wk(xk(b,!1));return c.getAll?yk(c.getAll()):new D((function(d,e){var f=[],g=c.openCursor();g.onsuccess=function(h){(h=h.target.result)?(f.push(h.value),h.continue()):d(f)},g.onerror=function(h){e(h.target.error)}}))})).then((function(b){var c={},d=[];if(0==a.b){for(d=0;d<b.length;d++)c[b[d].fbase_key]=b[d].value;d=function te(a,b){var d,c=[];for(d in a)d in b?typeof a[d]!=typeof b[d]?c.push(d):\"object\"==typeof a[d]&&null!=a[d]&&null!=b[d]?0<te(a[d],b[d]).length&&c.push(d):a[d]!==b[d]&&c.push(d):c.push(d);for(d in b)d in a||c.push(d);return c}(a.c,c),a.c=c}return d}))}function Bk(a){a.l&&a.l.cancel(\"STOP_EVENT\"),a.f&&(clearTimeout(a.f),a.f=null)}function Ck(a){var b=this,c=null;this.a=[],this.type=\"indexedDB\",this.c=a,this.b=E().then((function(){if(pk()){var d=Qe(),e=\"__sak\"+d;return rk||(rk=new ok),(c=rk).set(e,d).then((function(){return c.get(e)})).then((function(f){if(f!==d)throw Error(\"indexedDB not supported!\");return c.U(e)})).then((function(){return c})).o((function(){return b.c}))}return b.c})).then((function(d){return b.type=d.type,d.ca((function(e){w(b.a,(function(f){f(e)}))})),d}))}function Dk(){this.a={},this.type=\"inMemory\"}function Ek(){if(!function(){var a=\"Node\"==Ke();if(!(a=Gk()||a&&index_esm.default.INTERNAL.node&&index_esm.default.INTERNAL.node.localStorage))return!1;try{return a.setItem(\"__sak\",\"1\"),a.removeItem(\"__sak\"),!0}catch(b){return!1}}()){if(\"Node\"==Ke())throw new t(\"internal-error\",\"The LocalStorage compatibility library was not found.\");throw new t(\"web-storage-unsupported\")}this.a=Gk()||index_esm.default.INTERNAL.node.localStorage,this.type=\"localStorage\"}function Gk(){try{var a=l.localStorage,b=Qe();return a&&(a.setItem(b,\"1\"),a.removeItem(b)),a}catch(c){return null}}function Hk(){this.type=\"nullStorage\"}function Ik(){if(!function(){var a=\"Node\"==Ke();if(!(a=Kk()||a&&index_esm.default.INTERNAL.node&&index_esm.default.INTERNAL.node.sessionStorage))return!1;try{return a.setItem(\"__sak\",\"1\"),a.removeItem(\"__sak\"),!0}catch(b){return!1}}()){if(\"Node\"==Ke())throw new t(\"internal-error\",\"The SessionStorage compatibility library was not found.\");throw new t(\"web-storage-unsupported\")}this.a=Kk()||index_esm.default.INTERNAL.node.sessionStorage,this.type=\"sessionStorage\"}function Kk(){try{var a=l.sessionStorage,b=Qe();return a&&(a.setItem(b,\"1\"),a.removeItem(b)),a}catch(c){return null}}function Lk(){var a={};a.Browser=Mk,a.Node=Nk,a.ReactNative=Ok,a.Worker=Pk,this.a=a[Ke()]}gk.prototype.c=function(a){var b=a.data.eventType,c=a.data.eventId,d=this.a[b];if(d&&0<d.length){a.ports[0].postMessage({status:\"ack\",eventId:c,eventType:b,response:null});var e=[];w(d,(function(f){e.push(E().then((function(){return f(a.origin,a.data.data)})))})),Jc(e).then((function(f){var g=[];w(f,(function(h){g.push({fulfilled:h.Pb,value:h.value,reason:h.reason?h.reason.message:void 0})})),w(g,(function(h){for(var m in h)void 0===h[m]&&delete h[m]})),a.ports[0].postMessage({status:\"done\",eventId:c,eventType:b,response:g})}))}},kk.prototype.postMessage=function(a,b){this.a.postMessage(a,b)},lk.prototype.close=function(){for(;0<this.a.length;)nk(this,this.a[0]);this.b=!0},(k=ok.prototype).set=function(a,b){var c=this,d=!1;return vk(this,(function(e){return yk((e=wk(xk(e,!0))).get(a))})).then((function(e){return vk(c,(function(f){if(f=wk(xk(f,!0)),e)return e.value=b,yk(f.put(e));c.b++,d=!0;var g={};return g.fbase_key=a,g.value=b,yk(f.add(g))}))})).then((function(){return c.c[a]=b,zk(c,a)})).oa((function(){d&&c.b--}))},k.get=function(a){return vk(this,(function(b){return yk(wk(xk(b,!1)).get(a))})).then((function(b){return b&&b.value}))},k.U=function(a){var b=this,c=!1;return vk(this,(function(d){return c=!0,b.b++,yk(wk(xk(d,!0)).delete(a))})).then((function(){return delete b.c[a],zk(b,a)})).oa((function(){c&&b.b--}))},k.ca=function(a){0==this.a.length&&function(a){Bk(a),function b(){a.f=setTimeout((function(){a.l=qk(a).then((function(c){0<c.length&&w(a.a,(function(d){d(c)}))})).then((function(){b()})).o((function(c){\"STOP_EVENT\"!=c.message&&b()}))}),800)}()}(this),this.a.push(a)},k.ia=function(a){Xa(this.a,(function(b){return b==a})),0==this.a.length&&Bk(this)},(k=Ck.prototype).get=function(a){return this.b.then((function(b){return b.get(a)}))},k.set=function(a,b){return this.b.then((function(c){return c.set(a,b)}))},k.U=function(a){return this.b.then((function(b){return b.U(a)}))},k.ca=function(a){this.a.push(a)},k.ia=function(a){Xa(this.a,(function(b){return b==a}))},(k=Dk.prototype).get=function(a){return E(this.a[a])},k.set=function(a,b){return this.a[a]=b,E()},k.U=function(a){return delete this.a[a],E()},k.ca=function(){},k.ia=function(){},(k=Ek.prototype).get=function(a){var b=this;return E().then((function(){return We(b.a.getItem(a))}))},k.set=function(a,b){var c=this;return E().then((function(){var d=Ue(b);null===d?c.U(a):c.a.setItem(a,d)}))},k.U=function(a){var b=this;return E().then((function(){b.a.removeItem(a)}))},k.ca=function(a){l.window&&nd(l.window,\"storage\",a)},k.ia=function(a){l.window&&xd(l.window,\"storage\",a)},(k=Hk.prototype).get=function(){return E(null)},k.set=function(){return E()},k.U=function(){return E()},k.ca=function(){},k.ia=function(){},(k=Ik.prototype).get=function(a){var b=this;return E().then((function(){return We(b.a.getItem(a))}))},k.set=function(a,b){var c=this;return E().then((function(){var d=Ue(b);null===d?c.U(a):c.a.setItem(a,d)}))},k.U=function(a){var b=this;return E().then((function(){b.a.removeItem(a)}))},k.ca=function(){},k.ia=function(){};var Qk,Uk,Mk={F:Ek,bb:Ik},Nk={F:Ek,bb:Ik},Ok={F:fk,bb:Hk},Pk={F:Ek,bb:Hk},Rk={rd:\"local\",NONE:\"none\",td:\"session\"};function Tk(){var a=!(Xe(K())||!Ie()),b=Te(),c=Pe();this.m=a,this.h=b,this.l=c,this.a={},Qk||(Qk=new Lk),a=Qk;try{this.g=!qe()&&cf()||!l.indexedDB?new a.a.F:new Ck(Je()?new Dk:new a.a.F)}catch(d){this.g=new Dk,this.h=!0}try{this.i=new a.a.bb}catch(d){this.i=new Dk}this.v=new Dk,this.f=q(this.Yb,this),this.b={}}function Vk(){return Uk||(Uk=new Tk),Uk}function Wk(a,b){switch(b){case\"session\":return a.i;case\"none\":return a.v;default:return a.g}}function Xk(a,b){return\"firebase:\"+a.name+(b?\":\"+b:\"\")}function Zk(a,b,c){return c=Xk(b,c),\"local\"==b.F&&(a.b[c]=null),Wk(a,b.F).U(c)}function al(a){a.c&&(clearInterval(a.c),a.c=null)}function bl(a){this.a=a,this.b=Vk()}(k=Tk.prototype).get=function(a,b){return Wk(this,a.F).get(Xk(a,b))},k.set=function(a,b,c){var d=Xk(a,c),e=this,f=Wk(this,a.F);return f.set(d,b).then((function(){return f.get(d)})).then((function(g){\"local\"==a.F&&(e.b[d]=g)}))},k.addListener=function(a,b,c){a=Xk(a,b),this.l&&(this.b[a]=l.localStorage.getItem(a)),mb(this.a)&&(Wk(this,\"local\").ca(this.f),this.h||(qe()||!cf())&&l.indexedDB||!this.l||function(a){al(a),a.c=setInterval((function(){for(var b in a.a){var c=l.localStorage.getItem(b),d=a.b[b];c!=d&&(a.b[b]=c,c=new bd({type:\"storage\",key:b,target:window,oldValue:d,newValue:c,a:!0}),a.Yb(c))}}),1e3)}(this)),this.a[a]||(this.a[a]=[]),this.a[a].push(c)},k.removeListener=function(a,b,c){a=Xk(a,b),this.a[a]&&(Xa(this.a[a],(function(d){return d==c})),0==this.a[a].length&&delete this.a[a]),mb(this.a)&&(Wk(this,\"local\").ia(this.f),al(this))},k.Yb=function(a){if(a&&a.g){var b=a.a.key;if(null==b)for(var c in this.a){var d=this.b[c];void 0===d&&(d=null);var e=l.localStorage.getItem(c);e!==d&&(this.b[c]=e,this.mb(c))}else if(0==b.indexOf(\"firebase:\")&&this.a[b]){if(void 0!==a.a.a?Wk(this,\"local\").ia(this.f):al(this),this.m)if(c=l.localStorage.getItem(b),(d=a.a.newValue)!==c)null!==d?l.localStorage.setItem(b,d):l.localStorage.removeItem(b);else if(this.b[b]===d&&void 0===a.a.a)return;var f=this;c=function(){void 0===a.a.a&&f.b[b]===l.localStorage.getItem(b)||(f.b[b]=l.localStorage.getItem(b),f.mb(b))},Wb&&ic&&10==ic&&l.localStorage.getItem(b)!==a.a.newValue&&a.a.newValue!==a.a.oldValue?setTimeout(c,10):c()}}else w(a,q(this.mb,this))},k.mb=function(a){this.a[a]&&w(this.a[a],(function(b){b()}))};var il,cl={name:\"authEvent\",F:\"local\"};function el(){this.a=Vk()}function gl(a,b){this.b=hl,this.f=l.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=a,this.h=b,this.l=l.Int32Array?new Int32Array(64):Array(64),void 0===il&&(il=l.Int32Array?new Int32Array(jl):jl),this.reset()}r(gl,(function(){this.b=-1}));for(var hl=64,kl=hl-1,ll=[],ml=0;ml<kl;ml++)ll[ml]=0;var nl=Ya(128,ll);function ol(a){for(var b=a.f,c=a.l,d=0,e=0;e<b.length;)c[d++]=b[e]<<24|b[e+1]<<16|b[e+2]<<8|b[e+3],e=4*d;for(b=16;64>b;b++){var f=(0|c[b-16])+(((e=0|c[b-15])>>>7|e<<25)^(e>>>18|e<<14)^e>>>3)|0,g=(0|c[b-7])+(((d=0|c[b-2])>>>17|d<<15)^(d>>>19|d<<13)^d>>>10)|0;c[b]=f+g|0}d=0|a.a[0],e=0|a.a[1];var h=0|a.a[2],m=0|a.a[3],p=0|a.a[4],v=0|a.a[5],B=0|a.a[6];for(f=0|a.a[7],b=0;64>b;b++){var A=((d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+(d&e^d&h^e&h)|0;g=(f=f+((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))|0)+((g=(g=p&v^~p&B)+(0|il[b])|0)+(0|c[b])|0)|0,f=B,B=v,v=p,p=m+g|0,m=h,h=e,e=d,d=g+A|0}a.a[0]=a.a[0]+d|0,a.a[1]=a.a[1]+e|0,a.a[2]=a.a[2]+h|0,a.a[3]=a.a[3]+m|0,a.a[4]=a.a[4]+p|0,a.a[5]=a.a[5]+v|0,a.a[6]=a.a[6]+B|0,a.a[7]=a.a[7]+f|0}function pl(a,b,c){void 0===c&&(c=b.length);var d=0,e=a.c;if(\"string\"==typeof b)for(;d<c;)a.f[e++]=b.charCodeAt(d++),e==a.b&&(ol(a),e=0);else{if(!na(b))throw Error(\"message must be string or array\");for(;d<c;){var f=b[d++];if(!(\"number\"==typeof f&&0<=f&&255>=f&&f==(0|f)))throw Error(\"message must be a byte array\");a.f[e++]=f,e==a.b&&(ol(a),e=0)}}a.c=e,a.g+=c}gl.prototype.reset=function(){this.g=this.c=0,this.a=l.Int32Array?new Int32Array(this.h):Za(this.h)};var jl=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ql(){gl.call(this,8,rl)}r(ql,gl);var rl=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function sl(a,b,c,d,e,f){this.v=a,this.i=b,this.l=c,this.m=d||null,this.u=e||null,this.s=f,this.h=b+\":\"+c,this.C=new el,this.g=new bl(this.h),this.f=null,this.b=[],this.a=this.c=null}function tl(a){return new t(\"invalid-cordova-configuration\",a)}function zl(a,b){for(var c=0;c<a.b.length;c++)try{a.b[c](b)}catch(d){}}function wl(a){return a.f||(a.f=a.ma().then((function(){return new D((function(b){a.Ea((function c(d){return b(d),a.Sa(c),!1})),function(a){function b(g){d=!0,e&&e.cancel(),yl(a).then((function(h){var m=c;if(h&&g&&g.url){var p=null;-1!=(m=xg(g.url)).indexOf(\"/__/auth/callback\")&&(p=(p=\"object\"==typeof(p=We(be(p=J(m),\"firebaseError\")||null))?Aa(p):null)?new sh(h.c,h.b,null,null,p,null,h.T()):new sh(h.c,h.b,m,h.f,null,null,h.T())),m=p||c}zl(a,m)}))}var c=new sh(\"unknown\",null,null,null,new t(\"no-auth-event\")),d=!1,e=Fd(500).then((function(){return yl(a).then((function(){d||zl(a,c)}))})),f=l.handleOpenURL;l.handleOpenURL=function(g){if(0==g.toLowerCase().indexOf(L(\"BuildInfo.packageName\",l).toLowerCase()+\"://\")&&b({url:g}),\"function\"==typeof f)try{f(g)}catch(h){console.error(h)}},vh||(vh=new uh),function(a){var b=vh;b.a.push(a),b.b||(b.b=function(c){for(var d=0;d<b.a.length;d++)b.a[d](c)},\"function\"==typeof(a=L(\"universalLinks.subscribe\",l))&&a(null,b.b))}(b)}(a)}))}))),a.f}function yl(a){var b=null;return function(a){return a.b.get(cl,a.a).then((function(b){return th(b)}))}(a.g).then((function(c){return b=c,Zk((c=a.g).b,cl,c.a)})).then((function(){return b}))}function Bl(a){this.a=a,this.b=Vk()}(k=sl.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(Ge(void 0)?Ee().then((function(){return new D((function(a,b){var c=l.document,d=setTimeout((function(){b(Error(\"Cordova framework is not ready.\"))}),1e3);c.addEventListener(\"deviceready\",(function(){clearTimeout(d),a()}),!1)}))})):F(Error(\"Cordova must run in an Android or iOS file scheme.\"))).then((function(){if(\"function\"!=typeof L(\"universalLinks.subscribe\",l))throw tl(\"cordova-universal-links-plugin-fix is not installed\");if(void 0===L(\"BuildInfo.packageName\",l))throw tl(\"cordova-plugin-buildinfo is not installed\");if(\"function\"!=typeof L(\"cordova.plugins.browsertab.openUrl\",l))throw tl(\"cordova-plugin-browsertab is not installed\");if(\"function\"!=typeof L(\"cordova.InAppBrowser.open\",l))throw tl(\"cordova-plugin-inappbrowser is not installed\")}),(function(){throw new t(\"cordova-not-ready\")}))},k.Ob=function(a,b){return b(new t(\"operation-not-supported-in-this-environment\")),E()},k.Mb=function(){return F(new t(\"operation-not-supported-in-this-environment\"))},k.$b=function(){return!1},k.Xb=function(){return!0},k.Tb=function(){return!0},k.Nb=function(a,b,c,d){if(this.c)return F(new t(\"redirect-operation-pending\"));var e=this,f=l.document,g=null,h=null,m=null,p=null;return this.c=E().then((function(){return rh(b),wl(e)})).then((function(){return function(a,b,c,d,e){var f=function(){for(var a=20,b=[];0<a;)b.push(\"1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\".charAt(Math.floor(62*Math.random()))),a--;return b.join(\"\")}(),g=new sh(b,d,null,f,new t(\"no-auth-event\"),null,e),h=L(\"BuildInfo.packageName\",l);if(\"string\"!=typeof h)throw new t(\"invalid-cordova-configuration\");var m=L(\"BuildInfo.displayName\",l),p={};if(K().toLowerCase().match(/iphone|ipad|ipod/))p.ibi=h;else{if(!K().toLowerCase().match(/android/))return F(new t(\"operation-not-supported-in-this-environment\"));p.apn=h}m&&(p.appDisplayName=m),f=function(a){var b=new ql;pl(b,a),a=[];var c=8*b.g;pl(b,nl,56>b.c?56-b.c:b.b-(b.c-56));for(var d=63;56<=d;d--)b.f[d]=255&c,c/=256;for(ol(b),d=c=0;d<b.i;d++)for(var e=24;0<=e;e-=8)a[c++]=b.a[d]>>e&255;return function(a){return Ra(a,(function(b){return 1<(b=b.toString(16)).length?b:\"0\"+b})).join(\"\")}(a)}(f),p.sessionId=f;var v=ek(a.v,a.i,a.l,b,c,null,d,a.m,p,a.u,e,a.s);return a.ma().then((function(){var B=a.h;return a.C.a.set(cl,g.w(),B)})).then((function(){var B=L(\"cordova.plugins.browsertab.isAvailable\",l);if(\"function\"!=typeof B)throw new t(\"invalid-cordova-configuration\");var A=null;B((function(Q){if(Q){if(\"function\"!=typeof(A=L(\"cordova.plugins.browsertab.openUrl\",l)))throw new t(\"invalid-cordova-configuration\");A(v)}else{if(\"function\"!=typeof(A=L(\"cordova.InAppBrowser.open\",l)))throw new t(\"invalid-cordova-configuration\");Q=K(),a.a=A(v,Q.match(/(iPad|iPhone|iPod).*OS 7_\\d/i)||Q.match(/(iPad|iPhone|iPod).*OS 8_\\d/i)?\"_blank\":\"_system\",\"location=yes\")}}))}))}(e,a,b,c,d)})).then((function(){return new D((function(v,B){h=function(){var A=L(\"cordova.plugins.browsertab.close\",l);return v(),\"function\"==typeof A&&A(),e.a&&\"function\"==typeof e.a.close&&(e.a.close(),e.a=null),!1},e.Ea(h),p=function(){$e()&&m()},f.addEventListener(\"resume\",m=function(){g||(g=Fd(2e3).then((function(){B(new t(\"redirect-cancelled-by-user\"))})))},!1),K().toLowerCase().match(/android/)||f.addEventListener(\"visibilitychange\",p,!1)})).o((function(v){return yl(e).then((function(){throw v}))}))})).oa((function(){m&&f.removeEventListener(\"resume\",m,!1),p&&f.removeEventListener(\"visibilitychange\",p,!1),g&&g.cancel(),h&&e.Sa(h),e.c=null}))},k.Ea=function(a){this.b.push(a),wl(this).o((function(b){\"auth/invalid-cordova-configuration\"===b.code&&(b=new sh(\"unknown\",null,null,null,new t(\"no-auth-event\")),a(b))}))},k.Sa=function(a){Xa(this.b,(function(b){return b==a}))};var Cl={name:\"pendingRedirect\",F:\"session\"};function El(a){return Zk(a.b,Cl,a.a)}function Gl(a,b,c,d){this.i={},this.u=0,this.D=a,this.v=b,this.m=c,this.J=d,this.h=[],this.f=!1,this.l=q(this.s,this),this.b=new Hl,this.C=new Il,this.g=new Bl(Jl(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Kl(this.D,this.v,this.m,Da,this.J)}function Kl(a,b,c,d,e){var f=index_esm.default.SDK_VERSION||null;return Ge()?new sl(a,b,c,f,d,e):new Yj(a,b,c,f,d,e)}function Ll(a){a.f||(a.f=!0,a.a.Ea(a.l));var b=a.a;return a.a.ma().o((function(c){throw a.a==b&&a.reset(),c}))}function Ml(a){a.a.Xb()&&Ll(a).o((function(b){var c=new sh(\"unknown\",null,null,null,new t(\"operation-not-supported-in-this-environment\"));Nl(b)&&a.s(c)})),a.a.Tb()||Ol(a.b)}function Pl(a,b){Va(a.h,b)||a.h.push(b),a.f||function(a){return a.b.get(Cl,a.a).then((function(b){return\"pending\"==b}))}(a.g).then((function(c){c?El(a.g).then((function(){Ll(a).o((function(d){var e=new sh(\"unknown\",null,null,null,new t(\"operation-not-supported-in-this-environment\"));Nl(d)&&a.s(e)}))})):Ml(a)})).o((function(){Ml(a)}))}function Ql(a,b){Xa(a.h,(function(c){return c==b}))}Gl.prototype.reset=function(){this.f=!1,this.a.Sa(this.l),this.a=Kl(this.D,this.v,this.m,null,this.J),this.i={}},Gl.prototype.s=function(a){if(!a)throw new t(\"invalid-auth-event\");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),a&&a.getUid()&&this.i.hasOwnProperty(a.getUid()))return!1;for(var b=!1,c=0;c<this.h.length;c++){var d=this.h[c];if(d.Fb(a.c,a.b)){(b=this.c[a.c])&&(b.h(a,d),a&&(a.f||a.b)&&(this.i[a.getUid()]=!0,this.u=Date.now())),b=!0;break}}return Ol(this.b),b};var Rl=new Ze(2e3,1e4),Sl=new Ze(3e4,6e4);function Tl(a,b,c,d,e,f,g){return a.a.Mb(b,c,d,(function(){a.f||(a.f=!0,a.a.Ea(a.l))}),(function(){a.reset()}),e,f,g)}function Nl(a){return!(!a||\"auth/cordova-not-ready\"!=a.code)}function Ul(a,b,c,d,e){var f;return function(a){return a.b.set(Cl,\"pending\",a.a)}(a.g).then((function(){return a.a.Nb(b,c,d,e).o((function(g){if(Nl(g))throw new t(\"operation-not-supported-in-this-environment\");return f=g,El(a.g).then((function(){throw f}))})).then((function(){return a.a.$b()?new D((function(){})):El(a.g).then((function(){return a.qa()})).then((function(){})).o((function(){}))}))}))}function Vl(a,b,c,d,e){return a.a.Ob(d,(function(f){b.na(c,null,f,e)}),Rl.get())}Gl.prototype.qa=function(){return this.b.qa()};var Wl={};function Jl(a,b,c){return a=a+\":\"+b,c&&(a=a+\":\"+c.url),a}function Xl(a,b,c,d){var e=Jl(b,c,d);return Wl[e]||(Wl[e]=new Gl(a,b,c,d)),Wl[e]}function Hl(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Ol(a){a.g||(a.g=!0,Yl(a,!1,null,null))}function $l(a){a.g&&!a.i&&Yl(a,!1,null,null)}function bm(a,b){if(a.b=function(){return E(b)},a.f.length)for(var c=0;c<a.f.length;c++)a.f[c](b)}function Yl(a,b,c,d){b?d?function(a,b){if(a.b=function(){return F(b)},a.c.length)for(var c=0;c<a.c.length;c++)a.c[c](b)}(a,d):bm(a,c):bm(a,{user:null}),a.f=[],a.c=[]}function Il(){}function em(){this.ib=!1,Object.defineProperty(this,\"appVerificationDisabled\",{get:function(){return this.ib},set:function(a){this.ib=a},enumerable:!1})}function fm(a,b){this.a=b,M(this,\"verificationId\",a)}function gm(a,b,c,d){return new lh(a).fb(b,c).then((function(e){return new fm(e,d)}))}function hm(a){var b=ig(a);if(!(b&&b.exp&&b.auth_time&&b.iat))throw new t(\"internal-error\",\"An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.\");N(this,{token:a,expirationTime:bf(1e3*b.exp),authTime:bf(1e3*b.auth_time),issuedAtTime:bf(1e3*b.iat),signInProvider:b.firebase&&b.firebase.sign_in_provider?b.firebase.sign_in_provider:null,signInSecondFactor:b.firebase&&b.firebase.sign_in_second_factor?b.firebase.sign_in_second_factor:null,claims:b})}function im(a,b,c){var d=b&&b[jm];if(!d)throw new t(\"argument-error\",\"Internal assert: Invalid MultiFactorResolver\");this.a=a,this.f=nb(b),this.g=c,this.c=new yg(null,d),this.b=[];var e=this;w(b[km]||[],(function(f){(f=tf(f))&&e.b.push(f)})),M(this,\"auth\",this.a),M(this,\"session\",this.c),M(this,\"hints\",this.b)}Hl.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Hl.prototype.h=function(a,b){if(a){this.reset(),this.g=!0;var c=a.c,d=a.b,e=a.a&&\"auth/web-storage-unsupported\"==a.a.code,f=a.a&&\"auth/operation-not-supported-in-this-environment\"==a.a.code;this.i=!(!e&&!f),\"unknown\"!=c||e||f?a.a?(Yl(this,!0,null,a.a),E()):b.Fa(c,d)?function(a,b,c){c=c.Fa(b.c,b.b);var d=b.g,e=b.f,f=b.i,g=b.T(),h=!!b.c.match(/Redirect$/);c(d,e,g,f).then((function(m){Yl(a,h,m,null)})).o((function(m){Yl(a,h,null,m)}))}(this,a,b):F(new t(\"invalid-auth-event\")):(Yl(this,!1,null,null),E())}else F(new t(\"invalid-auth-event\"))},Hl.prototype.qa=function(){var a=this;return new D((function(b,c){a.b?a.b().then(b,c):(a.f.push(b),a.c.push(c),function(a){var b=new t(\"timeout\");a.a&&a.a.cancel(),a.a=Fd(Sl.get()).then((function(){a.b||(a.g=!0,Yl(a,!0,null,b))}))}(a))}))},Il.prototype.h=function(a,b){if(a){var c=a.c,d=a.b;a.a?(b.na(a.c,null,a.a,a.b),E()):b.Fa(c,d)?function(a,b){var c=a.b,d=a.c;b.Fa(d,c)(a.g,a.f,a.T(),a.i).then((function(e){b.na(d,e,null,c)})).o((function(e){b.na(d,null,e,c)}))}(a,b):F(new t(\"invalid-auth-event\"))}else F(new t(\"invalid-auth-event\"))},fm.prototype.confirm=function(a){return a=ph(this.verificationId,a),this.a(a)};var km=\"mfaInfo\",jm=\"mfaPendingCredential\";function lm(a,b,c,d){t.call(this,\"multi-factor-auth-required\",d,b),this.b=new im(a,b,c),M(this,\"resolver\",this.b)}function mm(a,b,c){if(a&&n(a.serverResponse)&&\"auth/multi-factor-auth-required\"===a.code)try{return new lm(b,a.serverResponse,c,a.message)}catch(d){}return null}function nm(){}function qm(a){M(this,\"factorId\",a.fa),this.a=a}function rm(a){if(qm.call(this,a),this.a.fa!=lh.PROVIDER_ID)throw new t(\"argument-error\",\"firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential\")}function sm(a,b){for(var c in G.call(this,a),b)this[c]=b[c]}function tm(a,b){this.a=a,this.b=[],this.c=q(this.yc,this),nd(this.a,\"userReloaded\",this.c);var c=[];b&&b.multiFactor&&b.multiFactor.enrolledFactors&&w(b.multiFactor.enrolledFactors,(function(d){var e=null,f={};if(d){d.uid&&(f[qf]=d.uid),d.displayName&&(f[rf]=d.displayName),d.enrollmentTime&&(f[sf]=new Date(d.enrollmentTime).toISOString()),d.phoneNumber&&(f[pf]=d.phoneNumber);try{e=new uf(f)}catch(g){}d=e}else d=null;d&&c.push(d)})),um(this,c)}function um(a,b){a.b=b,M(a,\"enrolledFactors\",b)}function xm(a,b,c){if(this.h=a,this.i=b,this.g=c,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error(\"Proactive refresh lower bound greater than upper bound!\")}function Am(a){this.f=a,this.b=this.a=null,this.c=Date.now()}function Bm(a,b){void 0===b&&(b=a.b?(b=a.b).a-b.g:0),a.c=Date.now()+1e3*b}function Cm(a,b){a.b=jg(b[Dg]||\"\"),a.a=b.refreshToken,Bm(a,void 0!==(b=b.expiresIn)?Number(b):void 0)}function Fm(a,b){this.a=a||null,this.b=b||null,N(this,{lastSignInTime:bf(b||null),creationTime:bf(a||null)})}function Hm(a,b,c,d,e,f){N(this,{uid:a,displayName:d||null,photoURL:e||null,email:c||null,phoneNumber:f||null,providerId:b})}function Im(a,b,c){this.J=[],this.l=a.apiKey,this.m=a.appName,this.s=a.authDomain||null;var d=index_esm.default.SDK_VERSION?Oe(index_esm.default.SDK_VERSION):null;this.a=new Ii(this.l,Ca(Da),d),a.emulatorConfig&&Pi(this.a,a.emulatorConfig),this.b=new Am(this.a),Jm(this,b[Dg]),Cm(this.b,b),M(this,\"refreshToken\",this.b.a),Km(this,c||{}),H.call(this),this.R=!1,this.s&&Re()&&(this.i=Xl(this.s,this.l,this.m)),this.S=[],this.h=null,this.u=function(a){return new xm((function(){return a.I(!0)}),(function(b){return!(!b||\"auth/network-request-failed\"!=b.code)}),(function(){var b=a.b.c-Date.now()-3e5;return 0<b?b:0}))}(this),this.aa=q(this.hb,this);var e=this;this.ya=null,this.Oa=function(f){e.wa(f.h)},this.ja=null,this.Aa=function(f){Pi(e.a,f.c)},this.X=null,this.$=[],this.Ba=function(f){Mm(e,f.f)},this.ba=null,this.O=new tm(this,c),M(this,\"multiFactor\",this.O)}function Nm(a,b){a.ja&&xd(a.ja,\"languageCodeChanged\",a.Oa),(a.ja=b)&&nd(b,\"languageCodeChanged\",a.Oa)}function Om(a,b){a.X&&xd(a.X,\"emulatorConfigChanged\",a.Aa),(a.X=b)&&nd(b,\"emulatorConfigChanged\",a.Aa)}function Mm(a,b){a.$=b,Ri(a.a,index_esm.default.SDK_VERSION?Oe(index_esm.default.SDK_VERSION,a.$):null)}function Pm(a,b){a.ba&&xd(a.ba,\"frameworkChanged\",a.Ba),(a.ba=b)&&nd(b,\"frameworkChanged\",a.Ba)}function Qm(a){try{return index_esm.default.app(a.m).auth()}catch(b){throw new t(\"internal-error\",\"No firebase.auth.Auth instance is available for the Firebase App '\"+a.m+\"'!\")}}function Rm(a){a.D||a.u.b||(a.u.start(),xd(a,\"tokenChanged\",a.aa),nd(a,\"tokenChanged\",a.aa))}function Sm(a){xd(a,\"tokenChanged\",a.aa),a.u.stop()}function Jm(a,b){a.za=b,M(a,\"_lat\",b)}function Um(a){for(var b=[],c=0;c<a.S.length;c++)b.push(a.S[c](a));return Jc(b).then((function(){return a}))}function Vm(a){a.i&&!a.R&&(a.R=!0,Pl(a.i,a))}function Km(a,b){N(a,{uid:b.uid,displayName:b.displayName||null,photoURL:b.photoURL||null,email:b.email||null,emailVerified:b.emailVerified||!1,phoneNumber:b.phoneNumber||null,isAnonymous:b.isAnonymous||!1,tenantId:b.tenantId||null,metadata:new Fm(b.createdAt,b.lastLoginAt),providerData:[]}),a.a.b=a.tenantId}function Wm(){}function Xm(a){return E().then((function(){if(a.D)throw new t(\"app-deleted\")}))}function Ym(a){return Ra(a.providerData,(function(b){return b.providerId}))}function Zm(a,b){b&&($m(a,b.providerId),a.providerData.push(b))}function $m(a,b){Xa(a.providerData,(function(c){return c.providerId==b}))}function an(a,b,c){(\"uid\"!=b||c)&&a.hasOwnProperty(b)&&M(a,b,c)}function bn(a,b){a!=b&&(N(a,{uid:b.uid,displayName:b.displayName,photoURL:b.photoURL,email:b.email,emailVerified:b.emailVerified,phoneNumber:b.phoneNumber,isAnonymous:b.isAnonymous,tenantId:b.tenantId,providerData:[]}),M(a,\"metadata\",b.metadata?function(a){return new Fm(a.a,a.b)}(b.metadata):new Fm),w(b.providerData,(function(c){Zm(a,c)})),function(a,b){a.b=b.b,a.a=b.a,a.c=b.c}(a.b,b.b),M(a,\"refreshToken\",a.b.a),um(a.O,b.O.b))}function cn(a){return a.I().then((function(b){var c=a.isAnonymous;return function(a,b){return O(a.a,Ij,{idToken:b}).then(q(a.Kc,a))}(a,b).then((function(){return c||an(a,\"isAnonymous\",!1),b}))}))}function wm(a,b){b[Dg]&&a.za!=b[Dg]&&(Cm(a.b,b),a.dispatchEvent(new sm(\"tokenChanged\")),Jm(a,b[Dg]),an(a,\"refreshToken\",a.b.a))}function gn(a,b){return cn(a).then((function(){if(Va(Ym(a),b))return Um(a).then((function(){throw new t(\"provider-already-linked\")}))}))}function fn(a,b,c){return kf({user:a,credential:qh(b),additionalUserInfo:b=og(b),operationType:c})}function hn(a,b){return wm(a,b),a.reload().then((function(){return a}))}function jn(a,b,c,d,e){if(!Re())return F(new t(\"operation-not-supported-in-this-environment\"));if(a.h&&!e)return F(a.h);var f=ng(c.providerId),g=Qe(a.uid+\":::\"),h=null;(!Te()||Ie())&&a.s&&c.isOAuthProvider&&(h=ek(a.s,a.l,a.m,b,c,null,g,index_esm.default.SDK_VERSION||null,null,null,a.tenantId));var m=ze(h,f&&f.ua,f&&f.ta);return d=d().then((function(){if(kn(a),!e)return a.I().then((function(){}))})).then((function(){return Tl(a.i,m,b,c,g,!!h,a.tenantId)})).then((function(){return new D((function(p,v){a.na(b,null,new t(\"cancelled-popup-request\"),a.g||null),a.f=p,a.C=v,a.g=g,a.c=Vl(a.i,a,b,m,g)}))})).then((function(p){return m&&ye(m),p?kf(p):null})).o((function(p){throw m&&ye(m),p})),R(a,d,e)}function ln(a,b,c,d,e){if(!Re())return F(new t(\"operation-not-supported-in-this-environment\"));if(a.h&&!e)return F(a.h);var f=null,g=Qe(a.uid+\":::\");return d=d().then((function(){if(kn(a),!e)return a.I().then((function(){}))})).then((function(){return a.ga=g,Um(a)})).then((function(h){return a.ha&&(h=(h=a.ha).b.set(mn,a.w(),h.a)),h})).then((function(){return Ul(a.i,b,c,g,a.tenantId)})).o((function(h){if(f=h,a.ha)return nn(a.ha);throw f})).then((function(){if(f)throw f})),R(a,d,e)}function kn(a){if(!a.i||!a.R){if(a.i&&!a.R)throw new t(\"internal-error\");throw new t(\"auth-domain-config-required\")}}function R(a,b,c){var d=function(a,b,c){return a.h&&!c?(b.cancel(),F(a.h)):b.o((function(d){throw!d||\"auth/user-disabled\"!=d.code&&\"auth/user-token-expired\"!=d.code||(a.h||a.dispatchEvent(new sm(\"userInvalidated\")),a.h=d),d}))}(a,b,c);return a.J.push(d),d.oa((function(){Wa(a.J,d)})),d.o((function(e){var f=null;throw e&&\"auth/multi-factor-auth-required\"===e.code&&(f=mm(e.w(),Qm(a),q(a.jc,a))),f||e}))}function pn(a){if(!a.apiKey)return null;var b={apiKey:a.apiKey,authDomain:a.authDomain,appName:a.appName,emulatorConfig:a.emulatorConfig},c={};if(!a.stsTokenManager||!a.stsTokenManager.accessToken)return null;c[Dg]=a.stsTokenManager.accessToken,c.refreshToken=a.stsTokenManager.refreshToken||null;var d=a.stsTokenManager.expirationTime;d&&(c.expiresIn=(d-Date.now())/1e3);var e=new Im(b,c,a);return a.providerData&&w(a.providerData,(function(f){f&&Zm(e,kf(f))})),a.redirectEventId&&(e.ga=a.redirectEventId),e}function sn(a){this.a=a,this.b=Vk()}im.prototype.Rc=function(a){var b=this;return a.sb(this.a.a,this.c).then((function(c){var d=nb(b.f);return delete d[km],delete d[jm],z(d,c),b.g(d)}))},r(lm,t),nm.prototype.sb=function(a,b,c){return b.type==zg?function(a,b,c,d){return c.Ha().then((function(e){return e={idToken:e},void 0!==d&&(e.displayName=d),z(e,{phoneVerificationInfo:hh(a.a)}),O(b,Gj,e)}))}(this,a,b,c):function(a,b,c){return c.Ha().then((function(d){return z(d={mfaPendingCredential:d},{phoneVerificationInfo:hh(a.a)}),O(b,Hj,d)}))}(this,a,b)},r(qm,nm),r(rm,qm),r(sm,G),(k=tm.prototype).yc=function(a){um(this,function(a){var b=[];return w(a.mfaInfo||[],(function(c){(c=tf(c))&&b.push(c)})),b}(a.hd))},k.Rb=function(){return this.a.I().then((function(a){return new yg(a,null)}))},k.fc=function(a,b){var c=this,d=this.a.a;return this.Rb().then((function(e){return a.sb(d,e,b)})).then((function(e){return wm(c.a,e),c.a.reload()}))},k.bd=function(a){var b=this,c=\"string\"==typeof a?a:a.uid,d=this.a.a;return this.a.I().then((function(e){return O(d,Lj,{idToken:e,mfaEnrollmentId:c})})).then((function(e){var f=Qa(b.b,(function(g){return g.uid!=c}));return um(b,f),wm(b.a,e),b.a.reload().o((function(g){if(\"auth/user-token-expired\"!=g.code)throw g}))}))},k.w=function(){return{multiFactor:{enrolledFactors:Ra(this.b,(function(a){return a.w()}))}}},xm.prototype.start=function(){this.a=this.c,function ym(a,b){a.stop(),a.b=Fd(function(a,b){return b?(a.a=a.c,a.g()):(b=a.a,a.a*=2,a.a>a.f&&(a.a=a.f),b)}(a,b)).then((function(){return function(){var a=l.document,b=null;return $e()||!a?E():new D((function(c){b=function(){$e()&&(a.removeEventListener(\"visibilitychange\",b,!1),c())},a.addEventListener(\"visibilitychange\",b,!1)})).o((function(c){throw a.removeEventListener(\"visibilitychange\",b,!1),c}))}()})).then((function(){return a.h()})).then((function(){ym(a,!0)})).o((function(c){a.i(c)&&ym(a,!1)}))}(this,!0)},xm.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Am.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},Am.prototype.getToken=function(a){return a=!!a,this.b&&!this.a?F(new t(\"user-token-expired\")):a||!this.b||Date.now()>this.c-3e4?this.a?function(a,b){return function(a,b){return new D((function(c,d){\"refresh_token\"==b.grant_type&&b.refresh_token||\"authorization_code\"==b.grant_type&&b.code?Si(a,a.l+\"?key=\"+encodeURIComponent(a.c),(function(e){e?e.error?d(Xi(e)):e.access_token&&e.refresh_token?c(e):d(new t(\"internal-error\")):d(new t(\"network-request-failed\"))}),\"POST\",fe(b).toString(),a.g,a.m.get()):d(new t(\"internal-error\"))}))}(a.f,b).then((function(c){return a.b=jg(c.access_token),a.a=c.refresh_token,Bm(a,c.expires_in),{accessToken:a.b.toString(),refreshToken:a.a}})).o((function(c){throw\"auth/user-token-expired\"==c.code&&(a.a=null),c}))}(this,{grant_type:\"refresh_token\",refresh_token:this.a}):E(null):E({accessToken:this.b.toString(),refreshToken:this.a})},Fm.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},r(Im,H),Im.prototype.wa=function(a){this.ya=a,Oi(this.a,a)},Im.prototype.la=function(){return this.ya},Im.prototype.Ga=function(){return Za(this.$)},Im.prototype.hb=function(){this.u.b&&(this.u.stop(),this.u.start())},M(Im.prototype,\"providerId\",\"firebase\"),(k=Im.prototype).reload=function(){var a=this;return R(this,Xm(this).then((function(){return cn(a).then((function(){return Um(a)})).then(Wm)})))},k.oc=function(a){return this.I(a).then((function(b){return new hm(b)}))},k.I=function(a){var b=this;return R(this,Xm(this).then((function(){return b.b.getToken(a)})).then((function(c){if(!c)throw new t(\"internal-error\");return c.accessToken!=b.za&&(Jm(b,c.accessToken),b.dispatchEvent(new sm(\"tokenChanged\"))),an(b,\"refreshToken\",c.refreshToken),c.accessToken})))},k.Kc=function(a){if(!(a=a.users)||!a.length)throw new t(\"internal-error\");Km(this,{uid:(a=a[0]).localId,displayName:a.displayName,photoURL:a.photoUrl,email:a.email,emailVerified:!!a.emailVerified,phoneNumber:a.phoneNumber,lastLoginAt:a.lastLoginAt,createdAt:a.createdAt,tenantId:a.tenantId});for(var b=function(a){return(a=a.providerUserInfo)&&a.length?Ra(a,(function(b){return new Hm(b.rawId,b.providerId,b.email,b.displayName,b.photoUrl,b.phoneNumber)})):[]}(a),c=0;c<b.length;c++)Zm(this,b[c]);an(this,\"isAnonymous\",!(this.email&&a.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new sm(\"userReloaded\",{hd:a}))},k.Lc=function(a){return gf(\"firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead.\"),this.tb(a)},k.tb=function(a){var b=this,c=null;return R(this,a.c(this.a,this.uid).then((function(d){return wm(b,d),c=fn(b,d,\"reauthenticate\"),b.h=null,b.reload()})).then((function(){return c})),!0)},k.Cc=function(a){return gf(\"firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead.\"),this.qb(a)},k.qb=function(a){var b=this,c=null;return R(this,gn(this,a.providerId).then((function(){return b.I()})).then((function(d){return a.b(b.a,d)})).then((function(d){return c=fn(b,d,\"link\"),hn(b,d)})).then((function(){return c})))},k.Dc=function(a,b){var c=this;return R(this,gn(this,\"phone\").then((function(){return gm(Qm(c),a,b,q(c.qb,c))})))},k.Mc=function(a,b){var c=this;return R(this,E().then((function(){return gm(Qm(c),a,b,q(c.tb,c))})),!0)},k.Bb=function(a){var b=this;return R(this,this.I().then((function(c){return b.a.Bb(c,a)})).then((function(c){return wm(b,c),b.reload()})))},k.ed=function(a){var b=this;return R(this,this.I().then((function(c){return a.b(b.a,c)})).then((function(c){return wm(b,c),b.reload()})))},k.Cb=function(a){var b=this;return R(this,this.I().then((function(c){return b.a.Cb(c,a)})).then((function(c){return wm(b,c),b.reload()})))},k.Db=function(a){if(void 0===a.displayName&&void 0===a.photoURL)return Xm(this);var b=this;return R(this,this.I().then((function(c){return b.a.Db(c,{displayName:a.displayName,photoUrl:a.photoURL})})).then((function(c){return wm(b,c),an(b,\"displayName\",c.displayName||null),an(b,\"photoURL\",c.photoUrl||null),w(b.providerData,(function(d){\"password\"===d.providerId&&(M(d,\"displayName\",b.displayName),M(d,\"photoURL\",b.photoURL))})),Um(b)})).then(Wm))},k.cd=function(a){var b=this;return R(this,cn(this).then((function(c){return Va(Ym(b),a)?function(a,b,c){return O(a,sj,{idToken:b,deleteProvider:c})}(b.a,c,[a]).then((function(d){var e={};return w(d.providerUserInfo||[],(function(f){e[f.providerId]=!0})),w(Ym(b),(function(f){e[f]||$m(b,f)})),e[lh.PROVIDER_ID]||M(b,\"phoneNumber\",null),Um(b)})):Um(b).then((function(){throw new t(\"no-such-provider\")}))})))},k.delete=function(){var a=this;return R(this,this.I().then((function(b){return O(a.a,Fj,{idToken:b})})).then((function(){a.dispatchEvent(new sm(\"userDeleted\"))}))).then((function(){for(var b=0;b<a.J.length;b++)a.J[b].cancel(\"app-deleted\");Nm(a,null),Om(a,null),Pm(a,null),a.J=[],a.D=!0,Sm(a),M(a,\"refreshToken\",null),a.i&&Ql(a.i,a)}))},k.Fb=function(a,b){return!!(\"linkViaPopup\"==a&&(this.g||null)==b&&this.f||\"reauthViaPopup\"==a&&(this.g||null)==b&&this.f||\"linkViaRedirect\"==a&&(this.ga||null)==b||\"reauthViaRedirect\"==a&&(this.ga||null)==b)},k.na=function(a,b,c,d){\"linkViaPopup\"!=a&&\"reauthViaPopup\"!=a||d!=(this.g||null)||(c&&this.C?this.C(c):b&&!c&&this.f&&this.f(b),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},k.Fa=function(a,b){return\"linkViaPopup\"==a&&b==(this.g||null)?q(this.Kb,this):\"reauthViaPopup\"==a&&b==(this.g||null)?q(this.Lb,this):\"linkViaRedirect\"==a&&(this.ga||null)==b?q(this.Kb,this):\"reauthViaRedirect\"==a&&(this.ga||null)==b?q(this.Lb,this):null},k.Ec=function(a){var b=this;return jn(this,\"linkViaPopup\",a,(function(){return gn(b,a.providerId).then((function(){return Um(b)}))}),!1)},k.Nc=function(a){return jn(this,\"reauthViaPopup\",a,(function(){return E()}),!0)},k.Fc=function(a){var b=this;return ln(this,\"linkViaRedirect\",a,(function(){return gn(b,a.providerId)}),!1)},k.Oc=function(a){return ln(this,\"reauthViaRedirect\",a,(function(){return E()}),!0)},k.Kb=function(a,b,c,d){var e=this;this.c&&(this.c.cancel(),this.c=null);var f=null;return R(this,this.I().then((function(g){return Hg(e.a,{requestUri:a,postBody:d,sessionId:b,idToken:g})})).then((function(g){return f=fn(e,g,\"link\"),hn(e,g)})).then((function(){return f})))},k.Lb=function(a,b,c,d){var e=this;this.c&&(this.c.cancel(),this.c=null);var f=null;return R(this,E().then((function(){return Cg(Ig(e.a,{requestUri:a,sessionId:b,postBody:d,tenantId:c}),e.uid)})).then((function(h){return f=fn(e,h,\"reauthenticate\"),wm(e,h),e.h=null,e.reload()})).then((function(){return f})),!0)},k.ub=function(a){var b=this,c=null;return R(this,this.I().then((function(d){return c=d,void 0===a||mb(a)?{}:bg(new Sf(a))})).then((function(d){return b.a.ub(c,d)})).then((function(d){if(b.email!=d)return b.reload()})).then((function(){})))},k.Eb=function(a,b){var c=this,d=null;return R(this,this.I().then((function(e){return d=e,void 0===b||mb(b)?{}:bg(new Sf(b))})).then((function(e){return c.a.Eb(d,a,e)})).then((function(e){if(c.email!=e)return c.reload()})).then((function(){})))},k.jc=function(a){var b=null,c=this;return R(this,a=Cg(E(a),c.uid).then((function(d){return b=fn(c,d,\"reauthenticate\"),wm(c,d),c.h=null,c.reload()})).then((function(){return b})),!0)},k.toJSON=function(){return this.w()},k.w=function(){var a={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&z(a,this.metadata.w()),w(this.providerData,(function(b){a.providerData.push(function(a){var c,b={};for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}(b))})),z(a,this.O.w()),a};var mn={name:\"redirectUser\",F:\"session\"};function nn(a){return Zk(a.b,mn,a.a)}function un(a){this.a=a,this.b=Vk(),this.c=null,this.f=function(a){var b=wn(\"local\"),c=wn(\"session\"),d=wn(\"none\");return function(a,b,c){var d=Xk(b,c),e=Wk(a,b.F);return a.get(b,c).then((function(f){var g=null;try{g=We(l.localStorage.getItem(d))}catch(h){}if(g&&!f)return l.localStorage.removeItem(d),a.set(b,g,c);g&&f&&\"localStorage\"!=e.type&&l.localStorage.removeItem(d)}))}(a.b,b,a.a).then((function(){return a.b.get(c,a.a)})).then((function(e){return e?c:a.b.get(d,a.a).then((function(f){return f?d:a.b.get(b,a.a).then((function(g){return g?b:a.b.get(zn,a.a).then((function(h){return h?wn(h):b}))}))}))})).then((function(e){return a.c=e,yn(a,e.F)})).o((function(){a.c||(a.c=b)}))}(this),this.b.addListener(wn(\"local\"),this.a,q(this.g,this))}function yn(a,b){var d,c=[];for(d in Rk)Rk[d]!==b&&c.push(Zk(a.b,wn(Rk[d]),a.a));return c.push(Zk(a.b,zn,a.a)),function(a){return new D((function(b,c){var d=a.length,e=[];if(d)for(var f=function(p,v){d--,e[p]=v,0==d&&b(e)},g=function(p){c(p)},h=0;h<a.length;h++)Gc(a[h],ua(f,h),g);else b(e)}))}(c)}un.prototype.g=function(){var a=this,b=wn(\"local\");xn(this,(function(){return E().then((function(){return a.c&&\"local\"!=a.c.F?a.b.get(b,a.a):null})).then((function(c){if(c)return yn(a,\"local\").then((function(){a.c=b}))}))}))};var zn={name:\"persistence\",F:\"session\"};function wn(a){return{name:\"authUser\",F:a}}function Bn(a,b){return xn(a,(function(){return a.b.set(a.c,b.w(),a.a)}))}function Cn(a){return xn(a,(function(){return Zk(a.b,a.c,a.a)}))}function Dn(a,b,c){return xn(a,(function(){return a.b.get(a.c,a.a).then((function(d){return d&&b&&(d.authDomain=b),d&&c&&(d.emulatorConfig=c),pn(d||{})}))}))}function xn(a,b){return a.f=a.f.then(b,b),a.f}function En(a){if(this.l=!1,M(this,\"settings\",new em),M(this,\"app\",a),!S(this).options||!S(this).options.apiKey)throw new t(\"invalid-api-key\");a=index_esm.default.SDK_VERSION?Oe(index_esm.default.SDK_VERSION):null,this.a=new Ii(S(this).options&&S(this).options.apiKey,Ca(Da),a),this.R=[],this.s=[],this.O=[],this.hb=index_esm.default.INTERNAL.createSubscribe(q(this.zc,this)),this.X=void 0,this.bc=index_esm.default.INTERNAL.createSubscribe(q(this.Ac,this)),Fn(this,null),this.i=new un(S(this).options.apiKey+\":\"+S(this).name),this.D=new sn(S(this).options.apiKey+\":\"+S(this).name),this.$=T(this,function(a){var b=S(a).options.authDomain,c=function(a){var b=function(a,b){return a.b.get(mn,a.a).then((function(c){return c&&b&&(c.authDomain=b),pn(c||{})}))}(a.D,S(a).options.authDomain).then((function(c){return(a.m=c)&&(c.ha=a.D),nn(a.D)}));return T(a,b)}(a).then((function(){return Dn(a.i,b,a.P)})).then((function(d){return d?(d.ha=a.D,a.m&&(a.m.ga||null)==(d.ga||null)?d:d.reload().then((function(){return Bn(a.i,d).then((function(){return d}))})).o((function(e){return\"auth/network-request-failed\"==e.code?d:Cn(a.i)}))):null})).then((function(d){Fn(a,d||null)}));return T(a,c)}(this)),this.h=T(this,function(a){return a.$.then((function(){return Qn(a)})).o((function(){})).then((function(){if(!a.l)return a.ja()})).o((function(){})).then((function(){if(!a.l){a.ba=!0;var b=a.i;b.b.addListener(wn(\"local\"),b.a,a.ja)}}))}(this)),this.ba=!1,this.ja=q(this.Zc,this),this.Ba=q(this.da,this),this.ya=q(this.mc,this),this.za=q(this.wc,this),this.Aa=q(this.xc,this),this.b=null,function(a){var b=S(a).options.authDomain,c=S(a).options.apiKey;b&&Re()&&(a.Oa=a.$.then((function(){if(!a.l){if(a.b=Xl(b,c,S(a).name,a.P),Pl(a.b,a),U(a)&&Vm(U(a)),a.m){Vm(a.m);var d=a.m;d.wa(a.la()),Nm(d,a),Mm(d=a.m,a.J),Pm(d,a),Pi((d=a.m).a,a.P),Om(d,a),a.m=null}return a.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=q(this.delete,this),this.INTERNAL.logFramework=q(this.Gc,this),this.u=0,H.call(this),function(a){Object.defineProperty(a,\"lc\",{get:function(){return this.la()},set:function(b){this.wa(b)},enumerable:!1}),a.aa=null,Object.defineProperty(a,\"ti\",{get:function(){return this.T()},set:function(b){this.yb(b)},enumerable:!1}),a.S=null,Object.defineProperty(a,\"emulatorConfig\",{get:function(){if(this.P){var b=J(this.P.url);b=kf({protocol:b.c,host:b.a,port:b.g,options:kf({disableWarnings:this.P.ec})})}else b=null;return b},enumerable:!1})}(this),this.J=[],this.P=null}function Kn(a){G.call(this,\"languageCodeChanged\"),this.h=a}function Ln(a){G.call(this,\"emulatorConfigChanged\"),this.c=a}function Mn(a){G.call(this,\"frameworkChanged\"),this.f=a}function On(a){return a.Oa||F(new t(\"auth-domain-config-required\"))}function Qn(a){if(!Re())return F(new t(\"operation-not-supported-in-this-environment\"));var b=On(a).then((function(){return a.b.qa()})).then((function(c){return c?kf(c):null}));return T(a,b)}function Fn(a,b){U(a)&&(function(a,b){Xa(a.S,(function(c){return c==b}))}(U(a),a.Ba),xd(U(a),\"tokenChanged\",a.ya),xd(U(a),\"userDeleted\",a.za),xd(U(a),\"userInvalidated\",a.Aa),Sm(U(a))),b&&(b.S.push(a.Ba),nd(b,\"tokenChanged\",a.ya),nd(b,\"userDeleted\",a.za),nd(b,\"userInvalidated\",a.Aa),0<a.u&&Rm(b)),M(a,\"currentUser\",b),b&&(b.wa(a.la()),Nm(b,a),Mm(b,a.J),Pm(b,a),Pi(b.a,a.P),Om(b,a))}function Pn(a,b){var c=null,d=null;return T(a,b.then((function(e){return c=qh(e),d=og(e),function(a,b){var c={};return c.apiKey=S(a).options.apiKey,c.authDomain=S(a).options.authDomain,c.appName=S(a).name,a.P&&(c.emulatorConfig=a.P),a.$.then((function(){return function(a,b,c,d){var e=new Im(a,b);return c&&(e.ha=c),d&&Mm(e,d),e.reload().then((function(){return e}))}(c,b,a.D,a.Ga())})).then((function(d){return U(a)&&d.uid==U(a).uid?(bn(U(a),d),a.da(d)):(Fn(a,d),Vm(d),a.da(d))})).then((function(){Rn(a)}))}(a,e)}),(function(e){var f=null;throw e&&\"auth/multi-factor-auth-required\"===e.code&&(f=mm(e.w(),a,q(a.kc,a))),f||e})).then((function(){return kf({user:U(a),credential:c,additionalUserInfo:d,operationType:\"signIn\"})})))}function S(a){return a.app}function U(a){return a.currentUser}function Vn(a){return U(a)&&U(a)._lat||null}function Rn(a){if(a.ba){for(var b=0;b<a.s.length;b++)a.s[b]&&a.s[b](Vn(a));if(a.X!==a.getUid()&&a.O.length)for(a.X=a.getUid(),b=0;b<a.O.length;b++)a.O[b]&&a.O[b](Vn(a))}}function T(a,b){return a.R.push(b),b.oa((function(){Wa(a.R,b)})),b}function Wn(){}function Xn(){this.a={},this.b=1e12}un.prototype.xb=function(a){var b=null,c=this;return function(a){var b=new t(\"invalid-persistence-type\"),c=new t(\"unsupported-persistence-type\");a:{for(d in Rk)if(Rk[d]==a){var d=!0;break a}d=!1}if(!d||\"string\"!=typeof a)throw b;switch(Ke()){case\"ReactNative\":if(\"session\"===a)throw c;break;case\"Node\":if(\"none\"!==a)throw c;break;case\"Worker\":if(\"session\"===a||!pk()&&\"none\"!==a)throw c;break;default:if(!Pe()&&\"none\"!==a)throw c}}(a),xn(this,(function(){return a!=c.c.F?c.b.get(c.c,c.a).then((function(d){return b=d,yn(c,a)})).then((function(){if(c.c=wn(a),b)return c.b.set(c.c,b,c.a)})):E()}))},r(En,H),r(Kn,G),r(Ln,G),r(Mn,G),(k=En.prototype).xb=function(a){return T(this,a=this.i.xb(a))},k.wa=function(a){this.aa===a||this.l||(this.aa=a,Oi(this.a,this.aa),this.dispatchEvent(new Kn(this.la())))},k.la=function(){return this.aa},k.fd=function(){var a=l.navigator;this.wa(a&&(a.languages&&a.languages[0]||a.language||a.userLanguage)||null)},k.gd=function(a,b){if(!this.P){if(!/^https?:\\/\\//.test(a))throw new t(\"argument-error\",\"Emulator URL must start with a valid scheme (http:// or https://).\");(function(a){\"undefined\"!=typeof console&&\"function\"==typeof console.info&&console.info(\"WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.\"),l.document&&!a&&Ee().then((function(){var b=l.document.createElement(\"div\");b.innerText=\"Running in emulator mode. Do not use with production credentials.\",b.style.position=\"fixed\",b.style.width=\"100%\",b.style.backgroundColor=\"#ffffff\",b.style.border=\".1em solid #000000\",b.style.color=\"#b50000\",b.style.bottom=\"0px\",b.style.left=\"0px\",b.style.margin=\"0px\",b.style.zIndex=1e4,b.style.textAlign=\"center\",b.classList.add(\"firebase-emulator-warning\"),l.document.body.appendChild(b)}))})(b=!!b&&!!b.disableWarnings),this.P={url:a,ec:b},this.settings.ib=!0,Pi(this.a,this.P),this.dispatchEvent(new Ln(this.P))}},k.Gc=function(a){this.J.push(a),Ri(this.a,index_esm.default.SDK_VERSION?Oe(index_esm.default.SDK_VERSION,this.J):null),this.dispatchEvent(new Mn(this.J))},k.Ga=function(){return Za(this.J)},k.yb=function(a){this.S===a||this.l||(this.S=a,this.a.b=this.S)},k.T=function(){return this.S},k.toJSON=function(){return{apiKey:S(this).options.apiKey,authDomain:S(this).options.authDomain,appName:S(this).name,currentUser:U(this)&&U(this).w()}},k.Fb=function(a,b){switch(a){case\"unknown\":case\"signInViaRedirect\":return!0;case\"signInViaPopup\":return this.g==b&&!!this.f;default:return!1}},k.na=function(a,b,c,d){\"signInViaPopup\"==a&&this.g==d&&(c&&this.C?this.C(c):b&&!c&&this.f&&this.f(b),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},k.Fa=function(a,b){return\"signInViaRedirect\"==a||\"signInViaPopup\"==a&&this.g==b&&this.f?q(this.ic,this):null},k.ic=function(a,b,c,d){var e=this,f={requestUri:a,postBody:d,sessionId:b,tenantId:c};return this.c&&(this.c.cancel(),this.c=null),e.$.then((function(){return Pn(e,Fg(e.a,f))}))},k.Xc=function(a){if(!Re())return F(new t(\"operation-not-supported-in-this-environment\"));var b=this,c=ng(a.providerId),d=Qe(),e=null;(!Te()||Ie())&&S(this).options.authDomain&&a.isOAuthProvider&&(e=ek(S(this).options.authDomain,S(this).options.apiKey,S(this).name,\"signInViaPopup\",a,null,d,index_esm.default.SDK_VERSION||null,null,null,this.T(),this.P));var f=ze(e,c&&c.ua,c&&c.ta);return T(this,c=On(this).then((function(g){return Tl(g,f,\"signInViaPopup\",a,d,!!e,b.T())})).then((function(){return new D((function(g,h){b.na(\"signInViaPopup\",null,new t(\"cancelled-popup-request\"),b.g),b.f=g,b.C=h,b.g=d,b.c=Vl(b.b,b,\"signInViaPopup\",f,d)}))})).then((function(g){return f&&ye(f),g?kf(g):null})).o((function(g){throw f&&ye(f),g})))},k.Yc=function(a){if(!Re())return F(new t(\"operation-not-supported-in-this-environment\"));var b=this;return T(this,On(this).then((function(){return function(a){return xn(a,(function(){return a.b.set(zn,a.c.F,a.a)}))}(b.i)})).then((function(){return Ul(b.b,\"signInViaRedirect\",a,void 0,b.T())})))},k.qa=function(){var a=this;return Qn(this).then((function(b){return a.b&&$l(a.b.b),b})).o((function(b){throw a.b&&$l(a.b.b),b}))},k.dd=function(a){if(!a)return F(new t(\"null-user\"));if(this.S!=a.tenantId)return F(new t(\"tenant-id-mismatch\"));var b=this,c={};c.apiKey=S(this).options.apiKey,c.authDomain=S(this).options.authDomain,c.appName=S(this).name;var d=function(a,b,c,d){var e=a.b,f={};return f[Dg]=e.b&&e.b.toString(),f.refreshToken=e.a,b=new Im(b||{apiKey:a.l,authDomain:a.s,appName:a.m},f),c&&(b.ha=c),d&&Mm(b,d),bn(b,a),b}(a,c,b.D,b.Ga());return T(this,this.h.then((function(){if(S(b).options.apiKey!=a.l)return d.reload()})).then((function(){return U(b)&&a.uid==U(b).uid?(bn(U(b),a),b.da(a)):(Fn(b,d),Vm(d),b.da(d))})).then((function(){Rn(b)})))},k.Ab=function(){var a=this;return T(this,this.h.then((function(){return a.b&&$l(a.b.b),U(a)?(Fn(a,null),Cn(a.i).then((function(){Rn(a)}))):E()})))},k.Zc=function(){var a=this;return Dn(this.i,S(this).options.authDomain).then((function(b){if(!a.l){var c;if(c=U(a)&&b){c=U(a).uid;var d=b.uid;c=null!=c&&\"\"!==c&&null!=d&&\"\"!==d&&c==d}if(c)return bn(U(a),b),U(a).I();(U(a)||b)&&(Fn(a,b),b&&(Vm(b),b.ha=a.D),a.b&&Pl(a.b,a),Rn(a))}}))},k.da=function(a){return Bn(this.i,a)},k.mc=function(){Rn(this),this.da(U(this))},k.wc=function(){this.Ab()},k.xc=function(){this.Ab()},k.kc=function(a){var b=this;return this.h.then((function(){return Pn(b,E(a))}))},k.zc=function(a){var b=this;this.addAuthTokenListener((function(){a.next(U(b))}))},k.Ac=function(a){var b=this;!function(a,b){a.O.push(b),T(a,a.h.then((function(){!a.l&&Va(a.O,b)&&a.X!==a.getUid()&&(a.X=a.getUid(),b(Vn(a)))})))}(this,(function(){a.next(U(b))}))},k.Ic=function(a,b,c){var d=this;return this.ba&&Promise.resolve().then((function(){\"function\"==typeof a?a(U(d)):\"function\"==typeof a.next&&a.next(U(d))})),this.hb(a,b,c)},k.Hc=function(a,b,c){var d=this;return this.ba&&Promise.resolve().then((function(){d.X=d.getUid(),\"function\"==typeof a?a(U(d)):\"function\"==typeof a.next&&a.next(U(d))})),this.bc(a,b,c)},k.nc=function(a){var b=this;return T(this,this.h.then((function(){return U(b)?U(b).I(a).then((function(d){return{accessToken:d}})):null})))},k.Tc=function(a){var b=this;return this.h.then((function(){return Pn(b,O(b.a,Kj,{token:a}))})).then((function(c){var d=c.user;return an(d,\"isAnonymous\",!1),b.da(d),c}))},k.Uc=function(a,b){var c=this;return this.h.then((function(){return Pn(c,O(c.a,ah,{email:a,password:b}))}))},k.dc=function(a,b){var c=this;return this.h.then((function(){return Pn(c,O(c.a,Ej,{email:a,password:b}))}))},k.$a=function(a){var b=this;return this.h.then((function(){return Pn(b,a.ka(b.a))}))},k.Sc=function(a){return gf(\"firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead.\"),this.$a(a)},k.zb=function(){var a=this;return this.h.then((function(){var b=U(a);if(b&&b.isAnonymous){var c=kf({providerId:null,isNewUser:!1});return kf({user:b,credential:null,additionalUserInfo:c,operationType:\"signIn\"})}return Pn(a,a.a.zb()).then((function(d){var e=d.user;return an(e,\"isAnonymous\",!0),a.da(e),d}))}))},k.getUid=function(){return U(this)&&U(this).uid||null},k.cc=function(a){this.addAuthTokenListener(a),this.u++,0<this.u&&U(this)&&Rm(U(this))},k.Pc=function(a){var b=this;w(this.s,(function(c){c==a&&b.u--})),0>this.u&&(this.u=0),0==this.u&&U(this)&&Sm(U(this)),this.removeAuthTokenListener(a)},k.addAuthTokenListener=function(a){var b=this;this.s.push(a),T(this,this.h.then((function(){b.l||Va(b.s,a)&&a(Vn(b))})))},k.removeAuthTokenListener=function(a){Xa(this.s,(function(b){return b==a}))},k.delete=function(){this.l=!0;for(var a=0;a<this.R.length;a++)this.R[a].cancel(\"app-deleted\");return this.R=[],this.i&&(a=this.i).b.removeListener(wn(\"local\"),a.a,this.ja),this.b&&(Ql(this.b,this),$l(this.b.b)),Promise.resolve()},k.hc=function(a){return T(this,function(a,b){return O(a,bj,{identifier:b,continueUri:Se()?re():\"http://localhost\"}).then((function(c){return c.signinMethods||[]}))}(this.a,a))},k.Bc=function(a){return!!fh(a)},k.wb=function(a,b){var c=this;return T(this,E().then((function(){var d=new Sf(b);if(!d.c)throw new t(\"argument-error\",$f+\" must be true when sending sign in link to email\");return bg(d)})).then((function(d){return c.a.wb(a,d)})).then((function(){})))},k.jd=function(a){return this.Ra(a).then((function(b){return b.data.email}))},k.nb=function(a,b){return T(this,this.a.nb(a,b).then((function(){})))},k.Ra=function(a){return T(this,this.a.Ra(a).then((function(b){return new vf(b)})))},k.jb=function(a){return T(this,this.a.jb(a).then((function(){})))},k.vb=function(a,b){var c=this;return T(this,E().then((function(){return void 0===b||mb(b)?{}:bg(new Sf(b))})).then((function(d){return c.a.vb(a,d)})).then((function(){})))},k.Wc=function(a,b){return T(this,gm(this,a,b,q(this.$a,this)))},k.Vc=function(a,b){var c=this;return T(this,E().then((function(){var d=b||re(),e=eh(a,d);if(!(d=fh(d)))throw new t(\"argument-error\",\"Invalid email link!\");if(d.tenantId!==c.T())throw new t(\"tenant-id-mismatch\");return c.$a(e)})))},Wn.prototype.render=function(){},Wn.prototype.reset=function(){},Wn.prototype.getResponse=function(){},Wn.prototype.execute=function(){};var Yn=null;function $n(a,b){return(b=ao(b))&&a.a[b]||null}function ao(a){return(a=void 0===a?1e12:a)?a.toString():null}function Zn(a,b){this.g=!1,this.c=b,this.a=this.b=null,this.h=\"invisible\"!==this.c.size,this.f=kc(a);var c=this;this.i=function(){c.execute()},this.h?this.execute():nd(this.f,\"click\",this.i)}function bo(a){if(a.g)throw Error(\"reCAPTCHA mock was already deleted!\")}function co(){}function eo(){}Xn.prototype.render=function(a,b){return this.a[this.b.toString()]=new Zn(a,b),this.b++},Xn.prototype.reset=function(a){var b=$n(this,a);a=ao(a),b&&a&&(b.delete(),delete this.a[a])},Xn.prototype.getResponse=function(a){return(a=$n(this,a))?a.getResponse():null},Xn.prototype.execute=function(a){(a=$n(this,a))&&a.execute()},Zn.prototype.getResponse=function(){return bo(this),this.b},Zn.prototype.execute=function(){bo(this);var a=this;this.a||(this.a=setTimeout((function(){a.b=function(){for(var a=50,b=[];0<a;)b.push(\"1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\".charAt(Math.floor(62*Math.random()))),a--;return b.join(\"\")}();var b=a.c.callback,c=a.c[\"expired-callback\"];if(b)try{b(a.b)}catch(d){}a.a=setTimeout((function(){if(a.a=null,a.b=null,c)try{c()}catch(d){}a.h&&a.execute()}),6e4)}),500))},Zn.prototype.delete=function(){bo(this),this.g=!0,clearTimeout(this.a),this.a=null,xd(this.f,\"click\",this.i)},M(co,\"FACTOR_ID\",\"phone\"),eo.prototype.g=function(){return Yn||(Yn=new Xn),E(Yn)},eo.prototype.c=function(){};var fo=null;function go(){this.b=l.grecaptcha?1/0:0,this.f=null,this.a=\"__rcb\"+Math.floor(1e6*Math.random()).toString()}var ho=new qb(rb,\"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}\"),io=new Ze(3e4,6e4);go.prototype.g=function(a){var b=this;return new D((function(c,d){var e=setTimeout((function(){d(new t(\"network-request-failed\"))}),io.get());!l.grecaptcha||a!==b.f&&!b.b?(l[b.a]=function(){if(l.grecaptcha){b.f=a;var g=l.grecaptcha.render;l.grecaptcha.render=function(h,m){return h=g(h,m),b.b++,h},clearTimeout(e),c(l.grecaptcha)}else clearTimeout(e),d(new t(\"internal-error\"));delete l[b.a]},E(Bi(zb(ho,{onload:b.a,hl:a||\"\"}))).o((function(){clearTimeout(e),d(new t(\"internal-error\",\"Unable to load external reCAPTCHA dependencies!\"))}))):(clearTimeout(e),c(l.grecaptcha))}))},go.prototype.c=function(){this.b--};var jo=null;function ko(a,b,c,d,e,f,g){if(M(this,\"type\",\"recaptcha\"),this.c=this.f=null,this.D=!1,this.v=b,this.g=null,g?(fo||(fo=new eo),g=fo):(jo||(jo=new go),g=jo),this.m=g,this.a=c||{theme:\"light\",type:\"image\"},this.h=[],this.a[lo])throw new t(\"argument-error\",\"sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.\");if(this.i=\"invisible\"===this.a[mo],!l.document)throw new t(\"operation-not-supported-in-this-environment\",\"RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.\");if(!kc(b)||!this.i&&kc(b).hasChildNodes())throw new t(\"argument-error\",\"reCAPTCHA container is either not found or already contains inner elements!\");this.s=new Ii(a,f||null,e||null),this.u=d||function(){return null};var h=this;this.l=[];var m=this.a[no];this.a[no]=function(v){if(oo(h,v),\"function\"==typeof m)m(v);else if(\"string\"==typeof m){var B=L(m,l);\"function\"==typeof B&&B(v)}};var p=this.a[po];this.a[po]=function(){if(oo(h,null),\"function\"==typeof p)p();else if(\"string\"==typeof p){var v=L(p,l);\"function\"==typeof v&&v()}}}var no=\"callback\",po=\"expired-callback\",lo=\"sitekey\",mo=\"size\";function oo(a,b){for(var c=0;c<a.l.length;c++)try{a.l[c](b)}catch(d){}}function ro(a,b){return a.h.push(b),b.oa((function(){Wa(a.h,b)})),b}function so(a){if(a.D)throw new t(\"internal-error\",\"RecaptchaVerifier instance has been destroyed.\")}function to(a,b,c){var d=!1;try{this.b=c||index_esm.default.app()}catch(g){throw new t(\"argument-error\",\"No firebase.app.App instance is currently initialized.\")}if(!this.b.options||!this.b.options.apiKey)throw new t(\"invalid-api-key\");c=this.b.options.apiKey;var e=this,f=null;try{f=this.b.auth().Ga()}catch(g){}try{d=this.b.auth().settings.appVerificationDisabledForTesting}catch(g){}f=index_esm.default.SDK_VERSION?Oe(index_esm.default.SDK_VERSION,f):null,ko.call(this,c,a,b,(function(){try{var g=e.b.auth().la()}catch(h){g=null}return g}),f,Ca(Da),d)}function uo(a,b,c,d){a:{c=Array.prototype.slice.call(c);for(var e=0,f=!1,g=0;g<b.length;g++)if(b[g].optional)f=!0;else{if(f)throw new t(\"internal-error\",\"Argument validator encountered a required argument after an optional argument.\");e++}if(f=b.length,c.length<e||f<c.length)d=\"Expected \"+(e==f?1==e?\"1 argument\":e+\" arguments\":e+\"-\"+f+\" arguments\")+\" but got \"+c.length+\".\";else{for(e=0;e<c.length;e++)if(f=b[e].optional&&void 0===c[e],!b[e].M(c[e])&&!f){if(b=b[e],0>e||e>=vo.length)throw new t(\"internal-error\",\"Argument validator received an unsupported number of arguments.\");c=vo[e],d=(d?\"\":c+\" argument \")+(b.name?'\"'+b.name+'\" ':\"\")+\"must be \"+b.K+\".\";break a}d=null}}if(d)throw new t(\"argument-error\",a+\" failed: \"+d)}(k=ko.prototype).Ia=function(){var a=this;return this.f?this.f:this.f=ro(this,E().then((function(){if(Se()&&!Je())return Ee();throw new t(\"operation-not-supported-in-this-environment\",\"RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.\")})).then((function(){return a.m.g(a.u())})).then((function(b){return a.g=b,O(a.s,Jj,{})})).then((function(b){a.a[lo]=b.recaptchaSiteKey})).o((function(b){throw a.f=null,b})))},k.render=function(){so(this);var a=this;return ro(this,this.Ia().then((function(){if(null===a.c){var b=a.v;if(!a.i){var c=kc(b);b=function(a,b,c){var d=arguments,e=document,f=String(d[0]),g=d[1];if(!jc&&g&&(g.name||g.type)){if(f=[\"<\",f],g.name&&f.push(' name=\"',Rb(g.name),'\"'),g.type){f.push(' type=\"',Rb(g.type),'\"');var h={};z(h,g),delete h.type,g=h}f.push(\">\"),f=f.join(\"\")}return f=oc(e,f),g&&(\"string\"==typeof g?f.className=g:Array.isArray(g)?f.className=g.join(\" \"):lc(f,g)),2<d.length&&pc(e,f,d),f}(\"DIV\"),c.appendChild(b)}a.c=a.g.render(b,a.a)}return a.c})))},k.verify=function(){so(this);var a=this;return ro(this,this.render().then((function(b){return new D((function(c){var d=a.g.getResponse(b);if(d)c(d);else{var e=function(f){f&&(function(a,b){Xa(a.l,(function(c){return c==b}))}(a,e),c(f))};a.l.push(e),a.i&&a.g.execute(a.c)}}))})))},k.reset=function(){so(this),null!==this.c&&this.g.reset(this.c)},k.clear=function(){so(this),this.D=!0,this.m.c();for(var a=0;a<this.h.length;a++)this.h[a].cancel(\"RecaptchaVerifier instance has been destroyed.\");if(!this.i){a=kc(this.v);for(var b;b=a.firstChild;)a.removeChild(b)}},r(to,ko);var vo=\"First Second Third Fourth Fifth Sixth Seventh Eighth Ninth\".split(\" \");function V(a,b){return{name:a||\"\",K:\"a valid string\",optional:!!b,M:function(c){return\"string\"==typeof c}}}function wo(a,b){return{name:a||\"\",K:\"a boolean\",optional:!!b,M:function(c){return\"boolean\"==typeof c}}}function W(a,b){return{name:a||\"\",K:\"a valid object\",optional:!!b,M:n}}function xo(a,b){return{name:a||\"\",K:\"a function\",optional:!!b,M:function(c){return\"function\"==typeof c}}}function yo(a,b){return{name:a||\"\",K:\"null\",optional:!!b,M:function(c){return null===c}}}function Co(a){return{name:a?a+\"Credential\":\"credential\",K:a?\"a valid \"+a+\" credential\":\"a valid credential\",optional:!1,M:function(b){return!!b&&!(!b.ka||a&&b.providerId!==a)}}}function Fo(a,b){return n(a)&&\"string\"==typeof a.type&&a.type===b&&\"function\"==typeof a.Ha}function Go(a){return n(a)&&\"string\"==typeof a.uid}function X(a,b,c,d){return{name:c||\"\",K:a.K+\" or \"+b.K,optional:!!d,M:function(e){return a.M(e)||b.M(e)}}}function Y(a,b){for(var c in b){var d=b[c].name;a[d]=Io(d,a[c],b[c].j)}}function Jo(a,b){for(var c in b){var d=b[c].name;d!==c&&Object.defineProperty(a,d,{get:ua((function(e){return this[e]}),c),set:ua((function(e,f,g,h){uo(e,[g],[h],!0),this[f]=h}),d,c,b[c].kb),enumerable:!0})}}function Z(a,b,c,d){a[b]=Io(b,c,d)}function Io(a,b,c){function d(){var g=Array.prototype.slice.call(arguments);return uo(e,c,g),b.apply(this,g)}if(!c)return b;var f,e=function(a){return(a=a.split(\".\"))[a.length-1]}(a);for(f in b)d[f]=b[f];for(f in b.prototype)d.prototype[f]=b.prototype[f];return d}Y(En.prototype,{jb:{name:\"applyActionCode\",j:[V(\"code\")]},Ra:{name:\"checkActionCode\",j:[V(\"code\")]},nb:{name:\"confirmPasswordReset\",j:[V(\"code\"),V(\"newPassword\")]},dc:{name:\"createUserWithEmailAndPassword\",j:[V(\"email\"),V(\"password\")]},hc:{name:\"fetchSignInMethodsForEmail\",j:[V(\"email\")]},qa:{name:\"getRedirectResult\",j:[]},Bc:{name:\"isSignInWithEmailLink\",j:[V(\"emailLink\")]},Hc:{name:\"onAuthStateChanged\",j:[X(W(),xo(),\"nextOrObserver\"),xo(\"opt_error\",!0),xo(\"opt_completed\",!0)]},Ic:{name:\"onIdTokenChanged\",j:[X(W(),xo(),\"nextOrObserver\"),xo(\"opt_error\",!0),xo(\"opt_completed\",!0)]},vb:{name:\"sendPasswordResetEmail\",j:[V(\"email\"),X(W(\"opt_actionCodeSettings\",!0),yo(null,!0),\"opt_actionCodeSettings\",!0)]},wb:{name:\"sendSignInLinkToEmail\",j:[V(\"email\"),W(\"actionCodeSettings\")]},xb:{name:\"setPersistence\",j:[V(\"persistence\")]},Sc:{name:\"signInAndRetrieveDataWithCredential\",j:[Co()]},zb:{name:\"signInAnonymously\",j:[]},$a:{name:\"signInWithCredential\",j:[Co()]},Tc:{name:\"signInWithCustomToken\",j:[V(\"token\")]},Uc:{name:\"signInWithEmailAndPassword\",j:[V(\"email\"),V(\"password\")]},Vc:{name:\"signInWithEmailLink\",j:[V(\"email\"),V(\"emailLink\",!0)]},Wc:{name:\"signInWithPhoneNumber\",j:[V(\"phoneNumber\"),{name:\"applicationVerifier\",K:\"an implementation of firebase.auth.ApplicationVerifier\",optional:!1,M:function(a){return!(!a||\"string\"!=typeof a.type||\"function\"!=typeof a.verify)}}]},Xc:{name:\"signInWithPopup\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(a){return!!(a&&a.providerId&&a.hasOwnProperty&&a.hasOwnProperty(\"isOAuthProvider\"))}}]},Yc:{name:\"signInWithRedirect\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(a){return!!(a&&a.providerId&&a.hasOwnProperty&&a.hasOwnProperty(\"isOAuthProvider\"))}}]},dd:{name:\"updateCurrentUser\",j:[X({name:\"user\",K:\"an instance of Firebase User\",optional:!1,M:function(b){return!!(b&&b instanceof Im)}},yo(),\"user\")]},Ab:{name:\"signOut\",j:[]},toJSON:{name:\"toJSON\",j:[V(null,!0)]},fd:{name:\"useDeviceLanguage\",j:[]},gd:{name:\"useEmulator\",j:[V(\"url\"),W(\"options\",!0)]},jd:{name:\"verifyPasswordResetCode\",j:[V(\"code\")]}}),Jo(En.prototype,{lc:{name:\"languageCode\",kb:X(V(),yo(),\"languageCode\")},ti:{name:\"tenantId\",kb:X(V(),yo(),\"tenantId\")}}),(En.Persistence=Rk).LOCAL=\"local\",En.Persistence.SESSION=\"session\",En.Persistence.NONE=\"none\",Y(Im.prototype,{delete:{name:\"delete\",j:[]},oc:{name:\"getIdTokenResult\",j:[wo(\"opt_forceRefresh\",!0)]},I:{name:\"getIdToken\",j:[wo(\"opt_forceRefresh\",!0)]},Cc:{name:\"linkAndRetrieveDataWithCredential\",j:[Co()]},qb:{name:\"linkWithCredential\",j:[Co()]},Dc:{name:\"linkWithPhoneNumber\",j:[V(\"phoneNumber\"),{name:\"applicationVerifier\",K:\"an implementation of firebase.auth.ApplicationVerifier\",optional:!1,M:function(a){return!(!a||\"string\"!=typeof a.type||\"function\"!=typeof a.verify)}}]},Ec:{name:\"linkWithPopup\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(a){return!!(a&&a.providerId&&a.hasOwnProperty&&a.hasOwnProperty(\"isOAuthProvider\"))}}]},Fc:{name:\"linkWithRedirect\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(a){return!!(a&&a.providerId&&a.hasOwnProperty&&a.hasOwnProperty(\"isOAuthProvider\"))}}]},Lc:{name:\"reauthenticateAndRetrieveDataWithCredential\",j:[Co()]},tb:{name:\"reauthenticateWithCredential\",j:[Co()]},Mc:{name:\"reauthenticateWithPhoneNumber\",j:[V(\"phoneNumber\"),{name:\"applicationVerifier\",K:\"an implementation of firebase.auth.ApplicationVerifier\",optional:!1,M:function(a){return!(!a||\"string\"!=typeof a.type||\"function\"!=typeof a.verify)}}]},Nc:{name:\"reauthenticateWithPopup\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(a){return!!(a&&a.providerId&&a.hasOwnProperty&&a.hasOwnProperty(\"isOAuthProvider\"))}}]},Oc:{name:\"reauthenticateWithRedirect\",j:[{name:\"authProvider\",K:\"a valid Auth provider\",optional:!1,M:function(a){return!!(a&&a.providerId&&a.hasOwnProperty&&a.hasOwnProperty(\"isOAuthProvider\"))}}]},reload:{name:\"reload\",j:[]},ub:{name:\"sendEmailVerification\",j:[X(W(\"opt_actionCodeSettings\",!0),yo(null,!0),\"opt_actionCodeSettings\",!0)]},toJSON:{name:\"toJSON\",j:[V(null,!0)]},cd:{name:\"unlink\",j:[V(\"provider\")]},Bb:{name:\"updateEmail\",j:[V(\"email\")]},Cb:{name:\"updatePassword\",j:[V(\"password\")]},ed:{name:\"updatePhoneNumber\",j:[Co(\"phone\")]},Db:{name:\"updateProfile\",j:[W(\"profile\")]},Eb:{name:\"verifyBeforeUpdateEmail\",j:[V(\"email\"),X(W(\"opt_actionCodeSettings\",!0),yo(null,!0),\"opt_actionCodeSettings\",!0)]}}),Y(Xn.prototype,{execute:{name:\"execute\"},render:{name:\"render\"},reset:{name:\"reset\"},getResponse:{name:\"getResponse\"}}),Y(Wn.prototype,{execute:{name:\"execute\"},render:{name:\"render\"},reset:{name:\"reset\"},getResponse:{name:\"getResponse\"}}),Y(D.prototype,{oa:{name:\"finally\"},o:{name:\"catch\"},then:{name:\"then\"}}),Jo(em.prototype,{appVerificationDisabled:{name:\"appVerificationDisabledForTesting\",kb:wo(\"appVerificationDisabledForTesting\")}}),Y(fm.prototype,{confirm:{name:\"confirm\",j:[V(\"verificationCode\")]}}),Z(Bg,\"fromJSON\",(function(a){a=\"string\"==typeof a?JSON.parse(a):a;for(var b,c=[Mg,dh,kh,Jg],d=0;d<c.length;d++)if(b=c[d](a))return b;return null}),[X(V(),W(),\"json\")]),Z(Zg,\"credential\",(function(a,b){return new Yg(a,b)}),[V(\"email\"),V(\"password\")]),Y(Yg.prototype,{w:{name:\"toJSON\",j:[V(null,!0)]}}),Y(Qg.prototype,{Ca:{name:\"addScope\",j:[V(\"scope\")]},Ka:{name:\"setCustomParameters\",j:[W(\"customOAuthParameters\")]}}),Z(Qg,\"credential\",Rg,[X(V(),W(),\"token\")]),Z(Zg,\"credentialWithLink\",eh,[V(\"email\"),V(\"emailLink\")]),Y(Sg.prototype,{Ca:{name:\"addScope\",j:[V(\"scope\")]},Ka:{name:\"setCustomParameters\",j:[W(\"customOAuthParameters\")]}}),Z(Sg,\"credential\",Tg,[X(V(),W(),\"token\")]),Y(Ug.prototype,{Ca:{name:\"addScope\",j:[V(\"scope\")]},Ka:{name:\"setCustomParameters\",j:[W(\"customOAuthParameters\")]}}),Z(Ug,\"credential\",Vg,[X(V(),X(W(),yo()),\"idToken\"),X(V(),yo(),\"accessToken\",!0)]),Y(Wg.prototype,{Ka:{name:\"setCustomParameters\",j:[W(\"customOAuthParameters\")]}}),Z(Wg,\"credential\",Xg,[X(V(),W(),\"token\"),V(\"secret\",!0)]),Y(Pg.prototype,{Ca:{name:\"addScope\",j:[V(\"scope\")]},credential:{name:\"credential\",j:[X(V(),X(W(),yo()),\"optionsOrIdToken\"),X(V(),yo(),\"accessToken\",!0)]},Ka:{name:\"setCustomParameters\",j:[W(\"customOAuthParameters\")]}}),Y(Kg.prototype,{w:{name:\"toJSON\",j:[V(null,!0)]}}),Y(Eg.prototype,{w:{name:\"toJSON\",j:[V(null,!0)]}}),Z(lh,\"credential\",ph,[V(\"verificationId\"),V(\"verificationCode\")]),Y(lh.prototype,{fb:{name:\"verifyPhoneNumber\",j:[X(V(),{name:\"phoneInfoOptions\",K:\"valid phone info options\",optional:!1,M:function(c){return!!c&&(c.session&&c.phoneNumber?Fo(c.session,zg)&&\"string\"==typeof c.phoneNumber:c.session&&c.multiFactorHint?Fo(c.session,Ag)&&Go(c.multiFactorHint):c.session&&c.multiFactorUid?Fo(c.session,Ag)&&\"string\"==typeof c.multiFactorUid:!!c.phoneNumber&&\"string\"==typeof c.phoneNumber)}},\"phoneInfoOptions\"),{name:\"applicationVerifier\",K:\"an implementation of firebase.auth.ApplicationVerifier\",optional:!1,M:function(a){return!(!a||\"string\"!=typeof a.type||\"function\"!=typeof a.verify)}}]}}),Y(gh.prototype,{w:{name:\"toJSON\",j:[V(null,!0)]}}),Y(t.prototype,{toJSON:{name:\"toJSON\",j:[V(null,!0)]}}),Y(yh.prototype,{toJSON:{name:\"toJSON\",j:[V(null,!0)]}}),Y(xh.prototype,{toJSON:{name:\"toJSON\",j:[V(null,!0)]}}),Y(lm.prototype,{toJSON:{name:\"toJSON\",j:[V(null,!0)]}}),Y(im.prototype,{Rc:{name:\"resolveSignIn\",j:[{name:\"multiFactorAssertion\",K:\"a valid multiFactorAssertion\",optional:!1,M:function(a){return!!a&&!!a.sb}}]}}),Y(tm.prototype,{Rb:{name:\"getSession\",j:[]},fc:{name:\"enroll\",j:[{name:\"multiFactorAssertion\",K:\"a valid multiFactorAssertion\",optional:!1,M:function(a){return!!a&&!!a.sb}},V(\"displayName\",!0)]},bd:{name:\"unenroll\",j:[X({name:\"multiFactorInfo\",K:\"a valid multiFactorInfo\",optional:!1,M:Go},V(),\"multiFactorInfoIdentifier\")]}}),Y(to.prototype,{clear:{name:\"clear\",j:[]},render:{name:\"render\",j:[]},verify:{name:\"verify\",j:[]}}),Z(Jf,\"parseLink\",Rf,[V(\"link\")]),Z(co,\"assertion\",(function(a){return new rm(a)}),[Co(\"phone\")]),function(){if(void 0===index_esm.default||!index_esm.default.INTERNAL||!index_esm.default.INTERNAL.registerComponent)throw Error(\"Cannot find the firebase namespace; be sure to include firebase-app.js before this library.\");var a={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Af,PASSWORD_RESET:\"PASSWORD_RESET\",RECOVER_EMAIL:\"RECOVER_EMAIL\",REVERT_SECOND_FACTOR_ADDITION:Cf,VERIFY_AND_CHANGE_EMAIL:Bf,VERIFY_EMAIL:\"VERIFY_EMAIL\"}},Auth:En,AuthCredential:Bg,Error:t};Z(a,\"EmailAuthProvider\",Zg,[]),Z(a,\"FacebookAuthProvider\",Qg,[]),Z(a,\"GithubAuthProvider\",Sg,[]),Z(a,\"GoogleAuthProvider\",Ug,[]),Z(a,\"TwitterAuthProvider\",Wg,[]),Z(a,\"OAuthProvider\",Pg,[V(\"providerId\")]),Z(a,\"SAMLAuthProvider\",Og,[V(\"providerId\")]),Z(a,\"PhoneAuthProvider\",lh,[{name:\"auth\",K:\"an instance of Firebase Auth\",optional:!0,M:function(a){return!!(a&&a instanceof En)}}]),Z(a,\"RecaptchaVerifier\",to,[X(V(),{name:\"\",K:\"an HTML element\",optional:!1,M:function(a){return!!(a&&a instanceof Element)}},\"recaptchaContainer\"),W(\"recaptchaParameters\",!0),{name:\"app\",K:\"an instance of Firebase App\",optional:!0,M:function(a){return!!(a&&a instanceof index_esm.default.app.App)}}]),Z(a,\"ActionCodeURL\",Jf,[]),Z(a,\"PhoneMultiFactorGenerator\",co,[]),index_esm.default.INTERNAL.registerComponent({name:\"auth\",instanceFactory:function(b){return new En(b=b.getProvider(\"app\").getImmediate())},multipleInstances:!1,serviceProps:a,instantiationMode:\"LAZY\",type:\"PUBLIC\"}),index_esm.default.INTERNAL.registerComponent({name:\"auth-internal\",instanceFactory:function(b){return{getUid:q((b=b.getProvider(\"auth\").getImmediate()).getUid,b),getToken:q(b.nc,b),addAuthTokenListener:q(b.cc,b),removeAuthTokenListener:q(b.Pc,b)}},multipleInstances:!1,instantiationMode:\"LAZY\",type:\"PRIVATE\"}),index_esm.default.registerVersion(\"@firebase/auth\",\"0.16.6\"),index_esm.default.INTERNAL.extendNamespace({User:Im})}()}).apply(\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{}),__webpack_require__(\"6Uf2\");var util_dist_index_esm=__webpack_require__(\"qOnz\"),logger_dist_index_esm=__webpack_require__(\"q/0M\"),extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)};function __values(o){var s=\"function\"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&\"number\"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}var index_esm_h,commonjsGlobal=\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:{},goog=goog||{},index_esm_k=commonjsGlobal||self;function index_esm_aa(){}function index_esm_ba(a){var b=typeof a;return\"array\"==(b=\"object\"!=b?b:a?Array.isArray(a)?\"array\":b:\"null\")||\"object\"==b&&\"number\"==typeof a.length}function index_esm_n(a){var b=typeof a;return\"object\"==b&&null!=a||\"function\"==b}var index_esm_da=\"closure_uid_\"+(1e9*Math.random()>>>0),index_esm_ea=0;function index_esm_fa(a,b,c){return a.call.apply(a.bind,arguments)}function index_esm_ha(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,d),a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function index_esm_p(a,b,c){return(index_esm_p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?index_esm_fa:index_esm_ha).apply(null,arguments)}function index_esm_ja(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();return d.push.apply(d,arguments),a.apply(this,d)}}function index_esm_q(){return Date.now()}function index_esm_r(a,b){function c(){}c.prototype=b.prototype,a.X=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.Kb=function(d,e,f){for(var g=Array(arguments.length-2),m=2;m<arguments.length;m++)g[m-2]=arguments[m];return b.prototype[e].apply(d,g)}}function index_esm_t(){this.j=this.j,this.i=this.i}index_esm_t.prototype.j=!1,index_esm_t.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(a){Object.prototype.hasOwnProperty.call(a,index_esm_da)&&a[index_esm_da]||(a[index_esm_da]=++index_esm_ea)}(this)},index_esm_t.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var index_esm_ma=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if(\"string\"==typeof a)return\"string\"!=typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},index_esm_na=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=\"string\"==typeof a?a.split(\"\"):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};function index_esm_qa(a){return Array.prototype.concat.apply([],arguments)}function index_esm_ra(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function index_esm_sa(a){return/^[\\s\\xa0]*$/.test(a)}var index_esm_w,index_esm_ta=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(a)[1]};function index_esm_v(a,b){return-1!=a.indexOf(b)}function index_esm_ua(a,b){return a<b?-1:a>b?1:0}a:{var index_esm_va=index_esm_k.navigator;if(index_esm_va){var index_esm_wa=index_esm_va.userAgent;if(index_esm_wa){index_esm_w=index_esm_wa;break a}}index_esm_w=\"\"}function index_esm_za(a,b,c){for(var d in a)b.call(c,a[d],d,a)}function index_esm_Aa(a){var b={};for(var c in a)b[c]=a[c];return b}var index_esm_Ba=\"constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf\".split(\" \");function index_esm_Ca(a,b){for(var c,d,e=1;e<arguments.length;e++){for(c in d=arguments[e])a[c]=d[c];for(var f=0;f<index_esm_Ba.length;f++)c=index_esm_Ba[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function index_esm_Da(a){return index_esm_Da[\" \"](a),a}index_esm_Da[\" \"]=index_esm_aa;var index_esm_Ma,a,index_esm_Ga=index_esm_v(index_esm_w,\"Opera\"),index_esm_x=index_esm_v(index_esm_w,\"Trident\")||index_esm_v(index_esm_w,\"MSIE\"),index_esm_Ha=index_esm_v(index_esm_w,\"Edge\"),index_esm_Ia=index_esm_Ha||index_esm_x,index_esm_Ja=index_esm_v(index_esm_w,\"Gecko\")&&!(index_esm_v(index_esm_w.toLowerCase(),\"webkit\")&&!index_esm_v(index_esm_w,\"Edge\"))&&!(index_esm_v(index_esm_w,\"Trident\")||index_esm_v(index_esm_w,\"MSIE\"))&&!index_esm_v(index_esm_w,\"Edge\"),index_esm_Ka=index_esm_v(index_esm_w.toLowerCase(),\"webkit\")&&!index_esm_v(index_esm_w,\"Edge\");function index_esm_La(){var a=index_esm_k.document;return a?a.documentMode:void 0}a:{var index_esm_Na=\"\",index_esm_Oa=(a=index_esm_w,index_esm_Ja?/rv:([^\\);]+)(\\)|;)/.exec(a):index_esm_Ha?/Edge\\/([\\d\\.]+)/.exec(a):index_esm_x?/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a):index_esm_Ka?/WebKit\\/(\\S+)/.exec(a):index_esm_Ga?/(?:Version)[ \\/]?(\\S+)/.exec(a):void 0);if(index_esm_Oa&&(index_esm_Na=index_esm_Oa?index_esm_Oa[1]:\"\"),index_esm_x){var index_esm_Pa=index_esm_La();if(null!=index_esm_Pa&&index_esm_Pa>parseFloat(index_esm_Na)){index_esm_Ma=String(index_esm_Pa);break a}}index_esm_Ma=index_esm_Na}var index_esm_Fa={};function index_esm_Qa(a){return function(a,b){var c=index_esm_Fa;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b()}(a,(function(){for(var b=0,e=index_esm_ta(String(index_esm_Ma)).split(\".\"),f=index_esm_ta(String(a)).split(\".\"),g=Math.max(e.length,f.length),m=0;0==b&&m<g;m++){var c=e[m]||\"\",d=f[m]||\"\";do{if(c=/(\\d*)(\\D*)(.*)/.exec(c)||[\"\",\"\",\"\",\"\"],d=/(\\d*)(\\D*)(.*)/.exec(d)||[\"\",\"\",\"\",\"\"],0==c[0].length&&0==d[0].length)break;b=index_esm_ua(0==c[1].length?0:parseInt(c[1],10),0==d[1].length?0:parseInt(d[1],10))||index_esm_ua(0==c[2].length,0==d[2].length)||index_esm_ua(c[2],d[2]),c=c[3],d=d[3]}while(0==b)}return 0<=b}))}var index_esm_Ta=index_esm_k.document&&index_esm_x&&(index_esm_La()||parseInt(index_esm_Ma,10))||void 0,index_esm_Ua=!index_esm_x||9<=Number(index_esm_Ta),index_esm_Va=index_esm_x&&!index_esm_Qa(\"9\"),index_esm_Wa=function(){if(!index_esm_k.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},\"passive\",{get:function(){a=!0}});try{index_esm_k.addEventListener(\"test\",index_esm_aa,b),index_esm_k.removeEventListener(\"test\",index_esm_aa,b)}catch(c){}return a}();function index_esm_y(a,b){this.type=a,this.a=this.target=b,this.defaultPrevented=!1}function index_esm_z(a,b){if(index_esm_y.call(this,a?a.type:\"\"),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=\"\",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType=\"\",this.c=null,a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.a=b,b=a.relatedTarget){if(index_esm_Ja){a:{try{index_esm_Da(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else\"mouseover\"==c?b=a.fromElement:\"mouseout\"==c&&(b=a.toElement);this.relatedTarget=b,d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||\"\",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=\"string\"==typeof a.pointerType?a.pointerType:index_esm_Xa[a.pointerType]||\"\",this.c=a,a.defaultPrevented&&this.b()}}index_esm_y.prototype.b=function(){this.defaultPrevented=!0},index_esm_r(index_esm_z,index_esm_y);var index_esm_Xa={2:\"touch\",3:\"pen\",4:\"mouse\"};index_esm_z.prototype.b=function(){index_esm_z.X.b.call(this);var a=this.c;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,index_esm_Va)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(b){}};var A=\"closure_listenable_\"+(1e6*Math.random()|0),index_esm_Ya=0;function index_esm_Za(a,b,c,d,e){this.listener=a,this.proxy=null,this.src=b,this.type=c,this.capture=!!d,this.ca=e,this.key=++index_esm_Ya,this.Y=this.Z=!1}function index_esm_$a(a){a.Y=!0,a.listener=null,a.proxy=null,a.src=null,a.ca=null}function index_esm_ab(a){this.src=a,this.a={},this.b=0}function index_esm_cb(a,b){var c=b.type;if(c in a.a){var f,d=a.a[c],e=index_esm_ma(d,b);(f=0<=e)&&Array.prototype.splice.call(d,e,1),f&&(index_esm_$a(b),0==a.a[c].length&&(delete a.a[c],a.b--))}}function index_esm_bb(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.Y&&f.listener==b&&f.capture==!!c&&f.ca==d)return e}return-1}index_esm_ab.prototype.add=function(a,b,c,d,e){var f=a.toString();(a=this.a[f])||(a=this.a[f]=[],this.b++);var g=index_esm_bb(a,b,d,e);return-1<g?(b=a[g],c||(b.Z=!1)):((b=new index_esm_Za(b,this.src,f,!!d,e)).Z=c,a.push(b)),b};var index_esm_db=\"closure_lm_\"+(1e6*Math.random()|0),index_esm_eb={};function index_esm_gb(a,b,c,d,e){if(d&&d.once)return function index_esm_hb(a,b,c,d,e){if(Array.isArray(b)){for(var f=0;f<b.length;f++)index_esm_hb(a,b[f],c,d,e);return null}return c=index_esm_ib(c),a&&a[A]?a.wa(b,c,index_esm_n(d)?!!d.capture:!!d,e):index_esm_jb(a,b,c,!0,d,e)}(a,b,c,d,e);if(Array.isArray(b)){for(var f=0;f<b.length;f++)index_esm_gb(a,b[f],c,d,e);return null}return c=index_esm_ib(c),a&&a[A]?a.va(b,c,index_esm_n(d)?!!d.capture:!!d,e):index_esm_jb(a,b,c,!1,d,e)}function index_esm_jb(a,b,c,d,e,f){if(!b)throw Error(\"Invalid event type\");var g=index_esm_n(e)?!!e.capture:!!e;if(g&&!index_esm_Ua)return null;var m=index_esm_kb(a);if(m||(a[index_esm_db]=m=new index_esm_ab(a)),(c=m.add(b,c,d,g,f)).proxy)return c;if(d=function(){var a=index_esm_nb,b=index_esm_Ua?function(c){return a.call(b.src,b.listener,c)}:function(c){if(!(c=a.call(b.src,b.listener,c)))return c};return b}(),c.proxy=d,d.src=a,d.listener=c,a.addEventListener)index_esm_Wa||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(index_esm_mb(b.toString()),d);else{if(!a.addListener||!a.removeListener)throw Error(\"addEventListener and attachEvent are unavailable.\");a.addListener(d)}return c}function index_esm_pb(a){if(\"number\"!=typeof a&&a&&!a.Y){var b=a.src;if(b&&b[A])index_esm_cb(b.c,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(index_esm_mb(c),d):b.addListener&&b.removeListener&&b.removeListener(d),(c=index_esm_kb(b))?(index_esm_cb(c,a),0==c.b&&(c.src=null,b[index_esm_db]=null)):index_esm_$a(a)}}}function index_esm_mb(a){return a in index_esm_eb?index_esm_eb[a]:index_esm_eb[a]=\"on\"+a}function index_esm_qb(a,b){var c=a.listener,d=a.ca||a.src;return a.Z&&index_esm_pb(a),c.call(d,b)}function index_esm_nb(a,b){if(a.Y)return!0;if(!index_esm_Ua){if(!b)a:{b=[\"window\",\"event\"];for(var c=index_esm_k,d=0;d<b.length;d++)if(null==(c=c[b[d]])){b=null;break a}b=c}return index_esm_qb(a,b=new index_esm_z(b,this))}return index_esm_qb(a,new index_esm_z(b,this))}function index_esm_kb(a){return(a=a[index_esm_db])instanceof index_esm_ab?a:null}var index_esm_sb=\"__closure_events_fn_\"+(1e9*Math.random()>>>0);function index_esm_ib(a){return\"function\"==typeof a?a:(a[index_esm_sb]||(a[index_esm_sb]=function(b){return a.handleEvent(b)}),a[index_esm_sb])}function index_esm_D(){index_esm_t.call(this),this.c=new index_esm_ab(this),this.J=this,this.C=null}function index_esm_E(a,b){var c,d=a.C;if(d)for(c=[];d;d=d.C)c.push(d);if(a=a.J,d=b.type||b,\"string\"==typeof b)b=new index_esm_y(b,a);else if(b instanceof index_esm_y)b.target=b.target||a;else{var e=b;index_esm_Ca(b=new index_esm_y(d,a),e)}if(e=!0,c)for(var f=c.length-1;0<=f;f--){var g=b.a=c[f];e=index_esm_tb(g,d,!0,b)&&e}if(e=index_esm_tb(g=b.a=a,d,!0,b)&&e,e=index_esm_tb(g,d,!1,b)&&e,c)for(f=0;f<c.length;f++)e=index_esm_tb(g=b.a=c[f],d,!1,b)&&e}function index_esm_tb(a,b,c,d){if(!(b=a.c.a[String(b)]))return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.Y&&g.capture==c){var m=g.listener,l=g.ca||g.src;g.Z&&index_esm_cb(a.c,g),e=!1!==m.call(l,d)&&e}}return e&&!d.defaultPrevented}index_esm_r(index_esm_D,index_esm_t),index_esm_D.prototype[A]=!0,(index_esm_h=index_esm_D.prototype).addEventListener=function(a,b,c,d){index_esm_gb(this,a,b,c,d)},index_esm_h.removeEventListener=function(a,b,c,d){!function index_esm_ob(a,b,c,d,e){if(Array.isArray(b))for(var f=0;f<b.length;f++)index_esm_ob(a,b[f],c,d,e);else d=index_esm_n(d)?!!d.capture:!!d,c=index_esm_ib(c),a&&a[A]?(a=a.c,(b=String(b).toString())in a.a&&-1<(c=index_esm_bb(f=a.a[b],c,d,e))&&(index_esm_$a(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--))):a&&(a=index_esm_kb(a))&&(b=a.a[b.toString()],a=-1,b&&(a=index_esm_bb(b,c,d,e)),(c=-1<a?b[a]:null)&&index_esm_pb(c))}(this,a,b,c,d)},index_esm_h.G=function(){if(index_esm_D.X.G.call(this),this.c){var c,a=this.c;for(c in a.a){for(var d=a.a[c],e=0;e<d.length;e++)index_esm_$a(d[e]);delete a.a[c],a.b--}}this.C=null},index_esm_h.va=function(a,b,c,d){return this.c.add(String(a),b,!1,c,d)},index_esm_h.wa=function(a,b,c,d){return this.c.add(String(a),b,!0,c,d)};var index_esm_ub=index_esm_k.JSON.stringify;function index_esm_vb(){this.b=this.a=null}var index_esm_Cb,index_esm_xb=new(function(){function class_1(a,b){this.c=a,this.f=b,this.b=0,this.a=null}return class_1.prototype.get=function(){var a;return 0<this.b?(this.b--,this.a=(a=this.a).next,a.next=null):a=this.c(),a},class_1}())((function(){return new index_esm_wb}),(function(a){a.reset()}));function index_esm_yb(){var a=index_esm_zb,b=null;return a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null),b}function index_esm_wb(){this.next=this.b=this.a=null}function index_esm_Ab(a){index_esm_k.setTimeout((function(){throw a}),0)}function index_esm_Bb(a,b){index_esm_Cb||function(){var a=index_esm_k.Promise.resolve(void 0);index_esm_Cb=function(){a.then(index_esm_Fb)}}(),index_esm_Eb||(index_esm_Cb(),index_esm_Eb=!0),index_esm_zb.add(a,b)}index_esm_vb.prototype.add=function(a,b){var c=index_esm_xb.get();c.set(a,b),this.b?this.b.next=c:this.a=c,this.b=c},index_esm_wb.prototype.set=function(a,b){this.a=a,this.b=b,this.next=null},index_esm_wb.prototype.reset=function(){this.next=this.b=this.a=null};var index_esm_Eb=!1,index_esm_zb=new index_esm_vb;function index_esm_Fb(){for(var a;a=index_esm_yb();){try{a.a.call(a.b)}catch(c){index_esm_Ab(c)}var b=index_esm_xb;b.f(a),100>b.b&&(b.b++,a.next=b.a,b.a=a)}index_esm_Eb=!1}function index_esm_Gb(a,b){index_esm_D.call(this),this.b=a||1,this.a=b||index_esm_k,this.f=index_esm_p(this.Za,this),this.g=index_esm_q()}function index_esm_Hb(a){a.aa=!1,a.M&&(a.a.clearTimeout(a.M),a.M=null)}function index_esm_Ib(a,b,c){if(\"function\"==typeof a)c&&(a=index_esm_p(a,c));else{if(!a||\"function\"!=typeof a.handleEvent)throw Error(\"Invalid listener argument\");a=index_esm_p(a.handleEvent,a)}return 2147483647<Number(b)?-1:index_esm_k.setTimeout(a,b||0)}function index_esm_Jb(a){a.a=index_esm_Ib((function(){a.a=null,a.c&&(a.c=!1,index_esm_Jb(a))}),a.h);var b=a.b;a.b=null,a.g.apply(null,b)}index_esm_r(index_esm_Gb,index_esm_D),(index_esm_h=index_esm_Gb.prototype).aa=!1,index_esm_h.M=null,index_esm_h.Za=function(){if(this.aa){var a=index_esm_q()-this.g;0<a&&a<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-a):(this.M&&(this.a.clearTimeout(this.M),this.M=null),index_esm_E(this,\"tick\"),this.aa&&(index_esm_Hb(this),this.start()))}},index_esm_h.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=index_esm_q())},index_esm_h.G=function(){index_esm_Gb.X.G.call(this),index_esm_Hb(this),delete this.a};var index_esm_Kb=function(_super){function Kb(a,b){var _this=_super.call(this)||this;return _this.g=a,_this.h=b,_this.b=null,_this.c=!1,_this.a=null,_this}return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}(Kb,_super),Kb.prototype.f=function(a){this.b=arguments,this.a?this.c=!0:index_esm_Jb(this)},Kb.prototype.G=function(){_super.prototype.G.call(this),this.a&&(index_esm_k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},Kb}(index_esm_t);function index_esm_F(a){index_esm_t.call(this),this.b=a,this.a={}}index_esm_r(index_esm_F,index_esm_t);var index_esm_Lb=[];function index_esm_Mb(a,b,c,d){Array.isArray(c)||(c&&(index_esm_Lb[0]=c.toString()),c=index_esm_Lb);for(var e=0;e<c.length;e++){var f=index_esm_gb(b,c[e],d||a.handleEvent,!1,a.b||a);if(!f)break;a.a[f.key]=f}}function index_esm_Nb(a){index_esm_za(a.a,(function(b,c){this.a.hasOwnProperty(c)&&index_esm_pb(b)}),a),a.a={}}function index_esm_Ob(){this.a=!0}function index_esm_G(a,b,c,d){a.info((function(){return\"XMLHTTP TEXT (\"+b+\"): \"+function(a,b){if(!a.a)return b;if(!b)return null;try{var c=JSON.parse(b);if(c)for(a=0;a<c.length;a++)if(Array.isArray(c[a])){var d=c[a];if(!(2>d.length)){var e=d[1];if(Array.isArray(e)&&!(1>e.length)){var f=e[0];if(\"noop\"!=f&&\"stop\"!=f&&\"close\"!=f)for(var g=1;g<e.length;g++)e[g]=\"\"}}}return index_esm_ub(c)}catch(m){return b}}(a,c)+(d?\" \"+d:\"\")}))}index_esm_F.prototype.G=function(){index_esm_F.X.G.call(this),index_esm_Nb(this)},index_esm_F.prototype.handleEvent=function(){throw Error(\"EventHandler.handleEvent not implemented\")},index_esm_Ob.prototype.info=function(){};var index_esm_H={},index_esm_Tb=null;function index_esm_Ub(){return index_esm_Tb=index_esm_Tb||new index_esm_D}function index_esm_Vb(a){index_esm_y.call(this,index_esm_H.Fa,a)}function index_esm_I(a){var b=index_esm_Ub();index_esm_E(b,new index_esm_Vb(b,a))}function index_esm_Wb(a,b){index_esm_y.call(this,index_esm_H.STAT_EVENT,a),this.stat=b}function index_esm_J(a){var b=index_esm_Ub();index_esm_E(b,new index_esm_Wb(b,a))}function index_esm_Xb(a){index_esm_y.call(this,index_esm_H.Ga,a)}function index_esm_K(a,b){if(\"function\"!=typeof a)throw Error(\"Fn must not be null and must be a function\");return index_esm_k.setTimeout((function(){a()}),b)}index_esm_H.Fa=\"serverreachability\",index_esm_r(index_esm_Vb,index_esm_y),index_esm_H.STAT_EVENT=\"statevent\",index_esm_r(index_esm_Wb,index_esm_y),index_esm_H.Ga=\"timingevent\",index_esm_r(index_esm_Xb,index_esm_y);var index_esm_Yb={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},index_esm_Zb={fb:\"complete\",Bb:\"success\",Ea:\"error\",Da:\"abort\",tb:\"ready\",ub:\"readystatechange\",TIMEOUT:\"timeout\",pb:\"incrementaldata\",sb:\"progress\",ib:\"downloadprogress\",Jb:\"uploadprogress\"};function index_esm_$b(){}function index_esm_bc(){}index_esm_$b.prototype.a=null;var index_esm_ec,index_esm_L={OPEN:\"a\",eb:\"b\",Ea:\"c\",qb:\"d\"};function index_esm_cc(){index_esm_y.call(this,\"d\")}function index_esm_dc(){index_esm_y.call(this,\"c\")}function index_esm_fc(){}function index_esm_M(a,b,c,d){this.g=a,this.c=b,this.f=c,this.S=d||1,this.J=new index_esm_F(this),this.P=index_esm_gc,this.R=new index_esm_Gb(a=index_esm_Ia?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}index_esm_r(index_esm_cc,index_esm_y),index_esm_r(index_esm_dc,index_esm_y),index_esm_r(index_esm_fc,index_esm_$b),index_esm_ec=new index_esm_fc;var index_esm_gc=45e3,index_esm_hc={},index_esm_ic={};function index_esm_jc(a,b,c){a.H=1,a.i=index_esm_kc(index_esm_N(b)),a.j=c,a.I=!0,index_esm_lc(a,null)}function index_esm_lc(a,b){a.u=index_esm_q(),index_esm_mc(a),a.l=index_esm_N(a.i);var c=a.l,d=a.S;Array.isArray(d)||(d=[String(d)]),index_esm_nc(c.b,\"t\",d),a.D=0,a.a=index_esm_oc(a.g,a.g.C?b:null),0<a.O&&(a.F=new index_esm_Kb(index_esm_p(a.Ca,a,a.a),a.O)),index_esm_Mb(a.J,a.a,\"readystatechange\",a.Xa),b=a.B?index_esm_Aa(a.B):{},a.j?(a.m||(a.m=\"POST\"),b[\"Content-Type\"]=\"application/x-www-form-urlencoded\",a.a.ba(a.l,a.m,a.j,b)):(a.m=\"GET\",a.a.ba(a.l,a.m,null,b)),index_esm_I(1),function(a,b,c,d,e,f){a.info((function(){if(a.a)if(f)for(var g=\"\",m=f.split(\"&\"),l=0;l<m.length;l++){var u=m[l].split(\"=\");if(1<u.length){var C=u[0];u=u[1];var B=C.split(\"_\");g=2<=B.length&&\"type\"==B[1]?g+(C+\"=\")+u+\"&\":g+(C+\"=redacted&\")}}else g=null;else g=f;return\"XMLHTTP REQ (\"+d+\") [attempt \"+e+\"]: \"+b+\"\\n\"+c+\"\\n\"+g}))}(a.c,a.m,a.l,a.f,a.S,a.j)}function index_esm_sc(a,b,c){for(var d=!0;!a.A&&a.D<c.length;){var e=index_esm_vc(a,c);if(e==index_esm_ic){4==b&&(a.h=4,index_esm_J(14),d=!1),index_esm_G(a.c,a.f,null,\"[Incomplete Response]\");break}if(e==index_esm_hc){a.h=4,index_esm_J(15),index_esm_G(a.c,a.f,c,\"[Invalid Chunk]\"),d=!1;break}index_esm_G(a.c,a.f,e,null),index_esm_qc(a,e)}4==b&&0==c.length&&(a.h=1,index_esm_J(16),d=!1),a.b=a.b&&d,d?0<c.length&&!a.V&&(a.V=!0,(b=a.g).a==a&&b.U&&!b.F&&(b.c.info(\"Great, no buffering proxy detected. Bytes received: \"+c.length),index_esm_wc(b),b.F=!0,index_esm_J(11))):(index_esm_G(a.c,a.f,c,\"[Invalid Chunked Response]\"),index_esm_P(a),index_esm_rc(a))}function index_esm_vc(a,b){var c=a.D,d=b.indexOf(\"\\n\",c);return-1==d?index_esm_ic:(c=Number(b.substring(c,d)),isNaN(c)?index_esm_hc:(d+=1)+c>b.length?index_esm_ic:(b=b.substr(d,c),a.D=d+c,b))}function index_esm_mc(a){a.T=index_esm_q()+a.P,index_esm_yc(a,a.P)}function index_esm_yc(a,b){if(null!=a.o)throw Error(\"WatchDog timer not null\");a.o=index_esm_K(index_esm_p(a.Va,a),b)}function index_esm_pc(a){a.o&&(index_esm_k.clearTimeout(a.o),a.o=null)}function index_esm_rc(a){0==a.g.v||a.A||index_esm_uc(a.g,a)}function index_esm_P(a){index_esm_pc(a);var b=a.F;b&&\"function\"==typeof b.ja&&b.ja(),a.F=null,index_esm_Hb(a.R),index_esm_Nb(a.J),a.a&&(b=a.a,a.a=null,b.abort(),b.ja())}function index_esm_qc(a,b){try{var c=a.g;if(0!=c.v&&(c.a==a||index_esm_zc(c.b,a)))if(c.I=a.N,!a.C&&index_esm_zc(c.b,a)&&3==c.v){try{var d=c.ka.a.parse(b)}catch(tc){d=null}if(Array.isArray(d)&&3==d.length){var e=d;if(0==e[0]){a:if(!c.j){if(c.a){if(!(c.a.u+3e3<a.u))break a;index_esm_Ac(c),index_esm_Bc(c)}index_esm_Cc(c),index_esm_J(18)}}else c.oa=e[1],0<c.oa-c.P&&37500>e[2]&&c.H&&0==c.o&&!c.m&&(c.m=index_esm_K(index_esm_p(c.Sa,c),6e3));if(1>=index_esm_Dc(c.b)&&c.ea){try{c.ea()}catch(tc){}c.ea=void 0}}else Q(c,11)}else if((a.C||c.a==a)&&index_esm_Ac(c),!index_esm_sa(b))for(b=d=c.ka.a.parse(b),d=0;d<b.length;d++)if(c.P=(e=b[d])[0],e=e[1],2==c.v)if(\"c\"==e[0]){c.J=e[1],c.ga=e[2];var f=e[3];null!=f&&(c.ha=f,c.c.info(\"VER=\"+c.ha));var g=e[4];null!=g&&(c.pa=g,c.c.info(\"SVER=\"+c.pa));var m=e[5];if(null!=m&&\"number\"==typeof m&&0<m){var l=1.5*m;c.D=l,c.c.info(\"backChannelRequestTimeoutMs_=\"+l)}l=c;var u=a.a;if(u){var C=u.a?u.a.getResponseHeader(\"X-Client-Wire-Protocol\"):null;if(C){var B=l.b;!B.a&&(index_esm_v(C,\"spdy\")||index_esm_v(C,\"quic\")||index_esm_v(C,\"h2\"))&&(B.f=B.g,B.a=new Set,B.b&&(index_esm_Ec(B,B.b),B.b=null))}if(l.A){var rb=u.a?u.a.getResponseHeader(\"X-HTTP-Session-Id\"):null;rb&&(l.na=rb,index_esm_R(l.B,l.A,rb))}}c.v=3,c.f&&c.f.ta(),c.U&&(c.N=index_esm_q()-a.u,c.c.info(\"Handshake RTT: \"+c.N+\"ms\"));var xa=a;if((l=c).la=index_esm_Fc(l,l.C?l.ga:null,l.fa),xa.C){index_esm_Gc(l.b,xa);var ya=xa,xc=l.D;xc&&ya.setTimeout(xc),ya.o&&(index_esm_pc(ya),index_esm_mc(ya)),l.a=xa}else index_esm_Hc(l);0<c.g.length&&index_esm_Ic(c)}else\"stop\"!=e[0]&&\"close\"!=e[0]||Q(c,7);else 3==c.v&&(\"stop\"==e[0]||\"close\"==e[0]?\"stop\"==e[0]?Q(c,7):index_esm_Jc(c):\"noop\"!=e[0]&&c.f&&c.f.sa(e),c.o=0);index_esm_I(4)}catch(tc){}}function index_esm_Lc(a,b){if(a.forEach&&\"function\"==typeof a.forEach)a.forEach(b,void 0);else if(index_esm_ba(a)||\"string\"==typeof a)index_esm_na(a,b,void 0);else{if(a.L&&\"function\"==typeof a.L)var c=a.L();else if(a.K&&\"function\"==typeof a.K)c=void 0;else if(index_esm_ba(a)||\"string\"==typeof a){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else for(e in c=[],d=0,a)c[d++]=e;e=(d=function(a){if(a.K&&\"function\"==typeof a.K)return a.K();if(\"string\"==typeof a)return a.split(\"\");if(index_esm_ba(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}for(d in b=[],c=0,a)b[c++]=a[d];return b}(a)).length;for(var f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}}function index_esm_S(a,b){this.b={},this.a=[],this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error(\"Uneven number of arguments\");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a)if(a instanceof index_esm_S)for(c=a.L(),d=0;d<c.length;d++)this.set(c[d],a.get(c[d]));else for(d in a)this.set(d,a[d])}function index_esm_Mc(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];index_esm_T(a.b,d)&&(a.a[c++]=d),b++}a.a.length=c}if(a.c!=a.a.length){var e={};for(c=b=0;b<a.a.length;)index_esm_T(e,d=a.a[b])||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}function index_esm_T(a,b){return Object.prototype.hasOwnProperty.call(a,b)}(index_esm_h=index_esm_M.prototype).setTimeout=function(a){this.P=a},index_esm_h.Xa=function(a){a=a.target;var b=this.F;b&&3==index_esm_O(a)?b.f():this.Ca(a)},index_esm_h.Ca=function(a){try{if(a==this.a)a:{var b=index_esm_O(this.a),c=this.a.ua(),d=this.a.W();if(!(3>b||3==b&&!index_esm_Ia&&!this.a.$())){this.A||4!=b||7==c||index_esm_I(8==c||0>=d?3:2),index_esm_pc(this);var e=this.a.W();this.N=e;var f=this.a.$();if(this.b=200==e,function(a,b,c,d,e,f,g){a.info((function(){return\"XMLHTTP RESP (\"+d+\") [ attempt \"+e+\"]: \"+b+\"\\n\"+c+\"\\n\"+f+\" \"+g}))}(this.c,this.m,this.l,this.f,this.S,b,e),this.b){if(this.U&&!this.C){b:{if(this.a){var g,m=this.a;if((g=m.a?m.a.getResponseHeader(\"X-HTTP-Initial-Response\"):null)&&!index_esm_sa(g)){var l=g;break b}}l=null}if(!l){this.b=!1,this.h=3,index_esm_J(12),index_esm_P(this),index_esm_rc(this);break a}index_esm_G(this.c,this.f,l,\"Initial handshake response via X-HTTP-Initial-Response\"),this.C=!0,index_esm_qc(this,l)}this.I?(index_esm_sc(this,b,f),index_esm_Ia&&this.b&&3==b&&(index_esm_Mb(this.J,this.R,\"tick\",this.Wa),this.R.start())):(index_esm_G(this.c,this.f,f,null),index_esm_qc(this,f)),4==b&&index_esm_P(this),this.b&&!this.A&&(4==b?index_esm_uc(this.g,this):(this.b=!1,index_esm_mc(this)))}else 400==e&&0<f.indexOf(\"Unknown SID\")?(this.h=3,index_esm_J(12)):(this.h=0,index_esm_J(13)),index_esm_P(this),index_esm_rc(this)}}}catch(u){}},index_esm_h.Wa=function(){if(this.a){var a=index_esm_O(this.a),b=this.a.$();this.D<b.length&&(index_esm_pc(this),index_esm_sc(this,a,b),this.b&&4!=a&&index_esm_mc(this))}},index_esm_h.cancel=function(){this.A=!0,index_esm_P(this)},index_esm_h.Va=function(){this.o=null;var a=index_esm_q();0<=a-this.T?(function(a,b){a.info((function(){return\"TIMEOUT: \"+b}))}(this.c,this.l),2!=this.H&&(index_esm_I(3),index_esm_J(17)),index_esm_P(this),this.h=2,index_esm_rc(this)):index_esm_yc(this,this.T-a)},(index_esm_h=index_esm_S.prototype).K=function(){index_esm_Mc(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a},index_esm_h.L=function(){return index_esm_Mc(this),this.a.concat()},index_esm_h.get=function(a,b){return index_esm_T(this.b,a)?this.b[a]:b},index_esm_h.set=function(a,b){index_esm_T(this.b,a)||(this.c++,this.a.push(a)),this.b[a]=b},index_esm_h.forEach=function(a,b){for(var c=this.L(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};var index_esm_Nc=/^(?:([^:/?#.]+):)?(?:\\/\\/(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$/;function index_esm_U(a,b){if(this.c=this.j=this.f=\"\",this.h=null,this.i=this.g=\"\",this.a=!1,a instanceof index_esm_U){this.a=void 0!==b?b:a.a,index_esm_Pc(this,a.f),this.j=a.j,index_esm_Qc(this,a.c),index_esm_Rc(this,a.h),this.g=a.g,b=a.b;var c=new index_esm_Sc;c.c=b.c,b.a&&(c.a=new index_esm_S(b.a),c.b=b.b),index_esm_Tc(this,c),this.i=a.i}else a&&(c=String(a).match(index_esm_Nc))?(this.a=!!b,index_esm_Pc(this,c[1]||\"\",!0),this.j=index_esm_Uc(c[2]||\"\"),index_esm_Qc(this,c[3]||\"\",!0),index_esm_Rc(this,c[4]),this.g=index_esm_Uc(c[5]||\"\",!0),index_esm_Tc(this,c[6]||\"\",!0),this.i=index_esm_Uc(c[7]||\"\")):(this.a=!!b,this.b=new index_esm_Sc(null,this.a))}function index_esm_N(a){return new index_esm_U(a)}function index_esm_Pc(a,b,c){a.f=c?index_esm_Uc(b,!0):b,a.f&&(a.f=a.f.replace(/:$/,\"\"))}function index_esm_Qc(a,b,c){a.c=c?index_esm_Uc(b,!0):b}function index_esm_Rc(a,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error(\"Bad port number \"+b);a.h=b}else a.h=null}function index_esm_Tc(a,b,c){b instanceof index_esm_Sc?(a.b=b,function(a,b){b&&!a.f&&(index_esm_V(a),a.c=null,a.a.forEach((function(c,d){var e=d.toLowerCase();d!=e&&(index_esm_ed(this,d),index_esm_nc(this,e,c))}),a)),a.f=b}(a.b,a.a)):(c||(b=index_esm_Vc(b,index_esm_ad)),a.b=new index_esm_Sc(b,a.a))}function index_esm_R(a,b,c){a.b.set(b,c)}function index_esm_kc(a){return index_esm_R(a,\"zx\",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^index_esm_q()).toString(36)),a}function index_esm_Uc(a,b){return a?b?decodeURI(a.replace(/%25/g,\"%2525\")):decodeURIComponent(a):\"\"}function index_esm_Vc(a,b,c){return\"string\"==typeof a?(a=encodeURI(a).replace(b,index_esm_dd),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),a):null}function index_esm_dd(a){return\"%\"+((a=a.charCodeAt(0))>>4&15).toString(16)+(15&a).toString(16)}index_esm_U.prototype.toString=function(){var a=[],b=this.f;b&&a.push(index_esm_Vc(b,index_esm_Wc,!0),\":\");var c=this.c;return(c||\"file\"==b)&&(a.push(\"//\"),(b=this.j)&&a.push(index_esm_Vc(b,index_esm_Wc,!0),\"@\"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,\"%$1\")),null!=(c=this.h)&&a.push(\":\",String(c))),(c=this.g)&&(this.c&&\"/\"!=c.charAt(0)&&a.push(\"/\"),a.push(index_esm_Vc(c,\"/\"==c.charAt(0)?index_esm_Xc:index_esm_Yc,!0))),(c=this.b.toString())&&a.push(\"?\",c),(c=this.i)&&a.push(\"#\",index_esm_Vc(c,index_esm_Zc)),a.join(\"\")};var index_esm_Wc=/[#\\/\\?@]/g,index_esm_Yc=/[#\\?:]/g,index_esm_Xc=/[#\\?]/g,index_esm_ad=/[#\\?@]/g,index_esm_Zc=/#/g;function index_esm_Sc(a,b){this.b=this.a=null,this.c=a||null,this.f=!!b}function index_esm_V(a){a.a||(a.a=new index_esm_S,a.b=0,a.c&&function(a,b){if(a){a=a.split(\"&\");for(var c=0;c<a.length;c++){var d=a[c].indexOf(\"=\"),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\\+/g,\" \")):\"\")}}}(a.c,(function(b,c){a.add(decodeURIComponent(b.replace(/\\+/g,\" \")),c)})))}function index_esm_ed(a,b){index_esm_V(a),b=index_esm_W(a,b),index_esm_T(a.a.b,b)&&(a.c=null,a.b-=a.a.get(b).length,index_esm_T((a=a.a).b,b)&&(delete a.b[b],a.c--,a.a.length>2*a.c&&index_esm_Mc(a)))}function index_esm_fd(a,b){return index_esm_V(a),b=index_esm_W(a,b),index_esm_T(a.a.b,b)}function index_esm_nc(a,b,c){index_esm_ed(a,b),0<c.length&&(a.c=null,a.a.set(index_esm_W(a,b),index_esm_ra(c)),a.b+=c.length)}function index_esm_W(a,b){return b=String(b),a.f&&(b=b.toLowerCase()),b}(index_esm_h=index_esm_Sc.prototype).add=function(a,b){index_esm_V(this),this.c=null,a=index_esm_W(this,a);var c=this.a.get(a);return c||this.a.set(a,c=[]),c.push(b),this.b+=1,this},index_esm_h.forEach=function(a,b){index_esm_V(this),this.a.forEach((function(c,d){index_esm_na(c,(function(e){a.call(b,e,d,this)}),this)}),this)},index_esm_h.L=function(){index_esm_V(this);for(var a=this.a.K(),b=this.a.L(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c},index_esm_h.K=function(a){index_esm_V(this);var b=[];if(\"string\"==typeof a)index_esm_fd(this,a)&&(b=index_esm_qa(b,this.a.get(index_esm_W(this,a))));else{a=this.a.K();for(var c=0;c<a.length;c++)b=index_esm_qa(b,a[c])}return b},index_esm_h.set=function(a,b){return index_esm_V(this),this.c=null,index_esm_fd(this,a=index_esm_W(this,a))&&(this.b-=this.a.get(a).length),this.a.set(a,[b]),this.b+=1,this},index_esm_h.get=function(a,b){return a&&0<(a=this.K(a)).length?String(a[0]):b},index_esm_h.toString=function(){if(this.c)return this.c;if(!this.a)return\"\";for(var a=[],b=this.a.L(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.K(d);for(var f=0;f<d.length;f++){var g=e;\"\"!==d[f]&&(g+=\"=\"+encodeURIComponent(String(d[f]))),a.push(g)}}return this.c=a.join(\"&\")};var index_esm_gd=function(){return function(a,b){this.b=a,this.a=b}}();function index_esm_hd(a){this.g=a||index_esm_id,a=index_esm_k.PerformanceNavigationTiming?0<(a=index_esm_k.performance.getEntriesByType(\"navigation\")).length&&(\"hq\"==a[0].nextHopProtocol||\"h2\"==a[0].nextHopProtocol):!!(index_esm_k.ia&&index_esm_k.ia.ya&&index_esm_k.ia.ya()&&index_esm_k.ia.ya().Lb),this.f=a?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var index_esm_id=10;function index_esm_jd(a){return!!a.b||!!a.a&&a.a.size>=a.f}function index_esm_Dc(a){return a.b?1:a.a?a.a.size:0}function index_esm_zc(a,b){return a.b?a.b==b:!!a.a&&a.a.has(b)}function index_esm_Ec(a,b){a.a?a.a.add(b):a.b=b}function index_esm_Gc(a,b){a.b&&a.b==b?a.b=null:a.a&&a.a.has(b)&&a.a.delete(b)}function index_esm_kd(a){var e_2,_a;if(null!=a.b)return a.c.concat(a.b.s);if(null!=a.a&&0!==a.a.size){var b=a.c;try{for(var _b=__values(a.a.values()),_c=_b.next();!_c.done;_c=_b.next())b=b.concat(_c.value.s)}catch(e_2_1){e_2={error:e_2_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_2)throw e_2.error}}return b}return index_esm_ra(a.c)}function index_esm_ld(){}function index_esm_md(){this.a=new index_esm_ld}function index_esm_nd(a,b,c){var d=c||\"\";try{index_esm_Lc(a,(function(e,f){var g=e;index_esm_n(e)&&(g=index_esm_ub(e)),b.push(d+f+\"=\"+encodeURIComponent(g))}))}catch(e){throw b.push(d+\"type=\"+encodeURIComponent(\"_badmap\")),e}}function index_esm_pd(a,b,c,d,e){try{b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,e(d)}catch(f){}}index_esm_hd.prototype.cancel=function(){var e_1,_a;if(this.c=index_esm_kd(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var _b=__values(this.a.values()),_c=_b.next();!_c.done;_c=_b.next())_c.value.cancel()}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}this.a.clear()}},index_esm_ld.prototype.stringify=function(a){return index_esm_k.JSON.stringify(a,void 0)},index_esm_ld.prototype.parse=function(a){return index_esm_k.JSON.parse(a,void 0)};var index_esm_qd=index_esm_k.JSON.parse;function index_esm_X(a){index_esm_D.call(this),this.headers=new index_esm_S,this.H=a||null,this.b=!1,this.s=this.a=null,this.B=\"\",this.h=0,this.f=\"\",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=index_esm_rd,this.D=this.F=!1}index_esm_r(index_esm_X,index_esm_D);var index_esm_rd=\"\",index_esm_sd=/^https?$/i,index_esm_td=[\"POST\",\"PUT\"];function index_esm_pa(a){return\"content-type\"==a.toLowerCase()}function index_esm_ud(a,b){a.b=!1,a.a&&(a.g=!0,a.a.abort(),a.g=!1),a.f=b,a.h=5,index_esm_xd(a),index_esm_yd(a)}function index_esm_xd(a){a.u||(a.u=!0,index_esm_E(a,\"complete\"),index_esm_E(a,\"error\"))}function zd(a){if(a.b&&void 0!==goog&&(!a.s[1]||4!=index_esm_O(a)||2!=a.W()))if(a.l&&4==index_esm_O(a))index_esm_Ib(a.za,0,a);else if(index_esm_E(a,\"readystatechange\"),4==index_esm_O(a)){a.b=!1;try{var c,l=a.W();a:switch(l){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break a;default:b=!1}if(!(c=b)){var d;if(d=0===l){var e=String(a.B).match(index_esm_Nc)[1]||null;if(!e&&index_esm_k.self&&index_esm_k.self.location){var f=index_esm_k.self.location.protocol;e=f.substr(0,f.length-1)}d=!index_esm_sd.test(e?e.toLowerCase():\"\")}c=d}if(c)index_esm_E(a,\"complete\"),index_esm_E(a,\"success\");else{a.h=6;try{var m=2<index_esm_O(a)?a.a.statusText:\"\"}catch(l){m=\"\"}a.f=m+\" [\"+a.W()+\"]\",index_esm_xd(a)}}finally{index_esm_yd(a)}}}function index_esm_yd(a,b){if(a.a){index_esm_vd(a);var c=a.a,d=a.s[0]?index_esm_aa:null;a.a=null,a.s=null,b||index_esm_E(a,\"ready\");try{c.onreadystatechange=d}catch(e){}}}function index_esm_vd(a){a.a&&a.D&&(a.a.ontimeout=null),a.m&&(index_esm_k.clearTimeout(a.m),a.m=null)}function index_esm_O(a){return a.a?a.a.readyState:0}function index_esm_Bd(a,b,c){a:{for(d in c){var d=!1;break a}d=!0}d||(c=function(a){var b=\"\";return index_esm_za(a,(function(c,d){b+=d,b+=\":\",b+=c,b+=\"\\r\\n\"})),b}(c),\"string\"==typeof a?null!=c&&encodeURIComponent(String(c)):index_esm_R(a,b,c))}function index_esm_Cd(a,b,c){return c&&c.internalChannelParams&&c.internalChannelParams[a]||b}function index_esm_Dd(a){this.pa=0,this.g=[],this.c=new index_esm_Ob,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=index_esm_Cd(\"failFast\",!1,a),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=index_esm_Cd(\"baseRetryDelayMs\",5e3,a),this.Ra=index_esm_Cd(\"retryDelaySeedMs\",1e4,a),this.Ma=index_esm_Cd(\"forwardChannelMaxRetries\",2,a),this.ma=index_esm_Cd(\"forwardChannelRequestTimeoutMs\",2e4,a),this.Na=a&&a.g||void 0,this.D=void 0,this.C=a&&a.supportsCrossDomainXhr||!1,this.J=\"\",this.b=new index_esm_hd(a&&a.concurrentRequestLimit),this.ka=new index_esm_md,this.da=a&&a.fastHandshake||!1,this.Ia=a&&a.b||!1,a&&a.f&&(this.c.a=!1),a&&a.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&a&&a.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=a&&a.c||!1)&&this.c.info(\"Opt-in to enable Chrome Origin Trials.\")}function index_esm_Jc(a){if(index_esm_Ed(a),3==a.v){var b=a.R++,c=index_esm_N(a.B);index_esm_R(c,\"SID\",a.J),index_esm_R(c,\"RID\",b),index_esm_R(c,\"TYPE\",\"terminate\"),index_esm_Fd(a,c),(b=new index_esm_M(a,a.c,b,void 0)).H=2,b.i=index_esm_kc(index_esm_N(c)),c=!1,index_esm_k.navigator&&index_esm_k.navigator.sendBeacon&&(c=index_esm_k.navigator.sendBeacon(b.i.toString(),\"\")),!c&&index_esm_k.Image&&((new Image).src=b.i,c=!0),c||(b.a=index_esm_oc(b.g,null),b.a.ba(b.i)),b.u=index_esm_q(),index_esm_mc(b)}index_esm_Gd(a)}function index_esm_Bc(a){a.a&&(index_esm_wc(a),a.a.cancel(),a.a=null)}function index_esm_Ed(a){index_esm_Bc(a),a.j&&(index_esm_k.clearTimeout(a.j),a.j=null),index_esm_Ac(a),a.b.cancel(),a.h&&(\"number\"==typeof a.h&&index_esm_k.clearTimeout(a.h),a.h=null)}function index_esm_Hd(a,b){a.g.push(new index_esm_gd(a.Oa++,b)),3==a.v&&index_esm_Ic(a)}function index_esm_Ic(a){index_esm_jd(a.b)||a.h||(a.h=!0,index_esm_Bb(a.Ba,a),a.u=0)}function index_esm_Ld(a,b){var c;c=b?b.f:a.R++;var d=index_esm_N(a.B);index_esm_R(d,\"SID\",a.J),index_esm_R(d,\"RID\",c),index_esm_R(d,\"AID\",a.P),index_esm_Fd(a,d),a.i&&a.l&&index_esm_Bd(d,a.i,a.l),c=new index_esm_M(a,a.c,c,a.u+1),null===a.i&&(c.B=a.l),b&&(a.g=b.s.concat(a.g)),b=index_esm_Kd(a,c,1e3),c.setTimeout(Math.round(.5*a.ma)+Math.round(.5*a.ma*Math.random())),index_esm_Ec(a.b,c),index_esm_jc(c,d,b)}function index_esm_Fd(a,b){a.f&&index_esm_Lc({},(function(c,d){index_esm_R(b,d,c)}))}function index_esm_Kd(a,b,c){c=Math.min(a.g.length,c);var d=a.f?index_esm_p(a.f.Ja,a.f,a):null;a:for(var e=a.g,f=-1;;){var g=[\"count=\"+c];-1==f?0<c?g.push(\"ofs=\"+(f=e[0].b)):f=0:g.push(\"ofs=\"+f);for(var m=!0,l=0;l<c;l++){var u=e[l].b,C=e[l].a;if(0>(u-=f))f=Math.max(0,e[l].b-100),m=!1;else try{index_esm_nd(C,g,\"req\"+u+\"_\")}catch(B){d&&d(C)}}if(m){d=g.join(\"&\");break a}}return a=a.g.splice(0,c),b.s=a,d}function index_esm_Hc(a){a.a||a.j||(a.T=1,index_esm_Bb(a.Aa,a),a.o=0)}function index_esm_Cc(a){return!(a.a||a.j||3<=a.o||(a.T++,a.j=index_esm_K(index_esm_p(a.Aa,a),index_esm_Jd(a,a.o)),a.o++,0))}function index_esm_wc(a){null!=a.s&&(index_esm_k.clearTimeout(a.s),a.s=null)}function index_esm_Md(a){a.a=new index_esm_M(a,a.c,\"rpc\",a.T),null===a.i&&(a.a.B=a.l),a.a.O=0;var b=index_esm_N(a.la);index_esm_R(b,\"RID\",\"rpc\"),index_esm_R(b,\"SID\",a.J),index_esm_R(b,\"CI\",a.H?\"0\":\"1\"),index_esm_R(b,\"AID\",a.P),index_esm_Fd(a,b),index_esm_R(b,\"TYPE\",\"xmlhttp\"),a.i&&a.l&&index_esm_Bd(b,a.i,a.l),a.D&&a.a.setTimeout(a.D);var c=a.a;a=a.ga,c.H=1,c.i=index_esm_kc(index_esm_N(b)),c.j=null,c.I=!0,index_esm_lc(c,a)}function index_esm_Ac(a){null!=a.m&&(index_esm_k.clearTimeout(a.m),a.m=null)}function index_esm_uc(a,b){var c=null;if(a.a==b){index_esm_Ac(a),index_esm_wc(a),a.a=null;var d=2}else{if(!index_esm_zc(a.b,b))return;c=b.s,index_esm_Gc(a.b,b),d=1}if(a.I=b.N,0!=a.v)if(b.b)if(1==d){c=b.j?b.j.length:0,b=index_esm_q()-b.u;var e=a.u;index_esm_E(d=index_esm_Ub(),new index_esm_Xb(d,c,b,e)),index_esm_Ic(a)}else index_esm_Hc(a);else if(3==(e=b.h)||0==e&&0<a.I||!(1==d&&function(a,b){return!(index_esm_Dc(a.b)>=a.b.f-(a.h?1:0)||(a.h?(a.g=b.s.concat(a.g),0):1==a.v||2==a.v||a.u>=(a.La?0:a.Ma)||(a.h=index_esm_K(index_esm_p(a.Ba,a,b),index_esm_Jd(a,a.u)),a.u++,0)))}(a,b)||2==d&&index_esm_Cc(a)))switch(c&&0<c.length&&(b=a.b,b.c=b.c.concat(c)),e){case 1:Q(a,5);break;case 4:Q(a,10);break;case 3:Q(a,6);break;default:Q(a,2)}}function index_esm_Jd(a,b){var c=a.Ha+Math.floor(Math.random()*a.Ra);return a.f||(c*=2),c*b}function Q(a,b){if(a.c.info(\"Error code \"+b),2==b){var c=null;a.f&&(c=null);var d=index_esm_p(a.Ya,a);c||(c=new index_esm_U(\"//www.google.com/images/cleardot.gif\"),index_esm_k.location&&\"http\"==index_esm_k.location.protocol||index_esm_Pc(c,\"https\"),index_esm_kc(c)),function(a,b){var c=new index_esm_Ob;if(index_esm_k.Image){var d=new Image;d.onload=index_esm_ja(index_esm_pd,c,d,\"TestLoadImage: loaded\",!0,b),d.onerror=index_esm_ja(index_esm_pd,c,d,\"TestLoadImage: error\",!1,b),d.onabort=index_esm_ja(index_esm_pd,c,d,\"TestLoadImage: abort\",!1,b),d.ontimeout=index_esm_ja(index_esm_pd,c,d,\"TestLoadImage: timeout\",!1,b),index_esm_k.setTimeout((function(){d.ontimeout&&d.ontimeout()}),1e4),d.src=a}else b(!1)}(c.toString(),d)}else index_esm_J(2);a.v=0,a.f&&a.f.ra(b),index_esm_Gd(a),index_esm_Ed(a)}function index_esm_Gd(a){a.v=0,a.I=-1,a.f&&(0==index_esm_kd(a.b).length&&0==a.g.length||(a.b.c.length=0,index_esm_ra(a.g),a.g.length=0),a.f.qa())}function index_esm_Fc(a,b,c){var d=function(a){return a instanceof index_esm_U?index_esm_N(a):new index_esm_U(a,void 0)}(c);if(\"\"!=d.c)b&&index_esm_Qc(d,b+\".\"+d.c),index_esm_Rc(d,d.h);else{var e=index_esm_k.location;d=function(a,b,c,d){var e=new index_esm_U(null,void 0);return a&&index_esm_Pc(e,a),b&&index_esm_Qc(e,b),c&&index_esm_Rc(e,c),d&&(e.g=d),e}(e.protocol,b?b+\".\"+e.hostname:e.hostname,+e.port,c)}return a.V&&index_esm_za(a.V,(function(f,g){index_esm_R(d,g,f)})),c=a.na,(b=a.A)&&c&&index_esm_R(d,b,c),index_esm_R(d,\"VER\",a.ha),index_esm_Fd(a,d),d}function index_esm_oc(a,b){if(b&&!a.C)throw Error(\"Can't create secondary domain capable XhrIo object.\");return(b=new index_esm_X(a.Na)).F=a.C,b}function index_esm_Nd(){}function index_esm_Od(){if(index_esm_x&&!(10<=Number(index_esm_Ta)))throw Error(\"Environmental error: no available transport.\")}function index_esm_Y(a,b){index_esm_D.call(this),this.a=new index_esm_Dd(b),this.o=a,this.b=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a[\"X-Client-Protocol\"]=\"webchannel\":a={\"X-Client-Protocol\":\"webchannel\"}),this.a.l=a,a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a[\"X-WebChannel-Content-Type\"]=b.messageContentType:a={\"X-WebChannel-Content-Type\":b.messageContentType}),b&&b.a&&(a?a[\"X-WebChannel-Client-Profile\"]=b.a:a={\"X-WebChannel-Client-Profile\":b.a}),this.a.O=a,(a=b&&b.httpHeadersOverwriteParam)&&!index_esm_sa(a)&&(this.a.i=a),this.m=b&&b.supportsCrossDomainXhr||!1,this.l=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!index_esm_sa(b)&&(this.a.A=b,null!==(a=this.b)&&b in a&&b in(a=this.b)&&delete a[b]),this.f=new index_esm_Z(this)}function index_esm_Pd(a){index_esm_cc.call(this);var b=a.__sm__;if(b){a:{for(var c in b){a=c;break a}a=void 0}(this.c=a)?(a=this.c,this.data=null!==b&&a in b?b[a]:void 0):this.data=b}else this.data=a}function index_esm_Qd(){index_esm_dc.call(this),this.status=1}function index_esm_Z(a){this.a=a}(index_esm_h=index_esm_X.prototype).ba=function(a,b,c,d){if(this.a)throw Error(\"[goog.net.XhrIo] Object is active with another request=\"+this.B+\"; newUri=\"+a);b=b?b.toUpperCase():\"GET\",this.B=a,this.f=\"\",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(a){var b;return(b=a.a)||(b=a.a={}),b}(this.H?this.H:index_esm_ec),this.a.onreadystatechange=index_esm_p(this.za,this);try{this.A=!0,this.a.open(b,String(a),!0),this.A=!1}catch(f){return void index_esm_ud(this,f)}a=c||\"\";var e=new index_esm_S(this.headers);d&&index_esm_Lc(d,(function(f,g){e.set(g,f)})),d=function(a){a:{for(var b=index_esm_pa,c=a.length,d=\"string\"==typeof a?a.split(\"\"):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:\"string\"==typeof a?a.charAt(b):a[b]}(e.L()),c=index_esm_k.FormData&&a instanceof index_esm_k.FormData,!(0<=index_esm_ma(index_esm_td,b))||d||c||e.set(\"Content-Type\",\"application/x-www-form-urlencoded;charset=utf-8\"),e.forEach((function(f,g){this.a.setRequestHeader(g,f)}),this),this.I&&(this.a.responseType=this.I),\"withCredentials\"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{index_esm_vd(this),0<this.o&&((this.D=function(a){return index_esm_x&&index_esm_Qa(9)&&\"number\"==typeof a.timeout&&void 0!==a.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=index_esm_p(this.xa,this)):this.m=index_esm_Ib(this.xa,this.o,this)),this.l=!0,this.a.send(a),this.l=!1}catch(f){index_esm_ud(this,f)}},index_esm_h.xa=function(){void 0!==goog&&this.a&&(this.f=\"Timed out after \"+this.o+\"ms, aborting\",this.h=8,index_esm_E(this,\"timeout\"),this.abort(8))},index_esm_h.abort=function(a){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=a||7,index_esm_E(this,\"complete\"),index_esm_E(this,\"abort\"),index_esm_yd(this))},index_esm_h.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),index_esm_yd(this,!0)),index_esm_X.X.G.call(this)},index_esm_h.za=function(){this.j||(this.A||this.l||this.g?zd(this):this.Ua())},index_esm_h.Ua=function(){zd(this)},index_esm_h.W=function(){try{return 2<index_esm_O(this)?this.a.status:-1}catch(a){return-1}},index_esm_h.$=function(){try{return this.a?this.a.responseText:\"\"}catch(a){return\"\"}},index_esm_h.Pa=function(a){if(this.a){var b=this.a.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),index_esm_qd(b)}},index_esm_h.ua=function(){return this.h},index_esm_h.Qa=function(){return\"string\"==typeof this.f?this.f:String(this.f)},(index_esm_h=index_esm_Dd.prototype).ha=8,index_esm_h.v=1,index_esm_h.Ba=function(a){if(this.h)if(this.h=null,1==this.v){if(!a){this.R=Math.floor(1e5*Math.random()),a=this.R++;var d,b=new index_esm_M(this,this.c,a,void 0),c=this.l;if(this.O&&(c?index_esm_Ca(c=index_esm_Aa(c),this.O):c=this.O),null===this.i&&(b.B=c),this.da)a:{for(var e=d=0;e<this.g.length;e++){var f=this.g[e];if(void 0===(f=\"__data__\"in f.a&&\"string\"==typeof(f=f.a.__data__)?f.length:void 0))break;if(4096<(d+=f)){d=e;break a}if(4096===d||e===this.g.length-1){d=e+1;break a}}d=1e3}else d=1e3;d=index_esm_Kd(this,b,d),index_esm_R(e=index_esm_N(this.B),\"RID\",a),index_esm_R(e,\"CVER\",22),this.A&&index_esm_R(e,\"X-HTTP-Session-Id\",this.A),index_esm_Fd(this,e),this.i&&c&&index_esm_Bd(e,this.i,c),index_esm_Ec(this.b,b),this.Ia&&index_esm_R(e,\"TYPE\",\"init\"),this.da?(index_esm_R(e,\"$req\",d),index_esm_R(e,\"SID\",\"null\"),b.U=!0,index_esm_jc(b,e,null)):index_esm_jc(b,e,d),this.v=2}}else 3==this.v&&(a?index_esm_Ld(this,a):0==this.g.length||index_esm_jd(this.b)||index_esm_Ld(this))},index_esm_h.Aa=function(){if(this.j=null,index_esm_Md(this),this.U&&!(this.F||null==this.a||0>=this.N)){var a=2*this.N;this.c.info(\"BP detection timer enabled: \"+a),this.s=index_esm_K(index_esm_p(this.Ta,this),a)}},index_esm_h.Ta=function(){this.s&&(this.s=null,this.c.info(\"BP detection timeout reached.\"),this.c.info(\"Buffering proxy detected and switch to long-polling!\"),this.H=!1,this.F=!0,index_esm_J(10),index_esm_Bc(this),index_esm_Md(this))},index_esm_h.Sa=function(){null!=this.m&&(this.m=null,index_esm_Bc(this),index_esm_Cc(this),index_esm_J(19))},index_esm_h.Ya=function(a){a?(this.c.info(\"Successfully pinged google.com\"),index_esm_J(2)):(this.c.info(\"Failed to ping google.com\"),index_esm_J(1))},(index_esm_h=index_esm_Nd.prototype).ta=function(){},index_esm_h.sa=function(){},index_esm_h.ra=function(){},index_esm_h.qa=function(){},index_esm_h.Ja=function(){},index_esm_Od.prototype.a=function(a,b){return new index_esm_Y(a,b)},index_esm_r(index_esm_Y,index_esm_D),index_esm_Y.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var a=this.a,b=this.o,c=this.b||void 0;index_esm_J(0),a.fa=b,a.V=c||{},a.H=a.S,a.B=index_esm_Fc(a,null,a.fa),index_esm_Ic(a)},index_esm_Y.prototype.close=function(){index_esm_Jc(this.a)},index_esm_Y.prototype.h=function(a){if(\"string\"==typeof a){var b={};b.__data__=a,index_esm_Hd(this.a,b)}else this.l?((b={}).__data__=index_esm_ub(a),index_esm_Hd(this.a,b)):index_esm_Hd(this.a,a)},index_esm_Y.prototype.G=function(){this.a.f=null,delete this.f,index_esm_Jc(this.a),delete this.a,index_esm_Y.X.G.call(this)},index_esm_r(index_esm_Pd,index_esm_cc),index_esm_r(index_esm_Qd,index_esm_dc),index_esm_r(index_esm_Z,index_esm_Nd),index_esm_Z.prototype.ta=function(){index_esm_E(this.a,\"a\")},index_esm_Z.prototype.sa=function(a){index_esm_E(this.a,new index_esm_Pd(a))},index_esm_Z.prototype.ra=function(a){index_esm_E(this.a,new index_esm_Qd(a))},index_esm_Z.prototype.qa=function(){index_esm_E(this.a,\"b\")},index_esm_Od.prototype.createWebChannel=index_esm_Od.prototype.a,index_esm_Y.prototype.send=index_esm_Y.prototype.h,index_esm_Y.prototype.open=index_esm_Y.prototype.g,index_esm_Y.prototype.close=index_esm_Y.prototype.close,index_esm_Yb.NO_ERROR=0,index_esm_Yb.TIMEOUT=8,index_esm_Yb.HTTP_ERROR=6,index_esm_Zb.COMPLETE=\"complete\",index_esm_bc.EventType=index_esm_L,index_esm_L.OPEN=\"a\",index_esm_L.CLOSE=\"b\",index_esm_L.ERROR=\"c\",index_esm_L.MESSAGE=\"d\",index_esm_D.prototype.listen=index_esm_D.prototype.va,index_esm_X.prototype.listenOnce=index_esm_X.prototype.wa,index_esm_X.prototype.getLastError=index_esm_X.prototype.Qa,index_esm_X.prototype.getLastErrorCode=index_esm_X.prototype.ua,index_esm_X.prototype.getStatus=index_esm_X.prototype.W,index_esm_X.prototype.getResponseJson=index_esm_X.prototype.Pa,index_esm_X.prototype.getResponseText=index_esm_X.prototype.$,index_esm_X.prototype.send=index_esm_X.prototype.ba;var ErrorCode=index_esm_Yb,EventType=index_esm_Zb,Event=index_esm_H,WebChannel=index_esm_bc,XhrIo=index_esm_X,tslib_es6=__webpack_require__(\"mrSG\"),prebuilt_28889c43_f8ea673b_E=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();prebuilt_28889c43_f8ea673b_E.o=-1;var _={OK:\"ok\",CANCELLED:\"cancelled\",UNKNOWN:\"unknown\",INVALID_ARGUMENT:\"invalid-argument\",DEADLINE_EXCEEDED:\"deadline-exceeded\",NOT_FOUND:\"not-found\",ALREADY_EXISTS:\"already-exists\",PERMISSION_DENIED:\"permission-denied\",UNAUTHENTICATED:\"unauthenticated\",RESOURCE_EXHAUSTED:\"resource-exhausted\",FAILED_PRECONDITION:\"failed-precondition\",ABORTED:\"aborted\",OUT_OF_RANGE:\"out-of-range\",UNIMPLEMENTED:\"unimplemented\",INTERNAL:\"internal\",UNAVAILABLE:\"unavailable\",DATA_LOSS:\"data-loss\"},prebuilt_28889c43_f8ea673b_S=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name=\"FirebaseError\",r.toString=function(){return r.name+\": [code=\"+r.code+\"]: \"+r.message},r}return Object(tslib_es6.__extends)(e,t),e}(Error),prebuilt_28889c43_f8ea673b_N=new logger_dist_index_esm.Logger(\"@firebase/firestore\");function prebuilt_28889c43_f8ea673b_D(){return prebuilt_28889c43_f8ea673b_N.logLevel}function prebuilt_28889c43_f8ea673b_A(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(prebuilt_28889c43_f8ea673b_N.logLevel<=logger_dist_index_esm.LogLevel.DEBUG){var r=e.map(prebuilt_28889c43_f8ea673b_C);prebuilt_28889c43_f8ea673b_N.debug.apply(prebuilt_28889c43_f8ea673b_N,Object(tslib_es6.__spreadArray)([\"Firestore (8.6.2): \"+t],r))}}function prebuilt_28889c43_f8ea673b_k(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(prebuilt_28889c43_f8ea673b_N.logLevel<=logger_dist_index_esm.LogLevel.ERROR){var r=e.map(prebuilt_28889c43_f8ea673b_C);prebuilt_28889c43_f8ea673b_N.error.apply(prebuilt_28889c43_f8ea673b_N,Object(tslib_es6.__spreadArray)([\"Firestore (8.6.2): \"+t],r))}}function prebuilt_28889c43_f8ea673b_x(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(prebuilt_28889c43_f8ea673b_N.logLevel<=logger_dist_index_esm.LogLevel.WARN){var r=e.map(prebuilt_28889c43_f8ea673b_C);prebuilt_28889c43_f8ea673b_N.warn.apply(prebuilt_28889c43_f8ea673b_N,Object(tslib_es6.__spreadArray)([\"Firestore (8.6.2): \"+t],r))}}function prebuilt_28889c43_f8ea673b_C(t){if(\"string\"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function prebuilt_28889c43_f8ea673b_R(t){void 0===t&&(t=\"Unexpected state\");var e=\"FIRESTORE (8.6.2) INTERNAL ASSERTION FAILED: \"+t;throw prebuilt_28889c43_f8ea673b_k(e),new Error(e)}function prebuilt_28889c43_f8ea673b_O(t,e){t||prebuilt_28889c43_f8ea673b_R()}function prebuilt_28889c43_f8ea673b_L(t,e){return t}function prebuilt_28889c43_f8ea673b_P(t){var e=\"undefined\"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&\"function\"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var prebuilt_28889c43_f8ea673b_M=function(){function t(){}return t.u=function(){for(var t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",e=Math.floor(256/t.length)*t.length,n=\"\";n.length<20;)for(var r=prebuilt_28889c43_f8ea673b_P(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function prebuilt_28889c43_f8ea673b_F(t,e){return t<e?-1:t>e?1:0}function prebuilt_28889c43_f8ea673b_V(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function prebuilt_28889c43_f8ea673b_q(t){return t+\"\\0\"}var prebuilt_28889c43_f8ea673b_U=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Timestamp nanoseconds out of range: \"+e);if(e>=1e9)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Timestamp nanoseconds out of range: \"+e);if(t<-62135596800)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Timestamp seconds out of range: \"+t);if(t>=253402300800)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Timestamp seconds out of range: \"+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?prebuilt_28889c43_f8ea673b_F(this.nanoseconds,t.nanoseconds):prebuilt_28889c43_f8ea673b_F(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return\"Timestamp(seconds=\"+this.seconds+\", nanoseconds=\"+this.nanoseconds+\")\"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,\"0\")+\".\"+String(this.nanoseconds).padStart(9,\"0\")},t}(),B=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new prebuilt_28889c43_f8ea673b_U(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return\"SnapshotVersion(\"+this.timestamp.toString()+\")\"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function j(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function prebuilt_28889c43_f8ea673b_K(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function prebuilt_28889c43_f8ea673b_G(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var prebuilt_28889c43_f8ea673b_Q=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&prebuilt_28889c43_f8ea673b_R(),void 0===n?n=t.length-e:n>t.length-e&&prebuilt_28889c43_f8ea673b_R(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,\"length\",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),prebuilt_28889c43_f8ea673b_z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(tslib_es6.__extends)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join(\"/\")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf(\"//\")>=0)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid segment (\"+s+\"). Paths must not contain // in them.\");r.push.apply(r,s.split(\"/\").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(prebuilt_28889c43_f8ea673b_Q),prebuilt_28889c43_f8ea673b_W=/^[_a-zA-Z][_a-zA-Z0-9]*$/,prebuilt_28889c43_f8ea673b_H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(tslib_es6.__extends)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return prebuilt_28889c43_f8ea673b_W.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\\\/g,\"\\\\\\\\\").replace(/`/g,\"\\\\`\"),e.isValidIdentifier(t)||(t=\"`\"+t+\"`\"),t})).join(\".\")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&\"__name__\"===this.get(0)},e.keyField=function(){return new e([\"__name__\"])},e.fromServerFormat=function(t){for(var n=[],r=\"\",i=0,o=function(){if(0===r.length)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid field path (\"+t+\"). Paths must not be empty, begin with '.', end with '.', or contain '..'\");n.push(r),r=\"\"},s=!1;i<t.length;){var u=t[i];if(\"\\\\\"===u){if(i+1===t.length)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Path has trailing escape character: \"+t);var a=t[i+1];if(\"\\\\\"!==a&&\".\"!==a&&\"`\"!==a)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Path has invalid escape sequence: \"+t);r+=a,i+=2}else\"`\"===u?(s=!s,i++):\".\"!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Unterminated ` in path: \"+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(prebuilt_28889c43_f8ea673b_Q),prebuilt_28889c43_f8ea673b_Y=function(){function t(t){this.fields=t,t.sort(prebuilt_28889c43_f8ea673b_H.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return prebuilt_28889c43_f8ea673b_V(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),prebuilt_28889c43_f8ea673b_X=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e=\"\",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return prebuilt_28889c43_f8ea673b_F(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();prebuilt_28889c43_f8ea673b_X.EMPTY_BYTE_STRING=new prebuilt_28889c43_f8ea673b_X(\"\");var prebuilt_28889c43_f8ea673b_J=new RegExp(/^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(?:\\.(\\d+))?Z$/);function $(t){if(prebuilt_28889c43_f8ea673b_O(!!t),\"string\"==typeof t){var e=0,n=prebuilt_28889c43_f8ea673b_J.exec(t);if(prebuilt_28889c43_f8ea673b_O(!!n),n[1]){var r=n[1];r=(r+\"000000000\").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:prebuilt_28889c43_f8ea673b_Z(t.seconds),nanos:prebuilt_28889c43_f8ea673b_Z(t.nanos)}}function prebuilt_28889c43_f8ea673b_Z(t){return\"number\"==typeof t?t:\"string\"==typeof t?Number(t):0}function tt(t){return\"string\"==typeof t?prebuilt_28889c43_f8ea673b_X.fromBase64String(t):prebuilt_28889c43_f8ea673b_X.fromUint8Array(t)}function et(t){var e,n;return\"server_timestamp\"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function rt(t){var e=$(t.mapValue.fields.__local_write_time__.timestampValue);return new prebuilt_28889c43_f8ea673b_U(e.seconds,e.nanos)}function it(t){return null==t}function ot(t){return 0===t&&1/t==-1/0}function st(t){return\"number\"==typeof t&&Number.isInteger(t)&&!ot(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var ut=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(prebuilt_28889c43_f8ea673b_z.fromString(e))},t.fromName=function(e){return new t(prebuilt_28889c43_f8ea673b_z.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===prebuilt_28889c43_f8ea673b_z.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return prebuilt_28889c43_f8ea673b_z.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new prebuilt_28889c43_f8ea673b_z(e.slice()))},t}();function at(t){return\"nullValue\"in t?0:\"booleanValue\"in t?1:\"integerValue\"in t||\"doubleValue\"in t?2:\"timestampValue\"in t?3:\"stringValue\"in t?5:\"bytesValue\"in t?6:\"referenceValue\"in t?7:\"geoPointValue\"in t?8:\"arrayValue\"in t?9:\"mapValue\"in t?et(t)?4:10:prebuilt_28889c43_f8ea673b_R()}function ct(t,e){var n=at(t);if(n!==at(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return rt(t).isEqual(rt(e));case 3:return function(t,e){if(\"string\"==typeof t.timestampValue&&\"string\"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=$(t.timestampValue),r=$(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return tt(t.bytesValue).isEqual(tt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return prebuilt_28889c43_f8ea673b_Z(t.geoPointValue.latitude)===prebuilt_28889c43_f8ea673b_Z(e.geoPointValue.latitude)&&prebuilt_28889c43_f8ea673b_Z(t.geoPointValue.longitude)===prebuilt_28889c43_f8ea673b_Z(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if(\"integerValue\"in t&&\"integerValue\"in e)return prebuilt_28889c43_f8ea673b_Z(t.integerValue)===prebuilt_28889c43_f8ea673b_Z(e.integerValue);if(\"doubleValue\"in t&&\"doubleValue\"in e){var n=prebuilt_28889c43_f8ea673b_Z(t.doubleValue),r=prebuilt_28889c43_f8ea673b_Z(e.doubleValue);return n===r?ot(n)===ot(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return prebuilt_28889c43_f8ea673b_V(t.arrayValue.values||[],e.arrayValue.values||[],ct);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(j(n)!==j(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ct(n[i],r[i])))return!1;return!0}(t,e);default:return prebuilt_28889c43_f8ea673b_R()}}function ht(t,e){return void 0!==(t.values||[]).find((function(t){return ct(t,e)}))}function ft(t,e){var n=at(t),r=at(e);if(n!==r)return prebuilt_28889c43_f8ea673b_F(n,r);switch(n){case 0:return 0;case 1:return prebuilt_28889c43_f8ea673b_F(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=prebuilt_28889c43_f8ea673b_Z(t.integerValue||t.doubleValue),r=prebuilt_28889c43_f8ea673b_Z(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return lt(t.timestampValue,e.timestampValue);case 4:return lt(rt(t),rt(e));case 5:return prebuilt_28889c43_f8ea673b_F(t.stringValue,e.stringValue);case 6:return function(t,e){var n=tt(t),r=tt(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split(\"/\"),r=e.split(\"/\"),i=0;i<n.length&&i<r.length;i++){var o=prebuilt_28889c43_f8ea673b_F(n[i],r[i]);if(0!==o)return o}return prebuilt_28889c43_f8ea673b_F(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=prebuilt_28889c43_f8ea673b_F(prebuilt_28889c43_f8ea673b_Z(t.latitude),prebuilt_28889c43_f8ea673b_Z(e.latitude));return 0!==n?n:prebuilt_28889c43_f8ea673b_F(prebuilt_28889c43_f8ea673b_Z(t.longitude),prebuilt_28889c43_f8ea673b_Z(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ft(n[i],r[i]);if(o)return o}return prebuilt_28889c43_f8ea673b_F(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=prebuilt_28889c43_f8ea673b_F(r[s],o[s]);if(0!==u)return u;var a=ft(n[r[s]],i[o[s]]);if(0!==a)return a}return prebuilt_28889c43_f8ea673b_F(r.length,o.length)}(t.mapValue,e.mapValue);default:throw prebuilt_28889c43_f8ea673b_R()}}function lt(t,e){if(\"string\"==typeof t&&\"string\"==typeof e&&t.length===e.length)return prebuilt_28889c43_f8ea673b_F(t,e);var n=$(t),r=$(e),i=prebuilt_28889c43_f8ea673b_F(n.seconds,r.seconds);return 0!==i?i:prebuilt_28889c43_f8ea673b_F(n.nanos,r.nanos)}function dt(t){return function pt(t){return\"nullValue\"in t?\"null\":\"booleanValue\"in t?\"\"+t.booleanValue:\"integerValue\"in t?\"\"+t.integerValue:\"doubleValue\"in t?\"\"+t.doubleValue:\"timestampValue\"in t?function(t){var e=$(t);return\"time(\"+e.seconds+\",\"+e.nanos+\")\"}(t.timestampValue):\"stringValue\"in t?t.stringValue:\"bytesValue\"in t?tt(t.bytesValue).toBase64():\"referenceValue\"in t?ut.fromName(t.referenceValue).toString():\"geoPointValue\"in t?\"geo(\"+(e=t.geoPointValue).latitude+\",\"+e.longitude+\")\":\"arrayValue\"in t?function(t){for(var e=\"[\",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=\",\",e+=pt(i[r]);return e+\"]\"}(t.arrayValue):\"mapValue\"in t?function(t){for(var e=\"{\",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=\",\",e+=o+\":\"+pt(t.fields[o])}return e+\"}\"}(t.mapValue):prebuilt_28889c43_f8ea673b_R();var e}(t)}function yt(t,e){return{referenceValue:\"projects/\"+t.projectId+\"/databases/\"+t.database+\"/documents/\"+e.path.canonicalString()}}function vt(t){return!!t&&\"integerValue\"in t}function mt(t){return!!t&&\"arrayValue\"in t}function gt(t){return!!t&&\"nullValue\"in t}function wt(t){return!!t&&\"doubleValue\"in t&&isNaN(Number(t.doubleValue))}function bt(t){return!!t&&\"mapValue\"in t}var It=function(){function t(t){this.overlayMap=new Map,this.partialValue=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(e){return t.extractNestedValue(this.buildProto(),e)},t.prototype.toProto=function(){return this.field(prebuilt_28889c43_f8ea673b_H.emptyPath())},t.prototype.set=function(t,e){this.setOverlay(t,e)},t.prototype.setAll=function(t){var e=this;t.forEach((function(t,n){t?e.set(n,t):e.delete(n)}))},t.prototype.delete=function(t){this.setOverlay(t,null)},t.prototype.isEqual=function(t){return ct(this.buildProto(),t.buildProto())},t.prototype.setOverlay=function(t,e){for(var n=this.overlayMap,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===at(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.lastSegment(),e)},t.prototype.applyOverlay=function(e,n){var r=this,i=!1,o=t.extractNestedValue(this.partialValue,e),s=bt(o)?Object.assign({},o.mapValue.fields):{};return n.forEach((function(t,n){if(t instanceof Map){var o=r.applyOverlay(e.child(n),t);null!=o&&(s[n]=o,i=!0)}else null!==t?(s[n]=t,i=!0):s.hasOwnProperty(n)&&(delete s[n],i=!0)})),i?{mapValue:{fields:s}}:null},t.prototype.buildProto=function(){var t=this.applyOverlay(prebuilt_28889c43_f8ea673b_H.emptyPath(),this.overlayMap);return null!=t&&(this.partialValue=t,this.overlayMap.clear()),this.partialValue},t.extractNestedValue=function(t,e){if(e.isEmpty())return t;for(var n=t,r=0;r<e.length-1;++r){if(!n.mapValue.fields)return null;if(!bt(n=n.mapValue.fields[e.get(r)]))return null}return(n=(n.mapValue.fields||{})[e.lastSegment()])||null},t.prototype.clone=function(){return new t(this.buildProto())},t}();function Tt(t){var e=[];return prebuilt_28889c43_f8ea673b_K(t.fields||{},(function(t,n){var r=new prebuilt_28889c43_f8ea673b_H([t]);if(bt(n)){var i=Tt(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)})),new prebuilt_28889c43_f8ea673b_Y(e)}var Et=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,B.min(),It.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,It.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,It.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=It.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=It.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,\"hasLocalMutations\",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"hasCommittedMutations\",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"hasPendingWrites\",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return\"Document(\"+this.key+\", \"+this.version+\", \"+JSON.stringify(this.data.toProto())+\", {documentType: \"+this.documentType+\"}), {documentState: \"+this.documentState+\"})\"},t}(),_t=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function St(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new _t(t,e,n,r,i,o,s)}function Nt(t){var e=prebuilt_28889c43_f8ea673b_L(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+=\"|cg:\"+e.collectionGroup),n+=\"|f:\",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+dt(t.value)}(t)})).join(\",\"),n+=\"|ob:\",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(\",\"),it(e.limit)||(n+=\"|l:\",n+=e.limit),e.startAt&&(n+=\"|lb:\",n+=qt(e.startAt)),e.endAt&&(n+=\"|ub:\",n+=qt(e.endAt)),e.h=n}return e.h}function Dt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Bt(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!ct(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Kt(t.startAt,e.startAt)&&Kt(t.endAt,e.endAt)}function At(t){return ut.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var kt=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(tslib_es6.__extends)(e,t),e.create=function(t,n,r){return t.isKeyField()?\"in\"===n||\"not-in\"===n?this.l(t,n,r):new xt(t,n,r):\"array-contains\"===n?new Lt(t,r):\"in\"===n?new Pt(t,r):\"not-in\"===n?new Mt(t,r):\"array-contains-any\"===n?new Ft(t,r):new e(t,n,r)},e.l=function(t,e,n){return\"in\"===e?new Ct(t,n):new Rt(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return\"!=\"===this.op?null!==e&&this.m(ft(e,this.value)):null!==e&&at(this.value)===at(e)&&this.m(ft(e,this.value))},e.prototype.m=function(t){switch(this.op){case\"<\":return t<0;case\"<=\":return t<=0;case\"==\":return 0===t;case\"!=\":return 0!==t;case\">\":return t>0;case\">=\":return t>=0;default:return prebuilt_28889c43_f8ea673b_R()}},e.prototype.g=function(){return[\"<\",\"<=\",\">\",\">=\",\"!=\",\"not-in\"].indexOf(this.op)>=0},e}((function(){})),xt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=ut.fromName(r.referenceValue),i}return Object(tslib_es6.__extends)(e,t),e.prototype.matches=function(t){var e=ut.comparator(t.key,this.key);return this.m(e)},e}(kt),Ct=function(t){function e(e,n){var r=this;return(r=t.call(this,e,\"in\",n)||this).keys=Ot(0,n),r}return Object(tslib_es6.__extends)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(kt),Rt=function(t){function e(e,n){var r=this;return(r=t.call(this,e,\"not-in\",n)||this).keys=Ot(0,n),r}return Object(tslib_es6.__extends)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(kt);function Ot(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return ut.fromName(t.referenceValue)}))}var Lt=function(t){function e(e,n){return t.call(this,e,\"array-contains\",n)||this}return Object(tslib_es6.__extends)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return mt(e)&&ht(e.arrayValue,this.value)},e}(kt),Pt=function(t){function e(e,n){return t.call(this,e,\"in\",n)||this}return Object(tslib_es6.__extends)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&ht(this.value.arrayValue,e)},e}(kt),Mt=function(t){function e(e,n){return t.call(this,e,\"not-in\",n)||this}return Object(tslib_es6.__extends)(e,t),e.prototype.matches=function(t){if(ht(this.value.arrayValue,{nullValue:\"NULL_VALUE\"}))return!1;var e=t.data.field(this.field);return null!==e&&!ht(this.value.arrayValue,e)},e}(kt),Ft=function(t){function e(e,n){return t.call(this,e,\"array-contains-any\",n)||this}return Object(tslib_es6.__extends)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!mt(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ht(e.value.arrayValue,t)}))},e}(kt),Vt=function(t,e){this.position=t,this.before=e};function qt(t){return(t.before?\"b\":\"a\")+\":\"+t.position.map((function(t){return dt(t)})).join(\",\")}var Ut=function(t,e){void 0===e&&(e=\"asc\"),this.field=t,this.dir=e};function Bt(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function jt(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?ut.comparator(ut.fromName(s.referenceValue),n.key):ft(s,n.data.field(o.field)),\"desc\"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Kt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ct(t.position[n],e.position[n]))return!1;return!0}var Gt=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=\"F\"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.p=null,this.T=null};function Qt(t,e,n,r,i,o,s,u){return new Gt(t,e,n,r,i,o,s,u)}function zt(t){return new Gt(t)}function Wt(t){return!it(t.limit)&&\"F\"===t.limitType}function Ht(t){return!it(t.limit)&&\"L\"===t.limitType}function Yt(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Xt(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Jt(t){return null!==t.collectionGroup}function $t(t){var e=prebuilt_28889c43_f8ea673b_L(t);if(null===e.p){e.p=[];var n=Xt(e),r=Yt(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Ut(n)),e.p.push(new Ut(prebuilt_28889c43_f8ea673b_H.keyField(),\"asc\"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var u=s[o];e.p.push(u),u.field.isKeyField()&&(i=!0)}if(!i){var a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:\"asc\";e.p.push(new Ut(prebuilt_28889c43_f8ea673b_H.keyField(),a))}}}return e.p}function Zt(t){var e=prebuilt_28889c43_f8ea673b_L(t);if(!e.T)if(\"F\"===e.limitType)e.T=St(e.path,e.collectionGroup,$t(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=$t(e);r<i.length;r++){var o=i[r];n.push(new Ut(o.field,\"desc\"===o.dir?\"asc\":\"desc\"))}var u=e.endAt?new Vt(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Vt(e.startAt.position,!e.startAt.before):null;e.T=St(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.T}function prebuilt_28889c43_f8ea673b_te(t,e,n){return new Gt(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function prebuilt_28889c43_f8ea673b_ee(t,e){return Dt(Zt(t),Zt(e))&&t.limitType===e.limitType}function prebuilt_28889c43_f8ea673b_ne(t){return Nt(Zt(t))+\"|lt:\"+t.limitType}function prebuilt_28889c43_f8ea673b_re(t){return\"Query(target=\"+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=\" collectionGroup=\"+t.collectionGroup),t.filters.length>0&&(e+=\", filters: [\"+t.filters.map((function(t){return(e=t).field.canonicalString()+\" \"+e.op+\" \"+dt(e.value);var e})).join(\", \")+\"]\"),it(t.limit)||(e+=\", limit: \"+t.limit),t.orderBy.length>0&&(e+=\", orderBy: [\"+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+\" (\"+t.dir+\")\"}(t)})).join(\", \")+\"]\"),t.startAt&&(e+=\", startAt: \"+qt(t.startAt)),t.endAt&&(e+=\", endAt: \"+qt(t.endAt)),\"Target(\"+e+\")\"}(Zt(t))+\"; limitType=\"+t.limitType+\")\"}function prebuilt_28889c43_f8ea673b_ie(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):ut.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!jt(t.startAt,$t(t),e)||t.endAt&&jt(t.endAt,$t(t),e))}(t,e)}function prebuilt_28889c43_f8ea673b_oe(t){return function(e,n){for(var r=!1,i=0,o=$t(t);i<o.length;i++){var s=o[i],u=prebuilt_28889c43_f8ea673b_se(s,e,n);if(0!==u)return u;r=r||s.field.isKeyField()}return 0}}function prebuilt_28889c43_f8ea673b_se(t,e,n){var r=t.field.isKeyField()?ut.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?ft(r,i):prebuilt_28889c43_f8ea673b_R()}(t.field,e,n);switch(t.dir){case\"asc\":return r;case\"desc\":return-1*r;default:return prebuilt_28889c43_f8ea673b_R()}}function prebuilt_28889c43_f8ea673b_ue(t,e){if(t.I){if(isNaN(e))return{doubleValue:\"NaN\"};if(e===1/0)return{doubleValue:\"Infinity\"};if(e===-1/0)return{doubleValue:\"-Infinity\"}}return{doubleValue:ot(e)?\"-0\":e}}function prebuilt_28889c43_f8ea673b_ae(t){return{integerValue:\"\"+t}}function prebuilt_28889c43_f8ea673b_ce(t,e){return st(e)?prebuilt_28889c43_f8ea673b_ae(e):prebuilt_28889c43_f8ea673b_ue(t,e)}var prebuilt_28889c43_f8ea673b_he=function(){this._=void 0};function prebuilt_28889c43_f8ea673b_fe(t,e,n){return t instanceof prebuilt_28889c43_f8ea673b_pe?function(t,e){var n={fields:{__type__:{stringValue:\"server_timestamp\"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof prebuilt_28889c43_f8ea673b_ye?prebuilt_28889c43_f8ea673b_ve(t,e):t instanceof prebuilt_28889c43_f8ea673b_me?prebuilt_28889c43_f8ea673b_ge(t,e):function(t,e){var n=prebuilt_28889c43_f8ea673b_de(t,e),r=prebuilt_28889c43_f8ea673b_be(n)+prebuilt_28889c43_f8ea673b_be(t.A);return vt(n)&&vt(t.A)?prebuilt_28889c43_f8ea673b_ae(r):prebuilt_28889c43_f8ea673b_ue(t.R,r)}(t,e)}function prebuilt_28889c43_f8ea673b_le(t,e,n){return t instanceof prebuilt_28889c43_f8ea673b_ye?prebuilt_28889c43_f8ea673b_ve(t,e):t instanceof prebuilt_28889c43_f8ea673b_me?prebuilt_28889c43_f8ea673b_ge(t,e):n}function prebuilt_28889c43_f8ea673b_de(t,e){return t instanceof prebuilt_28889c43_f8ea673b_we?vt(n=e)||function(t){return!!t&&\"doubleValue\"in t}(n)?e:{integerValue:0}:null;var n}var prebuilt_28889c43_f8ea673b_pe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(tslib_es6.__extends)(e,t),e}(prebuilt_28889c43_f8ea673b_he),prebuilt_28889c43_f8ea673b_ye=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(tslib_es6.__extends)(e,t),e}(prebuilt_28889c43_f8ea673b_he);function prebuilt_28889c43_f8ea673b_ve(t,e){for(var n=prebuilt_28889c43_f8ea673b_Ie(e),r=function(t){n.some((function(e){return ct(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var prebuilt_28889c43_f8ea673b_me=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(tslib_es6.__extends)(e,t),e}(prebuilt_28889c43_f8ea673b_he);function prebuilt_28889c43_f8ea673b_ge(t,e){for(var n=prebuilt_28889c43_f8ea673b_Ie(e),r=function(t){n=n.filter((function(e){return!ct(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var prebuilt_28889c43_f8ea673b_we=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(tslib_es6.__extends)(e,t),e}(prebuilt_28889c43_f8ea673b_he);function prebuilt_28889c43_f8ea673b_be(t){return prebuilt_28889c43_f8ea673b_Z(t.integerValue||t.doubleValue)}function prebuilt_28889c43_f8ea673b_Ie(t){return mt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var prebuilt_28889c43_f8ea673b_Te=function(t,e){this.field=t,this.transform=e},prebuilt_28889c43_f8ea673b_Ee=function(t,e){this.version=t,this.transformResults=e},_e=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,\"isNone\",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function prebuilt_28889c43_f8ea673b_Se(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var prebuilt_28889c43_f8ea673b_Ne=function(){};function prebuilt_28889c43_f8ea673b_De(t,e,n){t instanceof prebuilt_28889c43_f8ea673b_Re?function(t,e,n){var r=t.value.clone(),i=prebuilt_28889c43_f8ea673b_Pe(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof prebuilt_28889c43_f8ea673b_Oe?function(t,e,n){if(prebuilt_28889c43_f8ea673b_Se(t.precondition,e)){var r=prebuilt_28889c43_f8ea673b_Pe(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(prebuilt_28889c43_f8ea673b_Le(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function prebuilt_28889c43_f8ea673b_Ae(t,e,n){t instanceof prebuilt_28889c43_f8ea673b_Re?function(t,e,n){if(prebuilt_28889c43_f8ea673b_Se(t.precondition,e)){var r=t.value.clone(),i=prebuilt_28889c43_f8ea673b_Me(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(prebuilt_28889c43_f8ea673b_Ce(e),r).setHasLocalMutations()}}(t,e,n):t instanceof prebuilt_28889c43_f8ea673b_Oe?function(t,e,n){if(prebuilt_28889c43_f8ea673b_Se(t.precondition,e)){var r=prebuilt_28889c43_f8ea673b_Me(t.fieldTransforms,n,e),i=e.data;i.setAll(prebuilt_28889c43_f8ea673b_Le(t)),i.setAll(r),e.convertToFoundDocument(prebuilt_28889c43_f8ea673b_Ce(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){prebuilt_28889c43_f8ea673b_Se(t.precondition,e)&&e.convertToNoDocument(B.min())}(t,e)}function prebuilt_28889c43_f8ea673b_ke(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),u=prebuilt_28889c43_f8ea673b_de(o.transform,s||null);null!=u&&(null==n&&(n=It.empty()),n.set(o.field,u))}return n||null}function prebuilt_28889c43_f8ea673b_xe(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&prebuilt_28889c43_f8ea673b_V(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof prebuilt_28889c43_f8ea673b_ye&&e instanceof prebuilt_28889c43_f8ea673b_ye||t instanceof prebuilt_28889c43_f8ea673b_me&&e instanceof prebuilt_28889c43_f8ea673b_me?prebuilt_28889c43_f8ea673b_V(t.elements,e.elements,ct):t instanceof prebuilt_28889c43_f8ea673b_we&&e instanceof prebuilt_28889c43_f8ea673b_we?ct(t.A,e.A):t instanceof prebuilt_28889c43_f8ea673b_pe&&e instanceof prebuilt_28889c43_f8ea673b_pe}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function prebuilt_28889c43_f8ea673b_Ce(t){return t.isFoundDocument()?t.version:B.min()}var prebuilt_28889c43_f8ea673b_Re=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(tslib_es6.__extends)(e,t),e}(prebuilt_28889c43_f8ea673b_Ne),prebuilt_28889c43_f8ea673b_Oe=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(tslib_es6.__extends)(e,t),e}(prebuilt_28889c43_f8ea673b_Ne);function prebuilt_28889c43_f8ea673b_Le(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function prebuilt_28889c43_f8ea673b_Pe(t,e,n){var r=new Map;prebuilt_28889c43_f8ea673b_O(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=e.data.field(o.field);r.set(o.field,prebuilt_28889c43_f8ea673b_le(s,u,n[i]))}return r}function prebuilt_28889c43_f8ea673b_Me(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],u=s.transform,a=n.data.field(s.field);r.set(s.field,prebuilt_28889c43_f8ea673b_fe(u,a,e))}return r}var prebuilt_28889c43_f8ea673b_Fe,prebuilt_28889c43_f8ea673b_Ve,prebuilt_28889c43_f8ea673b_qe=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(tslib_es6.__extends)(e,t),e}(prebuilt_28889c43_f8ea673b_Ne),prebuilt_28889c43_f8ea673b_Ue=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(tslib_es6.__extends)(e,t),e}(prebuilt_28889c43_f8ea673b_Ne),prebuilt_28889c43_f8ea673b_Be=function(t){this.count=t};function prebuilt_28889c43_f8ea673b_je(t){switch(t){case _.OK:return prebuilt_28889c43_f8ea673b_R();case _.CANCELLED:case _.UNKNOWN:case _.DEADLINE_EXCEEDED:case _.RESOURCE_EXHAUSTED:case _.INTERNAL:case _.UNAVAILABLE:case _.UNAUTHENTICATED:return!1;case _.INVALID_ARGUMENT:case _.NOT_FOUND:case _.ALREADY_EXISTS:case _.PERMISSION_DENIED:case _.FAILED_PRECONDITION:case _.ABORTED:case _.OUT_OF_RANGE:case _.UNIMPLEMENTED:case _.DATA_LOSS:return!0;default:return prebuilt_28889c43_f8ea673b_R()}}function prebuilt_28889c43_f8ea673b_Ke(t){if(void 0===t)return prebuilt_28889c43_f8ea673b_k(\"GRPC error has no .code\"),_.UNKNOWN;switch(t){case prebuilt_28889c43_f8ea673b_Fe.OK:return _.OK;case prebuilt_28889c43_f8ea673b_Fe.CANCELLED:return _.CANCELLED;case prebuilt_28889c43_f8ea673b_Fe.UNKNOWN:return _.UNKNOWN;case prebuilt_28889c43_f8ea673b_Fe.DEADLINE_EXCEEDED:return _.DEADLINE_EXCEEDED;case prebuilt_28889c43_f8ea673b_Fe.RESOURCE_EXHAUSTED:return _.RESOURCE_EXHAUSTED;case prebuilt_28889c43_f8ea673b_Fe.INTERNAL:return _.INTERNAL;case prebuilt_28889c43_f8ea673b_Fe.UNAVAILABLE:return _.UNAVAILABLE;case prebuilt_28889c43_f8ea673b_Fe.UNAUTHENTICATED:return _.UNAUTHENTICATED;case prebuilt_28889c43_f8ea673b_Fe.INVALID_ARGUMENT:return _.INVALID_ARGUMENT;case prebuilt_28889c43_f8ea673b_Fe.NOT_FOUND:return _.NOT_FOUND;case prebuilt_28889c43_f8ea673b_Fe.ALREADY_EXISTS:return _.ALREADY_EXISTS;case prebuilt_28889c43_f8ea673b_Fe.PERMISSION_DENIED:return _.PERMISSION_DENIED;case prebuilt_28889c43_f8ea673b_Fe.FAILED_PRECONDITION:return _.FAILED_PRECONDITION;case prebuilt_28889c43_f8ea673b_Fe.ABORTED:return _.ABORTED;case prebuilt_28889c43_f8ea673b_Fe.OUT_OF_RANGE:return _.OUT_OF_RANGE;case prebuilt_28889c43_f8ea673b_Fe.UNIMPLEMENTED:return _.UNIMPLEMENTED;case prebuilt_28889c43_f8ea673b_Fe.DATA_LOSS:return _.DATA_LOSS;default:return prebuilt_28889c43_f8ea673b_R()}}(prebuilt_28889c43_f8ea673b_Ve=prebuilt_28889c43_f8ea673b_Fe||(prebuilt_28889c43_f8ea673b_Fe={}))[prebuilt_28889c43_f8ea673b_Ve.OK=0]=\"OK\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.CANCELLED=1]=\"CANCELLED\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.UNKNOWN=2]=\"UNKNOWN\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.INVALID_ARGUMENT=3]=\"INVALID_ARGUMENT\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.DEADLINE_EXCEEDED=4]=\"DEADLINE_EXCEEDED\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.NOT_FOUND=5]=\"NOT_FOUND\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.ALREADY_EXISTS=6]=\"ALREADY_EXISTS\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.PERMISSION_DENIED=7]=\"PERMISSION_DENIED\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.UNAUTHENTICATED=16]=\"UNAUTHENTICATED\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.RESOURCE_EXHAUSTED=8]=\"RESOURCE_EXHAUSTED\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.FAILED_PRECONDITION=9]=\"FAILED_PRECONDITION\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.ABORTED=10]=\"ABORTED\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.OUT_OF_RANGE=11]=\"OUT_OF_RANGE\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.UNIMPLEMENTED=12]=\"UNIMPLEMENTED\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.INTERNAL=13]=\"INTERNAL\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.UNAVAILABLE=14]=\"UNAVAILABLE\",prebuilt_28889c43_f8ea673b_Ve[prebuilt_28889c43_f8ea673b_Ve.DATA_LOSS=15]=\"DATA_LOSS\";var prebuilt_28889c43_f8ea673b_Ge=function(){function t(t,e){this.comparator=t,this.root=e||prebuilt_28889c43_f8ea673b_ze.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,prebuilt_28889c43_f8ea673b_ze.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,prebuilt_28889c43_f8ea673b_ze.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+\":\"+n),!1})),\"{\"+t.join(\", \")+\"}\"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new prebuilt_28889c43_f8ea673b_Qe(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new prebuilt_28889c43_f8ea673b_Qe(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new prebuilt_28889c43_f8ea673b_Qe(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new prebuilt_28889c43_f8ea673b_Qe(this.root,t,this.comparator,!0)},t}(),prebuilt_28889c43_f8ea673b_Qe=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),prebuilt_28889c43_f8ea673b_ze=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw prebuilt_28889c43_f8ea673b_R();if(this.right.isRed())throw prebuilt_28889c43_f8ea673b_R();var t=this.left.check();if(t!==this.right.check())throw prebuilt_28889c43_f8ea673b_R();return t+(this.isRed()?0:1)},t}();prebuilt_28889c43_f8ea673b_ze.EMPTY=null,prebuilt_28889c43_f8ea673b_ze.RED=!0,prebuilt_28889c43_f8ea673b_ze.BLACK=!1,prebuilt_28889c43_f8ea673b_ze.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,\"key\",{get:function(){throw prebuilt_28889c43_f8ea673b_R()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"value\",{get:function(){throw prebuilt_28889c43_f8ea673b_R()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"color\",{get:function(){throw prebuilt_28889c43_f8ea673b_R()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"left\",{get:function(){throw prebuilt_28889c43_f8ea673b_R()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"right\",{get:function(){throw prebuilt_28889c43_f8ea673b_R()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new prebuilt_28889c43_f8ea673b_ze(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var prebuilt_28889c43_f8ea673b_We=function(){function t(t){this.comparator=t,this.data=new prebuilt_28889c43_f8ea673b_Ge(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new prebuilt_28889c43_f8ea673b_He(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new prebuilt_28889c43_f8ea673b_He(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),\"SortedSet(\"+t.toString()+\")\"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),prebuilt_28889c43_f8ea673b_He=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),prebuilt_28889c43_f8ea673b_Ye=new prebuilt_28889c43_f8ea673b_Ge(ut.comparator);function prebuilt_28889c43_f8ea673b_Xe(){return prebuilt_28889c43_f8ea673b_Ye}var prebuilt_28889c43_f8ea673b_Je=new prebuilt_28889c43_f8ea673b_Ge(ut.comparator);function prebuilt_28889c43_f8ea673b_$e(){return prebuilt_28889c43_f8ea673b_Je}var prebuilt_28889c43_f8ea673b_Ze=new prebuilt_28889c43_f8ea673b_Ge(ut.comparator);function prebuilt_28889c43_f8ea673b_tn(){return prebuilt_28889c43_f8ea673b_Ze}var prebuilt_28889c43_f8ea673b_en=new prebuilt_28889c43_f8ea673b_We(ut.comparator);function prebuilt_28889c43_f8ea673b_nn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=prebuilt_28889c43_f8ea673b_en,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var prebuilt_28889c43_f8ea673b_rn=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_F);function prebuilt_28889c43_f8ea673b_on(){return prebuilt_28889c43_f8ea673b_rn}var prebuilt_28889c43_f8ea673b_sn=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,prebuilt_28889c43_f8ea673b_un.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(B.min(),r,prebuilt_28889c43_f8ea673b_on(),prebuilt_28889c43_f8ea673b_Xe(),prebuilt_28889c43_f8ea673b_nn())},t}(),prebuilt_28889c43_f8ea673b_un=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(prebuilt_28889c43_f8ea673b_X.EMPTY_BYTE_STRING,n,prebuilt_28889c43_f8ea673b_nn(),prebuilt_28889c43_f8ea673b_nn(),prebuilt_28889c43_f8ea673b_nn())},t}(),prebuilt_28889c43_f8ea673b_an=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},prebuilt_28889c43_f8ea673b_cn=function(t,e){this.targetId=t,this.V=e},prebuilt_28889c43_f8ea673b_hn=function(t,e,n,r){void 0===n&&(n=prebuilt_28889c43_f8ea673b_X.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},prebuilt_28889c43_f8ea673b_fn=function(){function t(){this.S=0,this.D=prebuilt_28889c43_f8ea673b_pn(),this.C=prebuilt_28889c43_f8ea673b_X.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,\"current\",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"resumeToken\",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"k\",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"O\",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.$=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=prebuilt_28889c43_f8ea673b_nn(),e=prebuilt_28889c43_f8ea673b_nn(),n=prebuilt_28889c43_f8ea673b_nn();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:prebuilt_28889c43_f8ea673b_R()}})),new prebuilt_28889c43_f8ea673b_un(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=prebuilt_28889c43_f8ea673b_pn()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),prebuilt_28889c43_f8ea673b_ln=function(){function t(t){this.W=t,this.G=new Map,this.H=prebuilt_28889c43_f8ea673b_Xe(),this.J=prebuilt_28889c43_f8ea673b_dn(),this.Y=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_F)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.tt(r=o[i],t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.$(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.$(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.$(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.$(t.resumeToken));break;default:prebuilt_28889c43_f8ea673b_R()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(At(i))if(0===n){var o=new ut(i.path);this.tt(e,o,Et.newNoDocument(o,B.min()))}else prebuilt_28889c43_f8ea673b_O(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.at=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&At(o.target)){var s=new ut(o.target.path);null!==e.H.get(s)||e.ut(i,s)||e.tt(i,s,Et.newNoDocument(s,t))}r.O&&(n.set(i,r.M()),r.L())}}));var r=prebuilt_28889c43_f8ea673b_nn();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new prebuilt_28889c43_f8ea673b_sn(t,n,this.Y,this.H,r);return this.H=prebuilt_28889c43_f8ea673b_Xe(),this.J=prebuilt_28889c43_f8ea673b_dn(),this.Y=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_F),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.ut(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.ut(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new prebuilt_28889c43_f8ea673b_fn,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_F),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||prebuilt_28889c43_f8ea673b_A(\"WatchChangeAggregator\",\"Detected inactive target\",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new prebuilt_28889c43_f8ea673b_fn),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.ut=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function prebuilt_28889c43_f8ea673b_dn(){return new prebuilt_28889c43_f8ea673b_Ge(ut.comparator)}function prebuilt_28889c43_f8ea673b_pn(){return new prebuilt_28889c43_f8ea673b_Ge(ut.comparator)}var prebuilt_28889c43_f8ea673b_yn={asc:\"ASCENDING\",desc:\"DESCENDING\"},prebuilt_28889c43_f8ea673b_vn={\"<\":\"LESS_THAN\",\"<=\":\"LESS_THAN_OR_EQUAL\",\">\":\"GREATER_THAN\",\">=\":\"GREATER_THAN_OR_EQUAL\",\"==\":\"EQUAL\",\"!=\":\"NOT_EQUAL\",\"array-contains\":\"ARRAY_CONTAINS\",in:\"IN\",\"not-in\":\"NOT_IN\",\"array-contains-any\":\"ARRAY_CONTAINS_ANY\"},prebuilt_28889c43_f8ea673b_mn=function(t,e){this.databaseId=t,this.I=e};function prebuilt_28889c43_f8ea673b_gn(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\\.\\d*/,\"\").replace(\"Z\",\"\")+\".\"+(\"000000000\"+e.nanoseconds).slice(-9)+\"Z\":{seconds:\"\"+e.seconds,nanos:e.nanoseconds}}function prebuilt_28889c43_f8ea673b_wn(t,e){return t.I?e.toBase64():e.toUint8Array()}function prebuilt_28889c43_f8ea673b_bn(t,e){return prebuilt_28889c43_f8ea673b_gn(t,e.toTimestamp())}function prebuilt_28889c43_f8ea673b_In(t){return prebuilt_28889c43_f8ea673b_O(!!t),B.fromTimestamp(function(t){var e=$(t);return new prebuilt_28889c43_f8ea673b_U(e.seconds,e.nanos)}(t))}function prebuilt_28889c43_f8ea673b_Tn(t,e){return function(t){return new prebuilt_28889c43_f8ea673b_z([\"projects\",t.projectId,\"databases\",t.database])}(t).child(\"documents\").child(e).canonicalString()}function prebuilt_28889c43_f8ea673b_En(t){var e=prebuilt_28889c43_f8ea673b_z.fromString(t);return prebuilt_28889c43_f8ea673b_O(prebuilt_28889c43_f8ea673b_Wn(e)),e}function _n(t,e){return prebuilt_28889c43_f8ea673b_Tn(t.databaseId,e.path)}function prebuilt_28889c43_f8ea673b_Sn(t,e){var n=prebuilt_28889c43_f8ea673b_En(e);if(n.get(1)!==t.databaseId.projectId)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Tried to deserialize key from different project: \"+n.get(1)+\" vs \"+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Tried to deserialize key from different database: \"+n.get(3)+\" vs \"+t.databaseId.database);return new ut(prebuilt_28889c43_f8ea673b_kn(n))}function prebuilt_28889c43_f8ea673b_Nn(t,e){return prebuilt_28889c43_f8ea673b_Tn(t.databaseId,e)}function prebuilt_28889c43_f8ea673b_Dn(t){var e=prebuilt_28889c43_f8ea673b_En(t);return 4===e.length?prebuilt_28889c43_f8ea673b_z.emptyPath():prebuilt_28889c43_f8ea673b_kn(e)}function prebuilt_28889c43_f8ea673b_An(t){return new prebuilt_28889c43_f8ea673b_z([\"projects\",t.databaseId.projectId,\"databases\",t.databaseId.database]).canonicalString()}function prebuilt_28889c43_f8ea673b_kn(t){return prebuilt_28889c43_f8ea673b_O(t.length>4&&\"documents\"===t.get(4)),t.popFirst(5)}function prebuilt_28889c43_f8ea673b_xn(t,e,n){return{name:_n(t,e),fields:n.toProto().mapValue.fields}}function prebuilt_28889c43_f8ea673b_Cn(t,e,n){var r=prebuilt_28889c43_f8ea673b_Sn(t,e.name),i=prebuilt_28889c43_f8ea673b_In(e.updateTime),o=new It({mapValue:{fields:e.fields}}),s=Et.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function prebuilt_28889c43_f8ea673b_Rn(t,e){var n;if(e instanceof prebuilt_28889c43_f8ea673b_Re)n={update:prebuilt_28889c43_f8ea673b_xn(t,e.key,e.value)};else if(e instanceof prebuilt_28889c43_f8ea673b_qe)n={delete:_n(t,e.key)};else if(e instanceof prebuilt_28889c43_f8ea673b_Oe)n={update:prebuilt_28889c43_f8ea673b_xn(t,e.key,e.data),updateMask:prebuilt_28889c43_f8ea673b_zn(e.fieldMask)};else{if(!(e instanceof prebuilt_28889c43_f8ea673b_Ue))return prebuilt_28889c43_f8ea673b_R();n={verify:_n(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof prebuilt_28889c43_f8ea673b_pe)return{fieldPath:e.field.canonicalString(),setToServerValue:\"REQUEST_TIME\"};if(n instanceof prebuilt_28889c43_f8ea673b_ye)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof prebuilt_28889c43_f8ea673b_me)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof prebuilt_28889c43_f8ea673b_we)return{fieldPath:e.field.canonicalString(),increment:n.A};throw prebuilt_28889c43_f8ea673b_R()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:prebuilt_28889c43_f8ea673b_bn(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:prebuilt_28889c43_f8ea673b_R()}(t,e.precondition)),n}function prebuilt_28889c43_f8ea673b_On(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?_e.updateTime(prebuilt_28889c43_f8ea673b_In(t.updateTime)):void 0!==t.exists?_e.exists(t.exists):_e.none()}(e.currentDocument):_e.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;\"setToServerValue\"in e?(prebuilt_28889c43_f8ea673b_O(\"REQUEST_TIME\"===e.setToServerValue),n=new prebuilt_28889c43_f8ea673b_pe):\"appendMissingElements\"in e?n=new prebuilt_28889c43_f8ea673b_ye(e.appendMissingElements.values||[]):\"removeAllFromArray\"in e?n=new prebuilt_28889c43_f8ea673b_me(e.removeAllFromArray.values||[]):\"increment\"in e?n=new prebuilt_28889c43_f8ea673b_we(t,e.increment):prebuilt_28889c43_f8ea673b_R();var o=prebuilt_28889c43_f8ea673b_H.fromServerFormat(e.fieldPath);return new prebuilt_28889c43_f8ea673b_Te(o,n)}(t,e)})):[];if(e.update){var i=prebuilt_28889c43_f8ea673b_Sn(t,e.update.name),o=new It({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new prebuilt_28889c43_f8ea673b_Y((t.fieldPaths||[]).map((function(t){return prebuilt_28889c43_f8ea673b_H.fromServerFormat(t)})))}(e.updateMask);return new prebuilt_28889c43_f8ea673b_Oe(i,o,s,n,r)}return new prebuilt_28889c43_f8ea673b_Re(i,o,n,r)}if(e.delete){var u=prebuilt_28889c43_f8ea673b_Sn(t,e.delete);return new prebuilt_28889c43_f8ea673b_qe(u,n)}if(e.verify){var a=prebuilt_28889c43_f8ea673b_Sn(t,e.verify);return new prebuilt_28889c43_f8ea673b_Ue(a,n)}return prebuilt_28889c43_f8ea673b_R()}function prebuilt_28889c43_f8ea673b_Ln(t,e){return{documents:[prebuilt_28889c43_f8ea673b_Nn(t,e.path)]}}function prebuilt_28889c43_f8ea673b_Pn(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=prebuilt_28889c43_f8ea673b_Nn(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=prebuilt_28889c43_f8ea673b_Nn(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if(\"==\"===t.op){if(wt(t.value))return{unaryFilter:{field:prebuilt_28889c43_f8ea673b_jn(t.field),op:\"IS_NAN\"}};if(gt(t.value))return{unaryFilter:{field:prebuilt_28889c43_f8ea673b_jn(t.field),op:\"IS_NULL\"}}}else if(\"!=\"===t.op){if(wt(t.value))return{unaryFilter:{field:prebuilt_28889c43_f8ea673b_jn(t.field),op:\"IS_NOT_NAN\"}};if(gt(t.value))return{unaryFilter:{field:prebuilt_28889c43_f8ea673b_jn(t.field),op:\"IS_NOT_NULL\"}}}return{fieldFilter:{field:prebuilt_28889c43_f8ea673b_jn(t.field),op:prebuilt_28889c43_f8ea673b_Bn(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:\"AND\",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:prebuilt_28889c43_f8ea673b_jn(t.field),direction:prebuilt_28889c43_f8ea673b_Un(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||it(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=prebuilt_28889c43_f8ea673b_Vn(e.startAt)),e.endAt&&(n.structuredQuery.endAt=prebuilt_28889c43_f8ea673b_Vn(e.endAt)),n}function prebuilt_28889c43_f8ea673b_Mn(t){var e=prebuilt_28889c43_f8ea673b_Dn(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){prebuilt_28889c43_f8ea673b_O(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function prebuilt_28889c43_f8ea673b_Fn(t){return t?void 0!==t.unaryFilter?[prebuilt_28889c43_f8ea673b_Qn(t)]:void 0!==t.fieldFilter?[prebuilt_28889c43_f8ea673b_Gn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return prebuilt_28889c43_f8ea673b_Fn(t)})).reduce((function(t,e){return t.concat(e)})):prebuilt_28889c43_f8ea673b_R():[]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new Ut(prebuilt_28889c43_f8ea673b_Kn(t.field),function(t){switch(t){case\"ASCENDING\":return\"asc\";case\"DESCENDING\":return\"desc\";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return it(e=\"object\"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=prebuilt_28889c43_f8ea673b_qn(n.startAt));var h=null;return n.endAt&&(h=prebuilt_28889c43_f8ea673b_qn(n.endAt)),Qt(e,i,u,s,a,\"F\",c,h)}function prebuilt_28889c43_f8ea673b_Vn(t){return{before:t.before,values:t.position}}function prebuilt_28889c43_f8ea673b_qn(t){return new Vt(t.values||[],!!t.before)}function prebuilt_28889c43_f8ea673b_Un(t){return prebuilt_28889c43_f8ea673b_yn[t]}function prebuilt_28889c43_f8ea673b_Bn(t){return prebuilt_28889c43_f8ea673b_vn[t]}function prebuilt_28889c43_f8ea673b_jn(t){return{fieldPath:t.canonicalString()}}function prebuilt_28889c43_f8ea673b_Kn(t){return prebuilt_28889c43_f8ea673b_H.fromServerFormat(t.fieldPath)}function prebuilt_28889c43_f8ea673b_Gn(t){return kt.create(prebuilt_28889c43_f8ea673b_Kn(t.fieldFilter.field),function(t){switch(t){case\"EQUAL\":return\"==\";case\"NOT_EQUAL\":return\"!=\";case\"GREATER_THAN\":return\">\";case\"GREATER_THAN_OR_EQUAL\":return\">=\";case\"LESS_THAN\":return\"<\";case\"LESS_THAN_OR_EQUAL\":return\"<=\";case\"ARRAY_CONTAINS\":return\"array-contains\";case\"IN\":return\"in\";case\"NOT_IN\":return\"not-in\";case\"ARRAY_CONTAINS_ANY\":return\"array-contains-any\";case\"OPERATOR_UNSPECIFIED\":default:return prebuilt_28889c43_f8ea673b_R()}}(t.fieldFilter.op),t.fieldFilter.value)}function prebuilt_28889c43_f8ea673b_Qn(t){switch(t.unaryFilter.op){case\"IS_NAN\":var e=prebuilt_28889c43_f8ea673b_Kn(t.unaryFilter.field);return kt.create(e,\"==\",{doubleValue:NaN});case\"IS_NULL\":var n=prebuilt_28889c43_f8ea673b_Kn(t.unaryFilter.field);return kt.create(n,\"==\",{nullValue:\"NULL_VALUE\"});case\"IS_NOT_NAN\":var r=prebuilt_28889c43_f8ea673b_Kn(t.unaryFilter.field);return kt.create(r,\"!=\",{doubleValue:NaN});case\"IS_NOT_NULL\":var i=prebuilt_28889c43_f8ea673b_Kn(t.unaryFilter.field);return kt.create(i,\"!=\",{nullValue:\"NULL_VALUE\"});case\"OPERATOR_UNSPECIFIED\":default:return prebuilt_28889c43_f8ea673b_R()}}function prebuilt_28889c43_f8ea673b_zn(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function prebuilt_28889c43_f8ea673b_Wn(t){return t.length>=4&&\"projects\"===t.get(0)&&\"databases\"===t.get(2)}function prebuilt_28889c43_f8ea673b_Hn(t){for(var e=\"\",n=0;n<t.length;n++)e.length>0&&(e=prebuilt_28889c43_f8ea673b_Xn(e)),e=prebuilt_28889c43_f8ea673b_Yn(t.get(n),e);return prebuilt_28889c43_f8ea673b_Xn(e)}function prebuilt_28889c43_f8ea673b_Yn(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case\"\\0\":n+=\"\u0001\u0010\";break;case\"\u0001\":n+=\"\u0001\u0011\";break;default:n+=o}}return n}function prebuilt_28889c43_f8ea673b_Xn(t){return t+\"\u0001\u0001\"}function prebuilt_28889c43_f8ea673b_Jn(t){var e=t.length;if(prebuilt_28889c43_f8ea673b_O(e>=2),2===e)return prebuilt_28889c43_f8ea673b_O(\"\u0001\"===t.charAt(0)&&\"\u0001\"===t.charAt(1)),prebuilt_28889c43_f8ea673b_z.emptyPath();for(var n=e-2,r=[],i=\"\",o=0;o<e;){var s=t.indexOf(\"\u0001\",o);switch((s<0||s>n)&&prebuilt_28889c43_f8ea673b_R(),t.charAt(s+1)){case\"\u0001\":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=\"\"),r.push(a);break;case\"\u0010\":i+=t.substring(o,s),i+=\"\\0\";break;case\"\u0011\":i+=t.substring(o,s+1);break;default:prebuilt_28889c43_f8ea673b_R()}o=s+2}return new prebuilt_28889c43_f8ea673b_z(r)}var prebuilt_28889c43_f8ea673b_$n=function(t,e){this.seconds=t,this.nanoseconds=e},prebuilt_28889c43_f8ea673b_Zn=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};prebuilt_28889c43_f8ea673b_Zn.store=\"owner\",prebuilt_28889c43_f8ea673b_Zn.key=\"owner\";var tr=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};tr.store=\"mutationQueues\",tr.keyPath=\"userId\";var er=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};er.store=\"mutations\",er.keyPath=\"batchId\",er.userMutationsIndex=\"userMutationsIndex\",er.userMutationsKeyPath=[\"userId\",\"batchId\"];var nr=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,prebuilt_28889c43_f8ea673b_Hn(e)]},t.key=function(t,e,n){return[t,prebuilt_28889c43_f8ea673b_Hn(e),n]},t}();nr.store=\"documentMutations\",nr.PLACEHOLDER=new nr;var rr=function(t,e){this.path=t,this.readTime=e},ir=function(t,e){this.path=t,this.version=e},or=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};or.store=\"remoteDocuments\",or.readTimeIndex=\"readTimeIndex\",or.readTimeIndexPath=\"readTime\",or.collectionReadTimeIndex=\"collectionReadTimeIndex\",or.collectionReadTimeIndexPath=[\"parentPath\",\"readTime\"];var sr=function(t){this.byteSize=t};sr.store=\"remoteDocumentGlobal\",sr.key=\"remoteDocumentGlobalKey\";var ur=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};ur.store=\"targets\",ur.keyPath=\"targetId\",ur.queryTargetsIndexName=\"queryTargetsIndex\",ur.queryTargetsKeyPath=[\"canonicalId\",\"targetId\"];var ar=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ar.store=\"targetDocuments\",ar.keyPath=[\"targetId\",\"path\"],ar.documentTargetsIndex=\"documentTargetsIndex\",ar.documentTargetsKeyPath=[\"path\",\"targetId\"];var cr=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};cr.key=\"targetGlobalKey\",cr.store=\"targetGlobal\";var hr=function(t,e){this.collectionId=t,this.parent=e};hr.store=\"collectionParents\",hr.keyPath=[\"collectionId\",\"parent\"];var fr=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};fr.store=\"clientMetadata\",fr.keyPath=\"clientId\";var lr=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};lr.store=\"bundles\",lr.keyPath=\"bundleId\";var dr=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};dr.store=\"namedQueries\",dr.keyPath=\"name\";var pr=Object(tslib_es6.__spreadArray)(Object(tslib_es6.__spreadArray)([],Object(tslib_es6.__spreadArray)(Object(tslib_es6.__spreadArray)([],Object(tslib_es6.__spreadArray)(Object(tslib_es6.__spreadArray)([],Object(tslib_es6.__spreadArray)(Object(tslib_es6.__spreadArray)([],[tr.store,er.store,nr.store,or.store,ur.store,prebuilt_28889c43_f8ea673b_Zn.store,cr.store,ar.store]),[fr.store])),[sr.store])),[hr.store])),[lr.store,dr.store]),yr=\"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.\",vr=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),mr=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},gr=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&prebuilt_28889c43_f8ea673b_R(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),wr=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new mr,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Tr(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Dr(e.target.error);n.ft.reject(new Tr(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Tr(n,e)}},Object.defineProperty(t.prototype,\"dt\",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"Aborting transaction:\",t?t.message:\"Client-initiated abort\"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new _r(e)},t}(),br=function(){function e(n,r,i){this.name=n,this.version=r,this.wt=i,12.2===e._t(Object(util_dist_index_esm.getUA)())&&prebuilt_28889c43_f8ea673b_k(\"Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.\")}return e.delete=function(t){return prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"Removing database:\",t),Sr(window.indexedDB.deleteDatabase(t)).toPromise()},e.yt=function(){if(\"undefined\"==typeof indexedDB)return!1;if(e.gt())return!0;var n=Object(util_dist_index_esm.getUA)(),r=e._t(n),i=0<r&&r<10,o=e.Et(n),s=0<o&&o<4.5;return!(n.indexOf(\"MSIE \")>0||n.indexOf(\"Trident/\")>0||n.indexOf(\"Edge/\")>0||i||s)},e.gt=function(){var t;return\"undefined\"!=typeof process&&\"YES\"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},e.It=function(t,e){return t.store(e)},e._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\\d_]+)/i),n=e?e[1].split(\"_\").slice(0,2).join(\".\"):\"-1\";return Number(n)},e.Et=function(t){var e=t.match(/Android ([\\d.]+)/i),n=e?e[1].split(\".\").slice(0,2).join(\".\"):\"-1\";return Number(n)},e.prototype.At=function(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"Opening database:\",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Tr(t,\"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed.\"))},i.onerror=function(e){var n=e.target.error;r(\"VersionError\"===n.name?new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,\"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.\"):new Tr(t,n))},i.onupgradeneeded=function(t){prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",'Database \"'+n.name+'\" requires upgrade from version:',t.oldVersion),n.wt.Rt(t.target.result,i.transaction,t.oldVersion,n.version).next((function(){prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"Database upgrade to version \"+n.version+\" complete\")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},e.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},e.prototype.runTransaction=function(t,e,n,r){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var i,o,s,u,a;return Object(tslib_es6.__generator)(this,(function(c){switch(c.label){case 0:i=\"readonly\"===e,o=0,s=function(){var e,s,a,c,h;return Object(tslib_es6.__generator)(this,(function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.At(t)];case 2:return u.db=f.sent(),e=wr.open(u.db,t,i?\"readonly\":\"readwrite\",n),s=r(e).catch((function(t){return e.abort(t),gr.reject(t)})).toPromise(),a={},s.catch((function(){})),[4,e.dt];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"Transaction failed with error:\",(c=f.sent()).message,\"Retrying:\",h=\"FirebaseError\"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},u=this,c.label=1;case 1:return[5,s()];case 2:if(\"object\"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),Ir=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,\"isDone\",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"Dt\",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"cursor\",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Sr(this.Pt.delete())},t}(),Tr=function(t){function e(e,n){var r=this;return(r=t.call(this,_.UNAVAILABLE,\"IndexedDB transaction '\"+e+\"' failed: \"+n)||this).name=\"IndexedDbTransactionError\",r}return Object(tslib_es6.__extends)(e,t),e}(prebuilt_28889c43_f8ea673b_S);function Er(t){return\"IndexedDbTransactionError\"===t.name}var _r=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"PUT\",this.store.name,t,e),n=this.store.put(e,t)):(prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"PUT\",this.store.name,\"<auto-key>\",t),n=this.store.put(t)),Sr(n)},t.prototype.add=function(t){return prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"ADD\",this.store.name,t,t),Sr(this.store.add(t))},t.prototype.get=function(t){var e=this;return Sr(this.store.get(t)).next((function(n){return void 0===n&&(n=null),prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"GET\",e.store.name,t,n),n}))},t.prototype.delete=function(t){return prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"DELETE\",this.store.name,t),Sr(this.store.delete(t))},t.prototype.count=function(){return prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"COUNT\",this.store.name),Sr(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){prebuilt_28889c43_f8ea673b_A(\"SimpleDb\",\"DELETE ALL\",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.Ot=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.$t=function(t){var e=this.cursor({});return new gr((function(n,r){e.onerror=function(t){var e=Dr(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new gr((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Ir(i),s=e(i.primaryKey,i.value,o);if(s instanceof gr){var u=s.catch((function(t){return o.done(),gr.reject(t)}));n.push(u)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return gr.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&(\"string\"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e=\"next\";if(t.reverse&&(e=\"prev\"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Sr(t){return new gr((function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Dr(t.target.error);n(e)}}))}var Nr=!1;function Dr(e){var n=br._t(Object(util_dist_index_esm.getUA)());if(n>=12.2&&n<13){var r=\"An internal error was encountered in the Indexed Database server\";if(e.message.indexOf(r)>=0){var i=new prebuilt_28889c43_f8ea673b_S(\"internal\",\"IOS_INDEXEDDB_BUG1: IndexedDb has thrown '\"+r+\"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.\");return Nr||(Nr=!0,setTimeout((function(){throw i}),0)),i}}return e}var Ar=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(tslib_es6.__extends)(e,t),e}(vr);function kr(t,e){var n=prebuilt_28889c43_f8ea673b_L(t);return br.It(n.Mt,e)}var xr=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&prebuilt_28889c43_f8ea673b_De(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&prebuilt_28889c43_f8ea673b_Ae(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&prebuilt_28889c43_f8ea673b_Ae(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(B.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),prebuilt_28889c43_f8ea673b_nn())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&prebuilt_28889c43_f8ea673b_V(this.mutations,t.mutations,(function(t,e){return prebuilt_28889c43_f8ea673b_xe(t,e)}))&&prebuilt_28889c43_f8ea673b_V(this.baseMutations,t.baseMutations,(function(t,e){return prebuilt_28889c43_f8ea673b_xe(t,e)}))},t}(),Cr=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){prebuilt_28889c43_f8ea673b_O(e.mutations.length===r.length);for(var i=prebuilt_28889c43_f8ea673b_tn(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Rr=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=B.min()),void 0===o&&(o=B.min()),void 0===s&&(s=prebuilt_28889c43_f8ea673b_X.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Or=function(t){this.Lt=t};function Lr(t,e){if(e.document)return prebuilt_28889c43_f8ea673b_Cn(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ut.fromSegments(e.noDocument.path),r=qr(e.noDocument.readTime),i=Et.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=ut.fromSegments(e.unknownDocument.path);return r=qr(e.unknownDocument.version),Et.newUnknownDocument(o,r)}return prebuilt_28889c43_f8ea673b_R()}function Pr(t,e,n){var r=Mr(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:_n(t,e.key),fields:e.data.toProto().mapValue.fields,updateTime:prebuilt_28889c43_f8ea673b_gn(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new or(null,null,o,s,r,i)}if(e.isNoDocument()){var u=e.key.path.toArray(),a=Vr(e.version);return s=e.hasCommittedMutations,new or(null,new rr(u,a),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Vr(e.version);return new or(new ir(c,h),null,null,!0,r,i)}return prebuilt_28889c43_f8ea673b_R()}function Mr(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Fr(t){var e=new prebuilt_28889c43_f8ea673b_U(t[0],t[1]);return B.fromTimestamp(e)}function Vr(t){var e=t.toTimestamp();return new prebuilt_28889c43_f8ea673b_$n(e.seconds,e.nanoseconds)}function qr(t){var e=new prebuilt_28889c43_f8ea673b_U(t.seconds,t.nanoseconds);return B.fromTimestamp(e)}function Ur(t,e){for(var n=(e.baseMutations||[]).map((function(e){return prebuilt_28889c43_f8ea673b_On(t.Lt,e)})),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var s=e.mutations.map((function(e){return prebuilt_28889c43_f8ea673b_On(t.Lt,e)})),u=prebuilt_28889c43_f8ea673b_U.fromMillis(e.localWriteTimeMs);return new xr(e.batchId,u,n,s)}function Br(t){var e,n,r=qr(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?qr(t.lastLimboFreeSnapshotVersion):B.min();return void 0!==t.query.documents?(prebuilt_28889c43_f8ea673b_O(1===(n=t.query).documents.length),e=Zt(zt(prebuilt_28889c43_f8ea673b_Dn(n.documents[0])))):e=function(t){return Zt(prebuilt_28889c43_f8ea673b_Mn(t))}(t.query),new Rr(e,t.targetId,0,t.lastListenSequenceNumber,r,i,prebuilt_28889c43_f8ea673b_X.fromBase64String(t.resumeToken))}function jr(t,e){var n,r=Vr(e.snapshotVersion),i=Vr(e.lastLimboFreeSnapshotVersion);n=At(e.target)?prebuilt_28889c43_f8ea673b_Ln(t.Lt,e.target):prebuilt_28889c43_f8ea673b_Pn(t.Lt,e.target);var o=e.resumeToken.toBase64();return new ur(e.targetId,Nt(e.target),r,o,e.sequenceNumber,i,n)}function Kr(t){var e=prebuilt_28889c43_f8ea673b_Mn({parent:t.parent,structuredQuery:t.structuredQuery});return\"LAST\"===t.limitType?prebuilt_28889c43_f8ea673b_te(e,e.limit,\"L\"):e}var Gr=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Qr(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:qr(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Qr(t).put({bundleId:(n=e).id,createTime:Vr(prebuilt_28889c43_f8ea673b_In(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return zr(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Kr(e.bundledQuery),readTime:qr(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return zr(t).put(function(t){return{name:t.name,readTime:Vr(prebuilt_28889c43_f8ea673b_In(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Qr(t){return kr(t,lr.store)}function zr(t){return kr(t,dr.store)}var Wr=function(){function t(){this.Bt=new Hr}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),gr.resolve()},t.prototype.getCollectionParents=function(t,e){return gr.resolve(this.Bt.getEntries(e))},t}(),Hr=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_z.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_z.comparator)).toArray()},t}(),Yr=function(){function t(){this.qt=new Hr}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:prebuilt_28889c43_f8ea673b_Hn(i)};return Xr(t).put(o)}return gr.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,\"\"],[prebuilt_28889c43_f8ea673b_q(e),\"\"],!1,!0);return Xr(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(prebuilt_28889c43_f8ea673b_Jn(o.parent))}return n}))},t}();function Xr(t){return kr(t,hr.store)}var Jr={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$r=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function Zr(t,e,n){var r=t.store(er.store),i=t.store(nr.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Ot({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){prebuilt_28889c43_f8ea673b_O(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],d=nr.key(e,l.key.path,n.batchId);o.push(i.delete(d)),c.push(l.key)}return gr.waitFor(o).next((function(){return c}))}function prebuilt_28889c43_f8ea673b_ti(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw prebuilt_28889c43_f8ea673b_R();e=t.noDocument}return JSON.stringify(e).length}$r.DEFAULT_COLLECTION_PERCENTILE=10,$r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$r.DEFAULT=new $r(41943040,$r.DEFAULT_COLLECTION_PERCENTILE,$r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$r.DISABLED=new $r(-1,0,0);var prebuilt_28889c43_f8ea673b_ei=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return prebuilt_28889c43_f8ea673b_O(\"\"!==e.uid),new t(e.isAuthenticated()?e.uid:\"\",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return prebuilt_28889c43_f8ea673b_ri(t).Ot({index:er.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=prebuilt_28889c43_f8ea673b_ii(t),s=prebuilt_28889c43_f8ea673b_ri(t);return s.add({}).next((function(u){prebuilt_28889c43_f8ea673b_O(\"number\"==typeof u);for(var a=new xr(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return prebuilt_28889c43_f8ea673b_Rn(t.Lt,e)})),i=n.mutations.map((function(e){return prebuilt_28889c43_f8ea673b_Rn(t.Lt,e)}));return new er(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,a),h=[],f=new prebuilt_28889c43_f8ea673b_We((function(t,e){return prebuilt_28889c43_f8ea673b_F(t.canonicalString(),e.canonicalString())})),l=0,d=r;l<d.length;l++){var p=d[l],y=nr.key(i.userId,p.key.path,u);f=f.add(p.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,nr.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Qt[u]=a.keys()})),gr.waitFor(h).next((function(){return a}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return prebuilt_28889c43_f8ea673b_ri(t).get(e).next((function(t){return t?(prebuilt_28889c43_f8ea673b_O(t.userId===n.userId),Ur(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?gr.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return prebuilt_28889c43_f8ea673b_ri(t).Ot({index:er.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(prebuilt_28889c43_f8ea673b_O(e.batchId>=r),o=Ur(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return prebuilt_28889c43_f8ea673b_ri(t).Ot({index:er.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return prebuilt_28889c43_f8ea673b_ri(t).Nt(er.userMutationsIndex,n).next((function(t){return t.map((function(t){return Ur(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=nr.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return prebuilt_28889c43_f8ea673b_ii(t).Ot({range:i},(function(r,i,s){var u=r[0],c=r[2],h=prebuilt_28889c43_f8ea673b_Jn(r[1]);if(u===n.userId&&e.path.isEqual(h))return prebuilt_28889c43_f8ea673b_ri(t).get(c).next((function(t){if(!t)throw prebuilt_28889c43_f8ea673b_R();prebuilt_28889c43_f8ea673b_O(t.userId===n.userId),o.push(Ur(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_F),i=[];return e.forEach((function(e){var o=nr.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=prebuilt_28889c43_f8ea673b_ii(t).Ot({range:s},(function(t,i,o){var s=t[0],a=t[2],c=prebuilt_28889c43_f8ea673b_Jn(t[1]);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(u)})),gr.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=nr.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_F);return prebuilt_28889c43_f8ea673b_ii(t).Ot({range:s},(function(t,e,o){var s=t[0],c=t[2],h=prebuilt_28889c43_f8ea673b_Jn(t[1]);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(u=u.add(c)):o.done()})).next((function(){return n.Wt(t,u)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(prebuilt_28889c43_f8ea673b_ri(t).get(e).next((function(t){if(null===t)throw prebuilt_28889c43_f8ea673b_R();prebuilt_28889c43_f8ea673b_O(t.userId===n.userId),r.push(Ur(n.R,t))})))})),gr.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Zr(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),gr.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return gr.resolve();var r=IDBKeyRange.lowerBound(nr.prefixForUser(e.userId)),i=[];return prebuilt_28889c43_f8ea673b_ii(t).Ot({range:r},(function(t,n,r){if(t[0]===e.userId){var o=prebuilt_28889c43_f8ea673b_Jn(t[1]);i.push(o)}else r.done()})).next((function(){prebuilt_28889c43_f8ea673b_O(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return prebuilt_28889c43_f8ea673b_ni(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return prebuilt_28889c43_f8ea673b_oi(t).get(this.userId).next((function(t){return t||new tr(e.userId,-1,\"\")}))},t}();function prebuilt_28889c43_f8ea673b_ni(t,e,n){var r=nr.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return prebuilt_28889c43_f8ea673b_ii(t).Ot({range:o,kt:!0},(function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()})).next((function(){return s}))}function prebuilt_28889c43_f8ea673b_ri(t){return kr(t,er.store)}function prebuilt_28889c43_f8ea673b_ii(t){return kr(t,nr.store)}function prebuilt_28889c43_f8ea673b_oi(t){return kr(t,tr.store)}var prebuilt_28889c43_f8ea673b_si=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),prebuilt_28889c43_f8ea673b_ui=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new prebuilt_28889c43_f8ea673b_si(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return B.fromTimestamp(new prebuilt_28889c43_f8ea673b_U(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return prebuilt_28889c43_f8ea673b_ai(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return prebuilt_28889c43_f8ea673b_O(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return prebuilt_28889c43_f8ea673b_ai(t).Ot((function(s,u){var a=Br(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.removeTargetData(t,a)))})).next((function(){return gr.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return prebuilt_28889c43_f8ea673b_ai(t).Ot((function(t,n){var r=Br(n);e(r)}))},t.prototype.Xt=function(t){return prebuilt_28889c43_f8ea673b_ci(t).get(cr.key).next((function(t){return prebuilt_28889c43_f8ea673b_O(null!==t),t}))},t.prototype.Zt=function(t,e){return prebuilt_28889c43_f8ea673b_ci(t).put(cr.key,e)},t.prototype.te=function(t,e){return prebuilt_28889c43_f8ea673b_ai(t).put(jr(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=Nt(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return prebuilt_28889c43_f8ea673b_ai(t).Ot({range:r,index:ur.queryTargetsIndexName},(function(t,n,r){var o=Br(n);Dt(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=prebuilt_28889c43_f8ea673b_hi(t);return e.forEach((function(e){var s=prebuilt_28889c43_f8ea673b_Hn(e.path);i.push(o.put(new ar(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),gr.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=prebuilt_28889c43_f8ea673b_hi(t);return gr.forEach(e,(function(e){var o=prebuilt_28889c43_f8ea673b_Hn(e.path);return gr.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=prebuilt_28889c43_f8ea673b_hi(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=prebuilt_28889c43_f8ea673b_hi(t),i=prebuilt_28889c43_f8ea673b_nn();return r.Ot({range:n,kt:!0},(function(t,e,n){var r=prebuilt_28889c43_f8ea673b_Jn(t[1]),o=new ut(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=prebuilt_28889c43_f8ea673b_Hn(e.path),r=IDBKeyRange.bound([n],[prebuilt_28889c43_f8ea673b_q(n)],!1,!0),i=0;return prebuilt_28889c43_f8ea673b_hi(t).Ot({index:ar.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){0!==t[0]&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return prebuilt_28889c43_f8ea673b_ai(t).get(e).next((function(t){return t?Br(t):null}))},t}();function prebuilt_28889c43_f8ea673b_ai(t){return kr(t,ur.store)}function prebuilt_28889c43_f8ea673b_ci(t){return kr(t,cr.store)}function prebuilt_28889c43_f8ea673b_hi(t){return kr(t,ar.store)}function prebuilt_28889c43_f8ea673b_fi(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){if(t.code!==_.FAILED_PRECONDITION||t.message!==yr)throw t;return prebuilt_28889c43_f8ea673b_A(\"LocalStore\",\"Unexpectedly lost primary lease\"),[2]}))}))}function prebuilt_28889c43_f8ea673b_li(t,e){var r=t[1],o=e[1],s=prebuilt_28889c43_f8ea673b_F(t[0],e[0]);return 0===s?prebuilt_28889c43_f8ea673b_F(r,o):s}var prebuilt_28889c43_f8ea673b_di=function(){function t(t){this.ne=t,this.buffer=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_li),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();prebuilt_28889c43_f8ea673b_li(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,\"maxValue\",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),prebuilt_28889c43_f8ea673b_pi=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ae(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,\"started\",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ae=function(t){var e=this,n=this.oe?3e5:6e4;prebuilt_28889c43_f8ea673b_A(\"LruGarbageCollector\",\"Garbage collection scheduled in \"+n+\"ms\"),this.ce=this.asyncQueue.enqueueAfterDelay(\"lru_garbage_collection\",n,(function(){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Er(e=n.sent())?(prebuilt_28889c43_f8ea673b_A(\"LruGarbageCollector\",\"Ignoring IndexedDB error during garbage collection: \",e),[3,6]):[3,4];case 4:return[4,prebuilt_28889c43_f8ea673b_fi(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ae(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),prebuilt_28889c43_f8ea673b_yi=function(){function t(t,e){this.ue=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ue.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return gr.resolve(prebuilt_28889c43_f8ea673b_E.o);var r=new prebuilt_28889c43_f8ea673b_di(e);return this.ue.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ue.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ue.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ue.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(prebuilt_28889c43_f8ea673b_A(\"LruGarbageCollector\",\"Garbage collection skipped; disabled\"),gr.resolve(Jr)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(prebuilt_28889c43_f8ea673b_A(\"LruGarbageCollector\",\"Garbage collection skipped; Cache size \"+r+\" is lower than threshold \"+n.params.cacheSizeCollectionThreshold),Jr):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ue.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,u,a,c=this,f=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(prebuilt_28889c43_f8ea673b_A(\"LruGarbageCollector\",\"Capping sequence numbers to collect down to the maximum of \"+c.params.maximumSequenceNumbersToCollect+\" from \"+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,u=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return a=Date.now(),prebuilt_28889c43_f8ea673b_D()<=logger_dist_index_esm.LogLevel.DEBUG&&prebuilt_28889c43_f8ea673b_A(\"LruGarbageCollector\",\"LRU Garbage Collection\\n\\tCounted targets in \"+(o-f)+\"ms\\n\\tDetermined least recently used \"+r+\" in \"+(s-o)+\"ms\\n\\tRemoved \"+i+\" targets in \"+(u-s)+\"ms\\n\\tRemoved \"+t+\" documents in \"+(a-u)+\"ms\\nTotal Duration: \"+(a-f)+\"ms\"),gr.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),prebuilt_28889c43_f8ea673b_vi=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new prebuilt_28889c43_f8ea673b_yi(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return prebuilt_28889c43_f8ea673b_mi(t,n)},t.prototype.removeReference=function(t,e,n){return prebuilt_28889c43_f8ea673b_mi(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return prebuilt_28889c43_f8ea673b_mi(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return prebuilt_28889c43_f8ea673b_oi(t).$t((function(r){return prebuilt_28889c43_f8ea673b_ni(t,r,e).next((function(t){return t&&(n=!0),gr.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,u){if(u<=e){var a=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),prebuilt_28889c43_f8ea673b_hi(t).delete([0,prebuilt_28889c43_f8ea673b_Hn(s.path)])}))}));i.push(a)}})).next((function(){return gr.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return prebuilt_28889c43_f8ea673b_mi(t,e)},t.prototype.we=function(t,e){var n,r=prebuilt_28889c43_f8ea673b_hi(t),i=prebuilt_28889c43_f8ea673b_E.o;return r.Ot({index:ar.documentTargetsIndex},(function(t,r){var s=r.path,u=r.sequenceNumber;0===t[0]?(i!==prebuilt_28889c43_f8ea673b_E.o&&e(new ut(prebuilt_28889c43_f8ea673b_Jn(n)),i),i=u,n=s):i=prebuilt_28889c43_f8ea673b_E.o})).next((function(){i!==prebuilt_28889c43_f8ea673b_E.o&&e(new ut(prebuilt_28889c43_f8ea673b_Jn(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function prebuilt_28889c43_f8ea673b_mi(t,e){return prebuilt_28889c43_f8ea673b_hi(t).put(function(t,e){return new ar(0,prebuilt_28889c43_f8ea673b_Hn(t.path),e)}(e,t.currentSequenceNumber))}var prebuilt_28889c43_f8ea673b_gi=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[1];if(this.equalsFn(o[0],t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){prebuilt_28889c43_f8ea673b_K(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}}))},t.prototype.isEmpty=function(){return prebuilt_28889c43_f8ea673b_G(this.inner)},t}(),prebuilt_28889c43_f8ea673b_wi=function(){function t(){this.changes=new prebuilt_28889c43_f8ea673b_gi((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:B.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Et.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?gr.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),prebuilt_28889c43_f8ea673b_bi=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return prebuilt_28889c43_f8ea673b_Ei(t).put(prebuilt_28889c43_f8ea673b_i(e),n)},t.prototype.removeEntry=function(t,e){var n=prebuilt_28889c43_f8ea673b_Ei(t),r=prebuilt_28889c43_f8ea673b_i(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return prebuilt_28889c43_f8ea673b_Ei(t).get(prebuilt_28889c43_f8ea673b_i(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return prebuilt_28889c43_f8ea673b_Ei(t).get(prebuilt_28889c43_f8ea673b_i(e)).next((function(t){return{document:n.ye(e,t),size:prebuilt_28889c43_f8ea673b_ti(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=prebuilt_28889c43_f8ea673b_Xe();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=prebuilt_28889c43_f8ea673b_Xe(),i=new prebuilt_28889c43_f8ea673b_Ge(ut.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,prebuilt_28889c43_f8ea673b_ti(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return gr.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return prebuilt_28889c43_f8ea673b_Ei(t).Ot({range:r},(function(t,e,r){for(var s=ut.fromSegments(t);o&&ut.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=prebuilt_28889c43_f8ea673b_Xe(),o=e.path.length+1,s={};if(n.isEqual(B.min())){var u=e.path.toArray();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.toArray(),c=Mr(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=or.collectionReadTimeIndex}return prebuilt_28889c43_f8ea673b_Ei(t).Ot(s,(function(t,n,s){if(t.length===o){var u=Lr(r.R,n);e.path.isPrefixOf(u.key.path)?prebuilt_28889c43_f8ea673b_ie(e,u)&&(i=i.insert(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new prebuilt_28889c43_f8ea673b_Ii(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return prebuilt_28889c43_f8ea673b_Ti(t).get(sr.key).next((function(t){return prebuilt_28889c43_f8ea673b_O(!!t),t}))},t.prototype.me=function(t,e){return prebuilt_28889c43_f8ea673b_Ti(t).put(sr.key,e)},t.prototype.ye=function(t,e){if(e){var n=Lr(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(B.min()))return n}return Et.newInvalidDocument(t)},t}(),prebuilt_28889c43_f8ea673b_Ii=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new prebuilt_28889c43_f8ea673b_gi((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Object(tslib_es6.__extends)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new prebuilt_28889c43_f8ea673b_We((function(t,e){return prebuilt_28889c43_f8ea673b_F(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var u=e.Ae.get(o);if(s.document.isValidDocument()){var a=Pr(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=prebuilt_28889c43_f8ea673b_ti(a);r+=c-u,n.push(e.Ie.addEntry(t,o,a))}else if(r-=u,e.trackRemovals){var h=Pr(e.Ie.R,Et.newNoDocument(o,B.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),gr.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(prebuilt_28889c43_f8ea673b_wi);function prebuilt_28889c43_f8ea673b_Ti(t){return kr(t,sr.store)}function prebuilt_28889c43_f8ea673b_Ei(t){return kr(t,or.store)}function prebuilt_28889c43_f8ea673b_i(t){return t.path.toArray()}var prebuilt_28889c43_f8ea673b_Si=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;prebuilt_28889c43_f8ea673b_O(n<r&&n>=0&&r<=11);var o=new wr(\"createOrUpgrade\",e);n<1&&r>=1&&(function(t){t.createObjectStore(prebuilt_28889c43_f8ea673b_Zn.store)}(t),function(t){t.createObjectStore(tr.store,{keyPath:tr.keyPath}),t.createObjectStore(er.store,{keyPath:er.keyPath,autoIncrement:!0}).createIndex(er.userMutationsIndex,er.userMutationsKeyPath,{unique:!0}),t.createObjectStore(nr.store)}(t),prebuilt_28889c43_f8ea673b_Ni(t),function(t){t.createObjectStore(or.store)}(t));var s=gr.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ar.store),t.deleteObjectStore(ur.store),t.deleteObjectStore(cr.store)}(t),prebuilt_28889c43_f8ea673b_Ni(t)),s=s.next((function(){return function(t){var e=t.store(cr.store),n=new cr(0,0,B.min().toTimestamp(),0);return e.put(cr.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(er.store).Nt().next((function(n){t.deleteObjectStore(er.store),t.createObjectStore(er.store,{keyPath:er.keyPath,autoIncrement:!0}).createIndex(er.userMutationsIndex,er.userMutationsKeyPath,{unique:!0});var r=e.store(er.store),i=n.map((function(t){return r.put(t)}));return gr.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(fr.store,{keyPath:fr.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(sr.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains(\"remoteDocumentChanges\")&&t.deleteObjectStore(\"remoteDocumentChanges\")}(t),function(t){var e=t.objectStore(or.store);e.createIndex(or.readTimeIndex,or.readTimeIndexPath,{unique:!1}),e.createIndex(or.collectionReadTimeIndex,or.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(lr.store,{keyPath:lr.keyPath})}(t),function(t){t.createObjectStore(dr.store,{keyPath:dr.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(or.store).Ot((function(t,n){e+=prebuilt_28889c43_f8ea673b_ti(n)})).next((function(){var n=new sr(e);return t.store(sr.store).put(sr.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(tr.store),r=t.store(er.store);return n.Nt().next((function(n){return gr.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(er.userMutationsIndex,i).next((function(r){return gr.forEach(r,(function(r){prebuilt_28889c43_f8ea673b_O(r.userId===n.userId);var i=Ur(e.R,r);return Zr(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(ar.store),n=t.store(or.store);return t.store(cr.store).get(cr.key).next((function(t){var r=[];return n.Ot((function(n,i){var o=new prebuilt_28889c43_f8ea673b_z(n),s=function(t){return[0,prebuilt_28889c43_f8ea673b_Hn(t)]}(o);r.push(e.get(s).next((function(n){return n?gr.resolve():function(n){return e.put(new ar(0,prebuilt_28889c43_f8ea673b_Hn(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return gr.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(hr.store,{keyPath:hr.keyPath});var n=e.store(hr.store),r=new Hr,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:prebuilt_28889c43_f8ea673b_Hn(i)})}};return e.store(or.store).Ot({kt:!0},(function(t,e){var n=new prebuilt_28889c43_f8ea673b_z(t);return i(n.popLast())})).next((function(){return e.store(nr.store).Ot({kt:!0},(function(t,e){var r=prebuilt_28889c43_f8ea673b_Jn(t[1]);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(ur.store);return n.Ot((function(t,r){var i=Br(r),o=jr(e.R,i);return n.put(o)}))},t}();function prebuilt_28889c43_f8ea673b_Ni(t){t.createObjectStore(ar.store,{keyPath:ar.keyPath}).createIndex(ar.documentTargetsIndex,ar.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ur.store,{keyPath:ur.keyPath}).createIndex(ur.queryTargetsIndexName,ur.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(cr.store)}var prebuilt_28889c43_f8ea673b_Di=\"Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.\",prebuilt_28889c43_f8ea673b_Ai=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=u,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.Oe=null,this.$e=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new prebuilt_28889c43_f8ea673b_S(_.UNIMPLEMENTED,\"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.\");this.referenceDelegate=new prebuilt_28889c43_f8ea673b_vi(this,i),this.Le=n+\"main\",this.R=new Or(a),this.Be=new br(this.Le,11,new prebuilt_28889c43_f8ea673b_Si(this.R)),this.qe=new prebuilt_28889c43_f8ea673b_ui(this.referenceDelegate,this.R),this.Ut=new Yr,this.Ue=function(t,e){return new prebuilt_28889c43_f8ea673b_bi(t,e)}(this.R,this.Ut),this.Qe=new Gr,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===h&&prebuilt_28889c43_f8ea673b_k(\"IndexedDbPersistence\",\"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page.\"))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,prebuilt_28889c43_f8ea673b_Di);return t.We(),t.Ge(),t.ze(),t.runTransaction(\"getHighestListenSequenceNumber\",\"readonly\",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new prebuilt_28889c43_f8ea673b_E(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction(\"updateClientMetadataAndTryBecomePrimary\",\"readwrite\",(function(e){return prebuilt_28889c43_f8ea673b_xi(e).put(new fr(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(Er(e))return prebuilt_28889c43_f8ea673b_A(\"IndexedDbPersistence\",\"Failed to extend owner lease: \",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return prebuilt_28889c43_f8ea673b_A(\"IndexedDbPersistence\",\"Releasing owner lease after error during lease refresh\",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return prebuilt_28889c43_f8ea673b_ki(t).get(prebuilt_28889c43_f8ea673b_Zn.key).next((function(t){return gr.resolve(e.tn(t))}))},t.prototype.en=function(t){return prebuilt_28889c43_f8ea673b_xi(t).delete(this.clientId)},t.prototype.nn=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var t,e,n,i=this;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.$e,18e5)?[3,2]:(this.$e=Date.now(),[4,this.runTransaction(\"maybeGarbageCollectMultiClientState\",\"readwrite-primary\",(function(t){var e=kr(t,fr.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return gr.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)this.Ke.removeItem(this.on(n[e].clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.Oe=this.Se.enqueueAfterDelay(\"client_metadata_refresh\",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?gr.resolve(!0):prebuilt_28889c43_f8ea673b_ki(t).get(prebuilt_28889c43_f8ea673b_Zn.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,prebuilt_28889c43_f8ea673b_Di);return!1}}return!(!e.networkEnabled||!e.inForeground)||prebuilt_28889c43_f8ea673b_xi(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))}))}))})).next((function(t){return e.isPrimary!==t&&prebuilt_28889c43_f8ea673b_A(\"IndexedDbPersistence\",\"Client \"+(t?\"is\":\"is not\")+\" eligible for a primary lease.\"),t}))},t.prototype.shutdown=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.an(),this.Oe&&(this.Oe.cancel(),this.Oe=null),this.un(),this.hn(),[4,this.Be.runTransaction(\"shutdown\",\"readwrite\",[prebuilt_28889c43_f8ea673b_Zn.store,fr.store],(function(e){var n=new Ar(e,prebuilt_28889c43_f8ea673b_E.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction(\"getActiveClients\",\"readonly\",(function(e){return prebuilt_28889c43_f8ea673b_xi(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,\"started\",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return prebuilt_28889c43_f8ea673b_ei.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var i,r=this;return prebuilt_28889c43_f8ea673b_A(\"IndexedDbPersistence\",\"Starting transaction:\",t),this.Be.runTransaction(t,\"readonly\"===e?\"readonly\":\"readwrite\",pr,(function(o){return i=new Ar(o,r.Ne?r.Ne.next():prebuilt_28889c43_f8ea673b_E.o),\"readwrite-primary\"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw prebuilt_28889c43_f8ea673b_k(\"Failed to obtain primary lease for action '\"+t+\"'.\"),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,yr);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return prebuilt_28889c43_f8ea673b_ki(t).get(prebuilt_28889c43_f8ea673b_Zn.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,prebuilt_28889c43_f8ea673b_Di)}))},t.prototype.Ze=function(t){var e=new prebuilt_28889c43_f8ea673b_Zn(this.clientId,this.allowTabSynchronization,Date.now());return prebuilt_28889c43_f8ea673b_ki(t).put(prebuilt_28889c43_f8ea673b_Zn.key,e)},t.yt=function(){return br.yt()},t.prototype.Xe=function(t){var e=this,n=prebuilt_28889c43_f8ea673b_ki(t);return n.get(prebuilt_28889c43_f8ea673b_Zn.key).next((function(t){return e.tn(t)?(prebuilt_28889c43_f8ea673b_A(\"IndexedDbPersistence\",\"Releasing primary lease.\"),n.delete(prebuilt_28889c43_f8ea673b_Zn.key)):gr.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(prebuilt_28889c43_f8ea673b_k(\"Detected an update time that is in the future: \"+t+\" > \"+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&\"function\"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground=\"visible\"===t.document.visibilityState,t.je()}))},this.document.addEventListener(\"visibilitychange\",this.ke),this.inForeground=\"visible\"===this.document.visibilityState)},t.prototype.un=function(){this.ke&&(this.document.removeEventListener(\"visibilitychange\",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;\"function\"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.an(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener(\"pagehide\",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener(\"pagehide\",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return prebuilt_28889c43_f8ea673b_A(\"IndexedDbPersistence\",\"Client '\"+t+\"' \"+(n?\"is\":\"is not\")+\" zombied in LocalStorage\"),n}catch(t){return prebuilt_28889c43_f8ea673b_k(\"IndexedDbPersistence\",\"Failed to get zombied client id.\",t),!1}},t.prototype.an=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){prebuilt_28889c43_f8ea673b_k(\"Failed to set zombie client id.\",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return\"firestore_zombie_\"+this.persistenceKey+\"_\"+t},t}();function prebuilt_28889c43_f8ea673b_ki(t){return kr(t,prebuilt_28889c43_f8ea673b_Zn.store)}function prebuilt_28889c43_f8ea673b_xi(t){return kr(t,fr.store)}function prebuilt_28889c43_f8ea673b_Ci(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+=\".\"+t.database),\"firestore/\"+e+\"/\"+n+\"/\"}var prebuilt_28889c43_f8ea673b_Ri=function(t,e){this.progress=t,this.wn=e},prebuilt_28889c43_f8ea673b_Oi=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return ut.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Jt(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new ut(e)).next((function(t){var e=prebuilt_28889c43_f8ea673b_$e();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=prebuilt_28889c43_f8ea673b_$e();return this.Ut.getCollectionParents(t,i).next((function(s){return gr.forEach(s,(function(s){var u=function(t,e){return new Gt(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,u,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return o.Rn(t,i=e,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c);null==h&&(h=Et.newInvalidDocument(c),r=r.insert(c,h)),prebuilt_28889c43_f8ea673b_Ae(a,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){prebuilt_28889c43_f8ea673b_ie(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=prebuilt_28889c43_f8ea673b_nn(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof prebuilt_28889c43_f8ea673b_Oe&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),prebuilt_28889c43_f8ea673b_Li=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=prebuilt_28889c43_f8ea673b_nn(),i=prebuilt_28889c43_f8ea673b_nn(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),prebuilt_28889c43_f8ea673b_Pi=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(B.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(Wt(e)||Ht(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(prebuilt_28889c43_f8ea673b_D()<=logger_dist_index_esm.LogLevel.DEBUG&&prebuilt_28889c43_f8ea673b_A(\"QueryEngine\",\"Re-using previous result from %s to execute query: %s\",n.toString(),prebuilt_28889c43_f8ea673b_re(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_oe(t));return e.forEach((function(e,r){prebuilt_28889c43_f8ea673b_ie(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i=\"F\"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return prebuilt_28889c43_f8ea673b_D()<=logger_dist_index_esm.LogLevel.DEBUG&&prebuilt_28889c43_f8ea673b_A(\"QueryEngine\",\"Using full collection scan to execute query:\",prebuilt_28889c43_f8ea673b_re(e)),this.Sn.getDocumentsMatchingQuery(t,e,B.min())},t}(),prebuilt_28889c43_f8ea673b_Mi=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new prebuilt_28889c43_f8ea673b_Ge(prebuilt_28889c43_f8ea673b_F),this.kn=new prebuilt_28889c43_f8ea673b_gi((function(t){return Nt(t)}),Dt),this.On=B.min(),this._n=t.getMutationQueue(n),this.$n=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new prebuilt_28889c43_f8ea673b_Oi(this.$n,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction(\"Collect garbage\",\"readwrite-primary\",(function(n){return t.collect(n,e.Fn)}))},t}();function prebuilt_28889c43_f8ea673b_Fi(t,e,n,r){return new prebuilt_28889c43_f8ea673b_Mi(t,e,n,r)}function prebuilt_28889c43_f8ea673b_Vi(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return Object(tslib_es6.__generator)(this,(function(s){switch(s.label){case 0:return n=prebuilt_28889c43_f8ea673b_L(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction(\"Handle user change\",\"readonly\",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new prebuilt_28889c43_f8ea673b_Oi(n.$n,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=prebuilt_28889c43_f8ea673b_nn(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var d=0,p=e;d<p.length;d++){var y=p[d];r.push(y.batchId);for(var v=0,m=y.mutations;v<m.length;v++)s=s.add(m[v].key)}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function prebuilt_28889c43_f8ea673b_qi(t,e){var n=prebuilt_28889c43_f8ea673b_L(t);return n.persistence.runTransaction(\"Acknowledge batch\",\"readwrite-primary\",(function(t){var r=e.batch.keys(),i=n.$n.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=gr.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);prebuilt_28889c43_f8ea673b_O(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function prebuilt_28889c43_f8ea673b_Ui(t){var e=prebuilt_28889c43_f8ea673b_L(t);return e.persistence.runTransaction(\"Get last remote snapshot version\",\"readonly\",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function prebuilt_28889c43_f8ea673b_Bi(t,e){var n=prebuilt_28889c43_f8ea673b_L(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction(\"Apply remote event\",\"readwrite-primary\",(function(t){var o=n.$n.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach((function(e,o){var u=i.get(o);if(u){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var a=e.resumeToken;if(a.approximateByteSize()>0){var c=u.withResumeToken(a,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return prebuilt_28889c43_f8ea673b_O(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(u,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var u=prebuilt_28889c43_f8ea673b_Xe();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(prebuilt_28889c43_f8ea673b_ji(t,o,e.documentUpdates,r,void 0).next((function(t){u=t}))),!r.isEqual(B.min())){var a=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(a)}return gr.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,u)})).next((function(){return u}))})).then((function(t){return n.Fn=i,t}))}function prebuilt_28889c43_f8ea673b_ji(t,e,n,r,i){var o=prebuilt_28889c43_f8ea673b_nn();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=prebuilt_28889c43_f8ea673b_Xe();return n.forEach((function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(B.min())?(e.removeEntry(n,a),o=o.insert(n,s)):!u.isValidDocument()||s.version.compareTo(u.version)>0||0===s.version.compareTo(u.version)&&u.hasPendingWrites?(e.addEntry(s,a),o=o.insert(n,s)):prebuilt_28889c43_f8ea673b_A(\"LocalStore\",\"Ignoring outdated watch update for \",n,\". Current version:\",u.version,\" Watch version:\",s.version)})),o}))}function prebuilt_28889c43_f8ea673b_Ki(t,e){var n=prebuilt_28889c43_f8ea673b_L(t);return n.persistence.runTransaction(\"Get next mutation batch\",\"readonly\",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function prebuilt_28889c43_f8ea673b_Gi(t,e){var n=prebuilt_28889c43_f8ea673b_L(t);return n.persistence.runTransaction(\"Allocate target\",\"readwrite\",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?gr.resolve(r=i):n.qe.allocateTargetId(t).next((function(i){return r=new Rr(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function prebuilt_28889c43_f8ea673b_Qi(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i,o,s;return Object(tslib_es6.__generator)(this,(function(u){switch(u.label){case 0:r=prebuilt_28889c43_f8ea673b_L(t),i=r.Fn.get(e),o=n?\"readwrite\":\"readwrite-primary\",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction(\"Release target\",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!Er(s=u.sent()))throw s;return prebuilt_28889c43_f8ea673b_A(\"LocalStore\",\"Failed to update sequence numbers for target \"+e+\": \"+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function prebuilt_28889c43_f8ea673b_zi(t,e,n){var r=prebuilt_28889c43_f8ea673b_L(t),i=B.min(),o=prebuilt_28889c43_f8ea673b_nn();return r.persistence.runTransaction(\"Execute query\",\"readonly\",(function(t){return function(t,e,n){var r=prebuilt_28889c43_f8ea673b_L(t),i=r.kn.get(n);return void 0!==i?gr.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,Zt(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:B.min(),n?o:prebuilt_28889c43_f8ea673b_nn())})).next((function(t){return{documents:t,Bn:o}}))}))}function prebuilt_28889c43_f8ea673b_Wi(t,e){var n=prebuilt_28889c43_f8ea673b_L(t),r=prebuilt_28889c43_f8ea673b_L(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction(\"Get target data\",\"readonly\",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function prebuilt_28889c43_f8ea673b_Hi(t){var e=prebuilt_28889c43_f8ea673b_L(t);return e.persistence.runTransaction(\"Get new document changes\",\"readonly\",(function(t){return function(t,e,n){var r=prebuilt_28889c43_f8ea673b_L(t),i=prebuilt_28889c43_f8ea673b_Xe(),o=Mr(n),s=prebuilt_28889c43_f8ea673b_Ei(e),u=IDBKeyRange.lowerBound(o,!0);return s.Ot({index:or.readTimeIndex,range:u},(function(t,e){var n=Lr(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Fr(o)}}))}(e.$n,t,e.On)})).then((function(t){var n=t.wn;return e.On=t.readTime,n}))}function prebuilt_28889c43_f8ea673b_Yi(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){return[2,(e=prebuilt_28889c43_f8ea673b_L(t)).persistence.runTransaction(\"Synchronize last document change read time\",\"readonly\",(function(t){return function(t){var e=prebuilt_28889c43_f8ea673b_Ei(t),n=B.min();return e.Ot({index:or.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Fr(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.On=t}))]}))}))}function prebuilt_28889c43_f8ea673b_Xi(t,e,n,r){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var i,o,s,u,a,c,h,f,l,d;return Object(tslib_es6.__generator)(this,(function(p){switch(p.label){case 0:for(i=prebuilt_28889c43_f8ea673b_L(t),o=prebuilt_28889c43_f8ea673b_nn(),s=prebuilt_28889c43_f8ea673b_Xe(),u=prebuilt_28889c43_f8ea673b_tn(),a=0,c=n;a<c.length;a++)f=e.qn((h=c[a]).metadata.name),h.document&&(o=o.add(f)),s=s.insert(f,e.Un(h)),u=u.insert(f,e.Qn(h.metadata.readTime));return l=i.$n.newChangeBuffer({trackRemovals:!0}),[4,prebuilt_28889c43_f8ea673b_Gi(i,function(t){return Zt(zt(prebuilt_28889c43_f8ea673b_z.fromString(\"__bundle__/docs/\"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction(\"Apply bundle documents\",\"readwrite\",(function(t){return prebuilt_28889c43_f8ea673b_ji(t,l,s,B.min(),u).next((function(e){return l.apply(t),e})).next((function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next((function(){return i.qe.addMatchingKeys(t,o,d.targetId)})).next((function(){return i.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function prebuilt_28889c43_f8ea673b_Ji(t,e,n){return void 0===n&&(n=prebuilt_28889c43_f8ea673b_nn()),Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return[4,prebuilt_28889c43_f8ea673b_Gi(t,Zt(Kr(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=prebuilt_28889c43_f8ea673b_L(t)).persistence.runTransaction(\"Save named query\",\"readwrite\",(function(t){var o=prebuilt_28889c43_f8ea673b_In(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(t,e);var s=r.withResumeToken(prebuilt_28889c43_f8ea673b_X.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next((function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.Qe.saveNamedQuery(t,e)}))}))]}}))}))}var prebuilt_28889c43_f8ea673b_$i=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return gr.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:prebuilt_28889c43_f8ea673b_In(n.createTime)}),gr.resolve()},t.prototype.getNamedQuery=function(t,e){return gr.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Kr(t.bundledQuery),readTime:prebuilt_28889c43_f8ea673b_In(t.readTime)}}(e)),gr.resolve()},t}(),prebuilt_28889c43_f8ea673b_Zi=function(){function t(){this.Wn=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_to.Gn),this.zn=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_to.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new prebuilt_28889c43_f8ea673b_to(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new prebuilt_28889c43_f8ea673b_to(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new ut(new prebuilt_28889c43_f8ea673b_z([])),r=new prebuilt_28889c43_f8ea673b_to(n,t),i=new prebuilt_28889c43_f8ea673b_to(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new ut(new prebuilt_28889c43_f8ea673b_z([])),n=new prebuilt_28889c43_f8ea673b_to(e,t),r=new prebuilt_28889c43_f8ea673b_to(e,t+1),i=prebuilt_28889c43_f8ea673b_nn();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new prebuilt_28889c43_f8ea673b_to(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),prebuilt_28889c43_f8ea673b_to=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return ut.comparator(t.key,e.key)||prebuilt_28889c43_f8ea673b_F(t.ns,e.ns)},t.Hn=function(t,e){return prebuilt_28889c43_f8ea673b_F(t.ns,e.ns)||ut.comparator(t.key,e.key)},t}(),prebuilt_28889c43_f8ea673b_eo=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_to.Gn)}return t.prototype.checkEmpty=function(t){return gr.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++;var o=new xr(i,e,n,r);this._n.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.rs=this.rs.add(new prebuilt_28889c43_f8ea673b_to(a.key,i)),this.Ut.addToCollectionParentIndex(t,a.key.path.popLast())}return gr.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return gr.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var r=this.cs(e+1),i=r<0?0:r;return gr.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return gr.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return gr.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new prebuilt_28889c43_f8ea673b_to(e,0),i=new prebuilt_28889c43_f8ea673b_to(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),gr.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_F);return e.forEach((function(t){var e=new prebuilt_28889c43_f8ea673b_to(t,0),i=new prebuilt_28889c43_f8ea673b_to(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),gr.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;ut.isDocumentKey(i)||(i=i.child(\"\"));var o=new prebuilt_28889c43_f8ea673b_to(new ut(i),0),s=new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_F);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),gr.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;prebuilt_28889c43_f8ea673b_O(0===this.hs(e.batchId,\"removed\")),this._n.shift();var r=this.rs;return gr.forEach(e.mutations,(function(i){var o=new prebuilt_28889c43_f8ea673b_to(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new prebuilt_28889c43_f8ea673b_to(e,0),r=this.rs.firstAfterOrEqual(n);return gr.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return gr.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),prebuilt_28889c43_f8ea673b_no=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new prebuilt_28889c43_f8ea673b_Ge(ut.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return gr.resolve(n?n.document.clone():Et.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=prebuilt_28889c43_f8ea673b_Xe();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Et.newInvalidDocument(t))})),gr.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=prebuilt_28889c43_f8ea673b_Xe(),i=new ut(e.path.child(\"\")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.value,c=a.document,h=a.readTime;if(!e.path.isPrefixOf(s.key.path))break;h.compareTo(n)<=0||prebuilt_28889c43_f8ea673b_ie(e,c)&&(r=r.insert(c.key,c.clone()))}return gr.resolve(r)},t.prototype.fs=function(t,e){return gr.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new prebuilt_28889c43_f8ea673b_ro(this)},t.prototype.getSize=function(t){return gr.resolve(this.size)},t}(),prebuilt_28889c43_f8ea673b_ro=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(tslib_es6.__extends)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),gr.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(prebuilt_28889c43_f8ea673b_wi),prebuilt_28889c43_f8ea673b_io=function(){function t(t){this.persistence=t,this.ds=new prebuilt_28889c43_f8ea673b_gi((function(t){return Nt(t)}),Dt),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.ws=0,this._s=new prebuilt_28889c43_f8ea673b_Zi,this.targetCount=0,this.ys=prebuilt_28889c43_f8ea673b_si.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),gr.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return gr.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return gr.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),gr.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),gr.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new prebuilt_28889c43_f8ea673b_si(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,gr.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),gr.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,gr.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,u.targetId)),i++)})),gr.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return gr.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return gr.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),gr.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),gr.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),gr.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return gr.resolve(n)},t.prototype.containsKey=function(t,e){return gr.resolve(this._s.containsKey(e))},t}(),prebuilt_28889c43_f8ea673b_oo=function(){function t(t,e){var n=this;this.gs={},this.Ne=new prebuilt_28889c43_f8ea673b_E(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new prebuilt_28889c43_f8ea673b_io(this),this.Ut=new Wr,this.Ue=function(t,e){return new prebuilt_28889c43_f8ea673b_no(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new Or(e),this.Qe=new prebuilt_28889c43_f8ea673b_$i(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,\"started\",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new prebuilt_28889c43_f8ea673b_eo(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;prebuilt_28889c43_f8ea673b_A(\"MemoryPersistence\",\"Starting transaction:\",t);var i=new prebuilt_28889c43_f8ea673b_so(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return gr.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),prebuilt_28889c43_f8ea673b_so=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(tslib_es6.__extends)(e,t),e}(vr),prebuilt_28889c43_f8ea673b_uo=function(){function t(t){this.persistence=t,this.As=new prebuilt_28889c43_f8ea673b_Zi,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,\"vs\",{get:function(){if(this.Rs)return this.Rs;throw prebuilt_28889c43_f8ea673b_R()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),gr.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),gr.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),gr.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return gr.forEach(this.vs,(function(r){var i=ut.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return gr.or([function(){return gr.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),prebuilt_28889c43_f8ea673b_ao=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?\"uid:\"+this.uid:\"anonymous-user\"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function prebuilt_28889c43_f8ea673b_co(t,e){return\"firestore_clients_\"+t+\"_\"+e}function prebuilt_28889c43_f8ea673b_ho(t,e,n){var r=\"firestore_mutations_\"+t+\"_\"+n;return e.isAuthenticated()&&(r+=\"_\"+e.uid),r}function prebuilt_28889c43_f8ea673b_fo(t,e){return\"firestore_targets_\"+t+\"_\"+e}prebuilt_28889c43_f8ea673b_ao.UNAUTHENTICATED=new prebuilt_28889c43_f8ea673b_ao(null),prebuilt_28889c43_f8ea673b_ao.GOOGLE_CREDENTIALS=new prebuilt_28889c43_f8ea673b_ao(\"google-credentials-uid\"),prebuilt_28889c43_f8ea673b_ao.FIRST_PARTY=new prebuilt_28889c43_f8ea673b_ao(\"first-party-uid\");var prebuilt_28889c43_f8ea673b_lo=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s=\"object\"==typeof o&&-1!==[\"pending\",\"acknowledged\",\"rejected\"].indexOf(o.state)&&(void 0===o.error||\"object\"==typeof o.error);return s&&o.error&&(s=\"string\"==typeof o.error.message&&\"string\"==typeof o.error.code)&&(i=new prebuilt_28889c43_f8ea673b_S(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(prebuilt_28889c43_f8ea673b_k(\"SharedClientState\",\"Failed to parse mutation state for ID '\"+n+\"': \"+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),prebuilt_28889c43_f8ea673b_po=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o=\"object\"==typeof i&&-1!==[\"not-current\",\"current\",\"rejected\"].indexOf(i.state)&&(void 0===i.error||\"object\"==typeof i.error);return o&&i.error&&(o=\"string\"==typeof i.error.message&&\"string\"==typeof i.error.code)&&(r=new prebuilt_28889c43_f8ea673b_S(i.error.code,i.error.message)),o?new t(e,i.state,r):(prebuilt_28889c43_f8ea673b_k(\"SharedClientState\",\"Failed to parse target state for ID '\"+e+\"': \"+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),prebuilt_28889c43_f8ea673b_yo=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i=\"object\"==typeof r&&r.activeTargetIds instanceof Array,o=prebuilt_28889c43_f8ea673b_on(),s=0;i&&s<r.activeTargetIds.length;++s)i=st(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(prebuilt_28889c43_f8ea673b_k(\"SharedClientState\",\"Failed to parse client data for instance '\"+e+\"': \"+n),null)},t}(),prebuilt_28889c43_f8ea673b_vo=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return\"object\"==typeof n&&-1!==[\"Unknown\",\"Online\",\"Offline\"].indexOf(n.onlineState)&&\"string\"==typeof n.clientId?new t(n.clientId,n.onlineState):(prebuilt_28889c43_f8ea673b_k(\"SharedClientState\",\"Failed to parse online state: \"+e),null)},t}(),prebuilt_28889c43_f8ea673b_mo=function(){function t(){this.activeTargetIds=prebuilt_28889c43_f8ea673b_on()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),prebuilt_28889c43_f8ea673b_go=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new prebuilt_28889c43_f8ea673b_Ge(prebuilt_28889c43_f8ea673b_F),this.started=!1,this.Os=[];var o=n.replace(/[.*+?^${}()|[\\]\\\\]/g,\"\\\\$&\");this.storage=this.window.localStorage,this.currentUser=i,this.$s=prebuilt_28889c43_f8ea673b_co(this.persistenceKey,this.Ns),this.Ms=function(t){return\"firestore_sequence_number_\"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new prebuilt_28889c43_f8ea673b_mo),this.Ls=new RegExp(\"^firestore_clients_\"+o+\"_([^_]*)$\"),this.Bs=new RegExp(\"^firestore_mutations_\"+o+\"_(\\\\d+)(?:_(.*))?$\"),this.qs=new RegExp(\"^firestore_targets_\"+o+\"_(\\\\d+)$\"),this.Us=function(t){return\"firestore_online_state_\"+t}(this.persistenceKey),this.Qs=function(t){return\"firestore_bundle_loaded_\"+t}(this.persistenceKey),this.window.addEventListener(\"storage\",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,a,c,f=this;return Object(tslib_es6.__generator)(this,(function(l){switch(l.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(prebuilt_28889c43_f8ea673b_co(this.persistenceKey,r)))&&(o=prebuilt_28889c43_f8ea673b_yo.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(s=this.storage.getItem(this.Us))&&(u=this.js(s))&&this.Ws(u),a=0,c=this.Os;a<c.length;a++)this.Fs(c[a]);return this.Os=[],this.window.addEventListener(\"pagehide\",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,\"pending\")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e=\"not-current\";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(prebuilt_28889c43_f8ea673b_fo(this.persistenceKey,t));if(n){var r=prebuilt_28889c43_f8ea673b_po.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(prebuilt_28889c43_f8ea673b_fo(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener(\"storage\",this.xs),this.removeItem(this.$s),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return prebuilt_28889c43_f8ea673b_A(\"SharedClientState\",\"READ\",t,e),e},t.prototype.setItem=function(t,e){prebuilt_28889c43_f8ea673b_A(\"SharedClientState\",\"SET\",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){prebuilt_28889c43_f8ea673b_A(\"SharedClientState\",\"REMOVE\",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(prebuilt_28889c43_f8ea673b_A(\"SharedClientState\",\"EVENT\",n.key,n.newValue),n.key===this.$s)return void prebuilt_28889c43_f8ea673b_k(\"Received WebStorage notification for local change. Another client might have garbage-collected our state\");this.Se.enqueueRetryable((function(){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Object(tslib_es6.__generator)(this,(function(u){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=prebuilt_28889c43_f8ea673b_E.o;if(null!=t)try{var n=JSON.parse(t);prebuilt_28889c43_f8ea673b_O(\"number\"==typeof n),e=n}catch(t){prebuilt_28889c43_f8ea673b_k(\"SharedClientState\",\"Failed to read sequence number from WebStorage\",t)}return e}(n.newValue))!==prebuilt_28889c43_f8ea673b_E.o&&this.sequenceNumberHandler(s);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.Os.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,\"Js\",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.$s,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new prebuilt_28889c43_f8ea673b_lo(this.currentUser,t,e,n),i=prebuilt_28889c43_f8ea673b_ho(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=prebuilt_28889c43_f8ea673b_ho(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:t}))},t.prototype.Ys=function(t,e,n){var r=prebuilt_28889c43_f8ea673b_fo(this.persistenceKey,t),i=new prebuilt_28889c43_f8ea673b_po(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,\"value-not-used\")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return prebuilt_28889c43_f8ea673b_yo.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]);return prebuilt_28889c43_f8ea673b_lo.Vs(new prebuilt_28889c43_f8ea673b_ao(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return prebuilt_28889c43_f8ea673b_po.Vs(r,e)},t.prototype.js=function(t){return prebuilt_28889c43_f8ea673b_vo.Vs(t)},t.prototype.ii=function(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ai(t.batchId,t.state,t.error)]:(prebuilt_28889c43_f8ea673b_A(\"SharedClientState\",\"Ignoring mutation for non-active user \"+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ui(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.syncEngine.hi(s,u).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=prebuilt_28889c43_f8ea673b_on();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),prebuilt_28889c43_f8ea673b_wo=function(){function t(){this.li=new prebuilt_28889c43_f8ea673b_mo,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||\"not-current\"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new prebuilt_28889c43_f8ea673b_mo,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),prebuilt_28889c43_f8ea673b_bo=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),prebuilt_28889c43_f8ea673b_Io=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener(\"online\",this.wi),window.removeEventListener(\"offline\",this.mi)},t.prototype.pi=function(){window.addEventListener(\"online\",this.wi),window.addEventListener(\"offline\",this.mi)},t.prototype._i=function(){prebuilt_28889c43_f8ea673b_A(\"ConnectivityMonitor\",\"Network connectivity changed: AVAILABLE\");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){prebuilt_28889c43_f8ea673b_A(\"ConnectivityMonitor\",\"Network connectivity changed: UNAVAILABLE\");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return\"undefined\"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),To={BatchGetDocuments:\"batchGet\",Commit:\"commit\",RunQuery:\"runQuery\"},prebuilt_28889c43_f8ea673b_Eo=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),_o=function(t){function u(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n}return Object(tslib_es6.__extends)(u,t),u.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var s=new XhrIo;s.listenOnce(EventType.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case ErrorCode.NO_ERROR:var e=s.getResponseJson();prebuilt_28889c43_f8ea673b_A(\"Connection\",\"XHR received:\",JSON.stringify(e)),i(e);break;case ErrorCode.TIMEOUT:prebuilt_28889c43_f8ea673b_A(\"Connection\",'RPC \"'+t+'\" timed out'),o(new prebuilt_28889c43_f8ea673b_S(_.DEADLINE_EXCEEDED,\"Request time out\"));break;case ErrorCode.HTTP_ERROR:var n=s.getStatus();if(prebuilt_28889c43_f8ea673b_A(\"Connection\",'RPC \"'+t+'\" failed with status:',n,\"response text:\",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,\"-\");return Object.values(_).indexOf(e)>=0?e:_.UNKNOWN}(r.status);o(new prebuilt_28889c43_f8ea673b_S(u,r.message))}else o(new prebuilt_28889c43_f8ea673b_S(_.UNKNOWN,\"Server responded with status \"+s.getStatus()))}else o(new prebuilt_28889c43_f8ea673b_S(_.UNAVAILABLE,\"Connection failed.\"));break;default:prebuilt_28889c43_f8ea673b_R()}}finally{prebuilt_28889c43_f8ea673b_A(\"Connection\",'RPC \"'+t+'\" completed.')}}));var u=JSON.stringify(r);s.send(e,\"POST\",u,n,15)}))},u.prototype.$i=function(t,u){var a=[this.Di,\"/\",\"google.firestore.v1.Firestore\",\"/\",t,\"/channel\"],c=new index_esm_Od,h=index_esm_Ub(),f={httpSessionIdParam:\"gsessionid\",initMessageHeaders:{},messageUrlParams:{database:\"projects/\"+this.databaseId.projectId+\"/databases/\"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Fi(f.initMessageHeaders,u),Object(util_dist_index_esm.isMobileCordova)()||Object(util_dist_index_esm.isReactNative)()||Object(util_dist_index_esm.isElectron)()||Object(util_dist_index_esm.isIE)()||Object(util_dist_index_esm.isUWP)()||Object(util_dist_index_esm.isBrowserExtension)()||(f.httpHeadersOverwriteParam=\"$httpHeaders\");var l=a.join(\"\");prebuilt_28889c43_f8ea673b_A(\"Connection\",\"Creating WebChannel: \"+l,f);var d=c.createWebChannel(l,f),w=!1,b=!1,I=new prebuilt_28889c43_f8ea673b_Eo({Ei:function(t){b?prebuilt_28889c43_f8ea673b_A(\"Connection\",\"Not sending because WebChannel is closed:\",t):(w||(prebuilt_28889c43_f8ea673b_A(\"Connection\",\"Opening WebChannel transport.\"),d.open(),w=!0),prebuilt_28889c43_f8ea673b_A(\"Connection\",\"WebChannel sending:\",t),d.send(t))},Ti:function(){return d.close()}}),T=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return T(d,WebChannel.EventType.OPEN,(function(){b||prebuilt_28889c43_f8ea673b_A(\"Connection\",\"WebChannel transport opened.\")})),T(d,WebChannel.EventType.CLOSE,(function(){b||(b=!0,prebuilt_28889c43_f8ea673b_A(\"Connection\",\"WebChannel transport closed\"),I.Vi())})),T(d,WebChannel.EventType.ERROR,(function(t){b||(b=!0,prebuilt_28889c43_f8ea673b_x(\"Connection\",\"WebChannel transport errored:\",t),I.Vi(new prebuilt_28889c43_f8ea673b_S(_.UNAVAILABLE,\"The operation could not be completed\")))})),T(d,WebChannel.EventType.MESSAGE,(function(t){var e;if(!b){var n=t.data[0];prebuilt_28889c43_f8ea673b_O(!!n);var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){prebuilt_28889c43_f8ea673b_A(\"Connection\",\"WebChannel received error:\",i);var o=i.status,s=function(t){var e=prebuilt_28889c43_f8ea673b_Fe[t];if(void 0!==e)return prebuilt_28889c43_f8ea673b_Ke(e)}(o),u=i.message;void 0===s&&(s=_.INTERNAL,u=\"Unknown error status: \"+o+\" with message \"+i.message),b=!0,I.Vi(new prebuilt_28889c43_f8ea673b_S(s,u)),d.close()}else prebuilt_28889c43_f8ea673b_A(\"Connection\",\"WebChannel received:\",n),I.Si(n)}})),T(h,Event.STAT_EVENT,(function(t){10===t.stat?prebuilt_28889c43_f8ea673b_A(\"Connection\",\"Detected buffering proxy\"):11===t.stat&&prebuilt_28889c43_f8ea673b_A(\"Connection\",\"Detected no buffering proxy\")})),setTimeout((function(){I.Pi()}),0),I},u}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.Di=(t.ssl?\"https\":\"http\")+\"://\"+t.host,this.Ci=\"projects/\"+this.databaseId.projectId+\"/databases/\"+this.databaseId.database+\"/documents\"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);prebuilt_28889c43_f8ea673b_A(\"RestConnection\",\"Sending: \",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return prebuilt_28889c43_f8ea673b_A(\"RestConnection\",\"Received: \",t),t}),(function(e){throw prebuilt_28889c43_f8ea673b_x(\"RestConnection\",t+\" failed with error: \",e,\"url: \",i,\"request:\",n),e}))},t.prototype.Oi=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t[\"X-Goog-Api-Client\"]=\"gl-js/ fire/8.6.2\",t[\"Content-Type\"]=\"text/plain\",this.databaseInfo.appId&&(t[\"X-Firebase-GMPID\"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){return this.Di+\"/v1/\"+e+\":\"+To[t]},t}());function So(){return\"undefined\"!=typeof window?window:null}function No(){return\"undefined\"!=typeof document?document:null}function prebuilt_28889c43_f8ea673b_Do(t){return new prebuilt_28889c43_f8ea673b_mn(t,!0)}var prebuilt_28889c43_f8ea673b_Ao=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&prebuilt_28889c43_f8ea673b_A(\"ExponentialBackoff\",\"Backing off for \"+i+\" ms (base delay: \"+this.qi+\" ms, delay with jitter: \"+n+\" ms, last attempt: \"+r+\" ms ago)\"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Qi=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),prebuilt_28889c43_f8ea673b_ko=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new prebuilt_28889c43_f8ea673b_Ao(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ar(),this.stream.send(t)},t.prototype.rr=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ar=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return this.ar(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===_.RESOURCE_EXHAUSTED?(prebuilt_28889c43_f8ea673b_k(e.toString()),prebuilt_28889c43_f8ea673b_k(\"Using maximum backoff delay to prevent overloading the backend.\"),this.Zi.Ki()):e&&e.code===_.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ur(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ur=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new prebuilt_28889c43_f8ea673b_S(_.UNKNOWN,\"Fetching auth token failed: \"+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return Object(tslib_es6.__awaiter)(t,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return prebuilt_28889c43_f8ea673b_A(\"PersistentStream\",\"close with error: \"+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(prebuilt_28889c43_f8ea673b_A(\"PersistentStream\",\"stream callback skipped by getCloseGuardedDispatcher.\"),Promise.resolve())}))}},t}(),prebuilt_28889c43_f8ea673b_xo=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,\"listen_stream_connection_backoff\",\"listen_stream_idle\",n,r,o)||this).R=i,s}return Object(tslib_es6.__extends)(e,t),e.prototype.wr=function(t){return this.Hi.$i(\"Listen\",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if(\"targetChange\"in e){var r=function(t){return\"NO_CHANGE\"===t?0:\"ADD\"===t?1:\"REMOVE\"===t?2:\"CURRENT\"===t?3:\"RESET\"===t?4:prebuilt_28889c43_f8ea673b_R()}(e.targetChange.targetChangeType||\"NO_CHANGE\"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(prebuilt_28889c43_f8ea673b_O(void 0===e||\"string\"==typeof e),prebuilt_28889c43_f8ea673b_X.fromBase64String(e||\"\")):(prebuilt_28889c43_f8ea673b_O(void 0===e||e instanceof Uint8Array),prebuilt_28889c43_f8ea673b_X.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?_.UNKNOWN:prebuilt_28889c43_f8ea673b_Ke(t.code);return new prebuilt_28889c43_f8ea673b_S(e,t.message||\"\")}(u);n=new prebuilt_28889c43_f8ea673b_hn(r,i,o,s||null)}else if(\"documentChange\"in e){i=prebuilt_28889c43_f8ea673b_Sn(t,(r=e.documentChange).document.name),o=prebuilt_28889c43_f8ea673b_In(r.document.updateTime);var u=new It({mapValue:{fields:r.document.fields}}),a=(s=Et.newFoundDocument(i,o,u),r.targetIds||[]);n=new prebuilt_28889c43_f8ea673b_an(a,r.removedTargetIds||[],s.key,s)}else if(\"documentDelete\"in e)i=prebuilt_28889c43_f8ea673b_Sn(t,(r=e.documentDelete).document),o=r.readTime?prebuilt_28889c43_f8ea673b_In(r.readTime):B.min(),u=Et.newNoDocument(i,o),n=new prebuilt_28889c43_f8ea673b_an([],s=r.removedTargetIds||[],u.key,u);else if(\"documentRemove\"in e)i=prebuilt_28889c43_f8ea673b_Sn(t,(r=e.documentRemove).document),n=new prebuilt_28889c43_f8ea673b_an([],o=r.removedTargetIds||[],i,null);else{if(!(\"filter\"in e))return prebuilt_28889c43_f8ea673b_R();var h=e.filter;i=new prebuilt_28889c43_f8ea673b_Be(r=h.count||0),n=new prebuilt_28889c43_f8ea673b_cn(o=h.targetId,i)}return n}(this.R,t),n=function(t){if(!(\"targetChange\"in t))return B.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?B.min():e.readTime?prebuilt_28889c43_f8ea673b_In(e.readTime):B.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=prebuilt_28889c43_f8ea673b_An(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=At(r)?{documents:prebuilt_28889c43_f8ea673b_Ln(t,r)}:{query:prebuilt_28889c43_f8ea673b_Pn(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=prebuilt_28889c43_f8ea673b_wn(t,e.resumeToken):e.snapshotVersion.compareTo(B.min())>0&&(n.readTime=prebuilt_28889c43_f8ea673b_gn(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return\"existence-filter-mismatch\";case 2:return\"limbo-document\";default:return prebuilt_28889c43_f8ea673b_R()}}(0,e.purpose);return null==n?null:{\"goog-listen-tags\":n}}(0,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=prebuilt_28889c43_f8ea673b_An(this.R),e.removeTarget=t,this.cr(e)},e}(prebuilt_28889c43_f8ea673b_ko),prebuilt_28889c43_f8ea673b_Co=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,\"write_stream_connection_backoff\",\"write_stream_idle\",n,r,o)||this).R=i,s.gr=!1,s}return Object(tslib_es6.__extends)(e,t),Object.defineProperty(e.prototype,\"pr\",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ur=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.$i(\"Write\",t)},e.prototype.onMessage=function(t){if(prebuilt_28889c43_f8ea673b_O(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(prebuilt_28889c43_f8ea673b_O(void 0!==e),t.map((function(t){return function(t,e){var n=prebuilt_28889c43_f8ea673b_In(t.updateTime?t.updateTime:e);return n.isEqual(B.min())&&(n=prebuilt_28889c43_f8ea673b_In(e)),new prebuilt_28889c43_f8ea673b_Ee(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=prebuilt_28889c43_f8ea673b_In(t.commitTime);return this.listener.Tr(n,e)}return prebuilt_28889c43_f8ea673b_O(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=prebuilt_28889c43_f8ea673b_An(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return prebuilt_28889c43_f8ea673b_Rn(e.R,t)}))};this.cr(n)},e}(prebuilt_28889c43_f8ea673b_ko),Ro=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(tslib_es6.__extends)(e,t),e.prototype.br=function(){if(this.Rr)throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,\"The client has already been terminated.\")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw\"FirebaseError\"===t.name?(t.code===_.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new prebuilt_28889c43_f8ea673b_S(_.UNKNOWN,t.toString())}))},e.prototype.Oi=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Oi(t,e,n,i)})).catch((function(t){throw\"FirebaseError\"===t.name?(t.code===_.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new prebuilt_28889c43_f8ea673b_S(_.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Oo=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=\"Unknown\",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr(\"Unknown\"),this.Pr=this.asyncQueue.enqueueAfterDelay(\"online_state_timeout\",1e4,(function(){return t.Pr=null,t.Cr(\"Backend didn't respond within 10 seconds.\"),t.Dr(\"Offline\"),Promise.resolve()})))},t.prototype.Nr=function(t){\"Online\"===this.state?this.Dr(\"Unknown\"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr(\"Connection failed 1 times. Most recent error: \"+t.toString()),this.Dr(\"Offline\")))},t.prototype.set=function(t){this.Fr(),this.vr=0,\"Online\"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e=\"Could not reach Cloud Firestore backend. \"+t+\"\\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.\";this.Vr?(prebuilt_28889c43_f8ea673b_k(e),this.Vr=!1):prebuilt_28889c43_f8ea673b_A(\"OnlineStateTracker\",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Lo=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.Or=new Map,this.$r=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(o,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){switch(t.label){case 0:return prebuilt_28889c43_f8ea673b_Ko(this)?(prebuilt_28889c43_f8ea673b_A(\"RemoteStore\",\"Restarting streams for network reachability change.\"),[4,function(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return(e=prebuilt_28889c43_f8ea673b_L(t)).$r.add(4),[4,Mo(e)];case 1:return n.sent(),e.Br.set(\"Unknown\"),e.$r.delete(4),[4,Po(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Oo(n,r)};function Po(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:if(!prebuilt_28889c43_f8ea673b_Ko(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Mo(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function prebuilt_28889c43_f8ea673b_Fo(t,e){var n=prebuilt_28889c43_f8ea673b_L(t);n.Or.has(e.targetId)||(n.Or.set(e.targetId,e),prebuilt_28889c43_f8ea673b_jo(n)?prebuilt_28889c43_f8ea673b_Bo(n):is(n).er()&&prebuilt_28889c43_f8ea673b_qo(n,e))}function Vo(t,e){var n=prebuilt_28889c43_f8ea673b_L(t),r=is(n);n.Or.delete(e),r.er()&&Uo(n,e),0===n.Or.size&&(r.er()?r.ir():prebuilt_28889c43_f8ea673b_Ko(n)&&n.Br.set(\"Unknown\"))}function prebuilt_28889c43_f8ea673b_qo(t,e){t.qr.U(e.targetId),is(t).mr(e)}function Uo(t,e){t.qr.U(e),is(t).yr(e)}function prebuilt_28889c43_f8ea673b_Bo(t){t.qr=new prebuilt_28889c43_f8ea673b_ln({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.Or.get(e)||null}}),is(t).start(),t.Br.Sr()}function prebuilt_28889c43_f8ea673b_jo(t){return prebuilt_28889c43_f8ea673b_Ko(t)&&!is(t).tr()&&t.Or.size>0}function prebuilt_28889c43_f8ea673b_Ko(t){return 0===prebuilt_28889c43_f8ea673b_L(t).$r.size}function prebuilt_28889c43_f8ea673b_Go(t){t.qr=void 0}function Qo(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){return t.Or.forEach((function(e,n){prebuilt_28889c43_f8ea673b_qo(t,e)})),[2]}))}))}function prebuilt_28889c43_f8ea673b_zo(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(n){return prebuilt_28889c43_f8ea673b_Go(t),prebuilt_28889c43_f8ea673b_jo(t)?(t.Br.Nr(e),prebuilt_28889c43_f8ea673b_Bo(t)):t.Br.set(\"Unknown\"),[2]}))}))}function Wo(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return Object(tslib_es6.__generator)(this,(function(s){switch(s.label){case 0:if(t.Br.set(\"Online\"),!(e instanceof prebuilt_28889c43_f8ea673b_hn&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return Object(tslib_es6.__generator)(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Or.has(o=i[r])?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Or.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),prebuilt_28889c43_f8ea673b_A(\"RemoteStore\",\"Failed to remove targets %s: %s \",e.targetIds.join(\",\"),r),[4,prebuilt_28889c43_f8ea673b_Ho(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof prebuilt_28889c43_f8ea673b_an?t.qr.X(e):e instanceof prebuilt_28889c43_f8ea673b_cn?t.qr.rt(e):t.qr.et(e),n.isEqual(B.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,prebuilt_28889c43_f8ea673b_Ui(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.at(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.Or.get(r);i&&t.Or.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.Or.get(e);if(n){t.Or.set(e,n.withResumeToken(prebuilt_28889c43_f8ea673b_X.EMPTY_BYTE_STRING,n.snapshotVersion)),Uo(t,e);var r=new Rr(n.target,e,1,n.sequenceNumber);prebuilt_28889c43_f8ea673b_qo(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return prebuilt_28889c43_f8ea673b_A(\"RemoteStore\",\"Failed to raise snapshot:\",o=s.sent()),[4,prebuilt_28889c43_f8ea673b_Ho(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function prebuilt_28889c43_f8ea673b_Ho(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r=this;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:if(!Er(e))throw e;return t.$r.add(1),[4,Mo(t)];case 1:return i.sent(),t.Br.set(\"Offline\"),n||(n=function(){return prebuilt_28889c43_f8ea673b_Ui(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return Object(tslib_es6.__awaiter)(r,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return prebuilt_28889c43_f8ea673b_A(\"RemoteStore\",\"Retrying IndexedDB access\"),[4,n()];case 1:return e.sent(),t.$r.delete(1),[4,Po(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Yo(t,e){return e().catch((function(n){return prebuilt_28889c43_f8ea673b_Ho(t,n,e)}))}function Xo(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(tslib_es6.__generator)(this,(function(s){switch(s.label){case 0:e=prebuilt_28889c43_f8ea673b_L(t),n=os(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return prebuilt_28889c43_f8ea673b_Ko(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,prebuilt_28889c43_f8ea673b_Ki(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=os(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,prebuilt_28889c43_f8ea673b_Ho(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return prebuilt_28889c43_f8ea673b_Jo(e)&&$o(e),[2]}}))}))}function prebuilt_28889c43_f8ea673b_Jo(t){return prebuilt_28889c43_f8ea673b_Ko(t)&&!os(t).tr()&&t.kr.length>0}function $o(t){os(t).start()}function Zo(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){return os(t).Ar(),[2]}))}))}function ts(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(tslib_es6.__generator)(this,(function(o){for(e=os(t),n=0,r=t.kr;n<r.length;n++)e.Er(r[n].mutations);return[2]}))}))}function es(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Cr.from(r,e,n),[4,Yo(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,Xo(t)];case 2:return o.sent(),[2]}}))}))}function ns(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return e&&os(t).pr?[4,function(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return prebuilt_28889c43_f8ea673b_je(r=e.code)&&r!==_.ABORTED?(n=t.kr.shift(),os(t).sr(),[4,Yo(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Xo(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return prebuilt_28889c43_f8ea673b_Jo(t)&&$o(t),[2]}}))}))}function rs(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return n=prebuilt_28889c43_f8ea673b_L(t),e?(n.$r.delete(2),[4,Po(n)]):[3,2];case 1:return i.sent(),[3,5];case 2:return e?[3,4]:(n.$r.add(2),[4,Mo(n)]);case 3:i.sent(),n.Br.set(\"Unknown\"),i.label=4;case 4:i.label=5;case 5:return[2]}}))}))}function is(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=prebuilt_28889c43_f8ea673b_L(t);return r.br(),new prebuilt_28889c43_f8ea673b_xo(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Qo.bind(null,t),Ri:prebuilt_28889c43_f8ea673b_zo.bind(null,t),_r:Wo.bind(null,t)}),t.Mr.push((function(n){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),prebuilt_28889c43_f8ea673b_jo(t)?prebuilt_28889c43_f8ea673b_Bo(t):t.Br.set(\"Unknown\"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),prebuilt_28889c43_f8ea673b_Go(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function os(t){var e=this;return t.Qr||(t.Qr=function(t,e,n){var r=prebuilt_28889c43_f8ea673b_L(t);return r.br(),new prebuilt_28889c43_f8ea673b_Co(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Zo.bind(null,t),Ri:ns.bind(null,t),Ir:ts.bind(null,t),Tr:es.bind(null,t)}),t.Mr.push((function(n){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return n?(t.Qr.sr(),[4,Xo(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:e.sent(),t.kr.length>0&&(prebuilt_28889c43_f8ea673b_A(\"RemoteStore\",\"Stopping write stream with \"+t.kr.length+\" pending writes\"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Qr}var ss=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new mr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new prebuilt_28889c43_f8ea673b_S(_.CANCELLED,\"Operation cancelled\"+(t?\": \"+t:\"\"))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function us(t,e){if(prebuilt_28889c43_f8ea673b_k(\"AsyncQueue\",e+\": \"+t),Er(t))return new prebuilt_28889c43_f8ea673b_S(_.UNAVAILABLE,e+\": \"+t);throw t}var as=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ut.comparator(e.key,n.key)}:function(t,e){return ut.comparator(t.key,e.key)},this.keyedMap=prebuilt_28889c43_f8ea673b_$e(),this.sortedSet=new prebuilt_28889c43_f8ea673b_Ge(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,\"size\",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?\"DocumentSet ()\":\"DocumentSet (\\n  \"+t.join(\"  \\n\")+\"\\n)\"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),cs=function(){function t(){this.Kr=new prebuilt_28889c43_f8ea673b_Ge(ut.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):prebuilt_28889c43_f8ea673b_R():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),hs=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,as.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,\"hasPendingWrites\",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&prebuilt_28889c43_f8ea673b_ee(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),fs=function(){this.Wr=void 0,this.listeners=[]},ls=function(){this.queries=new prebuilt_28889c43_f8ea673b_gi((function(t){return prebuilt_28889c43_f8ea673b_ne(t)}),prebuilt_28889c43_f8ea673b_ee),this.onlineState=\"Unknown\",this.Gr=new Set};function ds(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a;return Object(tslib_es6.__generator)(this,(function(c){switch(c.label){case 0:if(n=prebuilt_28889c43_f8ea673b_L(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new fs),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return u=c.sent(),a=us(u,\"Initialization of query '\"+prebuilt_28889c43_f8ea673b_re(e.query)+\"' failed\"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&ms(n),[2]}}))}))}function ps(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(tslib_es6.__generator)(this,(function(u){return n=prebuilt_28889c43_f8ea673b_L(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function ys(t,e){for(var n=prebuilt_28889c43_f8ea673b_L(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);a.Wr=s}}r&&ms(n)}function vs(t,e,n){var r=prebuilt_28889c43_f8ea673b_L(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function ms(t){t.Gr.forEach((function(t){t.next()}))}var gs=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState=\"Unknown\",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new hs(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&\"Offline\"!==e||t.docs.isEmpty()&&\"Offline\"!==e)},t.prototype.Zr=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=hs.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),ws=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return\"metadata\"in this.payload},t}(),bs=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return prebuilt_28889c43_f8ea673b_Sn(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?prebuilt_28889c43_f8ea673b_Cn(this.R,t.document,!1):Et.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime))},t.prototype.Qn=function(t){return prebuilt_28889c43_f8ea673b_In(t)},t}(),Is=function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=Ts(t)}return t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new bs(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||prebuilt_28889c43_f8ea673b_nn()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return[4,prebuilt_28889c43_f8ea673b_Xi(this.localStore,new bs(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,prebuilt_28889c43_f8ea673b_Ji(this.localStore,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState=\"Success\",new prebuilt_28889c43_f8ea673b_Ri(Object.assign({},this.progress),t))]}}))}))},t}();function Ts(t){return{taskState:\"Running\",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Es=function(t){this.key=t},_s=function(t){this.key=t},Ss=function(){function t(t,e){this.query=t,this.ao=e,this.uo=null,this.current=!1,this.ho=prebuilt_28889c43_f8ea673b_nn(),this.mutatedKeys=prebuilt_28889c43_f8ea673b_nn(),this.lo=prebuilt_28889c43_f8ea673b_oe(t),this.fo=new as(this.lo)}return Object.defineProperty(t.prototype,\"wo\",{get:function(){return this.ao},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new cs,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,u=!1,a=Wt(this.query)&&i.size===this.query.limit?i.last():null,c=Ht(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),f=prebuilt_28889c43_f8ea673b_ie(n.query,e)?e:null,l=!!h&&n.mutatedKeys.has(h.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),p=!1;h&&f?h.data.isEqual(f.data)?l!==d&&(r.track({type:3,doc:f}),p=!0):n.yo(h,f)||(r.track({type:2,doc:f}),p=!0,(a&&n.lo(f,a)>0||c&&n.lo(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),p=!0):h&&!f&&(r.track({type:1,doc:h}),p=!0,(a||c)&&(u=!0)),p&&(f?(s=s.add(f),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Wt(this.query)||Ht(this.query))for(;s.size>this.query.limit;){var h=Wt(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:u,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return prebuilt_28889c43_f8ea673b_R()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],u=0===this.ho.size&&this.current?1:0,a=u!==this.uo;return this.uo=u,0!==o.length||a?{snapshot:new hs(this.query,t.fo,i,o,t.mutatedKeys,0===u,a,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&\"Offline\"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new cs,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.ao.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.ao=e.ao.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.ao=e.ao.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=prebuilt_28889c43_f8ea673b_nn(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new _s(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Es(t))})),n},t.prototype.Ao=function(t){this.ao=t.Bn,this.ho=prebuilt_28889c43_f8ea673b_nn();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return hs.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.uo)},t}(),Ns=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ds=function(t){this.key=t,this.bo=!1},As=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new prebuilt_28889c43_f8ea673b_gi((function(t){return prebuilt_28889c43_f8ea673b_ne(t)}),prebuilt_28889c43_f8ea673b_ee),this.Vo=new Map,this.So=new Set,this.Do=new prebuilt_28889c43_f8ea673b_Ge(ut.comparator),this.Co=new Map,this.No=new prebuilt_28889c43_f8ea673b_Zi,this.xo={},this.Fo=new Map,this.ko=prebuilt_28889c43_f8ea673b_si.Yt(),this.onlineState=\"Unknown\",this.Oo=void 0}return Object.defineProperty(t.prototype,\"isPrimaryClient\",{get:function(){return!0===this.Oo},enumerable:!1,configurable:!0}),t}();function ks(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,i,o,s,u;return Object(tslib_es6.__generator)(this,(function(a){switch(a.label){case 0:return n=iu(t),(o=n.Po.get(e))?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,prebuilt_28889c43_f8ea673b_Gi(n.localStore,Zt(e))];case 2:return s=a.sent(),u=n.sharedClientState.addLocalQueryTarget(s.targetId),[4,xs(n,e,s.targetId,\"current\"===u)];case 3:i=a.sent(),n.isPrimaryClient&&prebuilt_28889c43_f8ea673b_Fo(n.remoteStore,s),a.label=4;case 4:return[2,i]}}))}))}function xs(t,e,n,r){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var i,o,s,u,a,c;return Object(tslib_es6.__generator)(this,(function(h){switch(h.label){case 0:return t.$o=function(e,n,r){return function(t,e,n,r){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var i,o,s;return Object(tslib_es6.__generator)(this,(function(u){switch(u.label){case 0:return(i=e.view._o(n)).Nn?[4,prebuilt_28889c43_f8ea673b_zi(t.localStore,e.query,!1).then((function(t){return e.view._o(t.documents,i)}))]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Ks(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,prebuilt_28889c43_f8ea673b_zi(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Ss(e,i.Bn),s=o._o(i.documents),u=prebuilt_28889c43_f8ea673b_un.createSynthesizedTargetChangeForCurrentChange(n,r&&\"Offline\"!==t.onlineState),a=o.applyChanges(s,t.isPrimaryClient,u),Ks(t,n,a.To),c=new Ns(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),a.snapshot)]}}))}))}function Cs(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return n=prebuilt_28889c43_f8ea673b_L(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!prebuilt_28889c43_f8ea673b_ee(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,prebuilt_28889c43_f8ea673b_Qi(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Vo(n.remoteStore,r.targetId),Bs(n,r.targetId)})).catch(prebuilt_28889c43_f8ea673b_fi)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Bs(n,r.targetId),[4,prebuilt_28889c43_f8ea673b_Qi(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Rs(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i,o,s;return Object(tslib_es6.__generator)(this,(function(u){switch(u.label){case 0:r=ou(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=prebuilt_28889c43_f8ea673b_L(t),i=prebuilt_28889c43_f8ea673b_U.now(),o=e.reduce((function(t,e){return t.add(e.key)}),prebuilt_28889c43_f8ea673b_nn());return r.persistence.runTransaction(\"Locally write mutations\",\"readwrite\",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=prebuilt_28889c43_f8ea673b_ke(c,n.get(c.key));null!=h&&s.push(new prebuilt_28889c43_f8ea673b_Oe(c.key,h,Tt(h.toProto().mapValue),_e.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=u.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new prebuilt_28889c43_f8ea673b_Ge(prebuilt_28889c43_f8ea673b_F)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,zs(r,i.changes)];case 3:return u.sent(),[4,Xo(r.remoteStore)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=us(o,\"Failed to persist write\"),n.reject(s),[3,6];case 6:return[2]}}))}))}function Os(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:n=prebuilt_28889c43_f8ea673b_L(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,prebuilt_28889c43_f8ea673b_Bi(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(prebuilt_28889c43_f8ea673b_O(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?prebuilt_28889c43_f8ea673b_O(r.bo):t.removedDocuments.size>0&&(prebuilt_28889c43_f8ea673b_O(r.bo),r.bo=!1))})),[4,zs(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,prebuilt_28889c43_f8ea673b_fi(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Ls(t,e,n){var r=prebuilt_28889c43_f8ea673b_L(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=prebuilt_28889c43_f8ea673b_L(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&ms(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Ps(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i,o,s,u,a;return Object(tslib_es6.__generator)(this,(function(c){switch(c.label){case 0:return(r=prebuilt_28889c43_f8ea673b_L(t)).sharedClientState.updateQueryState(e,\"rejected\",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new prebuilt_28889c43_f8ea673b_Ge(ut.comparator)).insert(o,Et.newNoDocument(o,B.min())),u=prebuilt_28889c43_f8ea673b_nn().add(o),a=new prebuilt_28889c43_f8ea673b_sn(B.min(),new Map,new prebuilt_28889c43_f8ea673b_We(prebuilt_28889c43_f8ea673b_F),s,u),[4,Os(r,a)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Qs(r),[3,4];case 2:return[4,prebuilt_28889c43_f8ea673b_Qi(r.localStore,e,!1).then((function(){return Bs(r,e,n)})).catch(prebuilt_28889c43_f8ea673b_fi)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Ms(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:n=prebuilt_28889c43_f8ea673b_L(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,prebuilt_28889c43_f8ea673b_qi(n.localStore,e)];case 2:return i=o.sent(),Us(n,r,null),qs(n,r),n.sharedClientState.updateMutationState(r,\"acknowledged\"),[4,zs(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,prebuilt_28889c43_f8ea673b_fi(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Fs(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:r=prebuilt_28889c43_f8ea673b_L(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=prebuilt_28889c43_f8ea673b_L(t);return n.persistence.runTransaction(\"Reject batch\",\"readwrite-primary\",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return prebuilt_28889c43_f8ea673b_O(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),Us(r,e,n),qs(r,e),r.sharedClientState.updateMutationState(e,\"rejected\",n),[4,zs(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,prebuilt_28889c43_f8ea673b_fi(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Vs(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(tslib_es6.__generator)(this,(function(u){switch(u.label){case 0:prebuilt_28889c43_f8ea673b_Ko((n=prebuilt_28889c43_f8ea673b_L(t)).remoteStore)||prebuilt_28889c43_f8ea673b_A(\"SyncEngine\",\"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.\"),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=prebuilt_28889c43_f8ea673b_L(t);return e.persistence.runTransaction(\"Get highest unacknowledged batch id\",\"readonly\",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=u.sent(),s=us(o,\"Initialization of waitForPendingWrites() operation failed\"),e.reject(s),[3,4];case 4:return[2]}}))}))}function qs(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function Us(t,e,n){var r=prebuilt_28889c43_f8ea673b_L(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Bs(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||js(t,e)}))}function js(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Vo(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Qs(t))}function Ks(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Es?(t.No.addReference(o.key,e),Gs(t,o)):o instanceof _s?(prebuilt_28889c43_f8ea673b_A(\"SyncEngine\",\"Document no longer in limbo: \"+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||js(t,o.key)):prebuilt_28889c43_f8ea673b_R()}}function Gs(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(prebuilt_28889c43_f8ea673b_A(\"SyncEngine\",\"New document in limbo: \"+n),t.So.add(r),Qs(t))}function Qs(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new ut(prebuilt_28889c43_f8ea673b_z.fromString(e)),r=t.ko.next();t.Co.set(r,new Ds(n)),t.Do=t.Do.insert(n,r),prebuilt_28889c43_f8ea673b_Fo(t.remoteStore,new Rr(Zt(zt(n.path)),r,2,prebuilt_28889c43_f8ea673b_E.o))}}function zs(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i,o,s;return Object(tslib_es6.__generator)(this,(function(u){switch(u.label){case 0:return r=prebuilt_28889c43_f8ea673b_L(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,u){s.push(r.$o(u,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,t.fromCache?\"not-current\":\"current\"),i.push(t);var e=prebuilt_28889c43_f8ea673b_Li.Pn(u.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return u.sent(),r.vo._r(i),[4,function(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,h;return Object(tslib_es6.__generator)(this,(function(f){switch(f.label){case 0:n=prebuilt_28889c43_f8ea673b_L(t),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,n.persistence.runTransaction(\"notifyLocalViewChanges\",\"readwrite\",(function(t){return gr.forEach(e,(function(e){return gr.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return gr.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return f.sent(),[3,4];case 3:if(!Er(r=f.sent()))throw r;return prebuilt_28889c43_f8ea673b_A(\"LocalStore\",\"Failed to update sequence numbers: \"+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.Fn.get(u),h=a.withLastLimboFreeSnapshotVersion(a.snapshotVersion),n.Fn=n.Fn.insert(u,h));return[2]}}))}))}(r.localStore,o)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))}function Ws(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return(n=prebuilt_28889c43_f8ea673b_L(t)).currentUser.isEqual(e)?[3,3]:(prebuilt_28889c43_f8ea673b_A(\"SyncEngine\",\"User change. New user:\",e.toKey()),[4,prebuilt_28889c43_f8ea673b_Vi(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new prebuilt_28889c43_f8ea673b_S(_.CANCELLED,\"'waitForPendingWrites' promise is rejected due to a user change.\"))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,zs(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Hs(t,e){var n=prebuilt_28889c43_f8ea673b_L(t),r=n.Co.get(e);if(r&&r.bo)return prebuilt_28889c43_f8ea673b_nn().add(r.key);var i=prebuilt_28889c43_f8ea673b_nn(),o=n.Vo.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var c=n.Po.get(u[s]);i=i.unionWith(c.view.wo)}return i}function Ys(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return[4,prebuilt_28889c43_f8ea673b_zi((n=prebuilt_28889c43_f8ea673b_L(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&Ks(n,e.targetId,i.To),i)]}}))}))}function Xs(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){return[2,prebuilt_28889c43_f8ea673b_Hi((e=prebuilt_28889c43_f8ea673b_L(t)).localStore).then((function(t){return zs(e,t)}))]}))}))}function Js(t,e,n,r){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(tslib_es6.__generator)(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=prebuilt_28889c43_f8ea673b_L(t),r=prebuilt_28889c43_f8ea673b_L(n._n);return n.persistence.runTransaction(\"Lookup mutation documents\",\"readonly\",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):gr.resolve(null)}))}))}((i=prebuilt_28889c43_f8ea673b_L(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:\"pending\"!==n?[3,3]:[4,Xo(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:\"acknowledged\"===n||\"rejected\"===n?(Us(i,e,r||null),qs(i,e),function(t,e){prebuilt_28889c43_f8ea673b_L(prebuilt_28889c43_f8ea673b_L(t)._n).Gt(e)}(i.localStore,e)):prebuilt_28889c43_f8ea673b_R(),s.label=4;case 4:return[4,zs(i,o)];case 5:return s.sent(),[3,7];case 6:prebuilt_28889c43_f8ea673b_A(\"SyncEngine\",\"Cannot apply mutation batch with id: \"+e),s.label=7;case 7:return[2]}}))}))}function $s(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s,a,c;return Object(tslib_es6.__generator)(this,(function(h){switch(h.label){case 0:return iu(n=prebuilt_28889c43_f8ea673b_L(t)),ou(n),!0!==e||!0===n.Oo?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Zs(n,r.toArray())]);case 1:return i=h.sent(),n.Oo=!0,[4,rs(n.remoteStore,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)prebuilt_28889c43_f8ea673b_Fo(n.remoteStore,s[o]);return[3,7];case 3:return!1!==e||!1===n.Oo?[3,7]:(a=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?a.push(e):c=c.then((function(){return Bs(n,e),prebuilt_28889c43_f8ea673b_Qi(n.localStore,e,!0)})),Vo(n.remoteStore,e)})),[4,c]);case 4:return h.sent(),[4,Zs(n,a)];case 5:return h.sent(),function(t){var e=prebuilt_28889c43_f8ea673b_L(t);e.Co.forEach((function(t,n){Vo(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new prebuilt_28889c43_f8ea673b_Ge(ut.comparator)}(n),n.Oo=!1,[4,rs(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function Zs(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c,h,f,d,p,y;return Object(tslib_es6.__generator)(this,(function(v){switch(v.label){case 0:n=prebuilt_28889c43_f8ea673b_L(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.Vo.get(u=s[o]))&&0!==c.length?[4,prebuilt_28889c43_f8ea673b_Gi(n.localStore,Zt(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(d=n.Po.get(f[h]),[4,Ys(n,d)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,prebuilt_28889c43_f8ea673b_Wi(n.localStore,u)];case 8:return y=v.sent(),[4,prebuilt_28889c43_f8ea673b_Gi(n.localStore,y)];case 9:return a=v.sent(),[4,xs(n,tu(y),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function tu(t){return Qt(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,\"F\",t.startAt,t.endAt)}function eu(t){var e=prebuilt_28889c43_f8ea673b_L(t);return prebuilt_28889c43_f8ea673b_L(prebuilt_28889c43_f8ea673b_L(e.localStore).persistence).fn()}function nu(t,e,n,r){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var i,o,s;return Object(tslib_es6.__generator)(this,(function(u){switch(u.label){case 0:return(i=prebuilt_28889c43_f8ea673b_L(t)).Oo?(prebuilt_28889c43_f8ea673b_A(\"SyncEngine\",\"Ignoring unexpected query state notification.\"),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case\"current\":case\"not-current\":return[3,2];case\"rejected\":return[3,5]}return[3,7];case 2:return[4,prebuilt_28889c43_f8ea673b_Hi(i.localStore)];case 3:return o=u.sent(),s=prebuilt_28889c43_f8ea673b_sn.createSynthesizedRemoteEventForCurrentChange(e,\"current\"===n),[4,zs(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,prebuilt_28889c43_f8ea673b_Qi(i.localStore,e,!0)];case 6:return u.sent(),Bs(i,e,r),[3,8];case 7:prebuilt_28889c43_f8ea673b_R(),u.label=8;case 8:return[2]}}))}))}function ru(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i,o,s,u,a,c,h,f;return Object(tslib_es6.__generator)(this,(function(d){switch(d.label){case 0:if(!(r=iu(t)).Oo)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?r.Vo.has(s=o[i])?(prebuilt_28889c43_f8ea673b_A(\"SyncEngine\",\"Adding an already active target \"+s),[3,5]):[4,prebuilt_28889c43_f8ea673b_Wi(r.localStore,s)]:[3,6];case 2:return u=d.sent(),[4,prebuilt_28889c43_f8ea673b_Gi(r.localStore,u)];case 3:return a=d.sent(),[4,xs(r,tu(u),a.targetId,!1)];case 4:d.sent(),prebuilt_28889c43_f8ea673b_Fo(r.remoteStore,a),d.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,prebuilt_28889c43_f8ea673b_Qi(r.localStore,t,!1).then((function(){Vo(r.remoteStore,t),Bs(r,t)})).catch(prebuilt_28889c43_f8ea673b_fi)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,f=n,d.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:d.sent(),d.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function iu(t){var e=prebuilt_28889c43_f8ea673b_L(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Os.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Hs.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ps.bind(null,e),e.vo._r=ys.bind(null,e.eventManager),e.vo.Mo=vs.bind(null,e.eventManager),e}function ou(t){var e=prebuilt_28889c43_f8ea673b_L(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ms.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Fs.bind(null,e),e}function su(t,e,n){var r=prebuilt_28889c43_f8ea673b_L(t);(function(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i,o,s,u,a;return Object(tslib_es6.__generator)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=c.sent(),[4,function(t,e){var n=prebuilt_28889c43_f8ea673b_L(t),r=prebuilt_28889c43_f8ea673b_In(e.createTime);return n.persistence.runTransaction(\"hasNewerBundle\",\"readonly\",(function(t){return n.Qe.getBundleMetadata(t,e.id)})).then((function(t){return!!t&&t.createTime.compareTo(r)>=0}))}(t.localStore,r)];case 2:return c.sent()?[4,e.close()]:[3,4];case 3:return[2,(c.sent(),void n._completeWith(function(t){return{taskState:\"Success\",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n._updateProgress(Ts(r)),i=new Is(r,t.localStore,e.R),[4,e.Lo()];case 5:o=c.sent(),c.label=6;case 6:return o?[4,i.oo(o)]:[3,10];case 7:return(s=c.sent())&&n._updateProgress(s),[4,e.Lo()];case 8:o=c.sent(),c.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return u=c.sent(),[4,zs(t,u.wn,void 0)];case 12:return c.sent(),[4,function(t,e){var n=prebuilt_28889c43_f8ea673b_L(t);return n.persistence.runTransaction(\"Save bundle\",\"readwrite\",(function(t){return n.Qe.saveBundleMetadata(t,e)}))}(t.localStore,r)];case 13:return c.sent(),n._completeWith(u.progress),[3,15];case 14:return prebuilt_28889c43_f8ea673b_x(\"SyncEngine\",\"Loading bundle failed with \"+(a=c.sent())),n._failWith(a),[3,15];case 15:return[2]}}))}))})(r,e,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var uu=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return this.R=prebuilt_28889c43_f8ea673b_Do(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return prebuilt_28889c43_f8ea673b_Fi(this.persistence,new prebuilt_28889c43_f8ea673b_Pi,t.initialUser,this.R)},t.prototype.qo=function(t){return new prebuilt_28889c43_f8ea673b_oo(prebuilt_28889c43_f8ea673b_uo.bs,this.R)},t.prototype.Bo=function(t){return new prebuilt_28889c43_f8ea673b_wo},t.prototype.terminate=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),au=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(tslib_es6.__extends)(e,t),e.prototype.initialize=function(e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,prebuilt_28889c43_f8ea673b_Yi(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,ou(this.Ko.syncEngine)];case 4:return n.sent(),[4,Xo(this.Ko.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Qo=function(t){return prebuilt_28889c43_f8ea673b_Fi(this.persistence,new prebuilt_28889c43_f8ea673b_Pi,t.initialUser,this.R)},e.prototype.Uo=function(t){return new prebuilt_28889c43_f8ea673b_pi(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue)},e.prototype.qo=function(t){var e=prebuilt_28889c43_f8ea673b_Ci(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?$r.withCacheSize(this.cacheSizeBytes):$r.DEFAULT;return new prebuilt_28889c43_f8ea673b_Ai(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,So(),No(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new prebuilt_28889c43_f8ea673b_wo},e}(uu),cu=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(tslib_es6.__extends)(e,t),e.prototype.initialize=function(e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof prebuilt_28889c43_f8ea673b_go?(this.sharedClientState.syncEngine={ai:Js.bind(null,n),ui:nu.bind(null,n),hi:ru.bind(null,n),fn:eu.bind(null,n),ci:Xs.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return Object(tslib_es6.__awaiter)(r,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return[4,$s(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=So();if(!prebuilt_28889c43_f8ea673b_go.yt(e))throw new prebuilt_28889c43_f8ea673b_S(_.UNIMPLEMENTED,\"IndexedDB persistence is only available on platforms that support LocalStorage.\");var n=prebuilt_28889c43_f8ea673b_Ci(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new prebuilt_28889c43_f8ea673b_go(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(au),hu=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n=this;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Ls(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Ws.bind(null,this.syncEngine),[4,rs(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new ls},t.prototype.createDatastore=function(t){var n=prebuilt_28889c43_f8ea673b_Do(t.databaseInfo.databaseId),r=new _o(t.databaseInfo);return function(t,e,n){return new Ro(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Ls(s.syncEngine,t,0)},o=prebuilt_28889c43_f8ea673b_Io.yt()?new prebuilt_28889c43_f8ea673b_Io:new prebuilt_28889c43_f8ea673b_bo,new Lo(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var u=new As(t,e,n,r,i,o);return s&&(u.Oo=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return e=prebuilt_28889c43_f8ea673b_L(t),prebuilt_28889c43_f8ea673b_A(\"RemoteStore\",\"RemoteStore shutting down.\"),e.$r.add(5),[4,Mo(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set(\"Unknown\"),[2]}}))}))}(this.remoteStore)},t}();function fu(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r;return Object(tslib_es6.__generator)(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject(\"unimplemented\")}}var lu=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error(\"Uncaught Error in snapshot listener:\",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),du=function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new mr,this.buffer=new Uint8Array,this.zo=new TextDecoder(\"utf-8\"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error(\"The first element of the bundle is not a metadata, it is\\n             \"+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo(\"length string (\"+e+\") is not valid number\"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new ws(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t===\"{\".charCodeAt(0)}))},t.prototype.Jo=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo(\"Reached the end of bundle when a length string is expected.\"),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo(\"Reached the end of bundle when more is expected.\"),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error(\"Invalid bundle format: \"+t)},t.prototype.tc=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),pu=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Firestore transactions require all reads to be executed before all writes.\");return[4,function(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s,u;return Object(tslib_es6.__generator)(this,(function(a){switch(a.label){case 0:return n=prebuilt_28889c43_f8ea673b_L(t),r=prebuilt_28889c43_f8ea673b_An(n.R)+\"/documents\",i={documents:e.map((function(t){return _n(n.R,t)}))},[4,n.Oi(\"BatchGetDocuments\",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return\"found\"in e?function(t,e){prebuilt_28889c43_f8ea673b_O(!!e.found);var n=prebuilt_28889c43_f8ea673b_Sn(t,e.found.name),r=prebuilt_28889c43_f8ea673b_In(e.found.updateTime),i=new It({mapValue:{fields:e.found.fields}});return Et.newFoundDocument(n,r,i)}(t,e):\"missing\"in e?function(t,e){prebuilt_28889c43_f8ea673b_O(!!e.missing),prebuilt_28889c43_f8ea673b_O(!!e.readTime);var n=prebuilt_28889c43_f8ea673b_Sn(t,e.missing),r=prebuilt_28889c43_f8ea673b_In(e.readTime);return Et.newNoDocument(n,r)}(t,e):prebuilt_28889c43_f8ea673b_R()}(n.R,t);s.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=s.get(t.toString());prebuilt_28889c43_f8ea673b_O(!!e),u.push(e)})),u)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new prebuilt_28889c43_f8ea673b_qe(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=ut.fromPath(n);e.mutations.push(new prebuilt_28889c43_f8ea673b_Ue(r,e.precondition(r)))})),[4,function(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return n=prebuilt_28889c43_f8ea673b_L(t),r=prebuilt_28889c43_f8ea673b_An(n.R)+\"/documents\",i={writes:e.map((function(t){return prebuilt_28889c43_f8ea673b_Rn(n.R,t)}))},[4,n.Ni(\"Commit\",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw prebuilt_28889c43_f8ea673b_R();e=B.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new prebuilt_28889c43_f8ea673b_S(_.ABORTED,\"Document version changed between two reads.\")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?_e.updateTime(e):_e.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(B.min()))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Can't update a document that doesn't exist.\");return _e.updateTime(e)}return _e.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),yu=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new prebuilt_28889c43_f8ea673b_Ao(this.asyncQueue,\"transaction_retry\")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return Object(tslib_es6.__awaiter)(t,void 0,void 0,(function(){var t,e,n=this;return Object(tslib_es6.__generator)(this,(function(r){return t=new pu(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!it(e)&&e.catch&&e.then?e:(this.deferred.reject(Error(\"Transaction callback must return a Promise\")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if(\"FirebaseError\"===t.name){var e=t.code;return\"aborted\"===e||\"failed-precondition\"===e||!prebuilt_28889c43_f8ea673b_je(e)}return!1},t}(),vu=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=prebuilt_28889c43_f8ea673b_ao.UNAUTHENTICATED,this.clientId=prebuilt_28889c43_f8ea673b_M.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return Object(tslib_es6.__awaiter)(r,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return prebuilt_28889c43_f8ea673b_A(\"FirestoreClient\",\"Received user=\",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,\"The client has already been terminated.\")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new mr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Object(tslib_es6.__awaiter)(t,void 0,void 0,(function(){var t,n;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=us(t,\"Failed to shutdown persistence\"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function mu(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r,i=this;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),prebuilt_28889c43_f8ea673b_A(\"FirestoreClient\",\"Initializing OfflineComponentProvider\"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return Object(tslib_es6.__awaiter)(i,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,prebuilt_28889c43_f8ea673b_Vi(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function gu(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,wu(t)];case 1:return n=i.sent(),prebuilt_28889c43_f8ea673b_A(\"FirestoreClient\",\"Initializing OnlineComponentProvider\"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return(n=prebuilt_28889c43_f8ea673b_L(t)).asyncQueue.verifyOperationInProgress(),prebuilt_28889c43_f8ea673b_A(\"RemoteStore\",\"RemoteStore received new credentials\"),r=prebuilt_28889c43_f8ea673b_Ko(n),n.$r.add(3),[4,Mo(n)];case 1:return i.sent(),r&&n.Br.set(\"Unknown\"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.$r.delete(3),[4,Po(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function wu(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(prebuilt_28889c43_f8ea673b_A(\"FirestoreClient\",\"Using default OfflineComponentProvider\"),[4,mu(t,new uu)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function bu(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(prebuilt_28889c43_f8ea673b_A(\"FirestoreClient\",\"Using default OnlineComponentProvider\"),[4,gu(t,new hu)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Iu(t){return wu(t).then((function(t){return t.persistence}))}function Tu(t){return wu(t).then((function(t){return t.localStore}))}function Eu(t){return bu(t).then((function(t){return t.remoteStore}))}function _u(t){return bu(t).then((function(t){return t.syncEngine}))}function Su(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:return[4,bu(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=ks.bind(null,e.syncEngine),n.onUnlisten=Cs.bind(null,e.syncEngine),n)]}}))}))}function Nu(t,e,n){var r=this;void 0===n&&(n={});var i=new mr;return t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(r,void 0,void 0,(function(){var r;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new lu({next:function(o){e.enqueueAndForget((function(){return ps(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new prebuilt_28889c43_f8ea673b_S(_.UNAVAILABLE,\"Failed to get document because the client is offline.\")):u&&o.fromCache&&r&&\"server\"===r.source?i.reject(new prebuilt_28889c43_f8ea673b_S(_.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to \"server\" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new gs(zt(n.path),o,{includeMetadataChanges:!0,so:!0});return ds(t,s)},[4,Su(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Du(t,e,n){var r=this;void 0===n&&(n={});var i=new mr;return t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(r,void 0,void 0,(function(){var r;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new lu({next:function(n){e.enqueueAndForget((function(){return ps(t,s)})),n.fromCache&&\"server\"===r.source?i.reject(new prebuilt_28889c43_f8ea673b_S(_.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to \"server\" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new gs(n,o,{includeMetadataChanges:!0,so:!0});return ds(t,s)},[4,Su(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Au=function(t,e,n,r,i,o,s){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s},ku=function(){function t(t,e){this.projectId=t,this.database=e||\"(default)\"}return Object.defineProperty(t.prototype,\"isDefaultDatabase\",{get:function(){return\"(default)\"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),xu=new Map,Cu=function(t,e){this.user=e,this.type=\"OAuth\",this.authHeaders={},this.authHeaders.Authorization=\"Bearer \"+t},Ru=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(prebuilt_28889c43_f8ea673b_ao.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Ou=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Lu=function(){function t(t){var e=this;this.currentUser=prebuilt_28889c43_f8ea673b_ao.UNAUTHENTICATED,this.oc=new mr,this.cc=0,this.changeListener=function(){return Promise.resolve()},this.ac=!1,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.hc(),e.oc.resolve(),e.ac&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){prebuilt_28889c43_f8ea673b_A(\"FirebaseCredentialsProvider\",\"Auth detected\"),e.auth=t,e.lc(),e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):e.ac&&(prebuilt_28889c43_f8ea673b_A(\"FirebaseCredentialsProvider\",\"Auth not yet detected\"),e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)})))}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(prebuilt_28889c43_f8ea673b_A(\"FirebaseCredentialsProvider\",\"getToken aborted due to token change.\"),t.getToken()):n?(prebuilt_28889c43_f8ea673b_O(\"string\"==typeof n.accessToken),new Cu(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){this.ac=!0,this.asyncQueue=t,this.changeListener=e},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.hc=function(){var t=this.auth&&this.auth.getUid();return prebuilt_28889c43_f8ea673b_O(null===t||\"string\"==typeof t),new prebuilt_28889c43_f8ea673b_ao(t)},t.prototype.lc=function(){var t=this;this.ac&&(this.ac=!1,this.asyncQueue.enqueueRetryable((function(){return Object(tslib_es6.__awaiter)(t,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,this.changeListener(this.currentUser)];case 2:return t.sent(),this.ac=!0,[2]}}))}))})))},t}(),Pu=function(){function t(t,e,n){this.fc=t,this.dc=e,this.wc=n,this.type=\"FirstParty\",this.user=prebuilt_28889c43_f8ea673b_ao.FIRST_PARTY}return Object.defineProperty(t.prototype,\"authHeaders\",{get:function(){var t={\"X-Goog-AuthUser\":this.dc},e=this.fc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.wc&&(t[\"X-Goog-Iam-Authorization-Token\"]=this.wc),t},enumerable:!1,configurable:!0}),t}(),Mu=function(){function t(t,e,n){this.fc=t,this.dc=e,this.wc=n}return t.prototype.getToken=function(){return Promise.resolve(new Pu(this.fc,this.dc,this.wc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(prebuilt_28889c43_f8ea673b_ao.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Fu(t,e,n){if(!n)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Function \"+t+\"() cannot be called with an empty \"+e+\".\")}function Vu(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid options passed to function \"+t+'(): You cannot specify both \"merge\" and \"mergeFields\".');return e}function qu(t,e,n,r){if(!0===e&&!0===r)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,t+\" and \"+n+\" cannot be used together.\")}function Uu(t){if(!ut.isDocumentKey(t))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid document reference. Document references must have an even number of segments, but \"+t+\" has \"+t.length+\".\")}function Bu(t){if(ut.isDocumentKey(t))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid collection reference. Collection references must have an odd number of segments, but \"+t+\" has \"+t.length+\".\")}function ju(t){if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"string\"==typeof t)return t.length>20&&(t=t.substring(0,20)+\"...\"),JSON.stringify(t);if(\"number\"==typeof t||\"boolean\"==typeof t)return\"\"+t;if(\"object\"==typeof t){if(t instanceof Array)return\"an array\";var e=function(t){if(t.constructor){var e=/function\\s+([^\\s(]+)\\s*\\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?\"a custom \"+e+\" object\":\"an object\"}return\"function\"==typeof t?\"a function\":prebuilt_28889c43_f8ea673b_R()}function Ku(t,e){if(\"_delegate\"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?\");var n=ju(t);throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Expected type '\"+e.name+\"', but it was: \"+n)}return t}function Gu(t,e){if(e<=0)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Function \"+t+\"() requires a positive number, but it was: \"+e+\".\")}var Qu=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Can't provide ssl option if host option is not set\");this.host=\"firestore.googleapis.com\",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"cacheSizeBytes must be at least 1048576\");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,qu(\"experimentalForceLongPolling\",t.experimentalForceLongPolling,\"experimentalAutoDetectLongPolling\",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),zu=function(){function t(t,e){this.type=\"firestore-lite\",this._persistenceKey=\"(lite)\",this._settings=new Qu({}),this._settingsFrozen=!1,t instanceof ku?(this._databaseId=t,this._credentials=new Ru):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,[\"projectId\"]))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,'\"projectId\" not provided in firebase.initializeApp.');return new ku(t.options.projectId)}(t),this._credentials=new Lu(e))}return Object.defineProperty(t.prototype,\"app\",{get:function(){if(!this._app)throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,\"Firestore was not initialized using the Firebase SDK. 'app' is not available\");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"_initialized\",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"_terminated\",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,\"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.\");this._settings=new Qu(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Ru;switch(t.type){case\"gapi\":var e=t.client;return prebuilt_28889c43_f8ea673b_O(!(\"object\"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Mu(e,t.sessionIndex||\"0\",t.iamToken||null);case\"provider\":return t.client;default:throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"makeCredentialsProvider failed due to invalid credential type\")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(e=xu.get(this))&&(prebuilt_28889c43_f8ea673b_A(\"ComponentProvider\",\"Removing Datastore\"),xu.delete(this),e.terminate()),Promise.resolve();var e},t}(),Wu=function(){function t(t,e,n){this.converter=e,this._key=n,this.type=\"document\",this.firestore=t}return Object.defineProperty(t.prototype,\"_path\",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"id\",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"path\",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"parent\",{get:function(){return new Yu(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Hu=function(){function t(t,e,n){this.converter=e,this._query=n,this.type=\"query\",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Yu=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,zt(r))||this)._path=r,i.type=\"collection\",i}return Object(tslib_es6.__extends)(e,t),Object.defineProperty(e.prototype,\"id\",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"path\",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"parent\",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Wu(this.firestore,null,new ut(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Hu);function Xu(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(util_dist_index_esm.getModularInstance)(t),Fu(\"collection\",\"path\",e),t instanceof zu)return Bu(n=prebuilt_28889c43_f8ea673b_z.fromString.apply(prebuilt_28889c43_f8ea673b_z,Object(tslib_es6.__spreadArray)([e],r))),new Yu(t,null,n);if(!(t instanceof Wu||t instanceof Yu))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore\");return Bu(n=prebuilt_28889c43_f8ea673b_z.fromString.apply(prebuilt_28889c43_f8ea673b_z,Object(tslib_es6.__spreadArray)([t.path],r)).child(prebuilt_28889c43_f8ea673b_z.fromString(e))),new Yu(t.firestore,null,n)}function Ju(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(util_dist_index_esm.getModularInstance)(t),1===arguments.length&&(e=prebuilt_28889c43_f8ea673b_M.u()),Fu(\"doc\",\"path\",e),t instanceof zu)return Uu(n=prebuilt_28889c43_f8ea673b_z.fromString.apply(prebuilt_28889c43_f8ea673b_z,Object(tslib_es6.__spreadArray)([e],r))),new Wu(t,null,new ut(n));if(!(t instanceof Wu||t instanceof Yu))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore\");return Uu(n=t._path.child(prebuilt_28889c43_f8ea673b_z.fromString.apply(prebuilt_28889c43_f8ea673b_z,Object(tslib_es6.__spreadArray)([e],r)))),new Wu(t.firestore,t instanceof Yu?t.converter:null,new ut(n))}function $u(t,e){return t=Object(util_dist_index_esm.getModularInstance)(t),e=Object(util_dist_index_esm.getModularInstance)(e),(t instanceof Wu||t instanceof Yu)&&(e instanceof Wu||e instanceof Yu)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Zu(t,e){return t=Object(util_dist_index_esm.getModularInstance)(t),e=Object(util_dist_index_esm.getModularInstance)(e),t instanceof Hu&&e instanceof Hu&&t.firestore===e.firestore&&prebuilt_28889c43_f8ea673b_ee(t._query,e._query)&&t.converter===e.converter}var prebuilt_28889c43_f8ea673b_ta=function(){function t(){var t=this;this._c=Promise.resolve(),this.mc=[],this.yc=!1,this.gc=[],this.Ec=null,this.Tc=!1,this.Ic=[],this.Zi=new prebuilt_28889c43_f8ea673b_Ao(this,\"async_queue_retry\"),this.Ac=function(){var e=No();e&&prebuilt_28889c43_f8ea673b_A(\"AsyncQueue\",\"Visibility state changed to \"+e.visibilityState),t.Zi.Gi()};var e=No();e&&\"function\"==typeof e.addEventListener&&e.addEventListener(\"visibilitychange\",this.Ac)}return Object.defineProperty(t.prototype,\"isShuttingDown\",{get:function(){return this.yc},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Rc(),this.bc(t)},t.prototype.enterRestrictedMode=function(){if(!this.yc){this.yc=!0;var t=No();t&&\"function\"==typeof t.removeEventListener&&t.removeEventListener(\"visibilitychange\",this.Ac)}},t.prototype.enqueue=function(t){return this.Rc(),this.yc?new Promise((function(t){})):this.bc(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.mc.push(t),e.vc()}))},t.prototype.vc=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:if(0===this.mc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.mc[0]()];case 2:return n.sent(),this.mc.shift(),this.Zi.reset(),[3,4];case 3:if(!Er(t=n.sent()))throw t;return prebuilt_28889c43_f8ea673b_A(\"AsyncQueue\",\"Operation failed with retryable error: \"+t),[3,4];case 4:this.mc.length>0&&this.Zi.ji((function(){return e.vc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.bc=function(t){var e=this,n=this._c.then((function(){return e.Tc=!0,t().catch((function(t){throw e.Ec=t,e.Tc=!1,prebuilt_28889c43_f8ea673b_k(\"INTERNAL UNHANDLED ERROR: \",function(t){var e=t.message||\"\";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+\"\\n\"+t.stack),e}(t)),t})).then((function(t){return e.Tc=!1,t}))}));return this._c=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Rc(),this.Ic.indexOf(t)>-1&&(e=0);var i=ss.createAndSchedule(this,t,e,n,(function(t){return r.Pc(t)}));return this.gc.push(i),i},t.prototype.Rc=function(){this.Ec&&prebuilt_28889c43_f8ea673b_R()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Vc=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var t;return Object(tslib_es6.__generator)(this,(function(e){switch(e.label){case 0:return[4,t=this._c];case 1:e.sent(),e.label=2;case 2:if(t!==this._c)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Sc=function(t){for(var e=0,n=this.gc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Dc=function(t){var e=this;return this.Vc().then((function(){e.gc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.gc;n<r.length;n++){var i=r[n];if(i.skipDelay(),\"all\"!==t&&i.timerId===t)break}return e.Vc()}))},t.prototype.Cc=function(t){this.Ic.push(t)},t.prototype.Pc=function(t){var e=this.gc.indexOf(t);this.gc.splice(e,1)},t}();function prebuilt_28889c43_f8ea673b_ea(t){return function(t,e){if(\"object\"!=typeof t||null===t)return!1;for(var n=t,r=0,i=[\"next\",\"error\",\"complete\"];r<i.length;r++){var o=i[r];if(o in n&&\"function\"==typeof n[o])return!0}return!1}(t)}var prebuilt_28889c43_f8ea673b_na=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new mr,this._lastProgress={taskState:\"Running\",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState=\"Error\",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),prebuilt_28889c43_f8ea673b_ia=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type=\"firestore\",r._queue=new prebuilt_28889c43_f8ea673b_ta,r._persistenceKey=\"name\"in e?e.name:\"[DEFAULT]\",r}return Object(tslib_es6.__extends)(e,t),e.prototype._terminate=function(){return this._firestoreClient||prebuilt_28889c43_f8ea673b_sa(this),this._firestoreClient.terminate()},e}(zu);function prebuilt_28889c43_f8ea673b_oa(t){return t._firestoreClient||prebuilt_28889c43_f8ea673b_sa(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function prebuilt_28889c43_f8ea673b_sa(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Au(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||\"\",t._persistenceKey,n);t._firestoreClient=new vu(t._credentials,t._queue,r)}function prebuilt_28889c43_f8ea673b_ua(t,e,n){var r=this,i=new mr;return t.asyncQueue.enqueue((function(){return Object(tslib_es6.__awaiter)(r,void 0,void 0,(function(){var r;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,mu(t,n)];case 1:return o.sent(),[4,gu(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return\"FirebaseError\"===t.name?t.code===_.FAILED_PRECONDITION||t.code===_.UNIMPLEMENTED:!(\"undefined\"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn(\"Error enabling offline persistence. Falling back to persistence disabled: \"+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function prebuilt_28889c43_f8ea673b_aa(t){if(t._initialized||t._terminated)throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,\"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.\")}var prebuilt_28889c43_f8ea673b_ca=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid field name at argument $(i + 1). Field names must not be empty.\");this._internalPath=new prebuilt_28889c43_f8ea673b_H(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),prebuilt_28889c43_f8ea673b_ha=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(prebuilt_28889c43_f8ea673b_X.fromBase64String(e))}catch(e){throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Failed to construct data from Base64 string: \"+e)}},t.fromUint8Array=function(e){return new t(prebuilt_28889c43_f8ea673b_X.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return\"Bytes(base64: \"+this.toBase64()+\")\"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),prebuilt_28889c43_f8ea673b_fa=function(t){this._methodName=t},prebuilt_28889c43_f8ea673b_la=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Latitude must be a number between -90 and 90, but was: \"+t);if(!isFinite(e)||e<-180||e>180)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Longitude must be a number between -180 and 180, but was: \"+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,\"latitude\",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"longitude\",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return prebuilt_28889c43_f8ea673b_F(this._lat,t._lat)||prebuilt_28889c43_f8ea673b_F(this._long,t._long)},t}(),prebuilt_28889c43_f8ea673b_da=/^__.*__$/,prebuilt_28889c43_f8ea673b_pa=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new prebuilt_28889c43_f8ea673b_Oe(t,this.data,this.fieldMask,e,this.fieldTransforms):new prebuilt_28889c43_f8ea673b_Re(t,this.data,e,this.fieldTransforms)},t}(),ya=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new prebuilt_28889c43_f8ea673b_Oe(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function prebuilt_28889c43_f8ea673b_va(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw prebuilt_28889c43_f8ea673b_R()}}var prebuilt_28889c43_f8ea673b_ma=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,\"path\",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"xc\",{get:function(){return this.settings.xc},enumerable:!1,configurable:!0}),t.prototype.Fc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Fc({path:n,Oc:!1});return r.$c(t),r},t.prototype.Mc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Fc({path:n,Oc:!1});return r.Nc(),r},t.prototype.Lc=function(t){return this.Fc({path:void 0,Oc:!0})},t.prototype.Bc=function(t){return prebuilt_28889c43_f8ea673b_Fa(t,this.settings.methodName,this.settings.qc||!1,this.path,this.settings.Uc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Nc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Bc(\"Document fields must not be empty\");if(prebuilt_28889c43_f8ea673b_va(this.xc)&&prebuilt_28889c43_f8ea673b_da.test(t))throw this.Bc('Document fields cannot begin and end with \"__\"')},t}(),ga=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||prebuilt_28889c43_f8ea673b_Do(t)}return t.prototype.Qc=function(t,e,n,r){return void 0===r&&(r=!1),new prebuilt_28889c43_f8ea673b_ma({xc:t,methodName:e,Uc:n,path:prebuilt_28889c43_f8ea673b_H.emptyPath(),Oc:!1,qc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function prebuilt_28889c43_f8ea673b_wa(t){var e=t._freezeSettings(),n=prebuilt_28889c43_f8ea673b_Do(t._databaseId);return new ga(t._databaseId,!!e.ignoreUndefinedProperties,n)}function prebuilt_28889c43_f8ea673b_ba(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Qc(o.merge||o.mergeFields?2:0,e,n,i);prebuilt_28889c43_f8ea673b_Oa(\"Data must be an object, but it was:\",s,r);var u,a,c=prebuilt_28889c43_f8ea673b_Ca(r,s);if(o.merge)u=new prebuilt_28889c43_f8ea673b_Y(s.fieldMask),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var d=prebuilt_28889c43_f8ea673b_La(e,l[f],n);if(!s.contains(d))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Field '\"+d+\"' is specified in your field mask but missing from your input data.\");prebuilt_28889c43_f8ea673b_Va(h,d)||h.push(d)}u=new prebuilt_28889c43_f8ea673b_Y(h),a=s.fieldTransforms.filter((function(t){return u.covers(t.field)}))}else u=null,a=s.fieldTransforms;return new prebuilt_28889c43_f8ea673b_pa(new It(c),u,a)}var prebuilt_28889c43_f8ea673b_Ia=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(tslib_es6.__extends)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.xc)throw t.Bc(1===t.xc?this._methodName+\"() can only appear at the top level of your update data\":this._methodName+\"() cannot be used with set() unless you pass {merge:true}\");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(prebuilt_28889c43_f8ea673b_fa);function prebuilt_28889c43_f8ea673b_Ta(t,e,n){return new prebuilt_28889c43_f8ea673b_ma({xc:3,Uc:e.settings.Uc,methodName:t._methodName,Oc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var prebuilt_28889c43_f8ea673b_Ea=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(tslib_es6.__extends)(e,t),e.prototype._toFieldTransform=function(t){return new prebuilt_28889c43_f8ea673b_Te(t.path,new prebuilt_28889c43_f8ea673b_pe)},e.prototype.isEqual=function(t){return t instanceof e},e}(prebuilt_28889c43_f8ea673b_fa),prebuilt_28889c43_f8ea673b_a=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Object(tslib_es6.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=prebuilt_28889c43_f8ea673b_Ta(this,t,!0),n=this.Kc.map((function(t){return prebuilt_28889c43_f8ea673b_xa(t,e)})),r=new prebuilt_28889c43_f8ea673b_ye(n);return new prebuilt_28889c43_f8ea673b_Te(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(prebuilt_28889c43_f8ea673b_fa),prebuilt_28889c43_f8ea673b_Sa=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Object(tslib_es6.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=prebuilt_28889c43_f8ea673b_Ta(this,t,!0),n=this.Kc.map((function(t){return prebuilt_28889c43_f8ea673b_xa(t,e)})),r=new prebuilt_28889c43_f8ea673b_me(n);return new prebuilt_28889c43_f8ea673b_Te(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(prebuilt_28889c43_f8ea673b_fa),prebuilt_28889c43_f8ea673b_Na=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).jc=n,r}return Object(tslib_es6.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=new prebuilt_28889c43_f8ea673b_we(t.R,prebuilt_28889c43_f8ea673b_ce(t.R,this.jc));return new prebuilt_28889c43_f8ea673b_Te(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(prebuilt_28889c43_f8ea673b_fa);function prebuilt_28889c43_f8ea673b_Da(t,e,n,r){var i=t.Qc(1,e,n);prebuilt_28889c43_f8ea673b_Oa(\"Data must be an object, but it was:\",i,r);var o=[],s=It.empty();prebuilt_28889c43_f8ea673b_K(r,(function(t,r){var a=prebuilt_28889c43_f8ea673b_Ma(e,t,n);r=Object(util_dist_index_esm.getModularInstance)(r);var c=i.Mc(a);if(r instanceof prebuilt_28889c43_f8ea673b_Ia)o.push(a);else{var h=prebuilt_28889c43_f8ea673b_xa(r,c);null!=h&&(o.push(a),s.set(a,h))}}));var a=new prebuilt_28889c43_f8ea673b_Y(o);return new ya(s,a,i.fieldTransforms)}function prebuilt_28889c43_f8ea673b_Aa(t,e,n,r,i,o){var s=t.Qc(1,e,n),a=[prebuilt_28889c43_f8ea673b_La(e,r,n)],c=[i];if(o.length%2!=0)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Function \"+e+\"() needs to be called with an even number of arguments that alternate between field names and values.\");for(var h=0;h<o.length;h+=2)a.push(prebuilt_28889c43_f8ea673b_La(e,o[h])),c.push(o[h+1]);for(var f=[],l=It.empty(),d=a.length-1;d>=0;--d)if(!prebuilt_28889c43_f8ea673b_Va(f,a[d])){var p=a[d],y=c[d];y=Object(util_dist_index_esm.getModularInstance)(y);var v=s.Mc(p);if(y instanceof prebuilt_28889c43_f8ea673b_Ia)f.push(p);else{var m=prebuilt_28889c43_f8ea673b_xa(y,v);null!=m&&(f.push(p),l.set(p,m))}}var g=new prebuilt_28889c43_f8ea673b_Y(f);return new ya(l,g,s.fieldTransforms)}function prebuilt_28889c43_f8ea673b_ka(t,e,n,r){return void 0===r&&(r=!1),prebuilt_28889c43_f8ea673b_xa(n,t.Qc(r?4:3,e))}function prebuilt_28889c43_f8ea673b_xa(t,e){if(prebuilt_28889c43_f8ea673b_Ra(t=Object(util_dist_index_esm.getModularInstance)(t)))return prebuilt_28889c43_f8ea673b_Oa(\"Unsupported field value:\",e,t),prebuilt_28889c43_f8ea673b_Ca(t,e);if(t instanceof prebuilt_28889c43_f8ea673b_fa)return function(t,e){if(!prebuilt_28889c43_f8ea673b_va(e.xc))throw e.Bc(t._methodName+\"() can only be used with update() and set()\");if(!e.path)throw e.Bc(t._methodName+\"() is not currently supported inside arrays\");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Oc&&4!==e.xc)throw e.Bc(\"Nested arrays are not supported\");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=prebuilt_28889c43_f8ea673b_xa(o[i],e.Lc(r));null==s&&(s={nullValue:\"NULL_VALUE\"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(util_dist_index_esm.getModularInstance)(t)))return{nullValue:\"NULL_VALUE\"};if(\"number\"==typeof t)return prebuilt_28889c43_f8ea673b_ce(e.R,t);if(\"boolean\"==typeof t)return{booleanValue:t};if(\"string\"==typeof t)return{stringValue:t};if(t instanceof Date){var n=prebuilt_28889c43_f8ea673b_U.fromDate(t);return{timestampValue:prebuilt_28889c43_f8ea673b_gn(e.R,n)}}if(t instanceof prebuilt_28889c43_f8ea673b_U)return n=new prebuilt_28889c43_f8ea673b_U(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:prebuilt_28889c43_f8ea673b_gn(e.R,n)};if(t instanceof prebuilt_28889c43_f8ea673b_la)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof prebuilt_28889c43_f8ea673b_ha)return{bytesValue:prebuilt_28889c43_f8ea673b_wn(e.R,t._byteString)};if(t instanceof Wu){var r=t.firestore._databaseId;if(!r.isEqual(n=e.databaseId))throw e.Bc(\"Document reference is for database \"+r.projectId+\"/\"+r.database+\" but should be for database \"+n.projectId+\"/\"+n.database);return{referenceValue:prebuilt_28889c43_f8ea673b_Tn(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Bc(\"Unsupported field value: \"+ju(t))}(t,e)}function prebuilt_28889c43_f8ea673b_Ca(t,e){var n={};return prebuilt_28889c43_f8ea673b_G(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):prebuilt_28889c43_f8ea673b_K(t,(function(t,r){var i=prebuilt_28889c43_f8ea673b_xa(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function prebuilt_28889c43_f8ea673b_Ra(t){return!(\"object\"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof prebuilt_28889c43_f8ea673b_U||t instanceof prebuilt_28889c43_f8ea673b_la||t instanceof prebuilt_28889c43_f8ea673b_ha||t instanceof Wu||t instanceof prebuilt_28889c43_f8ea673b_fa)}function prebuilt_28889c43_f8ea673b_Oa(t,e,n){if(!prebuilt_28889c43_f8ea673b_Ra(n)||!function(t){return\"object\"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=ju(n);throw e.Bc(\"an object\"===r?t+\" a custom object\":t+\" \"+r)}}function prebuilt_28889c43_f8ea673b_La(t,e,n){if((e=Object(util_dist_index_esm.getModularInstance)(e))instanceof prebuilt_28889c43_f8ea673b_ca)return e._internalPath;if(\"string\"==typeof e)return prebuilt_28889c43_f8ea673b_Ma(t,e);throw prebuilt_28889c43_f8ea673b_Fa(\"Field path arguments must be of type string or FieldPath.\",t,!1,void 0,n)}var prebuilt_28889c43_f8ea673b_Pa=new RegExp(\"[~\\\\*/\\\\[\\\\]]\");function prebuilt_28889c43_f8ea673b_Ma(t,e,n){if(e.search(prebuilt_28889c43_f8ea673b_Pa)>=0)throw prebuilt_28889c43_f8ea673b_Fa(\"Invalid field path (\"+e+\"). Paths must not contain '~', '*', '/', '[', or ']'\",t,!1,void 0,n);try{return(new(prebuilt_28889c43_f8ea673b_ca.bind.apply(prebuilt_28889c43_f8ea673b_ca,Object(tslib_es6.__spreadArray)([void 0],e.split(\".\")))))._internalPath}catch(r){throw prebuilt_28889c43_f8ea673b_Fa(\"Invalid field path (\"+e+\"). Paths must not be empty, begin with '.', end with '.', or contain '..'\",t,!1,void 0,n)}}function prebuilt_28889c43_f8ea673b_Fa(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,u=\"Function \"+e+\"() called with invalid data\";n&&(u+=\" (via `toFirestore()`)\");var a=\"\";return(o||s)&&(a+=\" (found\",o&&(a+=\" in field \"+r),s&&(a+=\" in document \"+i),a+=\")\"),new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,(u+=\". \")+t+a)}function prebuilt_28889c43_f8ea673b_Va(t,e){return t.some((function(t){return t.isEqual(e)}))}var prebuilt_28889c43_f8ea673b_qa=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,\"id\",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"ref\",{get:function(){return new Wu(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new prebuilt_28889c43_f8ea673b_Ua(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.toProto())}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(prebuilt_28889c43_f8ea673b_Ba(\"DocumentSnapshot.get\",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),prebuilt_28889c43_f8ea673b_Ua=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(tslib_es6.__extends)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(prebuilt_28889c43_f8ea673b_qa);function prebuilt_28889c43_f8ea673b_Ba(t,e){return\"string\"==typeof e?prebuilt_28889c43_f8ea673b_Ma(t,e):e instanceof prebuilt_28889c43_f8ea673b_ca?e._internalPath:e._delegate._internalPath}var prebuilt_28889c43_f8ea673b_ja=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),prebuilt_28889c43_f8ea673b_Ka=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this)._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return Object(tslib_es6.__extends)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new prebuilt_28889c43_f8ea673b_Ga(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.toProto(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(prebuilt_28889c43_f8ea673b_Ba(\"DocumentSnapshot.get\",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(prebuilt_28889c43_f8ea673b_qa),prebuilt_28889c43_f8ea673b_Ga=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(tslib_es6.__extends)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(prebuilt_28889c43_f8ea673b_Ka),prebuilt_28889c43_f8ea673b_Qa=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new prebuilt_28889c43_f8ea673b_ja(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,\"docs\",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"size\",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"empty\",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new prebuilt_28889c43_f8ea673b_Ga(n._firestore,n._userDataWriter,r.key,r,new prebuilt_28889c43_f8ea673b_ja(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().\");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:\"added\",doc:new prebuilt_28889c43_f8ea673b_Ga(t._firestore,t._userDataWriter,e.doc.key,e.doc,new prebuilt_28889c43_f8ea673b_ja(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new prebuilt_28889c43_f8ea673b_Ga(t._firestore,t._userDataWriter,e.doc.key,e.doc,new prebuilt_28889c43_f8ea673b_ja(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:prebuilt_28889c43_f8ea673b_za(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function prebuilt_28889c43_f8ea673b_za(t){switch(t){case 0:return\"added\";case 2:case 3:return\"modified\";case 1:return\"removed\";default:return prebuilt_28889c43_f8ea673b_R()}}function prebuilt_28889c43_f8ea673b_Wa(t,e){return t instanceof prebuilt_28889c43_f8ea673b_Ka&&e instanceof prebuilt_28889c43_f8ea673b_Ka?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof prebuilt_28889c43_f8ea673b_Qa&&e instanceof prebuilt_28889c43_f8ea673b_Qa&&t._firestore===e._firestore&&Zu(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function prebuilt_28889c43_f8ea673b_Ha(t){if(Ht(t)&&0===t.explicitOrderBy.length)throw new prebuilt_28889c43_f8ea673b_S(_.UNIMPLEMENTED,\"limitToLast() queries require specifying at least one orderBy() clause\")}var prebuilt_28889c43_f8ea673b_Ya=function(){};function prebuilt_28889c43_f8ea673b_Xa(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var prebuilt_28889c43_f8ea673b_Ja=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Wc=e,i.Gc=n,i.zc=r,i.type=\"where\",i}return Object(tslib_es6.__extends)(e,t),e.prototype._apply=function(t){var e=prebuilt_28889c43_f8ea673b_wa(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.isKeyField()){if(\"array-contains\"===o||\"array-contains-any\"===o)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid Query. You can't perform '\"+o+\"' queries on FieldPath.documentId().\");if(\"in\"===o||\"not-in\"===o){prebuilt_28889c43_f8ea673b_ic(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(prebuilt_28889c43_f8ea673b_rc(r,t,h[c]));u={arrayValue:{values:a}}}else u=prebuilt_28889c43_f8ea673b_rc(r,t,s)}else\"in\"!==o&&\"not-in\"!==o&&\"array-contains-any\"!==o||prebuilt_28889c43_f8ea673b_ic(s,o),u=prebuilt_28889c43_f8ea673b_ka(n,\"where\",s,\"in\"===o||\"not-in\"===o);var l=kt.create(i,o,u);return function(t,e){if(e.g()){var n=Xt(t);if(null!==n&&!n.isEqual(e.field))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '\"+n.toString()+\"' and '\"+e.field.toString()+\"'\");var r=Yt(t);null!==r&&prebuilt_28889c43_f8ea673b_oc(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case\"!=\":return[\"!=\",\"not-in\"];case\"array-contains\":return[\"array-contains\",\"array-contains-any\",\"not-in\"];case\"in\":return[\"array-contains-any\",\"in\",\"not-in\"];case\"array-contains-any\":return[\"array-contains\",\"array-contains-any\",\"in\",\"not-in\"];case\"not-in\":return[\"array-contains\",\"array-contains-any\",\"in\",\"not-in\",\"!=\"];default:return[]}}(e.op));if(null!==i)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,i===e.op?\"Invalid query. You cannot use more than one '\"+e.op.toString()+\"' filter.\":\"Invalid query. You cannot use '\"+e.op.toString()+\"' filters with '\"+i.toString()+\"' filters.\")}(t,l),l}(t._query,0,e,t.firestore._databaseId,this.Wc,this.Gc,this.zc);return new Hu(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Gt(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(prebuilt_28889c43_f8ea673b_Ya),prebuilt_28889c43_f8ea673b_$a=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Wc=e,r.Hc=n,r.type=\"orderBy\",r}return Object(tslib_es6.__extends)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. You must not call startAt() or startAfter() before calling orderBy().\");if(null!==t.endAt)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. You must not call endAt() or endBefore() before calling orderBy().\");var r=new Ut(e,n);return function(t,e){if(null===Yt(t)){var n=Xt(t);null!==n&&prebuilt_28889c43_f8ea673b_oc(0,n,e.field)}}(t,r),r}(t._query,this.Wc,this.Hc);return new Hu(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Gt(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(prebuilt_28889c43_f8ea673b_Ya),prebuilt_28889c43_f8ea673b_Za=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(tslib_es6.__extends)(e,t),e.prototype._apply=function(t){return new Hu(t.firestore,t.converter,prebuilt_28889c43_f8ea673b_te(t._query,this.Jc,this.Yc))},e}(prebuilt_28889c43_f8ea673b_Ya),prebuilt_28889c43_f8ea673b_tc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return Object(tslib_es6.__extends)(e,t),e.prototype._apply=function(t){var e=prebuilt_28889c43_f8ea673b_nc(t,this.type,this.Xc,this.Zc);return new Hu(t.firestore,t.converter,function(t,e){return new Gt(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(prebuilt_28889c43_f8ea673b_Ya),prebuilt_28889c43_f8ea673b_ec=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return Object(tslib_es6.__extends)(e,t),e.prototype._apply=function(t){var e=prebuilt_28889c43_f8ea673b_nc(t,this.type,this.Xc,this.Zc);return new Hu(t.firestore,t.converter,function(t,e){return new Gt(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(prebuilt_28889c43_f8ea673b_Ya);function prebuilt_28889c43_f8ea673b_nc(t,e,n,r){if(n[0]=Object(util_dist_index_esm.getModularInstance)(n[0]),n[0]instanceof prebuilt_28889c43_f8ea673b_qa)return function(t,e,n,r,i){if(!r)throw new prebuilt_28889c43_f8ea673b_S(_.NOT_FOUND,\"Can't use a DocumentSnapshot that doesn't exist for \"+n+\"().\");for(var o=[],s=0,u=$t(t);s<u.length;s++){var a=u[s];if(a.field.isKeyField())o.push(yt(e,r.key));else{var c=r.data.field(a.field);if(et(c))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field \"'+a.field+'\" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.canonicalString();throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. You are trying to start or end a query using a document for which the field '\"+h+\"' (used as the orderBy) does not exist.\")}o.push(c)}}return new Vt(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=prebuilt_28889c43_f8ea673b_wa(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Too many arguments provided to \"+r+\"(). The number of arguments must be less than or equal to the number of orderBy() clauses\");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.isKeyField()){if(\"string\"!=typeof c)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. Expected a string for document ID in \"+r+\"(), but got a \"+typeof c);if(!Jt(t)&&-1!==c.indexOf(\"/\"))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to \"+r+\"() must be a plain document ID, but '\"+c+\"' contains a slash.\");var h=t.path.child(prebuilt_28889c43_f8ea673b_z.fromString(c));if(!ut.isDocumentKey(h))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to \"+r+\"() must result in a valid document path, but '\"+h+\"' is not because it contains an odd number of segments.\");var f=new ut(h);u.push(yt(e,f))}else{var l=prebuilt_28889c43_f8ea673b_ka(n,r,c);u.push(l)}}return new Vt(u,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function prebuilt_28889c43_f8ea673b_rc(t,e,n){if(\"string\"==typeof(n=Object(util_dist_index_esm.getModularInstance)(n))){if(\"\"===n)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.\");if(!Jt(e)&&-1!==n.indexOf(\"/\"))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '\"+n+\"' contains a '/' character.\");var r=e.path.child(prebuilt_28889c43_f8ea673b_z.fromString(n));if(!ut.isDocumentKey(r))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '\"+r+\"' is not because it has an odd number of segments (\"+r.length+\").\");return yt(t,new ut(r))}if(n instanceof Wu)return yt(t,n._key);throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: \"+ju(n)+\".\")}function prebuilt_28889c43_f8ea673b_ic(t,e){if(!Array.isArray(t)||0===t.length)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid Query. A non-empty array is required for '\"+e.toString()+\"' filters.\");if(t.length>10)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid Query. '\"+e.toString()+\"' filters support a maximum of 10 elements in the value array.\")}function prebuilt_28889c43_f8ea673b_oc(t,e,n){if(!n.isEqual(e))throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '\"+e.toString()+\"' and so you must also use '\"+e.toString()+\"' as your first argument to orderBy(), but your first orderBy() is on field '\"+n.toString()+\"' instead.\")}var prebuilt_28889c43_f8ea673b_sc=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e=\"none\"),at(t)){case 0:return null;case 1:return t.booleanValue;case 2:return prebuilt_28889c43_f8ea673b_Z(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(tt(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw prebuilt_28889c43_f8ea673b_R()}},t.prototype.convertObject=function(t,e){var n=this,r={};return prebuilt_28889c43_f8ea673b_K(t.fields||{},(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new prebuilt_28889c43_f8ea673b_la(prebuilt_28889c43_f8ea673b_Z(t.latitude),prebuilt_28889c43_f8ea673b_Z(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case\"previous\":var n=function nt(t){var e=t.mapValue.fields.__previous_value__;return et(e)?nt(e):e}(t);return null==n?null:this.convertValue(n,e);case\"estimate\":return this.convertTimestamp(rt(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=$(t);return new prebuilt_28889c43_f8ea673b_U(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=prebuilt_28889c43_f8ea673b_z.fromString(t);prebuilt_28889c43_f8ea673b_O(prebuilt_28889c43_f8ea673b_Wn(n));var r=new ku(n.get(1),n.get(3)),i=new ut(n.popFirst(5));return r.isEqual(e)||prebuilt_28889c43_f8ea673b_k(\"Document \"+i+\" contains a document reference within a different database (\"+r.projectId+\"/\"+r.database+\") which is not supported. It will be treated as a reference in the current database (\"+e.projectId+\"/\"+e.database+\") instead.\"),i},t}();function prebuilt_28889c43_f8ea673b_uc(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var prebuilt_28889c43_f8ea673b_ac=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(tslib_es6.__extends)(e,t),e.prototype.convertBytes=function(t){return new prebuilt_28889c43_f8ea673b_ha(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Wu(this.firestore,null,e)},e}(prebuilt_28889c43_f8ea673b_sc),prebuilt_28889c43_f8ea673b_cc=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=prebuilt_28889c43_f8ea673b_wa(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=prebuilt_28889c43_f8ea673b_hc(t,this._firestore),i=prebuilt_28889c43_f8ea673b_uc(r.converter,e,n),o=prebuilt_28889c43_f8ea673b_ba(this._dataReader,\"WriteBatch.set\",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,_e.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=prebuilt_28889c43_f8ea673b_hc(t,this._firestore);return o=\"string\"==typeof(e=Object(util_dist_index_esm.getModularInstance)(e))||e instanceof prebuilt_28889c43_f8ea673b_ca?prebuilt_28889c43_f8ea673b_Aa(this._dataReader,\"WriteBatch.update\",s._key,e,n,r):prebuilt_28889c43_f8ea673b_Da(this._dataReader,\"WriteBatch.update\",s._key,e),this._mutations.push(o.toMutation(s._key,_e.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=prebuilt_28889c43_f8ea673b_hc(t,this._firestore);return this._mutations=this._mutations.concat(new prebuilt_28889c43_f8ea673b_qe(e._key,_e.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,\"A write batch can no longer be used after commit() has been called.\")},t}();function prebuilt_28889c43_f8ea673b_hc(t,e){if((t=Object(util_dist_index_esm.getModularInstance)(t)).firestore!==e)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Provided document reference is from a different Firestore instance.\");return t}var prebuilt_28889c43_f8ea673b_fc=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(tslib_es6.__extends)(e,t),e.prototype.convertBytes=function(t){return new prebuilt_28889c43_f8ea673b_ha(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Wu(this.firestore,null,e)},e}(prebuilt_28889c43_f8ea673b_sc);function prebuilt_28889c43_f8ea673b_lc(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ku(t,Wu);var o=Ku(t.firestore,prebuilt_28889c43_f8ea673b_ia),s=prebuilt_28889c43_f8ea673b_wa(o);return prebuilt_28889c43_f8ea673b_pc(o,[(\"string\"==typeof(e=Object(util_dist_index_esm.getModularInstance)(e))||e instanceof prebuilt_28889c43_f8ea673b_ca?prebuilt_28889c43_f8ea673b_Aa(s,\"updateDoc\",t._key,e,n,r):prebuilt_28889c43_f8ea673b_Da(s,\"updateDoc\",t._key,e)).toMutation(t._key,_e.exists(!0))])}function prebuilt_28889c43_f8ea673b_dc(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Object(util_dist_index_esm.getModularInstance)(t);var s={includeMetadataChanges:!1},a=0;\"object\"!=typeof i[a]||prebuilt_28889c43_f8ea673b_ea(i[a])||(s=i[a],a++);var c,h,f,l={includeMetadataChanges:s.includeMetadataChanges};if(prebuilt_28889c43_f8ea673b_ea(i[a])){var d=i[a];i[a]=null===(e=d.next)||void 0===e?void 0:e.bind(d),i[a+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),i[a+2]=null===(r=d.complete)||void 0===r?void 0:r.bind(d)}if(t instanceof Wu)h=Ku(t.firestore,prebuilt_28889c43_f8ea673b_ia),f=zt(t._key.path),c={next:function(e){i[a]&&i[a](prebuilt_28889c43_f8ea673b_yc(h,t,e))},error:i[a+1],complete:i[a+2]};else{var p=Ku(t,Hu);h=Ku(p.firestore,prebuilt_28889c43_f8ea673b_ia),f=p._query;var y=new prebuilt_28889c43_f8ea673b_fc(h);c={next:function(t){i[a]&&i[a](new prebuilt_28889c43_f8ea673b_Qa(h,y,p,t))},error:i[a+1],complete:i[a+2]},prebuilt_28889c43_f8ea673b_Ha(t._query)}return function(t,e,n,r){var i=this,o=new lu(r),s=new gs(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(i,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return e=ds,[4,Su(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(i,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return e=ps,[4,Su(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(prebuilt_28889c43_f8ea673b_oa(h),f,l,c)}function prebuilt_28889c43_f8ea673b_pc(t,e){return function(t,e){var n=this,r=new mr;return t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(n,void 0,void 0,(function(){var n;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return n=Rs,[4,_u(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(prebuilt_28889c43_f8ea673b_oa(t),e)}function prebuilt_28889c43_f8ea673b_yc(t,e,n){var r=n.docs.get(e._key),i=new prebuilt_28889c43_f8ea673b_fc(t);return new prebuilt_28889c43_f8ea673b_Ka(t,i,e._key,r,new prebuilt_28889c43_f8ea673b_ja(n.hasPendingWrites,n.fromCache),e.converter)}var prebuilt_28889c43_f8ea673b_vc=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(tslib_es6.__extends)(e,t),e.prototype.get=function(e){var n=this,r=prebuilt_28889c43_f8ea673b_hc(e,this._firestore),i=new prebuilt_28889c43_f8ea673b_fc(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new prebuilt_28889c43_f8ea673b_Ka(n._firestore,i,r._key,t._document,new prebuilt_28889c43_f8ea673b_ja(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=prebuilt_28889c43_f8ea673b_wa(t)}return t.prototype.get=function(t){var e=this,n=prebuilt_28889c43_f8ea673b_hc(t,this._firestore),r=new prebuilt_28889c43_f8ea673b_ac(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return prebuilt_28889c43_f8ea673b_R();var i=t[0];if(i.isFoundDocument())return new prebuilt_28889c43_f8ea673b_qa(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new prebuilt_28889c43_f8ea673b_qa(e._firestore,r,n._key,null,n.converter);throw prebuilt_28889c43_f8ea673b_R()}))},t.prototype.set=function(t,e,n){var r=prebuilt_28889c43_f8ea673b_hc(t,this._firestore),i=prebuilt_28889c43_f8ea673b_uc(r.converter,e,n),o=prebuilt_28889c43_f8ea673b_ba(this._dataReader,\"Transaction.set\",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=prebuilt_28889c43_f8ea673b_hc(t,this._firestore);return o=\"string\"==typeof(e=Object(util_dist_index_esm.getModularInstance)(e))||e instanceof prebuilt_28889c43_f8ea673b_ca?prebuilt_28889c43_f8ea673b_Aa(this._dataReader,\"Transaction.update\",s._key,e,n,r):prebuilt_28889c43_f8ea673b_Da(this._dataReader,\"Transaction.update\",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=prebuilt_28889c43_f8ea673b_hc(t,this._firestore);return this._transaction.delete(e._key),this},t}());function prebuilt_28889c43_f8ea673b_mc(){if(\"undefined\"==typeof Uint8Array)throw new prebuilt_28889c43_f8ea673b_S(_.UNIMPLEMENTED,\"Uint8Arrays are not available in this environment.\")}function prebuilt_28889c43_f8ea673b_gc(){if(\"undefined\"==typeof atob)throw new prebuilt_28889c43_f8ea673b_S(_.UNIMPLEMENTED,\"Blobs are unavailable in Firestore in this environment.\")}var prebuilt_28889c43_f8ea673b_wc=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return prebuilt_28889c43_f8ea673b_gc(),new t(prebuilt_28889c43_f8ea673b_ha.fromBase64String(e))},t.fromUint8Array=function(e){return prebuilt_28889c43_f8ea673b_mc(),new t(prebuilt_28889c43_f8ea673b_ha.fromUint8Array(e))},t.prototype.toBase64=function(){return prebuilt_28889c43_f8ea673b_gc(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return prebuilt_28889c43_f8ea673b_mc(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return\"Blob(base64: \"+this.toBase64()+\")\"},t}(),prebuilt_28889c43_f8ea673b_bc=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){prebuilt_28889c43_f8ea673b_aa(t=Ku(t,prebuilt_28889c43_f8ea673b_ia));var n=prebuilt_28889c43_f8ea673b_oa(t),r=t._freezeSettings(),i=new hu;return prebuilt_28889c43_f8ea673b_ua(n,i,new au(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){prebuilt_28889c43_f8ea673b_aa(t=Ku(t,prebuilt_28889c43_f8ea673b_ia));var e=prebuilt_28889c43_f8ea673b_oa(t),n=t._freezeSettings(),r=new hu;return prebuilt_28889c43_f8ea673b_ua(e,r,new cu(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,\"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.\");var n=new mr;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return br.yt()?[4,br.delete(t+\"main\")]:[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(prebuilt_28889c43_f8ea673b_Ci(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),prebuilt_28889c43_f8ea673b_Ic=function(){function t(t,e,n){var r=this;this._delegate=e,this.ta=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof ku||(this.ea=t)}return Object.defineProperty(t.prototype,\"_databaseId\",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._delegate._getSettings()),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=Ku(t,zu))._getSettings();if(\"firestore.googleapis.com\"!==i.host&&i.host!==e&&prebuilt_28889c43_f8ea673b_x(\"Host has been set in both settings() and useEmulator(), emulator host will be used\"),t._setSettings(Object.assign(Object.assign({},i),{host:e+\":\"+n,ssl:!1})),r.mockUserToken){var o=Object(util_dist_index_esm.createMockUserToken)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"mockUserToken must contain 'sub' or 'user_id' field!\");t._credentials=new Ou(new Cu(o,new prebuilt_28889c43_f8ea673b_ao(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){var e,n;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:return[4,Iu(t)];case 1:return e=r.sent(),[4,Eu(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=prebuilt_28889c43_f8ea673b_L(t);return e.$r.delete(0),Po(e)}(n))]}}))}))}))}(prebuilt_28889c43_f8ea673b_oa(Ku(this._delegate,prebuilt_28889c43_f8ea673b_ia)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){var e,n;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:return[4,Iu(t)];case 1:return e=r.sent(),[4,Eu(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return(e=prebuilt_28889c43_f8ea673b_L(t)).$r.add(0),[4,Mo(e)];case 1:return n.sent(),e.Br.set(\"Offline\"),[2]}}))}))}(n))]}}))}))}))}(prebuilt_28889c43_f8ea673b_oa(Ku(this._delegate,prebuilt_28889c43_f8ea673b_ia)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&qu(\"synchronizeTabs\",e=!!t.synchronizeTabs,\"experimentalForceOwningTab\",n=!!t.experimentalForceOwningTab),e?this.ta.enableMultiTabIndexedDbPersistence(this):this.ta.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.ta.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.ea&&(this.ea._removeServiceInstance(\"firestore\"),this.ea._removeServiceInstance(\"firestore-exp\")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new mr;return t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(e,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:return e=Vs,[4,_u(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(prebuilt_28889c43_f8ea673b_oa(Ku(this._delegate,prebuilt_28889c43_f8ea673b_ia)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new lu(e);return t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(n,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return e=function(t,e){prebuilt_28889c43_f8ea673b_L(t).Gr.add(e),e.next()},[4,Su(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(n,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return e=function(t,e){prebuilt_28889c43_f8ea673b_L(t).Gr.delete(e)},[4,Su(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(prebuilt_28889c43_f8ea673b_oa(t=Ku(t,prebuilt_28889c43_f8ea673b_ia)),prebuilt_28889c43_f8ea673b_ea(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,\"app\",{get:function(){if(!this.ea)throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,\"Firestore was not initialized using the Firebase SDK. 'app' is not available\");return this.ea},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new prebuilt_28889c43_f8ea673b_Mc(this,Xu(this._delegate,t))}catch(t){throw prebuilt_28889c43_f8ea673b_Ac(t,\"collection()\",\"Firestore.collection()\")}},t.prototype.doc=function(t){try{return new prebuilt_28889c43_f8ea673b_Dc(this,Ju(this._delegate,t))}catch(t){throw prebuilt_28889c43_f8ea673b_Ac(t,\"doc()\",\"Firestore.doc()\")}},t.prototype.collectionGroup=function(t){try{return new prebuilt_28889c43_f8ea673b_Oc(this,function(t,e){if(t=Ku(t,zu),Fu(\"collectionGroup\",\"collection id\",e),e.indexOf(\"/\")>=0)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid collection ID '\"+e+\"' passed to function collectionGroup(). Collection IDs must not contain '/'.\");return new Hu(t,null,function(t){return new Gt(prebuilt_28889c43_f8ea673b_z.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw prebuilt_28889c43_f8ea673b_Ac(t,\"collectionGroup()\",\"Firestore.collectionGroup()\")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new mr;return t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(n,void 0,void 0,(function(){var n;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return[4,function(t){return bu(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new yu(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(prebuilt_28889c43_f8ea673b_oa(t),(function(n){return e(new prebuilt_28889c43_f8ea673b_vc(t,n))}))}(this._delegate,(function(n){return t(new _c(e,n))}))},t.prototype.batch=function(){var t=this;return prebuilt_28889c43_f8ea673b_oa(this._delegate),new prebuilt_28889c43_f8ea673b_Sc(new prebuilt_28889c43_f8ea673b_cc(this._delegate,(function(e){return prebuilt_28889c43_f8ea673b_pc(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,'\"loadBundle()\" does not exist, have you imported \"firebase/firestore/bundle\"?')},t.prototype.namedQuery=function(t){throw new prebuilt_28889c43_f8ea673b_S(_.FAILED_PRECONDITION,'\"namedQuery()\" does not exist, have you imported \"firebase/firestore/bundle\"?')},t}(),prebuilt_28889c43_f8ea673b_Tc=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(tslib_es6.__extends)(e,t),e.prototype.convertBytes=function(t){return new prebuilt_28889c43_f8ea673b_wc(new prebuilt_28889c43_f8ea673b_ha(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return prebuilt_28889c43_f8ea673b_Dc.na(e,this.firestore,null)},e}(prebuilt_28889c43_f8ea673b_sc),_c=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new prebuilt_28889c43_f8ea673b_Tc(t)}return t.prototype.get=function(t){var e=this,n=prebuilt_28889c43_f8ea673b_Fc(t);return this._delegate.get(n).then((function(t){return new prebuilt_28889c43_f8ea673b_Cc(e._firestore,new prebuilt_28889c43_f8ea673b_Ka(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=prebuilt_28889c43_f8ea673b_Fc(t);return n?(Vu(\"Transaction.set\",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=prebuilt_28889c43_f8ea673b_Fc(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(tslib_es6.__spreadArray)([s,e,n],i)),this},t.prototype.delete=function(t){var e=prebuilt_28889c43_f8ea673b_Fc(t);return this._delegate.delete(e),this},t}(),prebuilt_28889c43_f8ea673b_Sc=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=prebuilt_28889c43_f8ea673b_Fc(t);return n?(Vu(\"WriteBatch.set\",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=prebuilt_28889c43_f8ea673b_Fc(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(tslib_es6.__spreadArray)([s,e,n],i)),this},t.prototype.delete=function(t){var e=prebuilt_28889c43_f8ea673b_Fc(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),prebuilt_28889c43_f8ea673b_Nc=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new prebuilt_28889c43_f8ea673b_Ga(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new prebuilt_28889c43_f8ea673b_Rc(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.sa=function(e,n){var r=t.ia,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new prebuilt_28889c43_f8ea673b_Tc(e),n),i.set(n,o)),o},t}();prebuilt_28889c43_f8ea673b_Nc.ia=new WeakMap;var prebuilt_28889c43_f8ea673b_Dc=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new prebuilt_28889c43_f8ea673b_Tc(t)}return t.ra=function(e,n,r){if(e.length%2!=0)throw new prebuilt_28889c43_f8ea673b_S(_.INVALID_ARGUMENT,\"Invalid document reference. Document references must have an even number of segments, but \"+e.canonicalString()+\" has \"+e.length);return new t(n,new Wu(n._delegate,r,new ut(e)))},t.na=function(e,n,r){return new t(n,new Wu(n._delegate,r,e))},Object.defineProperty(t.prototype,\"id\",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"parent\",{get:function(){return new prebuilt_28889c43_f8ea673b_Mc(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"path\",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new prebuilt_28889c43_f8ea673b_Mc(this.firestore,Xu(this._delegate,t))}catch(t){throw prebuilt_28889c43_f8ea673b_Ac(t,\"collection()\",\"DocumentReference.collection()\")}},t.prototype.isEqual=function(t){return(t=Object(util_dist_index_esm.getModularInstance)(t))instanceof Wu&&$u(this._delegate,t)},t.prototype.set=function(t,e){e=Vu(\"DocumentReference.set\",e);try{return function(t,e,n){t=Ku(t,Wu);var r=Ku(t.firestore,prebuilt_28889c43_f8ea673b_ia),i=prebuilt_28889c43_f8ea673b_uc(t.converter,e,n);return prebuilt_28889c43_f8ea673b_pc(r,[prebuilt_28889c43_f8ea673b_ba(prebuilt_28889c43_f8ea673b_wa(r),\"setDoc\",t._key,i,null!==t.converter,n).toMutation(t._key,_e.none())])}(this._delegate,t,e)}catch(t){throw prebuilt_28889c43_f8ea673b_Ac(t,\"setDoc()\",\"DocumentReference.set()\")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?prebuilt_28889c43_f8ea673b_lc(this._delegate,t):prebuilt_28889c43_f8ea673b_lc.apply(void 0,Object(tslib_es6.__spreadArray)([this._delegate,t,e],n))}catch(t){throw prebuilt_28889c43_f8ea673b_Ac(t,\"updateDoc()\",\"DocumentReference.update()\")}},t.prototype.delete=function(){return prebuilt_28889c43_f8ea673b_pc(Ku((t=this._delegate).firestore,prebuilt_28889c43_f8ea673b_ia),[new prebuilt_28889c43_f8ea673b_qe(t._key,_e.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=prebuilt_28889c43_f8ea673b_kc(e),i=prebuilt_28889c43_f8ea673b_xc(e,(function(e){return new prebuilt_28889c43_f8ea673b_Cc(t.firestore,new prebuilt_28889c43_f8ea673b_Ka(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return prebuilt_28889c43_f8ea673b_dc(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return(\"cache\"===(null==t?void 0:t.source)?function(t){t=Ku(t,Wu);var e=Ku(t.firestore,prebuilt_28889c43_f8ea673b_ia),n=prebuilt_28889c43_f8ea673b_oa(e),r=new prebuilt_28889c43_f8ea673b_fc(e);return function(t,e){var n=this,r=new mr;return t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(n,void 0,void 0,(function(){var n;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(tslib_es6.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=prebuilt_28889c43_f8ea673b_L(t);return n.persistence.runTransaction(\"read document\",\"readonly\",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new prebuilt_28889c43_f8ea673b_S(_.UNAVAILABLE,\"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)\")),[3,3];case 2:return r=o.sent(),i=us(r,\"Failed to get document '\"+e+\" from cache\"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Tu(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new prebuilt_28889c43_f8ea673b_Ka(e,r,t._key,n,new prebuilt_28889c43_f8ea673b_ja(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):\"server\"===(null==t?void 0:t.source)?function(t){t=Ku(t,Wu);var e=Ku(t.firestore,prebuilt_28889c43_f8ea673b_ia);return Nu(prebuilt_28889c43_f8ea673b_oa(e),t._key,{source:\"server\"}).then((function(n){return prebuilt_28889c43_f8ea673b_yc(e,t,n)}))}(this._delegate):function(t){t=Ku(t,Wu);var e=Ku(t.firestore,prebuilt_28889c43_f8ea673b_ia);return Nu(prebuilt_28889c43_f8ea673b_oa(e),t._key).then((function(n){return prebuilt_28889c43_f8ea673b_yc(e,t,n)}))}(this._delegate)).then((function(t){return new prebuilt_28889c43_f8ea673b_Cc(e.firestore,new prebuilt_28889c43_f8ea673b_Ka(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?prebuilt_28889c43_f8ea673b_Nc.sa(this.firestore,e):null))},t}();function prebuilt_28889c43_f8ea673b_Ac(t,e,n){return t.message=t.message.replace(e,n),t}function prebuilt_28889c43_f8ea673b_kc(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(\"object\"==typeof r&&!prebuilt_28889c43_f8ea673b_ea(r))return r}return{}}function prebuilt_28889c43_f8ea673b_xc(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=prebuilt_28889c43_f8ea673b_ea(t[0])?t[0]:prebuilt_28889c43_f8ea673b_ea(t[1])?t[1]:\"function\"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var prebuilt_28889c43_f8ea673b_Cc=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,\"ref\",{get:function(){return new prebuilt_28889c43_f8ea673b_Dc(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"id\",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"metadata\",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"exists\",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return prebuilt_28889c43_f8ea673b_Wa(this._delegate,t._delegate)},t}(),prebuilt_28889c43_f8ea673b_Rc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(tslib_es6.__extends)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(prebuilt_28889c43_f8ea673b_Cc),prebuilt_28889c43_f8ea673b_Oc=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new prebuilt_28889c43_f8ea673b_Tc(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,prebuilt_28889c43_f8ea673b_Xa(this._delegate,function(t,e,n){var r=e,i=prebuilt_28889c43_f8ea673b_Ba(\"where\",t);return new prebuilt_28889c43_f8ea673b_Ja(i,r,n)}(e,n,r)))}catch(e){throw prebuilt_28889c43_f8ea673b_Ac(e,/(orderBy|where)\\(\\)/,\"Query.$1()\")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,prebuilt_28889c43_f8ea673b_Xa(this._delegate,function(t,e){void 0===e&&(e=\"asc\");var n=e,r=prebuilt_28889c43_f8ea673b_Ba(\"orderBy\",t);return new prebuilt_28889c43_f8ea673b_$a(r,n)}(e,n)))}catch(e){throw prebuilt_28889c43_f8ea673b_Ac(e,/(orderBy|where)\\(\\)/,\"Query.$1()\")}},t.prototype.limit=function(e){try{return new t(this.firestore,prebuilt_28889c43_f8ea673b_Xa(this._delegate,function(t){return Gu(\"limit\",t),new prebuilt_28889c43_f8ea673b_Za(\"limit\",t,\"F\")}(e)))}catch(e){throw prebuilt_28889c43_f8ea673b_Ac(e,\"limit()\",\"Query.limit()\")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,prebuilt_28889c43_f8ea673b_Xa(this._delegate,function(t){return Gu(\"limitToLast\",t),new prebuilt_28889c43_f8ea673b_Za(\"limitToLast\",t,\"L\")}(e)))}catch(e){throw prebuilt_28889c43_f8ea673b_Ac(e,\"limitToLast()\",\"Query.limitToLast()\")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,prebuilt_28889c43_f8ea673b_Xa(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new prebuilt_28889c43_f8ea673b_tc(\"startAt\",t,!0)}).apply(void 0,e)))}catch(e){throw prebuilt_28889c43_f8ea673b_Ac(e,\"startAt()\",\"Query.startAt()\")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,prebuilt_28889c43_f8ea673b_Xa(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new prebuilt_28889c43_f8ea673b_tc(\"startAfter\",t,!1)}).apply(void 0,e)))}catch(e){throw prebuilt_28889c43_f8ea673b_Ac(e,\"startAfter()\",\"Query.startAfter()\")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,prebuilt_28889c43_f8ea673b_Xa(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new prebuilt_28889c43_f8ea673b_ec(\"endBefore\",t,!0)}).apply(void 0,e)))}catch(e){throw prebuilt_28889c43_f8ea673b_Ac(e,\"endBefore()\",\"Query.endBefore()\")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,prebuilt_28889c43_f8ea673b_Xa(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new prebuilt_28889c43_f8ea673b_ec(\"endAt\",t,!1)}).apply(void 0,e)))}catch(e){throw prebuilt_28889c43_f8ea673b_Ac(e,\"endAt()\",\"Query.endAt()\")}},t.prototype.isEqual=function(t){return Zu(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return(\"cache\"===(null==t?void 0:t.source)?function(t){t=Ku(t,Hu);var e=Ku(t.firestore,prebuilt_28889c43_f8ea673b_ia),n=prebuilt_28889c43_f8ea673b_oa(e),r=new prebuilt_28889c43_f8ea673b_fc(e);return function(t,e){var n=this,r=new mr;return t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(n,void 0,void 0,(function(){var n;return Object(tslib_es6.__generator)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var r,i,o,s,u;return Object(tslib_es6.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,prebuilt_28889c43_f8ea673b_zi(t,e,!0)];case 1:return u=a.sent(),r=new Ss(e,u.Bn),i=r._o(u.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=us(s,\"Failed to execute query '\"+e+\" against cache\"),n.reject(u),[3,3];case 3:return[2]}}))}))},[4,Tu(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new prebuilt_28889c43_f8ea673b_Qa(e,r,t,n)}))}(this._delegate):\"server\"===(null==t?void 0:t.source)?function(t){t=Ku(t,Hu);var e=Ku(t.firestore,prebuilt_28889c43_f8ea673b_ia),n=prebuilt_28889c43_f8ea673b_oa(e),r=new prebuilt_28889c43_f8ea673b_fc(e);return Du(n,t._query,{source:\"server\"}).then((function(n){return new prebuilt_28889c43_f8ea673b_Qa(e,r,t,n)}))}(this._delegate):function(t){t=Ku(t,Hu);var e=Ku(t.firestore,prebuilt_28889c43_f8ea673b_ia),n=prebuilt_28889c43_f8ea673b_oa(e),r=new prebuilt_28889c43_f8ea673b_fc(e);return prebuilt_28889c43_f8ea673b_Ha(t._query),Du(n,t._query).then((function(n){return new prebuilt_28889c43_f8ea673b_Qa(e,r,t,n)}))}(this._delegate)).then((function(t){return new prebuilt_28889c43_f8ea673b_Pc(e.firestore,new prebuilt_28889c43_f8ea673b_Qa(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=prebuilt_28889c43_f8ea673b_kc(e),i=prebuilt_28889c43_f8ea673b_xc(e,(function(e){return new prebuilt_28889c43_f8ea673b_Pc(t.firestore,new prebuilt_28889c43_f8ea673b_Qa(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return prebuilt_28889c43_f8ea673b_dc(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?prebuilt_28889c43_f8ea673b_Nc.sa(this.firestore,e):null))},t}(),prebuilt_28889c43_f8ea673b_Lc=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,\"type\",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"doc\",{get:function(){return new prebuilt_28889c43_f8ea673b_Rc(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"oldIndex\",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"newIndex\",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),prebuilt_28889c43_f8ea673b_Pc=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,\"query\",{get:function(){return new prebuilt_28889c43_f8ea673b_Oc(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"metadata\",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"size\",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"empty\",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"docs\",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new prebuilt_28889c43_f8ea673b_Rc(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new prebuilt_28889c43_f8ea673b_Lc(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new prebuilt_28889c43_f8ea673b_Rc(n._firestore,r))}))},t.prototype.isEqual=function(t){return prebuilt_28889c43_f8ea673b_Wa(this._delegate,t._delegate)},t}(),prebuilt_28889c43_f8ea673b_Mc=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(tslib_es6.__extends)(e,t),Object.defineProperty(e.prototype,\"id\",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"path\",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"parent\",{get:function(){var t=this._delegate.parent;return t?new prebuilt_28889c43_f8ea673b_Dc(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new prebuilt_28889c43_f8ea673b_Dc(this.firestore,void 0===t?Ju(this._delegate):Ju(this._delegate,t))}catch(t){throw prebuilt_28889c43_f8ea673b_Ac(t,\"doc()\",\"CollectionReference.doc()\")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Ku(t.firestore,prebuilt_28889c43_f8ea673b_ia),r=Ju(t),i=prebuilt_28889c43_f8ea673b_uc(t.converter,e);return prebuilt_28889c43_f8ea673b_pc(n,[prebuilt_28889c43_f8ea673b_ba(prebuilt_28889c43_f8ea673b_wa(t.firestore),\"addDoc\",r._key,i,null!==t.converter,{}).toMutation(r._key,_e.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new prebuilt_28889c43_f8ea673b_Dc(e.firestore,t)}))},e.prototype.isEqual=function(t){return $u(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?prebuilt_28889c43_f8ea673b_Nc.sa(this.firestore,t):null))},e}(prebuilt_28889c43_f8ea673b_Oc);function prebuilt_28889c43_f8ea673b_Fc(t){return Ku(t,Wu)}var e,o,prebuilt_28889c43_f8ea673b_Vc=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(prebuilt_28889c43_f8ea673b_ca.bind.apply(prebuilt_28889c43_f8ea673b_ca,Object(tslib_es6.__spreadArray)([void 0],t)))}return t.documentId=function(){return new t(prebuilt_28889c43_f8ea673b_H.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(util_dist_index_esm.getModularInstance)(t))instanceof prebuilt_28889c43_f8ea673b_ca&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),prebuilt_28889c43_f8ea673b_qc=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new prebuilt_28889c43_f8ea673b_Ea(\"serverTimestamp\");return e._methodName=\"FieldValue.serverTimestamp\",new t(e)},t.delete=function(){var e=new prebuilt_28889c43_f8ea673b_Ia(\"deleteField\");return e._methodName=\"FieldValue.delete\",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new prebuilt_28889c43_f8ea673b_a(\"arrayUnion\",t)}).apply(void 0,e);return r._methodName=\"FieldValue.arrayUnion\",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new prebuilt_28889c43_f8ea673b_Sa(\"arrayRemove\",t)}).apply(void 0,e);return r._methodName=\"FieldValue.arrayRemove\",new t(r)},t.increment=function(e){var n=function(t){return new prebuilt_28889c43_f8ea673b_Na(\"increment\",t)}(e);return n._methodName=\"FieldValue.increment\",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),component_dist_index_esm=__webpack_require__(\"/6Yf\"),esm5_L={Firestore:prebuilt_28889c43_f8ea673b_Ic,GeoPoint:prebuilt_28889c43_f8ea673b_la,Timestamp:prebuilt_28889c43_f8ea673b_U,Blob:prebuilt_28889c43_f8ea673b_wc,Transaction:_c,WriteBatch:prebuilt_28889c43_f8ea673b_Sc,DocumentReference:prebuilt_28889c43_f8ea673b_Dc,DocumentSnapshot:prebuilt_28889c43_f8ea673b_Cc,Query:prebuilt_28889c43_f8ea673b_Oc,QueryDocumentSnapshot:prebuilt_28889c43_f8ea673b_Rc,QuerySnapshot:prebuilt_28889c43_f8ea673b_Pc,CollectionReference:prebuilt_28889c43_f8ea673b_Mc,FieldPath:prebuilt_28889c43_f8ea673b_Vc,FieldValue:prebuilt_28889c43_f8ea673b_qc,setLogLevel:function(t){prebuilt_28889c43_f8ea673b_N.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(e,r){e.INTERNAL.registerComponent(new component_dist_index_esm.Component(\"firestore\",(function(e){return function(e,s){return new prebuilt_28889c43_f8ea673b_Ic(e,new prebuilt_28889c43_f8ea673b_ia(e,s),new prebuilt_28889c43_f8ea673b_bc)}(e.getProvider(\"app\").getImmediate(),e.getProvider(\"auth-internal\"))}),\"PUBLIC\").setServiceProps(Object.assign({},esm5_L)))})(e=index_esm.default),e.registerVersion(\"@firebase/firestore\",\"2.3.1\"),(o=prebuilt_28889c43_f8ea673b_Ic).prototype.loadBundle=function(t){return function(t,e){var n=prebuilt_28889c43_f8ea673b_oa(t=Ku(t,prebuilt_28889c43_f8ea673b_ia)),r=new prebuilt_28889c43_f8ea673b_na;return function(t,e,n,r){var i=this,o=function(t,e){return function(t,e){return new du(t,e)}(function(t,e){if(t instanceof Uint8Array)return fu(t,e);if(t instanceof ArrayBuffer)return fu(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error(\"Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream\")}(\"string\"==typeof t?(new TextEncoder).encode(t):t),e)}(n,prebuilt_28889c43_f8ea673b_Do(e));t.asyncQueue.enqueueAndForget((function(){return Object(tslib_es6.__awaiter)(i,void 0,void 0,(function(){var e;return Object(tslib_es6.__generator)(this,(function(n){switch(n.label){case 0:return e=su,[4,_u(t)];case 1:return e.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(n,t._databaseId,e,r),r}(this._delegate,t)},o.prototype.namedQuery=function(t){var e,n,r=this;return(e=this._delegate,n=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return Object(tslib_es6.__awaiter)(n,void 0,void 0,(function(){var n;return Object(tslib_es6.__generator)(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=prebuilt_28889c43_f8ea673b_L(t);return n.persistence.runTransaction(\"Get named query\",\"readonly\",(function(t){return n.Qe.getNamedQuery(t,e)}))},[4,Tu(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(prebuilt_28889c43_f8ea673b_oa(e=Ku(e,prebuilt_28889c43_f8ea673b_ia)),n).then((function(t){return t?new Hu(e,null,t.query):null}))).then((function(t){return t?new prebuilt_28889c43_f8ea673b_Oc(r,t):null}))};var errorCodeMap={OK:\"ok\",CANCELLED:\"cancelled\",UNKNOWN:\"unknown\",INVALID_ARGUMENT:\"invalid-argument\",DEADLINE_EXCEEDED:\"deadline-exceeded\",NOT_FOUND:\"not-found\",ALREADY_EXISTS:\"already-exists\",PERMISSION_DENIED:\"permission-denied\",UNAUTHENTICATED:\"unauthenticated\",RESOURCE_EXHAUSTED:\"resource-exhausted\",FAILED_PRECONDITION:\"failed-precondition\",ABORTED:\"aborted\",OUT_OF_RANGE:\"out-of-range\",UNIMPLEMENTED:\"unimplemented\",INTERNAL:\"internal\",UNAVAILABLE:\"unavailable\",DATA_LOSS:\"data-loss\"},index_esm_HttpsErrorImpl=function(_super){function HttpsErrorImpl(code,message,details){var _this=_super.call(this,message)||this;return Object.setPrototypeOf(_this,HttpsErrorImpl.prototype),_this.code=code,_this.details=details,_this}return Object(tslib_es6.__extends)(HttpsErrorImpl,_super),HttpsErrorImpl}(Error),index_esm_ContextProvider=function(){function ContextProvider(authProvider,messagingProvider){var _this=this;this.auth=null,this.messaging=null,this.auth=authProvider.getImmediate({optional:!0}),this.messaging=messagingProvider.getImmediate({optional:!0}),this.auth||authProvider.get().then((function(auth){return _this.auth=auth}),(function(){})),this.messaging||messagingProvider.get().then((function(messaging){return _this.messaging=messaging}),(function(){}))}return ContextProvider.prototype.getAuthToken=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var token;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:if(!this.auth)return[2,void 0];_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(token=_a.sent())?[2,token.accessToken]:[2,void 0];case 3:return _a.sent(),[2,void 0];case 4:return[2]}}))}))},ContextProvider.prototype.getInstanceIdToken=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:if(!this.messaging||!(\"Notification\"in self)||\"granted\"!==Notification.permission)return[2,void 0];_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,_a.sent()];case 3:return _a.sent(),[2,void 0];case 4:return[2]}}))}))},ContextProvider.prototype.getContext=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var authToken,instanceIdToken;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,this.getAuthToken()];case 1:return authToken=_a.sent(),[4,this.getInstanceIdToken()];case 2:return instanceIdToken=_a.sent(),[2,{authToken:authToken,instanceIdToken:instanceIdToken}]}}))}))},ContextProvider}();function mapValues(o,f){var result={};for(var key in o)o.hasOwnProperty(key)&&(result[key]=f(o[key]));return result}var instance,fetchImpl,namespaceExports,Serializer=function(){function Serializer(){}return Serializer.prototype.encode=function(data){var _this=this;if(null==data)return null;if(data instanceof Number&&(data=data.valueOf()),\"number\"==typeof data&&isFinite(data))return data;if(!0===data||!1===data)return data;if(\"[object String]\"===Object.prototype.toString.call(data))return data;if(Array.isArray(data))return data.map((function(x){return _this.encode(x)}));if(\"function\"==typeof data||\"object\"==typeof data)return mapValues(data,(function(x){return _this.encode(x)}));throw new Error(\"Data cannot be encoded in JSON: \"+data)},Serializer.prototype.decode=function(json){var _this=this;if(null==json)return json;if(json[\"@type\"])switch(json[\"@type\"]){case\"type.googleapis.com/google.protobuf.Int64Value\":case\"type.googleapis.com/google.protobuf.UInt64Value\":var value=Number(json.value);if(isNaN(value))throw new Error(\"Data cannot be decoded from JSON: \"+json);return value;default:throw new Error(\"Data cannot be decoded from JSON: \"+json)}return Array.isArray(json)?json.map((function(x){return _this.decode(x)})):\"function\"==typeof json||\"object\"==typeof json?mapValues(json,(function(x){return _this.decode(x)})):json},Serializer}(),index_esm_Service=function(){function Service(app_,authProvider,messagingProvider,appCheckProvider,regionOrCustomDomain_,fetchImpl){var _this=this;void 0===regionOrCustomDomain_&&(regionOrCustomDomain_=\"us-central1\"),this.app_=app_,this.appCheckProvider=appCheckProvider,this.fetchImpl=fetchImpl,this.serializer=new Serializer,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(_this.deleteService())}},this.contextProvider=new index_esm_ContextProvider(authProvider,messagingProvider),this.cancelAllRequests=new Promise((function(resolve){_this.deleteService=function(){return resolve()}}));try{var url=new URL(regionOrCustomDomain_);this.customDomain=url.origin,this.region=\"us-central1\"}catch(e){this.customDomain=null,this.region=regionOrCustomDomain_}}return Object.defineProperty(Service.prototype,\"app\",{get:function(){return this.app_},enumerable:!1,configurable:!0}),Service.prototype._url=function(name){var projectId=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+\"/\"+projectId+\"/\"+this.region+\"/\"+name:null!==this.customDomain?this.customDomain+\"/\"+name:\"https://\"+this.region+\"-\"+projectId+\".cloudfunctions.net/\"+name},Service.prototype.useEmulator=function(host,port){this.emulatorOrigin=\"http://\"+host+\":\"+port},Service.prototype.useFunctionsEmulator=function(origin){this.emulatorOrigin=origin},Service.prototype.httpsCallable=function(name,options){var _this=this;return function(data){return _this.call(name,data,options||{})}},Service.prototype.postJSON=function(url,body,headers){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var appCheckToken,response,json;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return headers[\"Content-Type\"]=\"application/json\",[4,this.getAppCheckToken()];case 1:null!==(appCheckToken=_a.sent())&&(headers[\"X-Firebase-AppCheck\"]=appCheckToken),_a.label=2;case 2:return _a.trys.push([2,4,,5]),[4,this.fetchImpl(url,{method:\"POST\",body:JSON.stringify(body),headers:headers})];case 3:return response=_a.sent(),[3,5];case 4:return _a.sent(),[2,{status:0,json:null}];case 5:json=null,_a.label=6;case 6:return _a.trys.push([6,8,,9]),[4,response.json()];case 7:return json=_a.sent(),[3,9];case 8:return _a.sent(),[3,9];case 9:return[2,{status:response.status,json:json}]}}))}))},Service.prototype.getAppCheckToken=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var appCheck;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return(appCheck=this.appCheckProvider.getImmediate({optional:!0}))?[4,appCheck.getToken()]:[3,2];case 1:return[2,_a.sent().token];case 2:return[2,null]}}))}))},Service.prototype.call=function(name,data,options){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var url,body,headers,context,_a,timer,failAfterPromise,response,error,responseData;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return url=this._url(name),data=this.serializer.encode(data),body={data:data},headers={},[4,this.contextProvider.getContext()];case 1:return(context=_b.sent()).authToken&&(headers.Authorization=\"Bearer \"+context.authToken),context.instanceIdToken&&(headers[\"Firebase-Instance-ID-Token\"]=context.instanceIdToken),_a=function(millis){var timer,promise=new Promise((function(_,reject){timer=setTimeout((function(){reject(new index_esm_HttpsErrorImpl(\"deadline-exceeded\",\"deadline-exceeded\"))}),millis)}));return{timer:timer,promise:promise}}(options.timeout||7e4),timer=_a.timer,failAfterPromise=_a.promise,[4,Promise.race([clearTimeoutWrapper(timer,this.postJSON(url,body,headers)),failAfterPromise,clearTimeoutWrapper(timer,this.cancelAllRequests)])];case 2:if(!(response=_b.sent()))throw new index_esm_HttpsErrorImpl(\"cancelled\",\"Firebase Functions instance was deleted.\");if(error=function(status,bodyJSON,serializer){var code=function(status){if(status>=200&&status<300)return\"ok\";switch(status){case 0:return\"internal\";case 400:return\"invalid-argument\";case 401:return\"unauthenticated\";case 403:return\"permission-denied\";case 404:return\"not-found\";case 409:return\"aborted\";case 429:return\"resource-exhausted\";case 499:return\"cancelled\";case 500:return\"internal\";case 501:return\"unimplemented\";case 503:return\"unavailable\";case 504:return\"deadline-exceeded\"}return\"unknown\"}(status),description=code,details=void 0;try{var errorJSON=bodyJSON&&bodyJSON.error;if(errorJSON){var status_1=errorJSON.status;if(\"string\"==typeof status_1){if(!errorCodeMap[status_1])return new index_esm_HttpsErrorImpl(\"internal\",\"internal\");code=errorCodeMap[status_1],description=status_1}var message=errorJSON.message;\"string\"==typeof message&&(description=message),void 0!==(details=errorJSON.details)&&(details=serializer.decode(details))}}catch(e){}return\"ok\"===code?null:new index_esm_HttpsErrorImpl(code,description,details)}(response.status,response.json,this.serializer))throw error;if(!response.json)throw new index_esm_HttpsErrorImpl(\"internal\",\"Response is not valid JSON object.\");if(void 0===(responseData=response.json.data)&&(responseData=response.json.result),void 0===responseData)throw new index_esm_HttpsErrorImpl(\"internal\",\"Response is missing data field.\");return[2,{data:this.serializer.decode(responseData)}]}}))}))},Service}();function clearTimeoutWrapper(timer,promise){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var result;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,promise];case 1:return result=_a.sent(),clearTimeout(timer),[2,result]}}))}))}instance=index_esm.default,fetchImpl=fetch.bind(self),namespaceExports={Functions:index_esm_Service},instance.INTERNAL.registerComponent(new component_dist_index_esm.Component(\"functions\",(function(container,_a){var regionOrCustomDomain=_a.instanceIdentifier,app=container.getProvider(\"app\").getImmediate(),authProvider=container.getProvider(\"auth-internal\"),appCheckProvider=container.getProvider(\"app-check-internal\"),messagingProvider=container.getProvider(\"messaging\");return new index_esm_Service(app,authProvider,messagingProvider,appCheckProvider,regionOrCustomDomain,fetchImpl)}),\"PUBLIC\").setServiceProps(namespaceExports).setMultipleInstances(!0)),index_esm.default.registerVersion(\"@firebase/functions\",\"0.6.9\");var index_esm_a,idb=__webpack_require__(\"nbvr\"),ERROR_DESCRIPTION_MAP=((index_esm_a={})[\"missing-app-config-values\"]='Missing App configuration value: \"{$valueName}\"',index_esm_a[\"not-registered\"]=\"Firebase Installation is not registered.\",index_esm_a[\"installation-not-found\"]=\"Firebase Installation not found.\",index_esm_a[\"request-failed\"]='{$requestName} request failed with error \"{$serverCode} {$serverStatus}: {$serverMessage}\"',index_esm_a[\"app-offline\"]=\"Could not process request. Application offline.\",index_esm_a[\"delete-pending-registration\"]=\"Can't delete installation while there is a pending registration request.\",index_esm_a),ERROR_FACTORY=new util_dist_index_esm.ErrorFactory(\"installations\",\"Installations\",ERROR_DESCRIPTION_MAP);function isServerError(error){return error instanceof util_dist_index_esm.FirebaseError&&error.code.includes(\"request-failed\")}function getInstallationsEndpoint(_a){return\"https://firebaseinstallations.googleapis.com/v1/projects/\"+_a.projectId+\"/installations\"}function extractAuthTokenInfoFromResponse(response){return{token:response.token,requestStatus:2,expiresIn:(responseExpiresIn=response.expiresIn,Number(responseExpiresIn.replace(\"s\",\"000\"))),creationTime:Date.now()};var responseExpiresIn}function getErrorFromResponse(requestName,response){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var responseJson,errorData;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,response.json()];case 1:return responseJson=_a.sent(),[2,ERROR_FACTORY.create(\"request-failed\",{requestName:requestName,serverCode:(errorData=responseJson.error).code,serverMessage:errorData.message,serverStatus:errorData.status})]}}))}))}function getHeaders(_a){return new Headers({\"Content-Type\":\"application/json\",Accept:\"application/json\",\"x-goog-api-key\":_a.apiKey})}function getHeadersWithAuth(appConfig,_a){var refreshToken=_a.refreshToken,headers=getHeaders(appConfig);return headers.append(\"Authorization\",function(refreshToken){return\"FIS_v2 \"+refreshToken}(refreshToken)),headers}function retryIfServerError(fn){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var result;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,fn()];case 1:return(result=_a.sent()).status>=500&&result.status<600?[2,fn()]:[2,result]}}))}))}function createInstallationRequest(appConfig,_a){var fid=_a.fid;return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var endpoint,headers,request,response,responseValue;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return endpoint=getInstallationsEndpoint(appConfig),headers=getHeaders(appConfig),request={method:\"POST\",headers:headers,body:JSON.stringify({fid:fid,authVersion:\"FIS_v2\",appId:appConfig.appId,sdkVersion:\"w:0.4.26\"})},[4,retryIfServerError((function(){return fetch(endpoint,request)}))];case 1:return(response=_b.sent()).ok?[4,response.json()]:[3,3];case 2:return[2,{fid:(responseValue=_b.sent()).fid||fid,registrationStatus:2,refreshToken:responseValue.refreshToken,authToken:extractAuthTokenInfoFromResponse(responseValue.authToken)}];case 3:return[4,getErrorFromResponse(\"Create Installation\",response)];case 4:throw _b.sent()}}))}))}function sleep(ms){return new Promise((function(resolve){setTimeout(resolve,ms)}))}var VALID_FID_PATTERN=/^[cdef][\\w-]{21}$/;function generateFid(){try{var fidByteArray=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(fidByteArray),fidByteArray[0]=112+fidByteArray[0]%16;var fid=function(fidByteArray){return(array=fidByteArray,btoa(String.fromCharCode.apply(String,Object(tslib_es6.__spreadArray)([],Object(tslib_es6.__read)(array)))).replace(/\\+/g,\"-\").replace(/\\//g,\"_\")).substr(0,22);var array}(fidByteArray);return VALID_FID_PATTERN.test(fid)?fid:\"\"}catch(_a){return\"\"}}function getKey(appConfig){return appConfig.appName+\"!\"+appConfig.appId}var fidChangeCallbacks=new Map;function fidChanged(appConfig,fid){var key=getKey(appConfig);callFidChangeCallbacks(key,fid),function(key,fid){var channel=getBroadcastChannel();channel&&channel.postMessage({key:key,fid:fid}),closeBroadcastChannel()}(key,fid)}function callFidChangeCallbacks(key,fid){var e_1,_a,callbacks=fidChangeCallbacks.get(key);if(callbacks)try{for(var callbacks_1=Object(tslib_es6.__values)(callbacks),callbacks_1_1=callbacks_1.next();!callbacks_1_1.done;callbacks_1_1=callbacks_1.next())(0,callbacks_1_1.value)(fid)}catch(e_1_1){e_1={error:e_1_1}}finally{try{callbacks_1_1&&!callbacks_1_1.done&&(_a=callbacks_1.return)&&_a.call(callbacks_1)}finally{if(e_1)throw e_1.error}}}var broadcastChannel=null;function getBroadcastChannel(){return!broadcastChannel&&\"BroadcastChannel\"in self&&((broadcastChannel=new BroadcastChannel(\"[Firebase] FID Change\")).onmessage=function(e){callFidChangeCallbacks(e.data.key,e.data.fid)}),broadcastChannel}function closeBroadcastChannel(){0===fidChangeCallbacks.size&&broadcastChannel&&(broadcastChannel.close(),broadcastChannel=null)}var dist_index_esm_a,OBJECT_STORE_NAME=\"firebase-installations-store\",dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=Object(idb.openDb)(\"firebase-installations-database\",1,(function(upgradeDB){switch(upgradeDB.oldVersion){case 0:upgradeDB.createObjectStore(OBJECT_STORE_NAME)}}))),dbPromise}function set(appConfig,value){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var key,db,tx,objectStore,oldValue;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return key=getKey(appConfig),[4,getDbPromise()];case 1:return db=_a.sent(),tx=db.transaction(OBJECT_STORE_NAME,\"readwrite\"),[4,(objectStore=tx.objectStore(OBJECT_STORE_NAME)).get(key)];case 2:return oldValue=_a.sent(),[4,objectStore.put(value,key)];case 3:return _a.sent(),[4,tx.complete];case 4:return _a.sent(),oldValue&&oldValue.fid===value.fid||fidChanged(appConfig,value.fid),[2,value]}}))}))}function remove(appConfig){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var key,db,tx;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return key=getKey(appConfig),[4,getDbPromise()];case 1:return db=_a.sent(),[4,(tx=db.transaction(OBJECT_STORE_NAME,\"readwrite\")).objectStore(OBJECT_STORE_NAME).delete(key)];case 2:return _a.sent(),[4,tx.complete];case 3:return _a.sent(),[2]}}))}))}function update(appConfig,updateFn){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var key,db,tx,store,oldValue,newValue;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return key=getKey(appConfig),[4,getDbPromise()];case 1:return db=_a.sent(),tx=db.transaction(OBJECT_STORE_NAME,\"readwrite\"),[4,(store=tx.objectStore(OBJECT_STORE_NAME)).get(key)];case 2:return oldValue=_a.sent(),void 0!==(newValue=updateFn(oldValue))?[3,4]:[4,store.delete(key)];case 3:return _a.sent(),[3,6];case 4:return[4,store.put(newValue,key)];case 5:_a.sent(),_a.label=6;case 6:return[4,tx.complete];case 7:return _a.sent(),!newValue||oldValue&&oldValue.fid===newValue.fid||fidChanged(appConfig,newValue.fid),[2,newValue]}}))}))}function getInstallationEntry(appConfig){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var registrationPromise,installationEntry,_a;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,update(appConfig,(function(oldEntry){var installationEntry=function(oldEntry){return clearTimedOutRequest(oldEntry||{fid:generateFid(),registrationStatus:0})}(oldEntry),entryWithPromise=function(appConfig,installationEntry){if(0===installationEntry.registrationStatus){if(!navigator.onLine)return{installationEntry:installationEntry,registrationPromise:Promise.reject(ERROR_FACTORY.create(\"app-offline\"))};var inProgressEntry={fid:installationEntry.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:inProgressEntry,registrationPromise:function(appConfig,installationEntry){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var registeredInstallationEntry,e_1;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,7]),[4,createInstallationRequest(appConfig,installationEntry)];case 1:return registeredInstallationEntry=_a.sent(),[2,set(appConfig,registeredInstallationEntry)];case 2:return isServerError(e_1=_a.sent())&&409===e_1.customData.serverCode?[4,remove(appConfig)]:[3,4];case 3:return _a.sent(),[3,6];case 4:return[4,set(appConfig,{fid:installationEntry.fid,registrationStatus:0})];case 5:_a.sent(),_a.label=6;case 6:throw e_1;case 7:return[2]}}))}))}(appConfig,inProgressEntry)}}return 1===installationEntry.registrationStatus?{installationEntry:installationEntry,registrationPromise:waitUntilFidRegistration(appConfig)}:{installationEntry:installationEntry}}(appConfig,installationEntry);return registrationPromise=entryWithPromise.registrationPromise,entryWithPromise.installationEntry}))];case 1:return\"\"!==(installationEntry=_b.sent()).fid?[3,3]:(_a={},[4,registrationPromise]);case 2:return[2,(_a.installationEntry=_b.sent(),_a)];case 3:return[2,{installationEntry:installationEntry,registrationPromise:registrationPromise}]}}))}))}function waitUntilFidRegistration(appConfig){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var entry,_a,installationEntry,registrationPromise;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,updateInstallationRequest(appConfig)];case 1:entry=_b.sent(),_b.label=2;case 2:return 1!==entry.registrationStatus?[3,5]:[4,sleep(100)];case 3:return _b.sent(),[4,updateInstallationRequest(appConfig)];case 4:return entry=_b.sent(),[3,2];case 5:return 0!==entry.registrationStatus?[3,7]:[4,getInstallationEntry(appConfig)];case 6:return _a=_b.sent(),installationEntry=_a.installationEntry,(registrationPromise=_a.registrationPromise)?[2,registrationPromise]:[2,installationEntry];case 7:return[2,entry]}}))}))}function updateInstallationRequest(appConfig){return update(appConfig,(function(oldEntry){if(!oldEntry)throw ERROR_FACTORY.create(\"installation-not-found\");return clearTimedOutRequest(oldEntry)}))}function clearTimedOutRequest(entry){return 1===(installationEntry=entry).registrationStatus&&installationEntry.registrationTime+1e4<Date.now()?{fid:entry.fid,registrationStatus:0}:entry;var installationEntry}function generateAuthTokenRequest(_a,installationEntry){var appConfig=_a.appConfig,platformLoggerProvider=_a.platformLoggerProvider;return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var endpoint,headers,platformLogger,request,response;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return endpoint=function(appConfig,_a){var fid=_a.fid;return getInstallationsEndpoint(appConfig)+\"/\"+fid+\"/authTokens:generate\"}(appConfig,installationEntry),headers=getHeadersWithAuth(appConfig,installationEntry),(platformLogger=platformLoggerProvider.getImmediate({optional:!0}))&&headers.append(\"x-firebase-client\",platformLogger.getPlatformInfoString()),request={method:\"POST\",headers:headers,body:JSON.stringify({installation:{sdkVersion:\"w:0.4.26\"}})},[4,retryIfServerError((function(){return fetch(endpoint,request)}))];case 1:return(response=_b.sent()).ok?[4,response.json()]:[3,3];case 2:return[2,extractAuthTokenInfoFromResponse(_b.sent())];case 3:return[4,getErrorFromResponse(\"Generate Auth Token\",response)];case 4:throw _b.sent()}}))}))}function refreshAuthToken(dependencies,forceRefresh){return void 0===forceRefresh&&(forceRefresh=!1),Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var tokenPromise,entry,_a;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,update(dependencies.appConfig,(function(oldEntry){if(!isEntryRegistered(oldEntry))throw ERROR_FACTORY.create(\"not-registered\");var authToken,oldAuthToken=oldEntry.authToken;if(!forceRefresh&&2===(authToken=oldAuthToken).requestStatus&&!function(authToken){var now=Date.now();return now<authToken.creationTime||authToken.creationTime+authToken.expiresIn<now+36e5}(authToken))return oldEntry;if(1===oldAuthToken.requestStatus)return tokenPromise=function(dependencies,forceRefresh){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var entry,authToken;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,updateAuthTokenRequest(dependencies.appConfig)];case 1:entry=_a.sent(),_a.label=2;case 2:return 1!==entry.authToken.requestStatus?[3,5]:[4,sleep(100)];case 3:return _a.sent(),[4,updateAuthTokenRequest(dependencies.appConfig)];case 4:return entry=_a.sent(),[3,2];case 5:return 0===(authToken=entry.authToken).requestStatus?[2,refreshAuthToken(dependencies,forceRefresh)]:[2,authToken]}}))}))}(dependencies,forceRefresh),oldEntry;if(!navigator.onLine)throw ERROR_FACTORY.create(\"app-offline\");var inProgressEntry=function(oldEntry){var inProgressAuthToken={requestStatus:1,requestTime:Date.now()};return Object(tslib_es6.__assign)(Object(tslib_es6.__assign)({},oldEntry),{authToken:inProgressAuthToken})}(oldEntry);return tokenPromise=function(dependencies,installationEntry){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var authToken,e_1,updatedInstallationEntry;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,8]),[4,generateAuthTokenRequest(dependencies,installationEntry)];case 1:return authToken=_a.sent(),updatedInstallationEntry=Object(tslib_es6.__assign)(Object(tslib_es6.__assign)({},installationEntry),{authToken:authToken}),[4,set(dependencies.appConfig,updatedInstallationEntry)];case 2:return _a.sent(),[2,authToken];case 3:return!isServerError(e_1=_a.sent())||401!==e_1.customData.serverCode&&404!==e_1.customData.serverCode?[3,5]:[4,remove(dependencies.appConfig)];case 4:return _a.sent(),[3,7];case 5:return updatedInstallationEntry=Object(tslib_es6.__assign)(Object(tslib_es6.__assign)({},installationEntry),{authToken:{requestStatus:0}}),[4,set(dependencies.appConfig,updatedInstallationEntry)];case 6:_a.sent(),_a.label=7;case 7:throw e_1;case 8:return[2]}}))}))}(dependencies,inProgressEntry),inProgressEntry}))];case 1:return entry=_b.sent(),tokenPromise?[4,tokenPromise]:[3,3];case 2:return _a=_b.sent(),[3,4];case 3:_a=entry.authToken,_b.label=4;case 4:return[2,_a]}}))}))}function updateAuthTokenRequest(appConfig){return update(appConfig,(function(oldEntry){if(!isEntryRegistered(oldEntry))throw ERROR_FACTORY.create(\"not-registered\");var authToken;return 1===(authToken=oldEntry.authToken).requestStatus&&authToken.requestTime+1e4<Date.now()?Object(tslib_es6.__assign)(Object(tslib_es6.__assign)({},oldEntry),{authToken:{requestStatus:0}}):oldEntry}))}function isEntryRegistered(installationEntry){return void 0!==installationEntry&&2===installationEntry.registrationStatus}function completeInstallationRegistration(appConfig){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var registrationPromise;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,getInstallationEntry(appConfig)];case 1:return(registrationPromise=_a.sent().registrationPromise)?[4,registrationPromise]:[3,3];case 2:_a.sent(),_a.label=3;case 3:return[2]}}))}))}function deleteInstallationRequest(appConfig,installationEntry){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var endpoint,headers,request,response;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return endpoint=function(appConfig,_a){var fid=_a.fid;return getInstallationsEndpoint(appConfig)+\"/\"+fid}(appConfig,installationEntry),headers=getHeadersWithAuth(appConfig,installationEntry),request={method:\"DELETE\",headers:headers},[4,retryIfServerError((function(){return fetch(endpoint,request)}))];case 1:return(response=_a.sent()).ok?[3,3]:[4,getErrorFromResponse(\"Delete Installation\",response)];case 2:throw _a.sent();case 3:return[2]}}))}))}function getMissingValueError(valueName){return ERROR_FACTORY.create(\"missing-app-config-values\",{valueName:valueName})}!function(instance){instance.INTERNAL.registerComponent(new component_dist_index_esm.Component(\"installations\",(function(container){var app=container.getProvider(\"app\").getImmediate(),dependencies={appConfig:function(app){var e_1,_a;if(!app||!app.options)throw getMissingValueError(\"App Configuration\");if(!app.name)throw getMissingValueError(\"App Name\");try{for(var configKeys_1=Object(tslib_es6.__values)([\"projectId\",\"apiKey\",\"appId\"]),configKeys_1_1=configKeys_1.next();!configKeys_1_1.done;configKeys_1_1=configKeys_1.next()){var keyName=configKeys_1_1.value;if(!app.options[keyName])throw getMissingValueError(keyName)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{configKeys_1_1&&!configKeys_1_1.done&&(_a=configKeys_1.return)&&_a.call(configKeys_1)}finally{if(e_1)throw e_1.error}}return{appName:app.name,projectId:app.options.projectId,apiKey:app.options.apiKey,appId:app.options.appId}}(app),platformLoggerProvider:container.getProvider(\"platform-logger\")};return{app:app,getId:function(){return function(dependencies){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var _a,installationEntry,registrationPromise;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,getInstallationEntry(dependencies.appConfig)];case 1:return _a=_b.sent(),installationEntry=_a.installationEntry,(registrationPromise=_a.registrationPromise)?registrationPromise.catch(console.error):refreshAuthToken(dependencies).catch(console.error),[2,installationEntry.fid]}}))}))}(dependencies)},getToken:function(forceRefresh){return function(dependencies,forceRefresh){return void 0===forceRefresh&&(forceRefresh=!1),Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,completeInstallationRegistration(dependencies.appConfig)];case 1:return _a.sent(),[4,refreshAuthToken(dependencies,forceRefresh)];case 2:return[2,_a.sent().token]}}))}))}(dependencies,forceRefresh)},delete:function(){return function(dependencies){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var appConfig,entry;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,update(appConfig=dependencies.appConfig,(function(oldEntry){if(!oldEntry||0!==oldEntry.registrationStatus)return oldEntry}))];case 1:if(!(entry=_a.sent()))return[3,6];if(1!==entry.registrationStatus)return[3,2];throw ERROR_FACTORY.create(\"delete-pending-registration\");case 2:if(2!==entry.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw ERROR_FACTORY.create(\"app-offline\");case 3:return[4,deleteInstallationRequest(appConfig,entry)];case 4:return _a.sent(),[4,remove(appConfig)];case 5:_a.sent(),_a.label=6;case 6:return[2]}}))}))}(dependencies)},onIdChange:function(callback){return function(_a,callback){var appConfig=_a.appConfig;return function(appConfig,callback){getBroadcastChannel();var key=getKey(appConfig),callbackSet=fidChangeCallbacks.get(key);callbackSet||(callbackSet=new Set,fidChangeCallbacks.set(key,callbackSet)),callbackSet.add(callback)}(appConfig,callback),function(){!function(appConfig,callback){var key=getKey(appConfig),callbackSet=fidChangeCallbacks.get(key);callbackSet&&(callbackSet.delete(callback),0===callbackSet.size&&fidChangeCallbacks.delete(key),closeBroadcastChannel())}(appConfig,callback)}}(dependencies,callback)}}}),\"PUBLIC\")),instance.registerVersion(\"@firebase/installations\",\"0.4.26\")}(index_esm.default);var ERROR_MAP=((dist_index_esm_a={})[\"missing-app-config-values\"]='Missing App configuration value: \"{$valueName}\"',dist_index_esm_a[\"only-available-in-window\"]=\"This method is available in a Window context.\",dist_index_esm_a[\"only-available-in-sw\"]=\"This method is available in a service worker context.\",dist_index_esm_a[\"permission-default\"]=\"The notification permission was not granted and dismissed instead.\",dist_index_esm_a[\"permission-blocked\"]=\"The notification permission was not granted and blocked instead.\",dist_index_esm_a[\"unsupported-browser\"]=\"This browser doesn't support the API's required to use the firebase SDK.\",dist_index_esm_a[\"failed-service-worker-registration\"]=\"We are unable to register the default service worker. {$browserErrorMessage}\",dist_index_esm_a[\"token-subscribe-failed\"]=\"A problem occurred while subscribing the user to FCM: {$errorInfo}\",dist_index_esm_a[\"token-subscribe-no-token\"]=\"FCM returned no token when subscribing the user to push.\",dist_index_esm_a[\"token-unsubscribe-failed\"]=\"A problem occurred while unsubscribing the user from FCM: {$errorInfo}\",dist_index_esm_a[\"token-update-failed\"]=\"A problem occurred while updating the user from FCM: {$errorInfo}\",dist_index_esm_a[\"token-update-no-token\"]=\"FCM returned no token when updating the user to push.\",dist_index_esm_a[\"use-sw-after-get-token\"]=\"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.\",dist_index_esm_a[\"invalid-sw-registration\"]=\"The input to useServiceWorker() must be a ServiceWorkerRegistration.\",dist_index_esm_a[\"invalid-bg-handler\"]=\"The input to setBackgroundMessageHandler() must be a function.\",dist_index_esm_a[\"invalid-vapid-key\"]=\"The public VAPID key must be a string.\",dist_index_esm_a[\"use-vapid-key-after-get-token\"]=\"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.\",dist_index_esm_a),index_esm_ERROR_FACTORY=new util_dist_index_esm.ErrorFactory(\"messaging\",\"Messaging\",ERROR_MAP),DEFAULT_VAPID_KEY=\"BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4\",MessageType=function(MessageType){return MessageType.PUSH_RECEIVED=\"push-received\",MessageType.NOTIFICATION_CLICKED=\"notification-clicked\",MessageType}({});function arrayToBase64(array){var uint8Array=new Uint8Array(array);return btoa(String.fromCharCode.apply(String,Object(tslib_es6.__spreadArray)([],Object(tslib_es6.__read)(uint8Array)))).replace(/=/g,\"\").replace(/\\+/g,\"-\").replace(/\\//g,\"_\")}function base64ToArray(base64String){for(var base64=(base64String+\"=\".repeat((4-base64String.length%4)%4)).replace(/\\-/g,\"+\").replace(/_/g,\"/\"),rawData=atob(base64),outputArray=new Uint8Array(rawData.length),i=0;i<rawData.length;++i)outputArray[i]=rawData.charCodeAt(i);return outputArray}function migrateOldDatabase(senderId){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var tokenDetails,_this=this;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return\"databases\"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!_a.sent().map((function(db){return db.name})).includes(\"fcm_token_details_db\"))return[2,null];_a.label=2;case 2:return tokenDetails=null,[4,Object(idb.openDb)(\"fcm_token_details_db\",5,(function(db){return Object(tslib_es6.__awaiter)(_this,void 0,void 0,(function(){var objectStore,value,oldDetails,_a;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return db.oldVersion<2?[2]:db.objectStoreNames.contains(\"fcm_token_object_Store\")?[4,(objectStore=db.transaction.objectStore(\"fcm_token_object_Store\")).index(\"fcmSenderId\").get(senderId)]:[2];case 1:return value=_b.sent(),[4,objectStore.clear()];case 2:if(_b.sent(),!value)return[2];if(2===db.oldVersion){if(!(oldDetails=value).auth||!oldDetails.p256dh||!oldDetails.endpoint)return[2];tokenDetails={token:oldDetails.fcmToken,createTime:null!==(_a=oldDetails.createTime)&&void 0!==_a?_a:Date.now(),subscriptionOptions:{auth:oldDetails.auth,p256dh:oldDetails.p256dh,endpoint:oldDetails.endpoint,swScope:oldDetails.swScope,vapidKey:\"string\"==typeof oldDetails.vapidKey?oldDetails.vapidKey:arrayToBase64(oldDetails.vapidKey)}}}else(3===db.oldVersion||4===db.oldVersion)&&(tokenDetails={token:(oldDetails=value).fcmToken,createTime:oldDetails.createTime,subscriptionOptions:{auth:arrayToBase64(oldDetails.auth),p256dh:arrayToBase64(oldDetails.p256dh),endpoint:oldDetails.endpoint,swScope:oldDetails.swScope,vapidKey:arrayToBase64(oldDetails.vapidKey)}});return[2]}}))}))}))];case 3:return _a.sent().close(),[4,Object(idb.deleteDb)(\"fcm_token_details_db\")];case 4:return _a.sent(),[4,Object(idb.deleteDb)(\"fcm_vapid_details_db\")];case 5:return _a.sent(),[4,Object(idb.deleteDb)(\"undefined\")];case 6:return _a.sent(),[2,checkTokenDetails(tokenDetails)?tokenDetails:null]}}))}))}function checkTokenDetails(tokenDetails){if(!tokenDetails||!tokenDetails.subscriptionOptions)return!1;var subscriptionOptions=tokenDetails.subscriptionOptions;return\"number\"==typeof tokenDetails.createTime&&tokenDetails.createTime>0&&\"string\"==typeof tokenDetails.token&&tokenDetails.token.length>0&&\"string\"==typeof subscriptionOptions.auth&&subscriptionOptions.auth.length>0&&\"string\"==typeof subscriptionOptions.p256dh&&subscriptionOptions.p256dh.length>0&&\"string\"==typeof subscriptionOptions.endpoint&&subscriptionOptions.endpoint.length>0&&\"string\"==typeof subscriptionOptions.swScope&&subscriptionOptions.swScope.length>0&&\"string\"==typeof subscriptionOptions.vapidKey&&subscriptionOptions.vapidKey.length>0}var index_esm_dbPromise=null;function index_esm_getDbPromise(){return index_esm_dbPromise||(index_esm_dbPromise=Object(idb.openDb)(\"firebase-messaging-database\",1,(function(upgradeDb){switch(upgradeDb.oldVersion){case 0:upgradeDb.createObjectStore(\"firebase-messaging-store\")}}))),index_esm_dbPromise}function dbGet(firebaseDependencies){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var key,tokenDetails,oldTokenDetails;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return key=index_esm_getKey(firebaseDependencies),[4,index_esm_getDbPromise()];case 1:return[4,_a.sent().transaction(\"firebase-messaging-store\").objectStore(\"firebase-messaging-store\").get(key)];case 2:return(tokenDetails=_a.sent())?[2,tokenDetails]:[3,3];case 3:return[4,migrateOldDatabase(firebaseDependencies.appConfig.senderId)];case 4:return(oldTokenDetails=_a.sent())?[4,dbSet(firebaseDependencies,oldTokenDetails)]:[3,6];case 5:return _a.sent(),[2,oldTokenDetails];case 6:return[2]}}))}))}function dbSet(firebaseDependencies,tokenDetails){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var key,db,tx;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return key=index_esm_getKey(firebaseDependencies),[4,index_esm_getDbPromise()];case 1:return db=_a.sent(),[4,(tx=db.transaction(\"firebase-messaging-store\",\"readwrite\")).objectStore(\"firebase-messaging-store\").put(tokenDetails,key)];case 2:return _a.sent(),[4,tx.complete];case 3:return _a.sent(),[2,tokenDetails]}}))}))}function dbRemove(firebaseDependencies){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var key,db,tx;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return key=index_esm_getKey(firebaseDependencies),[4,index_esm_getDbPromise()];case 1:return db=_a.sent(),[4,(tx=db.transaction(\"firebase-messaging-store\",\"readwrite\")).objectStore(\"firebase-messaging-store\").delete(key)];case 2:return _a.sent(),[4,tx.complete];case 3:return _a.sent(),[2]}}))}))}function index_esm_getKey(_a){return _a.appConfig.appId}function requestGetToken(firebaseDependencies,subscriptionOptions){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var headers,body,subscribeOptions,responseData,err_1;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,index_esm_getHeaders(firebaseDependencies)];case 1:headers=_a.sent(),body=getBody(subscriptionOptions),subscribeOptions={method:\"POST\",headers:headers,body:JSON.stringify(body)},_a.label=2;case 2:return _a.trys.push([2,5,,6]),[4,fetch(getEndpoint(firebaseDependencies.appConfig),subscribeOptions)];case 3:return[4,_a.sent().json()];case 4:return responseData=_a.sent(),[3,6];case 5:throw err_1=_a.sent(),index_esm_ERROR_FACTORY.create(\"token-subscribe-failed\",{errorInfo:err_1});case 6:if(responseData.error)throw index_esm_ERROR_FACTORY.create(\"token-subscribe-failed\",{errorInfo:responseData.error.message});if(!responseData.token)throw index_esm_ERROR_FACTORY.create(\"token-subscribe-no-token\");return[2,responseData.token]}}))}))}function requestUpdateToken(firebaseDependencies,tokenDetails){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var headers,body,updateOptions,responseData,err_2;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,index_esm_getHeaders(firebaseDependencies)];case 1:headers=_a.sent(),body=getBody(tokenDetails.subscriptionOptions),updateOptions={method:\"PATCH\",headers:headers,body:JSON.stringify(body)},_a.label=2;case 2:return _a.trys.push([2,5,,6]),[4,fetch(getEndpoint(firebaseDependencies.appConfig)+\"/\"+tokenDetails.token,updateOptions)];case 3:return[4,_a.sent().json()];case 4:return responseData=_a.sent(),[3,6];case 5:throw err_2=_a.sent(),index_esm_ERROR_FACTORY.create(\"token-update-failed\",{errorInfo:err_2});case 6:if(responseData.error)throw index_esm_ERROR_FACTORY.create(\"token-update-failed\",{errorInfo:responseData.error.message});if(!responseData.token)throw index_esm_ERROR_FACTORY.create(\"token-update-no-token\");return[2,responseData.token]}}))}))}function requestDeleteToken(firebaseDependencies,token){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var headers,unsubscribeOptions,responseData,err_3;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,index_esm_getHeaders(firebaseDependencies)];case 1:headers=_a.sent(),unsubscribeOptions={method:\"DELETE\",headers:headers},_a.label=2;case 2:return _a.trys.push([2,5,,6]),[4,fetch(getEndpoint(firebaseDependencies.appConfig)+\"/\"+token,unsubscribeOptions)];case 3:return[4,_a.sent().json()];case 4:if((responseData=_a.sent()).error)throw index_esm_ERROR_FACTORY.create(\"token-unsubscribe-failed\",{errorInfo:responseData.error.message});return[3,6];case 5:throw err_3=_a.sent(),index_esm_ERROR_FACTORY.create(\"token-unsubscribe-failed\",{errorInfo:err_3});case 6:return[2]}}))}))}function getEndpoint(_a){return\"https://fcmregistrations.googleapis.com/v1/projects/\"+_a.projectId+\"/registrations\"}function index_esm_getHeaders(_a){var appConfig=_a.appConfig,installations=_a.installations;return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var authToken;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,installations.getToken()];case 1:return authToken=_b.sent(),[2,new Headers({\"Content-Type\":\"application/json\",Accept:\"application/json\",\"x-goog-api-key\":appConfig.apiKey,\"x-goog-firebase-installations-auth\":\"FIS \"+authToken})]}}))}))}function getBody(_a){var vapidKey=_a.vapidKey,body={web:{endpoint:_a.endpoint,auth:_a.auth,p256dh:_a.p256dh}};return vapidKey!==DEFAULT_VAPID_KEY&&(body.web.applicationPubKey=vapidKey),body}function index_esm_getToken(firebaseDependencies,swRegistration,vapidKey){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var pushSubscription,tokenDetails,subscriptionOptions,e_1;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:if(\"granted\"!==Notification.permission)throw index_esm_ERROR_FACTORY.create(\"permission-blocked\");return[4,getPushSubscription(swRegistration,vapidKey)];case 1:return pushSubscription=_a.sent(),[4,dbGet(firebaseDependencies)];case 2:return tokenDetails=_a.sent(),subscriptionOptions={vapidKey:vapidKey,swScope:swRegistration.scope,endpoint:pushSubscription.endpoint,auth:arrayToBase64(pushSubscription.getKey(\"auth\")),p256dh:arrayToBase64(pushSubscription.getKey(\"p256dh\"))},tokenDetails?[3,3]:[2,getNewToken(firebaseDependencies,subscriptionOptions)];case 3:if(isEndpointEqual=(currentOptions=subscriptionOptions).endpoint===(dbOptions=tokenDetails.subscriptionOptions).endpoint,currentOptions.vapidKey===dbOptions.vapidKey&&isEndpointEqual&&currentOptions.auth===dbOptions.auth&&currentOptions.p256dh===dbOptions.p256dh)return[3,8];_a.label=4;case 4:return _a.trys.push([4,6,,7]),[4,requestDeleteToken(firebaseDependencies,tokenDetails.token)];case 5:return _a.sent(),[3,7];case 6:return e_1=_a.sent(),console.warn(e_1),[3,7];case 7:return[2,getNewToken(firebaseDependencies,subscriptionOptions)];case 8:return Date.now()>=tokenDetails.createTime+6048e5?[2,updateToken({token:tokenDetails.token,createTime:Date.now(),subscriptionOptions:subscriptionOptions},firebaseDependencies,swRegistration)]:[2,tokenDetails.token];case 9:return[2]}var dbOptions,currentOptions,isEndpointEqual}))}))}function deleteToken(firebaseDependencies,swRegistration){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var tokenDetails,pushSubscription;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,dbGet(firebaseDependencies)];case 1:return(tokenDetails=_a.sent())?[4,requestDeleteToken(firebaseDependencies,tokenDetails.token)]:[3,4];case 2:return _a.sent(),[4,dbRemove(firebaseDependencies)];case 3:_a.sent(),_a.label=4;case 4:return[4,swRegistration.pushManager.getSubscription()];case 5:return(pushSubscription=_a.sent())?[2,pushSubscription.unsubscribe()]:[2,!0]}}))}))}function updateToken(tokenDetails,firebaseDependencies,swRegistration){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var updatedToken,updatedTokenDetails,e_2;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,requestUpdateToken(firebaseDependencies,tokenDetails)];case 1:return updatedToken=_a.sent(),updatedTokenDetails=Object(tslib_es6.__assign)(Object(tslib_es6.__assign)({},tokenDetails),{token:updatedToken,createTime:Date.now()}),[4,dbSet(firebaseDependencies,updatedTokenDetails)];case 2:return _a.sent(),[2,updatedToken];case 3:return e_2=_a.sent(),[4,deleteToken(firebaseDependencies,swRegistration)];case 4:throw _a.sent(),e_2;case 5:return[2]}}))}))}function getNewToken(firebaseDependencies,subscriptionOptions){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var token,tokenDetails;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,requestGetToken(firebaseDependencies,subscriptionOptions)];case 1:return token=_a.sent(),tokenDetails={token:token,createTime:Date.now(),subscriptionOptions:subscriptionOptions},[4,dbSet(firebaseDependencies,tokenDetails)];case 2:return _a.sent(),[2,tokenDetails.token]}}))}))}function getPushSubscription(swRegistration,vapidKey){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var subscription;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,swRegistration.pushManager.getSubscription()];case 1:return(subscription=_a.sent())?[2,subscription]:[2,swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:base64ToArray(vapidKey)})]}}))}))}function isConsoleMessage(data){return\"object\"==typeof data&&!!data&&\"google.c.a.c_id\"in data}function index_esm_sleep(ms){return new Promise((function(resolve){setTimeout(resolve,ms)}))}var index_esm_SwController=function(){function SwController(firebaseDependencies){var _this=this;this.firebaseDependencies=firebaseDependencies,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener(\"push\",(function(e){e.waitUntil(_this.onPush(e))})),self.addEventListener(\"pushsubscriptionchange\",(function(e){e.waitUntil(_this.onSubChange(e))})),self.addEventListener(\"notificationclick\",(function(e){e.waitUntil(_this.onNotificationClick(e))}))}return Object.defineProperty(SwController.prototype,\"app\",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),SwController.prototype.setBackgroundMessageHandler=function(callback){if(this.isOnBackgroundMessageUsed=!1,!callback||\"function\"!=typeof callback)throw index_esm_ERROR_FACTORY.create(\"invalid-bg-handler\");this.bgMessageHandler=callback},SwController.prototype.onBackgroundMessage=function(nextOrObserver){var _this=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=nextOrObserver,function(){_this.bgMessageHandler=null}},SwController.prototype.getToken=function(){var _a,_b;return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var tokenDetails;return Object(tslib_es6.__generator)(this,(function(_c){switch(_c.label){case 0:return this.vapidKey?[3,2]:[4,dbGet(this.firebaseDependencies)];case 1:tokenDetails=_c.sent(),this.vapidKey=null!==(_b=null===(_a=null==tokenDetails?void 0:tokenDetails.subscriptionOptions)||void 0===_a?void 0:_a.vapidKey)&&void 0!==_b?_b:DEFAULT_VAPID_KEY,_c.label=2;case 2:return[2,index_esm_getToken(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},SwController.prototype.deleteToken=function(){return deleteToken(this.firebaseDependencies,self.registration)},SwController.prototype.requestPermission=function(){throw index_esm_ERROR_FACTORY.create(\"only-available-in-window\")},SwController.prototype.usePublicVapidKey=function(vapidKey){if(null!==this.vapidKey)throw index_esm_ERROR_FACTORY.create(\"use-vapid-key-after-get-token\");if(\"string\"!=typeof vapidKey||0===vapidKey.length)throw index_esm_ERROR_FACTORY.create(\"invalid-vapid-key\");this.vapidKey=vapidKey},SwController.prototype.useServiceWorker=function(){throw index_esm_ERROR_FACTORY.create(\"only-available-in-window\")},SwController.prototype.onMessage=function(){throw index_esm_ERROR_FACTORY.create(\"only-available-in-window\")},SwController.prototype.onTokenRefresh=function(){throw index_esm_ERROR_FACTORY.create(\"only-available-in-window\")},SwController.prototype.onPush=function(event){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var internalPayload,clientList,isNotificationShown,payload;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return(internalPayload=function(_a){var data=_a.data;if(!data)return null;try{return data.json()}catch(err){return null}}(event))?[4,getClientList()]:(console.debug(\"FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push.\"),[2]);case 1:return function(clientList){return clientList.some((function(client){return\"visible\"===client.visibilityState&&!client.url.startsWith(\"chrome-extension://\")}))}(clientList=_a.sent())?[2,sendMessagePayloadInternalToWindows(clientList,internalPayload)]:(isNotificationShown=!1,internalPayload.notification?[4,showNotification(wrapInternalPayload(internalPayload))]:[3,3]);case 2:_a.sent(),isNotificationShown=!0,_a.label=3;case 3:return!0===isNotificationShown&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(payload=function(internalPayload){var payload={from:internalPayload.from,collapseKey:internalPayload.collapse_key};return function(payload,messagePayloadInternal){if(messagePayloadInternal.notification){payload.notification={};var title=messagePayloadInternal.notification.title;title&&(payload.notification.title=title);var body=messagePayloadInternal.notification.body;body&&(payload.notification.body=body);var image=messagePayloadInternal.notification.image;image&&(payload.notification.image=image)}}(payload,internalPayload),function(payload,messagePayloadInternal){messagePayloadInternal.data&&(payload.data=messagePayloadInternal.data)}(payload,internalPayload),function(payload,messagePayloadInternal){if(messagePayloadInternal.fcmOptions){payload.fcmOptions={};var link=messagePayloadInternal.fcmOptions.link;link&&(payload.fcmOptions.link=link);var analyticsLabel=messagePayloadInternal.fcmOptions.analytics_label;analyticsLabel&&(payload.fcmOptions.analyticsLabel=analyticsLabel)}}(payload,internalPayload),payload}(internalPayload),\"function\"==typeof this.bgMessageHandler?this.bgMessageHandler(payload):this.bgMessageHandler.next(payload)),[4,index_esm_sleep(1e3)]);case 4:return _a.sent(),[2]}}))}))},SwController.prototype.onSubChange=function(event){var _a,_b;return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var tokenDetails;return Object(tslib_es6.__generator)(this,(function(_c){switch(_c.label){case 0:return event.newSubscription?[3,2]:[4,deleteToken(this.firebaseDependencies,self.registration)];case 1:return _c.sent(),[2];case 2:return[4,dbGet(this.firebaseDependencies)];case 3:return tokenDetails=_c.sent(),[4,deleteToken(this.firebaseDependencies,self.registration)];case 4:return _c.sent(),[4,index_esm_getToken(this.firebaseDependencies,self.registration,null!==(_b=null===(_a=null==tokenDetails?void 0:tokenDetails.subscriptionOptions)||void 0===_a?void 0:_a.vapidKey)&&void 0!==_b?_b:DEFAULT_VAPID_KEY)];case 5:return _c.sent(),[2]}}))}))},SwController.prototype.onNotificationClick=function(event){var _a,_b;return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var internalPayload,link,url,originUrl,client;return Object(tslib_es6.__generator)(this,(function(_c){switch(_c.label){case 0:return(internalPayload=null===(_b=null===(_a=event.notification)||void 0===_a?void 0:_a.data)||void 0===_b?void 0:_b.FCM_MSG)?event.action?[2]:(event.stopImmediatePropagation(),event.notification.close(),(link=function(payload){var _a,_b,_c;return(null!==(_b=null===(_a=payload.fcmOptions)||void 0===_a?void 0:_a.link)&&void 0!==_b?_b:null===(_c=payload.notification)||void 0===_c?void 0:_c.click_action)||(isConsoleMessage(payload.data)?self.location.origin:null)}(internalPayload))?(url=new URL(link,self.location.href),originUrl=new URL(self.location.origin),url.host!==originUrl.host?[2]:[4,getWindowClient(url)]):[2]):[2];case 1:return(client=_c.sent())?[3,4]:[4,self.clients.openWindow(link)];case 2:return client=_c.sent(),[4,index_esm_sleep(3e3)];case 3:return _c.sent(),[3,6];case 4:return[4,client.focus()];case 5:client=_c.sent(),_c.label=6;case 6:return client?(internalPayload.messageType=MessageType.NOTIFICATION_CLICKED,internalPayload.isFirebaseMessaging=!0,[2,client.postMessage(internalPayload)]):[2]}}))}))},SwController}();function wrapInternalPayload(internalPayload){var _a,wrappedInternalPayload=Object(tslib_es6.__assign)({},internalPayload.notification);return wrappedInternalPayload.data=((_a={}).FCM_MSG=internalPayload,_a),wrappedInternalPayload}function getWindowClient(url){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var clientList,clientList_1,clientList_1_1,client,clientUrl,e_1,_a;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,getClientList()];case 1:clientList=_b.sent();try{for(clientList_1=Object(tslib_es6.__values)(clientList),clientList_1_1=clientList_1.next();!clientList_1_1.done;clientList_1_1=clientList_1.next())if(client=clientList_1_1.value,clientUrl=new URL(client.url,self.location.href),url.host===clientUrl.host)return[2,client]}catch(e_1_1){e_1={error:e_1_1}}finally{try{clientList_1_1&&!clientList_1_1.done&&(_a=clientList_1.return)&&_a.call(clientList_1)}finally{if(e_1)throw e_1.error}}return[2,null]}}))}))}function sendMessagePayloadInternalToWindows(clientList,internalPayload){var e_2,_a;internalPayload.isFirebaseMessaging=!0,internalPayload.messageType=MessageType.PUSH_RECEIVED;try{for(var clientList_2=Object(tslib_es6.__values)(clientList),clientList_2_1=clientList_2.next();!clientList_2_1.done;clientList_2_1=clientList_2.next())clientList_2_1.value.postMessage(internalPayload)}catch(e_2_1){e_2={error:e_2_1}}finally{try{clientList_2_1&&!clientList_2_1.done&&(_a=clientList_2.return)&&_a.call(clientList_2)}finally{if(e_2)throw e_2.error}}}function getClientList(){return self.clients.matchAll({type:\"window\",includeUncontrolled:!0})}function showNotification(notificationPayloadInternal){var _a,actions=notificationPayloadInternal.actions,maxActions=Notification.maxActions;return actions&&maxActions&&actions.length>maxActions&&console.warn(\"This browser only supports \"+maxActions+\" actions. The remaining actions will not be displayed.\"),self.registration.showNotification(null!==(_a=notificationPayloadInternal.title)&&void 0!==_a?_a:\"\",notificationPayloadInternal)}var index_esm_WindowController=function(){function WindowController(firebaseDependencies){var _this=this;this.firebaseDependencies=firebaseDependencies,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener(\"message\",(function(e){return _this.messageEventListener(e)}))}return Object.defineProperty(WindowController.prototype,\"app\",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),WindowController.prototype.messageEventListener=function(event){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var internalPayload,dataPayload;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return(internalPayload=event.data).isFirebaseMessaging?(this.onMessageCallback&&internalPayload.messageType===MessageType.PUSH_RECEIVED&&(\"function\"==typeof this.onMessageCallback?this.onMessageCallback(function(internalPayload){return delete internalPayload.messageType,delete internalPayload.isFirebaseMessaging,internalPayload}(Object.assign({},internalPayload))):this.onMessageCallback.next(Object.assign({},internalPayload))),isConsoleMessage(dataPayload=internalPayload.data)&&\"1\"===dataPayload[\"google.c.a.e\"]?[4,this.logEvent(internalPayload.messageType,dataPayload)]:[3,2]):[2];case 1:_a.sent(),_a.label=2;case 2:return[2]}}))}))},WindowController.prototype.getVapidKey=function(){return this.vapidKey},WindowController.prototype.getSwReg=function(){return this.swRegistration},WindowController.prototype.getToken=function(options){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return\"default\"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:_a.sent(),_a.label=2;case 2:if(\"granted\"!==Notification.permission)throw index_esm_ERROR_FACTORY.create(\"permission-blocked\");return[4,this.updateVapidKey(null==options?void 0:options.vapidKey)];case 3:return _a.sent(),[4,this.updateSwReg(null==options?void 0:options.serviceWorkerRegistration)];case 4:return _a.sent(),[2,index_esm_getToken(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},WindowController.prototype.updateVapidKey=function(vapidKey){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(_a){return vapidKey?this.vapidKey=vapidKey:this.vapidKey||(this.vapidKey=DEFAULT_VAPID_KEY),[2]}))}))},WindowController.prototype.updateSwReg=function(swRegistration){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return swRegistration||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:_a.sent(),_a.label=2;case 2:if(!swRegistration&&this.swRegistration)return[2];if(!(swRegistration instanceof ServiceWorkerRegistration))throw index_esm_ERROR_FACTORY.create(\"invalid-sw-registration\");return this.swRegistration=swRegistration,[2]}}))}))},WindowController.prototype.registerDefaultSw=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var _a,e_1;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,2,,3]),_a=this,[4,navigator.serviceWorker.register(\"/firebase-messaging-sw.js\",{scope:\"/firebase-cloud-messaging-push-scope\"})];case 1:return _a.swRegistration=_b.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e_1=_b.sent(),index_esm_ERROR_FACTORY.create(\"failed-service-worker-registration\",{browserErrorMessage:e_1.message});case 3:return[2]}}))}))},WindowController.prototype.deleteToken=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:_a.sent(),_a.label=2;case 2:return[2,deleteToken(this.firebaseDependencies,this.swRegistration)]}}))}))},WindowController.prototype.requestPermission=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var permissionResult;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return\"granted\"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if(\"granted\"===(permissionResult=_a.sent()))return[2];throw index_esm_ERROR_FACTORY.create(\"denied\"===permissionResult?\"permission-blocked\":\"permission-default\")}}))}))},WindowController.prototype.usePublicVapidKey=function(vapidKey){if(null!==this.vapidKey)throw index_esm_ERROR_FACTORY.create(\"use-vapid-key-after-get-token\");if(\"string\"!=typeof vapidKey||0===vapidKey.length)throw index_esm_ERROR_FACTORY.create(\"invalid-vapid-key\");this.vapidKey=vapidKey},WindowController.prototype.useServiceWorker=function(swRegistration){if(!(swRegistration instanceof ServiceWorkerRegistration))throw index_esm_ERROR_FACTORY.create(\"invalid-sw-registration\");if(this.swRegistration)throw index_esm_ERROR_FACTORY.create(\"use-sw-after-get-token\");this.swRegistration=swRegistration},WindowController.prototype.onMessage=function(nextOrObserver){var _this=this;return this.onMessageCallback=nextOrObserver,function(){_this.onMessageCallback=null}},WindowController.prototype.setBackgroundMessageHandler=function(){throw index_esm_ERROR_FACTORY.create(\"only-available-in-sw\")},WindowController.prototype.onBackgroundMessage=function(){throw index_esm_ERROR_FACTORY.create(\"only-available-in-sw\")},WindowController.prototype.onTokenRefresh=function(){return function(){}},WindowController.prototype.logEvent=function(messageType,data){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var eventType;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return eventType=function(messageType){switch(messageType){case MessageType.NOTIFICATION_CLICKED:return\"notification_open\";case MessageType.PUSH_RECEIVED:return\"notification_foreground\";default:throw new Error}}(messageType),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return _a.sent().logEvent(eventType,{message_id:data[\"google.c.a.c_id\"],message_name:data[\"google.c.a.c_l\"],message_time:data[\"google.c.a.ts\"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},WindowController}();function index_esm_getMissingValueError(valueName){return index_esm_ERROR_FACTORY.create(\"missing-app-config-values\",{valueName:valueName})}var NAMESPACE_EXPORTS={isSupported:isSupported};function isSupported(){return self&&\"ServiceWorkerGlobalScope\"in self?\"indexedDB\"in self&&null!==indexedDB&&\"PushManager\"in self&&\"Notification\"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty(\"showNotification\")&&PushSubscription.prototype.hasOwnProperty(\"getKey\"):\"indexedDB\"in window&&null!==indexedDB&&navigator.cookieEnabled&&\"serviceWorker\"in navigator&&\"PushManager\"in window&&\"Notification\"in window&&\"fetch\"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty(\"showNotification\")&&PushSubscription.prototype.hasOwnProperty(\"getKey\")}index_esm.default.INTERNAL.registerComponent(new component_dist_index_esm.Component(\"messaging\",(function(container){var app=container.getProvider(\"app\").getImmediate(),firebaseDependencies={app:app,appConfig:function(app){var e_1,_a;if(!app||!app.options)throw index_esm_getMissingValueError(\"App Configuration Object\");if(!app.name)throw index_esm_getMissingValueError(\"App Name\");var options=app.options;try{for(var configKeys_1=Object(tslib_es6.__values)([\"projectId\",\"apiKey\",\"appId\",\"messagingSenderId\"]),configKeys_1_1=configKeys_1.next();!configKeys_1_1.done;configKeys_1_1=configKeys_1.next()){var keyName=configKeys_1_1.value;if(!options[keyName])throw index_esm_getMissingValueError(keyName)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{configKeys_1_1&&!configKeys_1_1.done&&(_a=configKeys_1.return)&&_a.call(configKeys_1)}finally{if(e_1)throw e_1.error}}return{appName:app.name,projectId:options.projectId,apiKey:options.apiKey,appId:options.appId,senderId:options.messagingSenderId}}(app),installations:container.getProvider(\"installations\").getImmediate(),analyticsProvider:container.getProvider(\"analytics-internal\")};if(!isSupported())throw index_esm_ERROR_FACTORY.create(\"unsupported-browser\");return self&&\"ServiceWorkerGlobalScope\"in self?new index_esm_SwController(firebaseDependencies):new index_esm_WindowController(firebaseDependencies)}),\"PUBLIC\").setServiceProps(NAMESPACE_EXPORTS));var index_esm_FirebaseStorageError=function(_super){function FirebaseStorageError(code,message){var _this=_super.call(this,prependCode(code),\"Firebase Storage: \"+message+\" (\"+prependCode(code)+\")\")||this;return _this.customData={serverResponse:null},_this._baseMessage=_this.message,Object.setPrototypeOf(_this,FirebaseStorageError.prototype),_this}return Object(tslib_es6.__extends)(FirebaseStorageError,_super),FirebaseStorageError.prototype._codeEquals=function(code){return prependCode(code)===this.code},Object.defineProperty(FirebaseStorageError.prototype,\"serverResponse\",{get:function(){return this.customData.serverResponse},set:function(serverResponse){this.customData.serverResponse=serverResponse,this.message=this.customData.serverResponse?this._baseMessage+\"\\n\"+this.customData.serverResponse:this._baseMessage},enumerable:!1,configurable:!0}),FirebaseStorageError}(util_dist_index_esm.FirebaseError);function prependCode(code){return\"storage/\"+code}function unknown(){return new index_esm_FirebaseStorageError(\"unknown\",\"An unknown error occurred, please check the error payload for server response.\")}function index_esm_canceled(){return new index_esm_FirebaseStorageError(\"canceled\",\"User canceled the upload/download.\")}function cannotSliceBlob(){return new index_esm_FirebaseStorageError(\"cannot-slice-blob\",\"Cannot slice blob for upload. Please retry the upload.\")}function invalidArgument(message){return new index_esm_FirebaseStorageError(\"invalid-argument\",message)}function appDeleted(){return new index_esm_FirebaseStorageError(\"app-deleted\",\"The Firebase app was deleted.\")}function invalidRootOperation(name){return new index_esm_FirebaseStorageError(\"invalid-root-operation\",\"The operation '\"+name+\"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').\")}function invalidFormat(format,message){return new index_esm_FirebaseStorageError(\"invalid-format\",\"String does not match format '\"+format+\"': \"+message)}function internalError(message){throw new index_esm_FirebaseStorageError(\"internal-error\",\"Internal error: \"+message)}var StringFormat={RAW:\"raw\",BASE64:\"base64\",BASE64URL:\"base64url\",DATA_URL:\"data_url\"},StringData=function(){return function(data,contentType){this.data=data,this.contentType=contentType||null}}();function dataFromString(format,stringData){switch(format){case StringFormat.RAW:return new StringData(utf8Bytes_(stringData));case StringFormat.BASE64:case StringFormat.BASE64URL:return new StringData(base64Bytes_(format,stringData));case StringFormat.DATA_URL:return new StringData((parts=new DataURLParts(stringData)).base64?base64Bytes_(StringFormat.BASE64,parts.rest):function(value){var decoded;try{decoded=decodeURIComponent(value)}catch(e){throw invalidFormat(StringFormat.DATA_URL,\"Malformed data URL.\")}return utf8Bytes_(decoded)}(parts.rest),function(dataUrl){return new DataURLParts(dataUrl).contentType}(stringData))}var parts;throw unknown()}function utf8Bytes_(value){for(var b=[],i=0;i<value.length;i++){var c=value.charCodeAt(i);if(c<=127)b.push(c);else if(c<=2047)b.push(192|c>>6,128|63&c);else if(55296==(64512&c))if(i<value.length-1&&56320==(64512&value.charCodeAt(i+1))){var hi=c,lo=value.charCodeAt(++i);b.push(240|(c=65536|(1023&hi)<<10|1023&lo)>>18,128|c>>12&63,128|c>>6&63,128|63&c)}else b.push(239,191,189);else 56320==(64512&c)?b.push(239,191,189):b.push(224|c>>12,128|c>>6&63,128|63&c)}return new Uint8Array(b)}function base64Bytes_(format,value){switch(format){case StringFormat.BASE64:var hasMinus=-1!==value.indexOf(\"-\"),hasUnder=-1!==value.indexOf(\"_\");if(hasMinus||hasUnder)throw invalidFormat(format,\"Invalid character '\"+(hasMinus?\"-\":\"_\")+\"' found: is it base64url encoded?\");break;case StringFormat.BASE64URL:var hasPlus=-1!==value.indexOf(\"+\"),hasSlash=-1!==value.indexOf(\"/\");if(hasPlus||hasSlash)throw invalidFormat(format,\"Invalid character '\"+(hasPlus?\"+\":\"/\")+\"' found: is it base64 encoded?\");value=value.replace(/-/g,\"+\").replace(/_/g,\"/\")}var bytes;try{bytes=atob(value)}catch(e){throw invalidFormat(format,\"Invalid character found\")}for(var array=new Uint8Array(bytes.length),i=0;i<bytes.length;i++)array[i]=bytes.charCodeAt(i);return array}var DataURLParts=function(){return function(dataURL){this.base64=!1,this.contentType=null;var matches=dataURL.match(/^data:([^,]+)?,/);if(null===matches)throw invalidFormat(StringFormat.DATA_URL,\"Must be formatted 'data:[<mediatype>][;base64],<data>\");var s,middle=matches[1]||null;null!=middle&&(this.base64=(s=middle).length>=\";base64\".length&&\";base64\"===s.substring(s.length-\";base64\".length),this.contentType=this.base64?middle.substring(0,middle.length-\";base64\".length):middle),this.rest=dataURL.substring(dataURL.indexOf(\",\")+1)}}(),TaskEvent={STATE_CHANGED:\"state_changed\"},TaskState={RUNNING:\"running\",PAUSED:\"paused\",SUCCESS:\"success\",CANCELED:\"canceled\",ERROR:\"error\"};function taskStateFromInternalTaskState(state){switch(state){case\"running\":case\"pausing\":case\"canceling\":return TaskState.RUNNING;case\"paused\":return TaskState.PAUSED;case\"success\":return TaskState.SUCCESS;case\"canceled\":return TaskState.CANCELED;case\"error\":default:return TaskState.ERROR}}var index_esm_ErrorCode=function(ErrorCode){return ErrorCode[ErrorCode.NO_ERROR=0]=\"NO_ERROR\",ErrorCode[ErrorCode.NETWORK_ERROR=1]=\"NETWORK_ERROR\",ErrorCode[ErrorCode.ABORT=2]=\"ABORT\",ErrorCode}({}),NetworkXhrIo=function(){function NetworkXhrIo(){var _this=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=index_esm_ErrorCode.NO_ERROR,this.sendPromise_=new Promise((function(resolve){_this.xhr_.addEventListener(\"abort\",(function(){_this.errorCode_=index_esm_ErrorCode.ABORT,resolve(_this)})),_this.xhr_.addEventListener(\"error\",(function(){_this.errorCode_=index_esm_ErrorCode.NETWORK_ERROR,resolve(_this)})),_this.xhr_.addEventListener(\"load\",(function(){resolve(_this)}))}))}return NetworkXhrIo.prototype.send=function(url,method,body,headers){if(this.sent_)throw internalError(\"cannot .send() more than once\");if(this.sent_=!0,this.xhr_.open(method,url,!0),void 0!==headers)for(var key in headers)headers.hasOwnProperty(key)&&this.xhr_.setRequestHeader(key,headers[key].toString());return void 0!==body?this.xhr_.send(body):this.xhr_.send(),this.sendPromise_},NetworkXhrIo.prototype.getErrorCode=function(){if(!this.sent_)throw internalError(\"cannot .getErrorCode() before sending\");return this.errorCode_},NetworkXhrIo.prototype.getStatus=function(){if(!this.sent_)throw internalError(\"cannot .getStatus() before sending\");try{return this.xhr_.status}catch(e){return-1}},NetworkXhrIo.prototype.getResponseText=function(){if(!this.sent_)throw internalError(\"cannot .getResponseText() before sending\");return this.xhr_.responseText},NetworkXhrIo.prototype.abort=function(){this.xhr_.abort()},NetworkXhrIo.prototype.getResponseHeader=function(header){return this.xhr_.getResponseHeader(header)},NetworkXhrIo.prototype.addUploadProgressListener=function(listener){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener(\"progress\",listener)},NetworkXhrIo.prototype.removeUploadProgressListener=function(listener){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener(\"progress\",listener)},NetworkXhrIo}(),XhrIoPool=function(){function XhrIoPool(){}return XhrIoPool.prototype.createXhrIo=function(){return new NetworkXhrIo},XhrIoPool}(),Location=function(){function Location(bucket,path){this.bucket=bucket,this.path_=path}return Object.defineProperty(Location.prototype,\"path\",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(Location.prototype,\"isRoot\",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),Location.prototype.fullServerUrl=function(){var encode=encodeURIComponent;return\"/b/\"+encode(this.bucket)+\"/o/\"+encode(this.path)},Location.prototype.bucketOnlyServerUrl=function(){return\"/b/\"+encodeURIComponent(this.bucket)+\"/o\"},Location.makeFromBucketSpec=function(bucketString,host){var bucketLocation;try{bucketLocation=Location.makeFromUrl(bucketString,host)}catch(e){return new Location(bucketString,\"\")}if(\"\"===bucketLocation.path)return bucketLocation;throw new index_esm_FirebaseStorageError(\"invalid-default-bucket\",\"Invalid default bucket '\"+bucketString+\"'.\")},Location.makeFromUrl=function(url,host){var location=null,gsRegex=new RegExp(\"^gs://([A-Za-z0-9.\\\\-_]+)(/(.*))?$\",\"i\");function httpModify(loc){loc.path_=decodeURIComponent(loc.path)}for(var firebaseStorageHost=host.replace(/[.]/g,\"\\\\.\"),groups=[{regex:gsRegex,indices:{bucket:1,path:3},postModify:function(loc){\"/\"===loc.path.charAt(loc.path.length-1)&&(loc.path_=loc.path_.slice(0,-1))}},{regex:new RegExp(\"^https?://\"+firebaseStorageHost+\"/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\\\-_]+)/o(/([^?#]*).*)?$\",\"i\"),indices:{bucket:1,path:3},postModify:httpModify},{regex:new RegExp(\"^https?://\"+(\"firebasestorage.googleapis.com\"===host?\"(?:storage.googleapis.com|storage.cloud.google.com)\":host)+\"/([A-Za-z0-9.\\\\-_]+)/([^?#]*)\",\"i\"),indices:{bucket:1,path:2},postModify:httpModify}],i=0;i<groups.length;i++){var group=groups[i],captures=group.regex.exec(url);if(captures){var pathValue=captures[group.indices.path];pathValue||(pathValue=\"\"),location=new Location(captures[group.indices.bucket],pathValue),group.postModify(location);break}}if(null==location)throw function(url){return new index_esm_FirebaseStorageError(\"invalid-url\",\"Invalid URL '\"+url+\"'.\")}(url);return location},Location}(),FailRequest=function(){function FailRequest(error){this.promise_=Promise.reject(error)}return FailRequest.prototype.getPromise=function(){return this.promise_},FailRequest.prototype.cancel=function(_appDelete){},FailRequest}();function isString(p){return\"string\"==typeof p||p instanceof String}function isNativeBlob(p){return isNativeBlobDefined()&&p instanceof Blob}function isNativeBlobDefined(){return\"undefined\"!=typeof Blob}function validateNumber(argument,minValue,maxValue,value){if(value<minValue)throw invalidArgument(\"Invalid value for '\"+argument+\"'. Expected \"+minValue+\" or greater.\");if(value>maxValue)throw invalidArgument(\"Invalid value for '\"+argument+\"'. Expected \"+maxValue+\" or less.\")}function makeUrl(urlPart,host){var protocolMatch=host.match(/^(\\w+):\\/\\/.+/),origin=host;return null==(null==protocolMatch?void 0:protocolMatch[1])&&(origin=\"https://\"+host),origin+\"/v0\"+urlPart}function makeQueryString(params){var encode=encodeURIComponent,queryPart=\"?\";for(var key in params)params.hasOwnProperty(key)&&(queryPart=queryPart+(encode(key)+\"=\")+encode(params[key])+\"&\");return queryPart.slice(0,-1)}var NetworkRequest=function(){function NetworkRequest(url,method,headers,body,successCodes,additionalRetryCodes,callback,errorCallback,timeout,progressCallback,pool){var _this=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=url,this.method_=method,this.headers_=headers,this.body_=body,this.successCodes_=successCodes.slice(),this.additionalRetryCodes_=additionalRetryCodes.slice(),this.callback_=callback,this.errorCallback_=errorCallback,this.progressCallback_=progressCallback,this.timeout_=timeout,this.pool_=pool,this.promise_=new Promise((function(resolve,reject){_this.resolve_=resolve,_this.reject_=reject,_this.start_()}))}return NetworkRequest.prototype.start_=function(){var self=this;function backoffDone(requestWentThrough,status){var err,resolve=self.resolve_,reject=self.reject_,xhr=status.xhr;if(status.wasSuccessCode)try{var result=self.callback_(xhr,xhr.getResponseText());void 0!==result?resolve(result):resolve()}catch(e){reject(e)}else null!==xhr?((err=unknown()).serverResponse=xhr.getResponseText(),reject(self.errorCallback_?self.errorCallback_(xhr,err):err)):reject(err=status.canceled?self.appDelete_?appDeleted():index_esm_canceled():new index_esm_FirebaseStorageError(\"retry-limit-exceeded\",\"Max retry time for operation exceeded, please try again.\"))}this.canceled_?backoffDone(0,new RequestEndStatus(!1,null,!0)):this.backoffId_=function(f,callback,timeout){var waitSeconds=1,timeoutId=null,hitTimeout=!1,cancelState=0;function canceled(){return 2===cancelState}var triggeredCallback=!1;function triggerCallback(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];triggeredCallback||(triggeredCallback=!0,callback.apply(null,args))}function callWithDelay(millis){timeoutId=setTimeout((function(){timeoutId=null,function(backoffCallback,canceled){if(canceled)backoffCallback(!1,new RequestEndStatus(!1,null,!0));else{var xhr=self.pool_.createXhrIo();self.pendingXhr_=xhr,null!==self.progressCallback_&&xhr.addUploadProgressListener(progressListener),xhr.send(self.url_,self.method_,self.body_,self.headers_).then((function(xhr){null!==self.progressCallback_&&xhr.removeUploadProgressListener(progressListener),self.pendingXhr_=null;var hitServer=(xhr=xhr).getErrorCode()===index_esm_ErrorCode.NO_ERROR,status=xhr.getStatus();if(hitServer&&!self.isRetryStatusCode_(status)){var successCode=-1!==self.successCodes_.indexOf(status);backoffCallback(!0,new RequestEndStatus(successCode,xhr))}else{var wasCanceled=xhr.getErrorCode()===index_esm_ErrorCode.ABORT;backoffCallback(!1,new RequestEndStatus(!1,null,wasCanceled))}}))}function progressListener(progressEvent){null!==self.progressCallback_&&self.progressCallback_(progressEvent.loaded,progressEvent.lengthComputable?progressEvent.total:-1)}}(handler,canceled())}),millis)}function handler(success){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];if(!triggeredCallback)if(success)triggerCallback.call.apply(triggerCallback,Object(tslib_es6.__spreadArray)([null,success],args));else{var waitMillis,mustStop=canceled()||hitTimeout;mustStop?triggerCallback.call.apply(triggerCallback,Object(tslib_es6.__spreadArray)([null,success],args)):(waitSeconds<64&&(waitSeconds*=2),1===cancelState?(cancelState=2,waitMillis=0):waitMillis=1e3*(waitSeconds+Math.random()),callWithDelay(waitMillis))}}var stopped=!1;function stop(wasTimeout){stopped||(stopped=!0,triggeredCallback||(null!==timeoutId?(wasTimeout||(cancelState=2),clearTimeout(timeoutId),callWithDelay(0)):wasTimeout||(cancelState=1)))}return callWithDelay(0),setTimeout((function(){hitTimeout=!0,stop(!0)}),timeout),stop}(0,backoffDone,this.timeout_)},NetworkRequest.prototype.getPromise=function(){return this.promise_},NetworkRequest.prototype.cancel=function(appDelete){this.canceled_=!0,this.appDelete_=appDelete||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},NetworkRequest.prototype.isRetryStatusCode_=function(status){var isFiveHundredCode=status>=500&&status<600,isExtraRetryCode=-1!==[408,429].indexOf(status),isRequestSpecificRetryCode=-1!==this.additionalRetryCodes_.indexOf(status);return isFiveHundredCode||isExtraRetryCode||isRequestSpecificRetryCode},NetworkRequest}(),RequestEndStatus=function(){return function(wasSuccessCode,xhr,canceled){this.wasSuccessCode=wasSuccessCode,this.xhr=xhr,this.canceled=!!canceled}}();function getBlobBuilder(){return\"undefined\"!=typeof BlobBuilder?BlobBuilder:\"undefined\"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function getBlob(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var BlobBuilder=getBlobBuilder();if(void 0!==BlobBuilder){for(var bb=new BlobBuilder,i=0;i<args.length;i++)bb.append(args[i]);return bb.getBlob()}if(isNativeBlobDefined())return new Blob(args);throw new index_esm_FirebaseStorageError(\"unsupported-environment\",\"This browser doesn't seem to support creating Blobs\")}var FbsBlob=function(){function FbsBlob(data,elideCopy){var size=0,blobType=\"\";isNativeBlob(data)?(this.data_=data,size=data.size,blobType=data.type):data instanceof ArrayBuffer?(elideCopy?this.data_=new Uint8Array(data):(this.data_=new Uint8Array(data.byteLength),this.data_.set(new Uint8Array(data))),size=this.data_.length):data instanceof Uint8Array&&(elideCopy?this.data_=data:(this.data_=new Uint8Array(data.length),this.data_.set(data)),size=data.length),this.size_=size,this.type_=blobType}return FbsBlob.prototype.size=function(){return this.size_},FbsBlob.prototype.type=function(){return this.type_},FbsBlob.prototype.slice=function(startByte,endByte){if(isNativeBlob(this.data_)){var sliced=(start=startByte,end=endByte,(blob=this.data_).webkitSlice?blob.webkitSlice(start,end):blob.mozSlice?blob.mozSlice(start,end):blob.slice?blob.slice(start,end):null);return null===sliced?null:new FbsBlob(sliced)}var blob,start,end;return new FbsBlob(new Uint8Array(this.data_.buffer,startByte,endByte-startByte),!0)},FbsBlob.getBlob=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];if(isNativeBlobDefined()){var blobby=args.map((function(val){return val instanceof FbsBlob?val.data_:val}));return new FbsBlob(getBlob.apply(null,blobby))}var uint8Arrays=args.map((function(val){return isString(val)?dataFromString(StringFormat.RAW,val).data:val.data_})),finalLength_1=0;uint8Arrays.forEach((function(array){finalLength_1+=array.byteLength}));var merged_1=new Uint8Array(finalLength_1),index_1=0;return uint8Arrays.forEach((function(array){for(var i=0;i<array.length;i++)merged_1[index_1++]=array[i]})),new FbsBlob(merged_1,!0)},FbsBlob.prototype.uploadData=function(){return this.data_},FbsBlob}();function jsonObjectOrNull(s){var obj,p;try{obj=JSON.parse(s)}catch(e){return null}return\"object\"!=typeof(p=obj)||Array.isArray(p)?null:obj}function lastComponent(path){var index=path.lastIndexOf(\"/\",path.length-2);return-1===index?path:path.slice(index+1)}function noXform_(metadata,value){return value}var Mapping=function(){return function(server,local,writable,xform){this.server=server,this.local=local||server,this.writable=!!writable,this.xform=xform||noXform_}}(),mappings_=null;function getMappings(){if(mappings_)return mappings_;var mappings=[];mappings.push(new Mapping(\"bucket\")),mappings.push(new Mapping(\"generation\")),mappings.push(new Mapping(\"metageneration\")),mappings.push(new Mapping(\"name\",\"fullPath\",!0));var nameMapping=new Mapping(\"name\");nameMapping.xform=function(_metadata,fullPath){return function(fullPath){return!isString(fullPath)||fullPath.length<2?fullPath:lastComponent(fullPath)}(fullPath)},mappings.push(nameMapping);var sizeMapping=new Mapping(\"size\");return sizeMapping.xform=function(_metadata,size){return void 0!==size?Number(size):size},mappings.push(sizeMapping),mappings.push(new Mapping(\"timeCreated\")),mappings.push(new Mapping(\"updated\")),mappings.push(new Mapping(\"md5Hash\",null,!0)),mappings.push(new Mapping(\"cacheControl\",null,!0)),mappings.push(new Mapping(\"contentDisposition\",null,!0)),mappings.push(new Mapping(\"contentEncoding\",null,!0)),mappings.push(new Mapping(\"contentLanguage\",null,!0)),mappings.push(new Mapping(\"contentType\",null,!0)),mappings.push(new Mapping(\"metadata\",\"customMetadata\",!0)),mappings_=mappings}function fromResourceString(service,resourceString,mappings){var obj=jsonObjectOrNull(resourceString);return null===obj?null:function(service,resource,mappings){for(var metadata={type:\"file\"},len=mappings.length,i=0;i<len;i++){var mapping=mappings[i];metadata[mapping.local]=mapping.xform(metadata,resource[mapping.server])}return function(metadata,service){Object.defineProperty(metadata,\"ref\",{get:function(){var loc=new Location(metadata.bucket,metadata.fullPath);return service._makeStorageReference(loc)}})}(metadata,service),metadata}(service,obj,mappings)}function toResourceString(metadata,mappings){for(var resource={},len=mappings.length,i=0;i<len;i++){var mapping=mappings[i];mapping.writable&&(resource[mapping.server]=metadata[mapping.local])}return JSON.stringify(resource)}var RequestInfo=function(){return function(url,method,handler,timeout){this.url=url,this.method=method,this.handler=handler,this.timeout=timeout,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}();function handlerCheck(cndn){if(!cndn)throw unknown()}function metadataHandler(service,mappings){return function(xhr,text){var metadata=fromResourceString(service,text,mappings);return handlerCheck(null!==metadata),metadata}}function sharedErrorHandler(location){return function(xhr,err){var newErr;return(newErr=401===xhr.getStatus()?xhr.getResponseText().includes(\"Firebase App Check token is invalid\")?new index_esm_FirebaseStorageError(\"unauthorized-app\",\"This app does not have permission to access Firebase Storage on this project.\"):new index_esm_FirebaseStorageError(\"unauthenticated\",\"User is not authenticated, please authenticate using Firebase Authentication and try again.\"):402===xhr.getStatus()?new index_esm_FirebaseStorageError(\"quota-exceeded\",\"Quota for bucket '\"+location.bucket+\"' exceeded, please view quota on https://firebase.google.com/pricing/.\"):403===xhr.getStatus()?new index_esm_FirebaseStorageError(\"unauthorized\",\"User does not have permission to access '\"+location.path+\"'.\"):err).serverResponse=err.serverResponse,newErr}}function objectErrorHandler(location){var shared=sharedErrorHandler(location);return function(xhr,err){var newErr=shared(xhr,err);return 404===xhr.getStatus()&&(newErr=new index_esm_FirebaseStorageError(\"object-not-found\",\"Object '\"+location.path+\"' does not exist.\")),newErr.serverResponse=err.serverResponse,newErr}}function getMetadata(service,location,mappings){var url=makeUrl(location.fullServerUrl(),service.host),timeout=service.maxOperationRetryTime,requestInfo=new RequestInfo(url,\"GET\",metadataHandler(service,mappings),timeout);return requestInfo.errorHandler=objectErrorHandler(location),requestInfo}function metadataForUpload_(location,blob,metadata){var metadataClone=Object.assign({},metadata);return metadataClone.fullPath=location.path,metadataClone.size=blob.size(),metadataClone.contentType||(metadataClone.contentType=function(metadata,blob){return blob&&blob.type()||\"application/octet-stream\"}(0,blob)),metadataClone}var ResumableUploadStatus=function(){return function(current,total,finalized,metadata){this.current=current,this.total=total,this.finalized=!!finalized,this.metadata=metadata||null}}();function checkResumeHeader_(xhr,allowed){var status=null;try{status=xhr.getResponseHeader(\"X-Goog-Upload-Status\")}catch(e){handlerCheck(!1)}return handlerCheck(!!status&&-1!==(allowed||[\"active\"]).indexOf(status)),status}var Observer=function(){return function(nextOrObserver,error,complete){if(\"function\"==typeof nextOrObserver||null!=error||null!=complete)this.next=nextOrObserver,this.error=error,this.complete=complete;else{var observer=nextOrObserver;this.next=observer.next,this.error=observer.error,this.complete=observer.complete}}}();function index_esm_async(f){return function(){for(var argsToForward=[],_i=0;_i<arguments.length;_i++)argsToForward[_i]=arguments[_i];Promise.resolve().then((function(){return f.apply(void 0,argsToForward)}))}}var UploadTask=function(){function UploadTask(ref,blob,metadata){var _this=this;void 0===metadata&&(metadata=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=ref,this._blob=blob,this._metadata=metadata,this._mappings=getMappings(),this._resumable=this._shouldDoResumable(this._blob),this._state=\"running\",this._errorHandler=function(error){_this._request=void 0,_this._chunkMultiplier=1,error._codeEquals(\"canceled\")?(_this._needToFetchStatus=!0,_this.completeTransitions_()):(_this._error=error,_this._transition(\"error\"))},this._metadataErrorHandler=function(error){_this._request=void 0,error._codeEquals(\"canceled\")?_this.completeTransitions_():(_this._error=error,_this._transition(\"error\"))},this._promise=new Promise((function(resolve,reject){_this._resolve=resolve,_this._reject=reject,_this._start()})),this._promise.then(null,(function(){}))}return UploadTask.prototype._makeProgressCallback=function(){var _this=this,sizeBefore=this._transferred;return function(loaded){return _this._updateProgress(sizeBefore+loaded)}},UploadTask.prototype._shouldDoResumable=function(blob){return blob.size()>262144},UploadTask.prototype._start=function(){\"running\"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},UploadTask.prototype._resolveToken=function(callback){var _this=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(_a){var authToken=_a[0],appCheckToken=_a[1];switch(_this._state){case\"running\":callback(authToken,appCheckToken);break;case\"canceling\":_this._transition(\"canceled\");break;case\"pausing\":_this._transition(\"paused\")}}))},UploadTask.prototype._createResumable=function(){var _this=this;this._resolveToken((function(authToken,appCheckToken){var requestInfo=function(service,location,mappings,blob,metadata){var urlPart=location.bucketOnlyServerUrl(),metadataForUpload=metadataForUpload_(location,blob,metadata),urlParams={name:metadataForUpload.fullPath},url=makeUrl(urlPart,service.host),headers={\"X-Goog-Upload-Protocol\":\"resumable\",\"X-Goog-Upload-Command\":\"start\",\"X-Goog-Upload-Header-Content-Length\":blob.size(),\"X-Goog-Upload-Header-Content-Type\":metadataForUpload.contentType,\"Content-Type\":\"application/json; charset=utf-8\"},body=toResourceString(metadataForUpload,mappings),requestInfo=new RequestInfo(url,\"POST\",(function(xhr){var url;checkResumeHeader_(xhr);try{url=xhr.getResponseHeader(\"X-Goog-Upload-URL\")}catch(e){handlerCheck(!1)}return handlerCheck(isString(url)),url}),service.maxUploadRetryTime);return requestInfo.urlParams=urlParams,requestInfo.headers=headers,requestInfo.body=body,requestInfo.errorHandler=sharedErrorHandler(location),requestInfo}(_this._ref.storage,_this._ref._location,_this._mappings,_this._blob,_this._metadata),createRequest=_this._ref.storage._makeRequest(requestInfo,authToken,appCheckToken);_this._request=createRequest,createRequest.getPromise().then((function(url){_this._request=void 0,_this._uploadUrl=url,_this._needToFetchStatus=!1,_this.completeTransitions_()}),_this._errorHandler)}))},UploadTask.prototype._fetchStatus=function(){var _this=this,url=this._uploadUrl;this._resolveToken((function(authToken,appCheckToken){var requestInfo=function(service,location,url,blob){var requestInfo=new RequestInfo(url,\"POST\",(function(xhr){var status=checkResumeHeader_(xhr,[\"active\",\"final\"]),sizeString=null;try{sizeString=xhr.getResponseHeader(\"X-Goog-Upload-Size-Received\")}catch(e){handlerCheck(!1)}sizeString||handlerCheck(!1);var size=Number(sizeString);return handlerCheck(!isNaN(size)),new ResumableUploadStatus(size,blob.size(),\"final\"===status)}),service.maxUploadRetryTime);return requestInfo.headers={\"X-Goog-Upload-Command\":\"query\"},requestInfo.errorHandler=sharedErrorHandler(location),requestInfo}(_this._ref.storage,_this._ref._location,url,_this._blob),statusRequest=_this._ref.storage._makeRequest(requestInfo,authToken,appCheckToken);_this._request=statusRequest,statusRequest.getPromise().then((function(status){status=status,_this._request=void 0,_this._updateProgress(status.current),_this._needToFetchStatus=!1,status.finalized&&(_this._needToFetchMetadata=!0),_this.completeTransitions_()}),_this._errorHandler)}))},UploadTask.prototype._continueUpload=function(){var _this=this,chunkSize=262144*this._chunkMultiplier,status=new ResumableUploadStatus(this._transferred,this._blob.size()),url=this._uploadUrl;this._resolveToken((function(authToken,appCheckToken){var requestInfo;try{requestInfo=function(location,service,url,blob,chunkSize,mappings,status,progressCallback){var status_=new ResumableUploadStatus(0,0);if(status?(status_.current=status.current,status_.total=status.total):(status_.current=0,status_.total=blob.size()),blob.size()!==status_.total)throw new index_esm_FirebaseStorageError(\"server-file-wrong-size\",\"Server recorded incorrect upload file size, please retry the upload.\");var bytesLeft=status_.total-status_.current,bytesToUpload=bytesLeft;chunkSize>0&&(bytesToUpload=Math.min(bytesToUpload,chunkSize));var startByte=status_.current,headers={\"X-Goog-Upload-Command\":bytesToUpload===bytesLeft?\"upload, finalize\":\"upload\",\"X-Goog-Upload-Offset\":status_.current},body=blob.slice(startByte,startByte+bytesToUpload);if(null===body)throw cannotSliceBlob();var requestInfo=new RequestInfo(url,\"POST\",(function(xhr,text){var metadata,uploadStatus=checkResumeHeader_(xhr,[\"active\",\"final\"]),newCurrent=status_.current+bytesToUpload,size=blob.size();return metadata=\"final\"===uploadStatus?metadataHandler(service,mappings)(xhr,text):null,new ResumableUploadStatus(newCurrent,size,\"final\"===uploadStatus,metadata)}),service.maxUploadRetryTime);return requestInfo.headers=headers,requestInfo.body=body.uploadData(),requestInfo.progressCallback=progressCallback||null,requestInfo.errorHandler=sharedErrorHandler(location),requestInfo}(_this._ref._location,_this._ref.storage,url,_this._blob,chunkSize,_this._mappings,status,_this._makeProgressCallback())}catch(e){return _this._error=e,void _this._transition(\"error\")}var uploadRequest=_this._ref.storage._makeRequest(requestInfo,authToken,appCheckToken);_this._request=uploadRequest,uploadRequest.getPromise().then((function(newStatus){_this._increaseMultiplier(),_this._request=void 0,_this._updateProgress(newStatus.current),newStatus.finalized?(_this._metadata=newStatus.metadata,_this._transition(\"success\")):_this.completeTransitions_()}),_this._errorHandler)}))},UploadTask.prototype._increaseMultiplier=function(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},UploadTask.prototype._fetchMetadata=function(){var _this=this;this._resolveToken((function(authToken,appCheckToken){var requestInfo=getMetadata(_this._ref.storage,_this._ref._location,_this._mappings),metadataRequest=_this._ref.storage._makeRequest(requestInfo,authToken,appCheckToken);_this._request=metadataRequest,metadataRequest.getPromise().then((function(metadata){_this._request=void 0,_this._metadata=metadata,_this._transition(\"success\")}),_this._metadataErrorHandler)}))},UploadTask.prototype._oneShotUpload=function(){var _this=this;this._resolveToken((function(authToken,appCheckToken){var requestInfo=function(service,location,mappings,blob,metadata){var urlPart=location.bucketOnlyServerUrl(),headers={\"X-Goog-Upload-Protocol\":\"multipart\"},boundary=function(){for(var str=\"\",i=0;i<2;i++)str+=Math.random().toString().slice(2);return str}();headers[\"Content-Type\"]=\"multipart/related; boundary=\"+boundary;var metadata_=metadataForUpload_(location,blob,metadata),metadataString=toResourceString(metadata_,mappings),body=FbsBlob.getBlob(\"--\"+boundary+\"\\r\\nContent-Type: application/json; charset=utf-8\\r\\n\\r\\n\"+metadataString+\"\\r\\n--\"+boundary+\"\\r\\nContent-Type: \"+metadata_.contentType+\"\\r\\n\\r\\n\",blob,\"\\r\\n--\"+boundary+\"--\");if(null===body)throw cannotSliceBlob();var urlParams={name:metadata_.fullPath},url=makeUrl(urlPart,service.host),timeout=service.maxUploadRetryTime,requestInfo=new RequestInfo(url,\"POST\",metadataHandler(service,mappings),timeout);return requestInfo.urlParams=urlParams,requestInfo.headers=headers,requestInfo.body=body.uploadData(),requestInfo.errorHandler=sharedErrorHandler(location),requestInfo}(_this._ref.storage,_this._ref._location,_this._mappings,_this._blob,_this._metadata),multipartRequest=_this._ref.storage._makeRequest(requestInfo,authToken,appCheckToken);_this._request=multipartRequest,multipartRequest.getPromise().then((function(metadata){_this._request=void 0,_this._metadata=metadata,_this._updateProgress(_this._blob.size()),_this._transition(\"success\")}),_this._errorHandler)}))},UploadTask.prototype._updateProgress=function(transferred){var old=this._transferred;this._transferred=transferred,this._transferred!==old&&this._notifyObservers()},UploadTask.prototype._transition=function(state){if(this._state!==state)switch(state){case\"canceling\":case\"pausing\":this._state=state,void 0!==this._request&&this._request.cancel();break;case\"running\":var wasPaused=\"paused\"===this._state;this._state=state,wasPaused&&(this._notifyObservers(),this._start());break;case\"paused\":this._state=state,this._notifyObservers();break;case\"canceled\":this._error=index_esm_canceled(),this._state=state,this._notifyObservers();break;case\"error\":case\"success\":this._state=state,this._notifyObservers()}},UploadTask.prototype.completeTransitions_=function(){switch(this._state){case\"pausing\":this._transition(\"paused\");break;case\"canceling\":this._transition(\"canceled\");break;case\"running\":this._start()}},Object.defineProperty(UploadTask.prototype,\"snapshot\",{get:function(){var externalState=taskStateFromInternalTaskState(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:externalState,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),UploadTask.prototype.on=function(type,nextOrObserver,error,completed){var _this=this,observer=new Observer(nextOrObserver,error,completed);return this._addObserver(observer),function(){_this._removeObserver(observer)}},UploadTask.prototype.then=function(onFulfilled,onRejected){return this._promise.then(onFulfilled,onRejected)},UploadTask.prototype.catch=function(onRejected){return this.then(null,onRejected)},UploadTask.prototype._addObserver=function(observer){this._observers.push(observer),this._notifyObserver(observer)},UploadTask.prototype._removeObserver=function(observer){var i=this._observers.indexOf(observer);-1!==i&&this._observers.splice(i,1)},UploadTask.prototype._notifyObservers=function(){var _this=this;this._finishPromise(),this._observers.slice().forEach((function(observer){_this._notifyObserver(observer)}))},UploadTask.prototype._finishPromise=function(){if(void 0!==this._resolve){var triggered=!0;switch(taskStateFromInternalTaskState(this._state)){case TaskState.SUCCESS:index_esm_async(this._resolve.bind(null,this.snapshot))();break;case TaskState.CANCELED:case TaskState.ERROR:index_esm_async(this._reject.bind(null,this._error))();break;default:triggered=!1}triggered&&(this._resolve=void 0,this._reject=void 0)}},UploadTask.prototype._notifyObserver=function(observer){switch(taskStateFromInternalTaskState(this._state)){case TaskState.RUNNING:case TaskState.PAUSED:observer.next&&index_esm_async(observer.next.bind(observer,this.snapshot))();break;case TaskState.SUCCESS:observer.complete&&index_esm_async(observer.complete.bind(observer))();break;case TaskState.CANCELED:case TaskState.ERROR:observer.error&&index_esm_async(observer.error.bind(observer,this._error))();break;default:observer.error&&index_esm_async(observer.error.bind(observer,this._error))()}},UploadTask.prototype.resume=function(){var valid=\"paused\"===this._state||\"pausing\"===this._state;return valid&&this._transition(\"running\"),valid},UploadTask.prototype.pause=function(){var valid=\"running\"===this._state;return valid&&this._transition(\"pausing\"),valid},UploadTask.prototype.cancel=function(){var valid=\"running\"===this._state||\"pausing\"===this._state;return valid&&this._transition(\"canceling\"),valid},UploadTask}(),Reference=function(){function Reference(_service,location){this._service=_service,this._location=location instanceof Location?location:Location.makeFromUrl(location,_service.host)}return Reference.prototype.toString=function(){return\"gs://\"+this._location.bucket+\"/\"+this._location.path},Reference.prototype._newRef=function(service,location){return new Reference(service,location)},Object.defineProperty(Reference.prototype,\"root\",{get:function(){var location=new Location(this._location.bucket,\"\");return this._newRef(this._service,location)},enumerable:!1,configurable:!0}),Object.defineProperty(Reference.prototype,\"bucket\",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(Reference.prototype,\"fullPath\",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(Reference.prototype,\"name\",{get:function(){return lastComponent(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(Reference.prototype,\"storage\",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(Reference.prototype,\"parent\",{get:function(){var newPath=function(path){if(0===path.length)return null;var index=path.lastIndexOf(\"/\");return-1===index?\"\":path.slice(0,index)}(this._location.path);if(null===newPath)return null;var location=new Location(this._location.bucket,newPath);return new Reference(this._service,location)},enumerable:!1,configurable:!0}),Reference.prototype._throwIfRoot=function(name){if(\"\"===this._location.path)throw invalidRootOperation(name)},Reference}();function list$1(ref,options){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var op,requestInfo;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return null!=options&&\"number\"==typeof options.maxResults&&validateNumber(\"options.maxResults\",1,1e3,options.maxResults),requestInfo=function(service,location,delimiter,pageToken,maxResults){var urlParams={};urlParams.prefix=location.isRoot?\"\":location.path+\"/\",delimiter&&delimiter.length>0&&(urlParams.delimiter=delimiter),pageToken&&(urlParams.pageToken=pageToken),maxResults&&(urlParams.maxResults=maxResults);var url=makeUrl(location.bucketOnlyServerUrl(),service.host),timeout=service.maxOperationRetryTime,requestInfo=new RequestInfo(url,\"GET\",function(service,bucket){return function(xhr,text){var listResult=function(service,bucket,resourceString){var obj=jsonObjectOrNull(resourceString);return null===obj?null:function(service,bucket,resource){var listResult={prefixes:[],items:[],nextPageToken:resource.nextPageToken};if(resource.prefixes)for(var _i=0,_a=resource.prefixes;_i<_a.length;_i++){var pathWithoutTrailingSlash=_a[_i].replace(/\\/$/,\"\"),reference=service._makeStorageReference(new Location(bucket,pathWithoutTrailingSlash));listResult.prefixes.push(reference)}if(resource.items)for(var _b=0,_c=resource.items;_b<_c.length;_b++)reference=service._makeStorageReference(new Location(bucket,_c[_b].name)),listResult.items.push(reference);return listResult}(service,bucket,obj)}(service,bucket,text);return handlerCheck(null!==listResult),listResult}}(service,location.bucket),timeout);return requestInfo.urlParams=urlParams,requestInfo.errorHandler=sharedErrorHandler(location),requestInfo}(ref.storage,ref._location,\"/\",(op=options||{}).pageToken,op.maxResults),[4,ref.storage.makeRequestWithTokens(requestInfo)];case 1:return[2,_a.sent().getPromise()]}}))}))}function _getChild(ref,childPath){var newPath=function(path,childPath){var canonicalChildPath=childPath.split(\"/\").filter((function(component){return component.length>0})).join(\"/\");return 0===path.length?canonicalChildPath:path+\"/\"+canonicalChildPath}(ref._location.path,childPath),location=new Location(ref._location.bucket,newPath);return new Reference(ref.storage,location)}function isUrl(path){return/^[A-Za-z]+:\\/\\//.test(path)}function extractBucket(host,config){var bucketString=null==config?void 0:config.storageBucket;return null==bucketString?null:Location.makeFromBucketSpec(bucketString,host)}var index_esm_StorageService=function(){function StorageService(app,_authProvider,_appCheckProvider,_pool,_url,_firebaseVersion){this.app=app,this._authProvider=_authProvider,this._appCheckProvider=_appCheckProvider,this._pool=_pool,this._url=_url,this._firebaseVersion=_firebaseVersion,this._bucket=null,this._host=\"firebasestorage.googleapis.com\",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=_url?Location.makeFromBucketSpec(_url,this._host):extractBucket(this._host,this.app.options)}return Object.defineProperty(StorageService.prototype,\"host\",{get:function(){return this._host},set:function(host){this._host=host,this._bucket=null!=this._url?Location.makeFromBucketSpec(this._url,host):extractBucket(host,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(StorageService.prototype,\"maxUploadRetryTime\",{get:function(){return this._maxUploadRetryTime},set:function(time){validateNumber(\"time\",0,Number.POSITIVE_INFINITY,time),this._maxUploadRetryTime=time},enumerable:!1,configurable:!0}),Object.defineProperty(StorageService.prototype,\"maxOperationRetryTime\",{get:function(){return this._maxOperationRetryTime},set:function(time){validateNumber(\"time\",0,Number.POSITIVE_INFINITY,time),this._maxOperationRetryTime=time},enumerable:!1,configurable:!0}),StorageService.prototype._getAuthToken=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var auth,tokenData;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return(auth=this._authProvider.getImmediate({optional:!0}))?[4,auth.getToken()]:[3,2];case 1:if(null!==(tokenData=_a.sent()))return[2,tokenData.accessToken];_a.label=2;case 2:return[2,null]}}))}))},StorageService.prototype._getAppCheckToken=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var appCheck;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return(appCheck=this._appCheckProvider.getImmediate({optional:!0}))?[4,appCheck.getToken()]:[3,2];case 1:return[2,_a.sent().token];case 2:return[2,null]}}))}))},StorageService.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(request){return request.cancel()})),this._requests.clear(),Promise.resolve()},StorageService.prototype._makeStorageReference=function(loc){return new Reference(this,loc)},StorageService.prototype._makeRequest=function(requestInfo,authToken,appCheckToken){var _this=this;if(this._deleted)return new FailRequest(appDeleted());var request_1=function(requestInfo,appId,authToken,appCheckToken,pool,firebaseVersion){var queryPart=makeQueryString(requestInfo.urlParams),url=requestInfo.url+queryPart,headers=Object.assign({},requestInfo.headers);return function(headers,appId){appId&&(headers[\"X-Firebase-GMPID\"]=appId)}(headers,appId),function(headers,authToken){null!==authToken&&authToken.length>0&&(headers.Authorization=\"Firebase \"+authToken)}(headers,authToken),function(headers,firebaseVersion){headers[\"X-Firebase-Storage-Version\"]=\"webjs/\"+(null!=firebaseVersion?firebaseVersion:\"AppManager\")}(headers,firebaseVersion),function(headers,appCheckToken){null!==appCheckToken&&(headers[\"X-Firebase-AppCheck\"]=appCheckToken)}(headers,appCheckToken),new NetworkRequest(url,requestInfo.method,headers,requestInfo.body,requestInfo.successCodes,requestInfo.additionalRetryCodes,requestInfo.handler,requestInfo.errorHandler,requestInfo.timeout,requestInfo.progressCallback,pool)}(requestInfo,this._appId,authToken,appCheckToken,this._pool,this._firebaseVersion);return this._requests.add(request_1),request_1.getPromise().then((function(){return _this._requests.delete(request_1)}),(function(){return _this._requests.delete(request_1)})),request_1},StorageService.prototype.makeRequestWithTokens=function(requestInfo){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var _a;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,Promise.all([this._getAuthToken(),this._getAppCheckToken()])];case 1:return _a=_b.sent(),[2,this._makeRequest(requestInfo,_a[0],_a[1])]}}))}))},StorageService}();function ref$1(serviceOrRef,pathOrUrl){return function(serviceOrRef,pathOrUrl){if(pathOrUrl&&isUrl(pathOrUrl)){if(serviceOrRef instanceof index_esm_StorageService)return new Reference(serviceOrRef,pathOrUrl);throw invalidArgument(\"To use ref(service, url), the first argument must be a Storage instance.\")}return function refFromPath(ref,path){if(ref instanceof index_esm_StorageService){var service=ref;if(null==service._bucket)throw new index_esm_FirebaseStorageError(\"no-default-bucket\",\"No default bucket found. Did you set the 'storageBucket' property when initializing the app?\");var reference=new Reference(service,service._bucket);return null!=path?refFromPath(reference,path):reference}if(void 0!==path){if(path.includes(\"..\"))throw invalidArgument('`path` param cannot contain \"..\"');return _getChild(ref,path)}return ref}(serviceOrRef,pathOrUrl)}(serviceOrRef=Object(util_dist_index_esm.getModularInstance)(serviceOrRef),pathOrUrl)}var UploadTaskSnapshotCompat=function(){function UploadTaskSnapshotCompat(_delegate,task,ref){this._delegate=_delegate,this.task=task,this.ref=ref}return Object.defineProperty(UploadTaskSnapshotCompat.prototype,\"bytesTransferred\",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(UploadTaskSnapshotCompat.prototype,\"metadata\",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(UploadTaskSnapshotCompat.prototype,\"state\",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(UploadTaskSnapshotCompat.prototype,\"totalBytes\",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),UploadTaskSnapshotCompat}(),UploadTaskCompat=function(){function UploadTaskCompat(_delegate,_ref){this._delegate=_delegate,this._ref=_ref,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(UploadTaskCompat.prototype,\"snapshot\",{get:function(){return new UploadTaskSnapshotCompat(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),UploadTaskCompat.prototype.then=function(onFulfilled,onRejected){var _this=this;return this._delegate.then((function(snapshot){if(onFulfilled)return onFulfilled(new UploadTaskSnapshotCompat(snapshot,_this,_this._ref))}),onRejected)},UploadTaskCompat.prototype.on=function(type,nextOrObserver,error,completed){var _this=this,wrappedNextOrObserver=void 0;return nextOrObserver&&(wrappedNextOrObserver=\"function\"==typeof nextOrObserver?function(taskSnapshot){return nextOrObserver(new UploadTaskSnapshotCompat(taskSnapshot,_this,_this._ref))}:{next:nextOrObserver.next?function(taskSnapshot){return nextOrObserver.next(new UploadTaskSnapshotCompat(taskSnapshot,_this,_this._ref))}:void 0,complete:nextOrObserver.complete||void 0,error:nextOrObserver.error||void 0}),this._delegate.on(type,wrappedNextOrObserver,error||void 0,completed||void 0)},UploadTaskCompat}(),ListResultCompat=function(){function ListResultCompat(_delegate,_service){this._delegate=_delegate,this._service=_service}return Object.defineProperty(ListResultCompat.prototype,\"prefixes\",{get:function(){var _this=this;return this._delegate.prefixes.map((function(ref){return new index_esm_ReferenceCompat(ref,_this._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(ListResultCompat.prototype,\"items\",{get:function(){var _this=this;return this._delegate.items.map((function(ref){return new index_esm_ReferenceCompat(ref,_this._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(ListResultCompat.prototype,\"nextPageToken\",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),ListResultCompat}(),index_esm_ReferenceCompat=function(){function ReferenceCompat(_delegate,storage){this._delegate=_delegate,this.storage=storage}return Object.defineProperty(ReferenceCompat.prototype,\"name\",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(ReferenceCompat.prototype,\"bucket\",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(ReferenceCompat.prototype,\"fullPath\",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),ReferenceCompat.prototype.toString=function(){return this._delegate.toString()},ReferenceCompat.prototype.child=function(childPath){return new ReferenceCompat(function(ref,childPath){return _getChild(ref,childPath)}(this._delegate,childPath),this.storage)},Object.defineProperty(ReferenceCompat.prototype,\"root\",{get:function(){return new ReferenceCompat(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(ReferenceCompat.prototype,\"parent\",{get:function(){var reference=this._delegate.parent;return null==reference?null:new ReferenceCompat(reference,this.storage)},enumerable:!1,configurable:!0}),ReferenceCompat.prototype.put=function(data,metadata){return this._throwIfRoot(\"put\"),new UploadTaskCompat(function(ref,data,metadata){return function(ref,data,metadata){return ref._throwIfRoot(\"uploadBytesResumable\"),new UploadTask(ref,new FbsBlob(data),metadata)}(ref=Object(util_dist_index_esm.getModularInstance)(ref),data,metadata)}(this._delegate,data,metadata),this)},ReferenceCompat.prototype.putString=function(value,format,metadata){void 0===format&&(format=StringFormat.RAW),this._throwIfRoot(\"putString\");var data=dataFromString(format,value),metadataClone=Object(tslib_es6.__assign)({},metadata);return null==metadataClone.contentType&&null!=data.contentType&&(metadataClone.contentType=data.contentType),new UploadTaskCompat(new UploadTask(this._delegate,new FbsBlob(data.data,!0),metadataClone),this)},ReferenceCompat.prototype.listAll=function(){var ref,_this=this;return(ref=this._delegate,function(ref){var accumulator={prefixes:[],items:[]};return function listAllHelper(ref,accumulator,pageToken){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var nextPage,_a,_b;return Object(tslib_es6.__generator)(this,(function(_c){switch(_c.label){case 0:return[4,list$1(ref,{pageToken:pageToken})];case 1:return nextPage=_c.sent(),(_a=accumulator.prefixes).push.apply(_a,nextPage.prefixes),(_b=accumulator.items).push.apply(_b,nextPage.items),null==nextPage.nextPageToken?[3,3]:[4,listAllHelper(ref,accumulator,nextPage.nextPageToken)];case 2:_c.sent(),_c.label=3;case 3:return[2]}}))}))}(ref,accumulator).then((function(){return accumulator}))}(ref=Object(util_dist_index_esm.getModularInstance)(ref))).then((function(r){return new ListResultCompat(r,_this.storage)}))},ReferenceCompat.prototype.list=function(options){var _this=this;return function(ref,options){return list$1(ref=Object(util_dist_index_esm.getModularInstance)(ref),options)}(this._delegate,options||void 0).then((function(r){return new ListResultCompat(r,_this.storage)}))},ReferenceCompat.prototype.getMetadata=function(){return ref=this._delegate,function(ref){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var requestInfo;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return ref._throwIfRoot(\"getMetadata\"),requestInfo=getMetadata(ref.storage,ref._location,getMappings()),[4,ref.storage.makeRequestWithTokens(requestInfo)];case 1:return[2,_a.sent().getPromise()]}}))}))}(ref=Object(util_dist_index_esm.getModularInstance)(ref));var ref},ReferenceCompat.prototype.updateMetadata=function(metadata){return function(ref,metadata){return function(ref,metadata){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var requestInfo;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return ref._throwIfRoot(\"updateMetadata\"),requestInfo=function(service,location,metadata,mappings){var url=makeUrl(location.fullServerUrl(),service.host),body=toResourceString(metadata,mappings),timeout=service.maxOperationRetryTime,requestInfo=new RequestInfo(url,\"PATCH\",metadataHandler(service,mappings),timeout);return requestInfo.headers={\"Content-Type\":\"application/json; charset=utf-8\"},requestInfo.body=body,requestInfo.errorHandler=objectErrorHandler(location),requestInfo}(ref.storage,ref._location,metadata,getMappings()),[4,ref.storage.makeRequestWithTokens(requestInfo)];case 1:return[2,_a.sent().getPromise()]}}))}))}(ref=Object(util_dist_index_esm.getModularInstance)(ref),metadata)}(this._delegate,metadata)},ReferenceCompat.prototype.getDownloadURL=function(){return ref=this._delegate,function(ref){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var requestInfo;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return ref._throwIfRoot(\"getDownloadURL\"),requestInfo=function(service,location,mappings){var url=makeUrl(location.fullServerUrl(),service.host),timeout=service.maxOperationRetryTime,requestInfo=new RequestInfo(url,\"GET\",function(service,mappings){return function(xhr,text){var metadata=fromResourceString(service,text,mappings);return handlerCheck(null!==metadata),function(metadata,resourceString,host){var obj=jsonObjectOrNull(resourceString);if(null===obj)return null;if(!isString(obj.downloadTokens))return null;var tokens=obj.downloadTokens;if(0===tokens.length)return null;var encode=encodeURIComponent;return tokens.split(\",\").map((function(token){var path=metadata.fullPath;return makeUrl(\"/b/\"+encode(metadata.bucket)+\"/o/\"+encode(path),host)+makeQueryString({alt:\"media\",token:token})}))[0]}(metadata,text,service.host)}}(service,mappings),timeout);return requestInfo.errorHandler=objectErrorHandler(location),requestInfo}(ref.storage,ref._location,getMappings()),[4,ref.storage.makeRequestWithTokens(requestInfo)];case 1:return[2,_a.sent().getPromise().then((function(url){if(null===url)throw new index_esm_FirebaseStorageError(\"no-download-url\",\"The given file does not have any download URLs.\");return url}))]}}))}))}(ref=Object(util_dist_index_esm.getModularInstance)(ref));var ref},ReferenceCompat.prototype.delete=function(){return this._throwIfRoot(\"delete\"),ref=this._delegate,function(ref){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var requestInfo;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return ref._throwIfRoot(\"deleteObject\"),requestInfo=function(service,location){var url=makeUrl(location.fullServerUrl(),service.host),requestInfo=new RequestInfo(url,\"DELETE\",(function(_xhr,_text){}),service.maxOperationRetryTime);return requestInfo.successCodes=[200,204],requestInfo.errorHandler=objectErrorHandler(location),requestInfo}(ref.storage,ref._location),[4,ref.storage.makeRequestWithTokens(requestInfo)];case 1:return[2,_a.sent().getPromise()]}}))}))}(ref=Object(util_dist_index_esm.getModularInstance)(ref));var ref},ReferenceCompat.prototype._throwIfRoot=function(name){if(\"\"===this._delegate._location.path)throw invalidRootOperation(name)},ReferenceCompat}(),StorageServiceCompat=function(){function StorageServiceCompat(app,_delegate){var _this=this;this.app=app,this._delegate=_delegate,this.INTERNAL={delete:function(){return _this._delegate._delete()}}}return Object.defineProperty(StorageServiceCompat.prototype,\"maxOperationRetryTime\",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(StorageServiceCompat.prototype,\"maxUploadRetryTime\",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),StorageServiceCompat.prototype.ref=function(path){if(isUrl(path))throw invalidArgument(\"ref() expected a child path but got a URL, use refFromURL instead.\");return new index_esm_ReferenceCompat(ref$1(this._delegate,path),this)},StorageServiceCompat.prototype.refFromURL=function(url){if(!isUrl(url))throw invalidArgument(\"refFromURL() expected a full URL but got a child path, use ref() instead.\");try{Location.makeFromUrl(url,this._delegate.host)}catch(e){throw invalidArgument(\"refFromUrl() expected a valid full URL but got an invalid one.\")}return new index_esm_ReferenceCompat(ref$1(this._delegate,url),this)},StorageServiceCompat.prototype.setMaxUploadRetryTime=function(time){this._delegate.maxUploadRetryTime=time},StorageServiceCompat.prototype.setMaxOperationRetryTime=function(time){this._delegate.maxOperationRetryTime=time},StorageServiceCompat.prototype.useEmulator=function(host,port){!function(storage,host,port){storage.host=\"http://\"+host+\":\"+port}(this._delegate,host,port)},StorageServiceCompat}();function index_esm_factory(container,_a){var url=_a.instanceIdentifier,app=container.getProvider(\"app\").getImmediate(),authProvider=container.getProvider(\"auth-internal\"),appCheckProvider=container.getProvider(\"app-check-internal\");return new StorageServiceCompat(app,new index_esm_StorageService(app,authProvider,appCheckProvider,new XhrIoPool,url,index_esm.default.SDK_VERSION))}!function(instance){var namespaceExports={TaskState:TaskState,TaskEvent:TaskEvent,StringFormat:StringFormat,Storage:index_esm_StorageService,Reference:index_esm_ReferenceCompat};instance.INTERNAL.registerComponent(new component_dist_index_esm.Component(\"storage\",index_esm_factory,\"PUBLIC\").setServiceProps(namespaceExports).setMultipleInstances(!0)),instance.registerVersion(\"@firebase/storage\",\"0.5.2\")}(index_esm.default);var performance_dist_index_esm_a,apiInstance,windowInstance,index_esm_ERROR_DESCRIPTION_MAP=((performance_dist_index_esm_a={})[\"trace started\"]=\"Trace {$traceName} was started before.\",performance_dist_index_esm_a[\"trace stopped\"]=\"Trace {$traceName} is not running.\",performance_dist_index_esm_a[\"nonpositive trace startTime\"]=\"Trace {$traceName} startTime should be positive.\",performance_dist_index_esm_a[\"nonpositive trace duration\"]=\"Trace {$traceName} duration should be positive.\",performance_dist_index_esm_a[\"no window\"]=\"Window is not available.\",performance_dist_index_esm_a[\"no app id\"]=\"App id is not available.\",performance_dist_index_esm_a[\"no project id\"]=\"Project id is not available.\",performance_dist_index_esm_a[\"no api key\"]=\"Api key is not available.\",performance_dist_index_esm_a[\"invalid cc log\"]=\"Attempted to queue invalid cc event\",performance_dist_index_esm_a[\"FB not default\"]=\"Performance can only start when Firebase app instance is the default one.\",performance_dist_index_esm_a[\"RC response not ok\"]=\"RC response is not ok\",performance_dist_index_esm_a[\"invalid attribute name\"]=\"Attribute name {$attributeName} is invalid.\",performance_dist_index_esm_a[\"invalid attribute value\"]=\"Attribute value {$attributeValue} is invalid.\",performance_dist_index_esm_a[\"invalid custom metric name\"]=\"Custom metric name {$customMetricName} is invalid\",performance_dist_index_esm_a[\"invalid String merger input\"]=\"Input for String merger is invalid, contact support team to resolve.\",performance_dist_index_esm_a),dist_index_esm_ERROR_FACTORY=new util_dist_index_esm.ErrorFactory(\"performance\",\"Performance\",index_esm_ERROR_DESCRIPTION_MAP),consoleLogger=new logger_dist_index_esm.Logger(\"Performance\");consoleLogger.logLevel=logger_dist_index_esm.LogLevel.INFO;var settingsServiceInstance,index_esm_Api=function(){function Api(window){if(this.window=window,!window)throw dist_index_esm_ERROR_FACTORY.create(\"no window\");this.performance=window.performance,this.PerformanceObserver=window.PerformanceObserver,this.windowLocation=window.location,this.navigator=window.navigator,this.document=window.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=window.localStorage),window.perfMetrics&&window.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=window.perfMetrics.onFirstInputDelay)}return Api.prototype.getUrl=function(){return this.windowLocation.href.split(\"?\")[0]},Api.prototype.mark=function(name){this.performance&&this.performance.mark&&this.performance.mark(name)},Api.prototype.measure=function(measureName,mark1,mark2){this.performance&&this.performance.measure&&this.performance.measure(measureName,mark1,mark2)},Api.prototype.getEntriesByType=function(type){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(type):[]},Api.prototype.getEntriesByName=function(name){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(name):[]},Api.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},Api.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!Object(util_dist_index_esm.isIndexedDBAvailable)()||(consoleLogger.info(\"IndexedDB is not supported by current browswer\"),!1):(consoleLogger.info(\"Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled.\"),!1)},Api.prototype.setupObserver=function(entryType,callback){this.PerformanceObserver&&new this.PerformanceObserver((function(list){for(var _i=0,_a=list.getEntries();_i<_a.length;_i++)callback(_a[_i])})).observe({entryTypes:[entryType]})},Api.getInstance=function(){return void 0===apiInstance&&(apiInstance=new Api(windowInstance)),apiInstance},Api}();function mergeStrings(part1,part2){var sizeDiff=part1.length-part2.length;if(sizeDiff<0||sizeDiff>1)throw dist_index_esm_ERROR_FACTORY.create(\"invalid String merger input\");for(var resultArray=[],i=0;i<part1.length;i++)resultArray.push(part1.charAt(i)),part2.length>i&&resultArray.push(part2.charAt(i));return resultArray.join(\"\")}var iid,SettingsService=function(){function SettingsService(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl=\"https://firebaselogging.googleapis.com/v0cc/log?format=json_proto\",this.flTransportEndpointUrl=mergeStrings(\"hts/frbslgigp.ogepscmv/ieo/eaylg\",\"tp:/ieaeogn-agolai.o/1frlglgc/o\"),this.transportKey=mergeStrings(\"AzSC8r6ReiGqFMyfvgow\",\"Iayx0u-XT3vksVM-pIV\"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return SettingsService.prototype.getAppId=function(){var appId=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!appId)throw dist_index_esm_ERROR_FACTORY.create(\"no app id\");return appId},SettingsService.prototype.getProjectId=function(){var projectId=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!projectId)throw dist_index_esm_ERROR_FACTORY.create(\"no project id\");return projectId},SettingsService.prototype.getApiKey=function(){var apiKey=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!apiKey)throw dist_index_esm_ERROR_FACTORY.create(\"no api key\");return apiKey},SettingsService.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat(\"?key=\",this.transportKey)},SettingsService.getInstance=function(){return void 0===settingsServiceInstance&&(settingsServiceInstance=new SettingsService),settingsServiceInstance},SettingsService}();function getIid(){return iid}var VisibilityState=function(VisibilityState){return VisibilityState[VisibilityState.UNKNOWN=0]=\"UNKNOWN\",VisibilityState[VisibilityState.VISIBLE=1]=\"VISIBLE\",VisibilityState[VisibilityState.HIDDEN=2]=\"HIDDEN\",VisibilityState}({}),RESERVED_ATTRIBUTE_PREFIXES=[\"firebase_\",\"google_\",\"ga_\"],ATTRIBUTE_FORMAT_REGEX=new RegExp(\"^[a-zA-Z]\\\\w*$\");function getServiceWorkerStatus(){var navigator=index_esm_Api.getInstance().navigator;return\"serviceWorker\"in navigator?navigator.serviceWorker.controller?2:3:1}function getVisibilityState(){switch(index_esm_Api.getInstance().document.visibilityState){case\"visible\":return VisibilityState.VISIBLE;case\"hidden\":return VisibilityState.HIDDEN;default:return VisibilityState.UNKNOWN}}function getEffectiveConnectionType(){var navigatorConnection=index_esm_Api.getInstance().navigator.connection;switch(navigatorConnection&&navigatorConnection.effectiveType){case\"slow-2g\":return 1;case\"2g\":return 2;case\"3g\":return 3;case\"4g\":return 4;default:return 0}}function processConfig(config){if(!config)return config;var settingsServiceInstance=SettingsService.getInstance(),entries=config.entries||{};return settingsServiceInstance.loggingEnabled=void 0===entries.fpr_enabled||\"true\"===String(entries.fpr_enabled),entries.fpr_log_source&&(settingsServiceInstance.logSource=Number(entries.fpr_log_source)),entries.fpr_log_endpoint_url&&(settingsServiceInstance.logEndPointUrl=entries.fpr_log_endpoint_url),entries.fpr_log_transport_key&&(settingsServiceInstance.transportKey=entries.fpr_log_transport_key),void 0!==entries.fpr_vc_network_request_sampling_rate&&(settingsServiceInstance.networkRequestsSamplingRate=Number(entries.fpr_vc_network_request_sampling_rate)),void 0!==entries.fpr_vc_trace_sampling_rate&&(settingsServiceInstance.tracesSamplingRate=Number(entries.fpr_vc_trace_sampling_rate)),settingsServiceInstance.logTraceAfterSampling=shouldLogAfterSampling(settingsServiceInstance.tracesSamplingRate),settingsServiceInstance.logNetworkAfterSampling=shouldLogAfterSampling(settingsServiceInstance.networkRequestsSamplingRate),config}function shouldLogAfterSampling(samplingRate){return Math.random()<=samplingRate}var index_esm_initializationPromise,initializationStatus=1;function getInitializationPromise(){return initializationStatus=2,index_esm_initializationPromise=index_esm_initializationPromise||function(){var document=index_esm_Api.getInstance().document;return new Promise((function(resolve){if(document&&\"complete\"!==document.readyState){var handler_1=function(){\"complete\"===document.readyState&&(document.removeEventListener(\"readystatechange\",handler_1),resolve())};document.addEventListener(\"readystatechange\",handler_1)}else resolve()}))}().then((function(){return(iidPromise=SettingsService.getInstance().installationsService.getId()).then((function(iidVal){iid=iidVal})),iidPromise;var iidPromise})).then((function(iid){return function(iid){var config=function(){var localStorage=index_esm_Api.getInstance().localStorage;if(localStorage){var expiryString=localStorage.getItem(\"@firebase/performance/configexpire\");if(expiryString&&Number(expiryString)>Date.now()){var configStringified=localStorage.getItem(\"@firebase/performance/config\");if(configStringified)try{return JSON.parse(configStringified)}catch(_a){return}}}}();return config?(processConfig(config),Promise.resolve()):function(iid){return(authTokenPromise=SettingsService.getInstance().installationsService.getToken(),authTokenPromise.then((function(authTokenVal){})),authTokenPromise).then((function(authToken){var configEndPoint=\"https://firebaseremoteconfig.googleapis.com/v1/projects/\"+SettingsService.getInstance().getProjectId()+\"/namespaces/fireperf:fetch?key=\"+SettingsService.getInstance().getApiKey(),request=new Request(configEndPoint,{method:\"POST\",headers:{Authorization:\"FIREBASE_INSTALLATIONS_AUTH \"+authToken},body:JSON.stringify({app_instance_id:iid,app_instance_id_token:authToken,app_id:SettingsService.getInstance().getAppId(),app_version:\"0.4.12\",sdk_version:\"0.0.1\"})});return fetch(request).then((function(response){if(response.ok)return response.json();throw dist_index_esm_ERROR_FACTORY.create(\"RC response not ok\")}))})).catch((function(){consoleLogger.info(\"Could not fetch config, will use default configs\")}));var authTokenPromise}(iid).then(processConfig).then((function(config){return function(config){var localStorage=index_esm_Api.getInstance().localStorage;config&&localStorage&&(localStorage.setItem(\"@firebase/performance/config\",JSON.stringify(config)),localStorage.setItem(\"@firebase/performance/configexpire\",String(Date.now()+60*SettingsService.getInstance().configTimeToLive*60*1e3)))}(config)}),(function(){}))}(iid)})).then((function(){return changeInitializationStatus()}),(function(){return changeInitializationStatus()}))}function changeInitializationStatus(){initializationStatus=3}var index_esm_logger,remainingTries=3,queue=[],isTransportSetup=!1;function addToQueue(evt){if(!evt.eventTime||!evt.message)throw dist_index_esm_ERROR_FACTORY.create(\"invalid cc log\");queue=Object(tslib_es6.__spreadArray)(Object(tslib_es6.__spreadArray)([],queue),[evt])}function sendLog(resource,resourceType){index_esm_logger||(index_esm_logger=function(serializer){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var message=serializer.apply(void 0,args);addToQueue({message:message,eventTime:Date.now()})}}(serializer)),index_esm_logger(resource,resourceType)}function logTrace(trace){var settingsService=SettingsService.getInstance();!settingsService.instrumentationEnabled&&trace.isAuto||(settingsService.dataCollectionEnabled||trace.isAuto)&&index_esm_Api.getInstance().requiredApisAvailable()&&(trace.isAuto&&getVisibilityState()!==VisibilityState.VISIBLE||(3===initializationStatus?sendTraceLog(trace):getInitializationPromise().then((function(){return sendTraceLog(trace)}),(function(){return sendTraceLog(trace)}))))}function sendTraceLog(trace){if(getIid()){var settingsService=SettingsService.getInstance();settingsService.loggingEnabled&&settingsService.logTraceAfterSampling&&setTimeout((function(){return sendLog(trace,1)}),0)}}function serializer(resource,resourceType){return 0===resourceType?(networkRequestMetric={url:(networkRequest=resource).url,http_method:networkRequest.httpMethod||0,http_response_code:200,response_payload_bytes:networkRequest.responsePayloadBytes,client_start_time_us:networkRequest.startTimeUs,time_to_response_initiated_us:networkRequest.timeToResponseInitiatedUs,time_to_response_completed_us:networkRequest.timeToResponseCompletedUs},perfMetric={application_info:getApplicationInfo(),network_request_metric:networkRequestMetric},JSON.stringify(perfMetric)):function(trace){var traceMetric={name:trace.name,is_auto:trace.isAuto,client_start_time_us:trace.startTimeUs,duration_us:trace.durationUs};0!==Object.keys(trace.counters).length&&(traceMetric.counters=trace.counters);var customAttributes=trace.getAttributes();0!==Object.keys(customAttributes).length&&(traceMetric.custom_attributes=customAttributes);var perfMetric={application_info:getApplicationInfo(),trace_metric:traceMetric};return JSON.stringify(perfMetric)}(resource);var networkRequest,networkRequestMetric,perfMetric}function getApplicationInfo(){return{google_app_id:SettingsService.getInstance().getAppId(),app_instance_id:getIid(),web_app_info:{sdk_version:\"0.4.12\",page_url:index_esm_Api.getInstance().getUrl(),service_worker_status:getServiceWorkerStatus(),visibility_state:getVisibilityState(),effective_connection_type:getEffectiveConnectionType()},application_process_state:0}}var oobMetrics=[\"_fp\",\"_fcp\",\"_fid\"],index_esm_Trace=function(){function Trace(name,isAuto,traceMeasureName){void 0===isAuto&&(isAuto=!1),this.name=name,this.isAuto=isAuto,this.state=1,this.customAttributes={},this.counters={},this.api=index_esm_Api.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=\"FB-PERF-TRACE-START-\"+this.randomId+\"-\"+this.name,this.traceStopMark=\"FB-PERF-TRACE-STOP-\"+this.randomId+\"-\"+this.name,this.traceMeasure=traceMeasureName||\"FB-PERF-TRACE-MEASURE-\"+this.randomId+\"-\"+this.name,traceMeasureName&&this.calculateTraceMetrics())}return Trace.prototype.start=function(){if(1!==this.state)throw dist_index_esm_ERROR_FACTORY.create(\"trace started\",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},Trace.prototype.stop=function(){if(2!==this.state)throw dist_index_esm_ERROR_FACTORY.create(\"trace stopped\",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),logTrace(this)},Trace.prototype.record=function(startTime,duration,options){if(startTime<=0)throw dist_index_esm_ERROR_FACTORY.create(\"nonpositive trace startTime\",{traceName:this.name});if(duration<=0)throw dist_index_esm_ERROR_FACTORY.create(\"nonpositive trace duration\",{traceName:this.name});if(this.durationUs=Math.floor(1e3*duration),this.startTimeUs=Math.floor(1e3*startTime),options&&options.attributes&&(this.customAttributes=Object(tslib_es6.__assign)({},options.attributes)),options&&options.metrics)for(var _i=0,_a=Object.keys(options.metrics);_i<_a.length;_i++){var metric=_a[_i];isNaN(Number(options.metrics[metric]))||(this.counters[metric]=Number(Math.floor(options.metrics[metric])))}logTrace(this)},Trace.prototype.incrementMetric=function(counter,numAsInteger){void 0===numAsInteger&&(numAsInteger=1),this.putMetric(counter,void 0===this.counters[counter]?numAsInteger:this.counters[counter]+numAsInteger)},Trace.prototype.putMetric=function(counter,numAsInteger){if(traceName=this.name,0===(name=counter).length||name.length>100||!(traceName&&traceName.startsWith(\"_wt_\")&&oobMetrics.indexOf(name)>-1)&&name.startsWith(\"_\"))throw dist_index_esm_ERROR_FACTORY.create(\"invalid custom metric name\",{customMetricName:counter});var providedValue,valueAsInteger,name,traceName;this.counters[counter]=(providedValue=numAsInteger,(valueAsInteger=Math.floor(providedValue))<providedValue&&consoleLogger.info(\"Metric value should be an Integer, setting the value as : \"+valueAsInteger+\".\"),valueAsInteger)},Trace.prototype.getMetric=function(counter){return this.counters[counter]||0},Trace.prototype.putAttribute=function(attr,value){var name,isValidName=!(0===(name=attr).length||name.length>40||RESERVED_ATTRIBUTE_PREFIXES.some((function(prefix){return name.startsWith(prefix)}))||!name.match(ATTRIBUTE_FORMAT_REGEX)),isValidValue=function(value){return 0!==value.length&&value.length<=100}(value);if(isValidName&&isValidValue)this.customAttributes[attr]=value;else{if(!isValidName)throw dist_index_esm_ERROR_FACTORY.create(\"invalid attribute name\",{attributeName:attr});if(!isValidValue)throw dist_index_esm_ERROR_FACTORY.create(\"invalid attribute value\",{attributeValue:value})}},Trace.prototype.getAttribute=function(attr){return this.customAttributes[attr]},Trace.prototype.removeAttribute=function(attr){void 0!==this.customAttributes[attr]&&delete this.customAttributes[attr]},Trace.prototype.getAttributes=function(){return Object(tslib_es6.__assign)({},this.customAttributes)},Trace.prototype.setStartTime=function(startTime){this.startTimeUs=startTime},Trace.prototype.setDuration=function(duration){this.durationUs=duration},Trace.prototype.calculateTraceMetrics=function(){var perfMeasureEntries=this.api.getEntriesByName(this.traceMeasure),perfMeasureEntry=perfMeasureEntries&&perfMeasureEntries[0];perfMeasureEntry&&(this.durationUs=Math.floor(1e3*perfMeasureEntry.duration),this.startTimeUs=Math.floor(1e3*(perfMeasureEntry.startTime+this.api.getTimeOrigin())))},Trace.createOobTrace=function(navigationTimings,paintTimings,firstInputDelay){var route=index_esm_Api.getInstance().getUrl();if(route){var trace=new Trace(\"_wt_\"+route,!0),timeOriginUs=Math.floor(1e3*index_esm_Api.getInstance().getTimeOrigin());if(trace.setStartTime(timeOriginUs),navigationTimings&&navigationTimings[0]&&(trace.setDuration(Math.floor(1e3*navigationTimings[0].duration)),trace.putMetric(\"domInteractive\",Math.floor(1e3*navigationTimings[0].domInteractive)),trace.putMetric(\"domContentLoadedEventEnd\",Math.floor(1e3*navigationTimings[0].domContentLoadedEventEnd)),trace.putMetric(\"loadEventEnd\",Math.floor(1e3*navigationTimings[0].loadEventEnd))),paintTimings){var firstPaint=paintTimings.find((function(paintObject){return\"first-paint\"===paintObject.name}));firstPaint&&firstPaint.startTime&&trace.putMetric(\"_fp\",Math.floor(1e3*firstPaint.startTime));var firstContentfulPaint=paintTimings.find((function(paintObject){return\"first-contentful-paint\"===paintObject.name}));firstContentfulPaint&&firstContentfulPaint.startTime&&trace.putMetric(\"_fcp\",Math.floor(1e3*firstContentfulPaint.startTime)),firstInputDelay&&trace.putMetric(\"_fid\",Math.floor(1e3*firstInputDelay))}logTrace(trace)}},Trace.createUserTimingTrace=function(measureName){logTrace(new Trace(measureName,!1,measureName))},Trace}();function createNetworkRequestEntry(entry){var performanceEntry=entry;if(performanceEntry&&void 0!==performanceEntry.responseStart){var timeOrigin=index_esm_Api.getInstance().getTimeOrigin(),startTimeUs=Math.floor(1e3*(performanceEntry.startTime+timeOrigin)),timeToResponseInitiatedUs=performanceEntry.responseStart?Math.floor(1e3*(performanceEntry.responseStart-performanceEntry.startTime)):void 0,timeToResponseCompletedUs=Math.floor(1e3*(performanceEntry.responseEnd-performanceEntry.startTime));!function(networkRequest){var settingsService=SettingsService.getInstance();if(settingsService.instrumentationEnabled){var networkRequestUrl=networkRequest.url,logEndpointUrl=settingsService.logEndPointUrl.split(\"?\")[0],flEndpointUrl=settingsService.flTransportEndpointUrl.split(\"?\")[0];networkRequestUrl!==logEndpointUrl&&networkRequestUrl!==flEndpointUrl&&settingsService.loggingEnabled&&settingsService.logNetworkAfterSampling&&setTimeout((function(){return sendLog(networkRequest,0)}),0)}}({url:performanceEntry.name&&performanceEntry.name.split(\"?\")[0],responsePayloadBytes:performanceEntry.transferSize,startTimeUs:startTimeUs,timeToResponseInitiatedUs:timeToResponseInitiatedUs,timeToResponseCompletedUs:timeToResponseCompletedUs})}}function setupOobResources(){getIid()&&(setTimeout((function(){return function(){var api=index_esm_Api.getInstance(),navigationTimings=api.getEntriesByType(\"navigation\"),paintTimings=api.getEntriesByType(\"paint\");if(api.onFirstInputDelay){var timeoutId_1=setTimeout((function(){index_esm_Trace.createOobTrace(navigationTimings,paintTimings),timeoutId_1=void 0}),5e3);api.onFirstInputDelay((function(fid){timeoutId_1&&(clearTimeout(timeoutId_1),index_esm_Trace.createOobTrace(navigationTimings,paintTimings,fid))}))}else index_esm_Trace.createOobTrace(navigationTimings,paintTimings)}()}),0),setTimeout((function(){return function(){for(var api=index_esm_Api.getInstance(),_i=0,resources_1=api.getEntriesByType(\"resource\");_i<resources_1.length;_i++)createNetworkRequestEntry(resources_1[_i]);api.setupObserver(\"resource\",createNetworkRequestEntry)}()}),0),setTimeout((function(){return function(){for(var api=index_esm_Api.getInstance(),_i=0,measures_1=api.getEntriesByType(\"measure\");_i<measures_1.length;_i++)createUserTimingTrace(measures_1[_i]);api.setupObserver(\"measure\",createUserTimingTrace)}()}),0))}function createUserTimingTrace(measure){var measureName=measure.name;\"FB-PERF-TRACE-MEASURE\"!==measureName.substring(0,\"FB-PERF-TRACE-MEASURE\".length)&&index_esm_Trace.createUserTimingTrace(measureName)}var index_esm_PerformanceController=function(){function PerformanceController(app){this.app=app,index_esm_Api.getInstance().requiredApisAvailable()&&Object(util_dist_index_esm.validateIndexedDBOpenable)().then((function(isAvailable){isAvailable&&(isTransportSetup||(function processQueue(timeOffset){setTimeout((function(){var staged,log_event;if(0!==remainingTries)return queue.length?(log_event=(staged=queue.splice(0,1e3)).map((function(evt){return{source_extension_json_proto3:evt.message,event_time_ms:String(evt.eventTime)}})),void function(data,staged){return function(data){var flTransportFullUrl=SettingsService.getInstance().getFlTransportFullUrl();return fetch(flTransportFullUrl,{method:\"POST\",body:JSON.stringify(data)})}(data).then((function(res){return res.ok||consoleLogger.info(\"Call to Firebase backend failed.\"),res.json()})).then((function(res){var transportWait=Number(res.nextRequestWaitMillis),requestOffset=1e4;isNaN(transportWait)||(requestOffset=Math.max(transportWait,requestOffset));var logResponseDetails=res.logResponseDetails;Array.isArray(logResponseDetails)&&logResponseDetails.length>0&&\"RETRY_REQUEST_LATER\"===logResponseDetails[0].responseAction&&(queue=Object(tslib_es6.__spreadArray)(Object(tslib_es6.__spreadArray)([],staged),queue),consoleLogger.info(\"Retry transport request later.\")),remainingTries=3,processQueue(requestOffset)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:SettingsService.getInstance().logSource,log_event:log_event},staged).catch((function(){queue=Object(tslib_es6.__spreadArray)(Object(tslib_es6.__spreadArray)([],staged),queue),remainingTries--,consoleLogger.info(\"Tries left: \"+remainingTries+\".\"),processQueue(1e4)}))):processQueue(1e4)}),timeOffset)}(5500),isTransportSetup=!0),getInitializationPromise().then(setupOobResources,setupOobResources))})).catch((function(error){consoleLogger.info(\"Environment doesn't support IndexedDB: \"+error)}))}return PerformanceController.prototype.trace=function(name){return new index_esm_Trace(name)},Object.defineProperty(PerformanceController.prototype,\"instrumentationEnabled\",{get:function(){return SettingsService.getInstance().instrumentationEnabled},set:function(val){SettingsService.getInstance().instrumentationEnabled=val},enumerable:!1,configurable:!0}),Object.defineProperty(PerformanceController.prototype,\"dataCollectionEnabled\",{get:function(){return SettingsService.getInstance().dataCollectionEnabled},set:function(val){SettingsService.getInstance().dataCollectionEnabled=val},enumerable:!1,configurable:!0}),PerformanceController}();!function(instance){instance.INTERNAL.registerComponent(new component_dist_index_esm.Component(\"performance\",(function(container){return function(app,installations){if(\"[DEFAULT]\"!==app.name)throw dist_index_esm_ERROR_FACTORY.create(\"FB not default\");if(\"undefined\"==typeof window)throw dist_index_esm_ERROR_FACTORY.create(\"no window\");return function(window){windowInstance=window}(window),SettingsService.getInstance().firebaseAppInstance=app,SettingsService.getInstance().installationsService=installations,new index_esm_PerformanceController(app)}(container.getProvider(\"app\").getImmediate(),container.getProvider(\"installations\").getImmediate())}),\"PUBLIC\")),instance.registerVersion(\"@firebase/performance\",\"0.4.12\")}(index_esm.default);var analytics_dist_index_esm_a,GTAG_URL=\"https://www.googletagmanager.com/gtag/js\",GtagCommand=function(GtagCommand){return GtagCommand.EVENT=\"event\",GtagCommand.SET=\"set\",GtagCommand.CONFIG=\"config\",GtagCommand}({}),EventName=function(EventName){return EventName.ADD_SHIPPING_INFO=\"add_shipping_info\",EventName.ADD_PAYMENT_INFO=\"add_payment_info\",EventName.ADD_TO_CART=\"add_to_cart\",EventName.ADD_TO_WISHLIST=\"add_to_wishlist\",EventName.BEGIN_CHECKOUT=\"begin_checkout\",EventName.CHECKOUT_PROGRESS=\"checkout_progress\",EventName.EXCEPTION=\"exception\",EventName.GENERATE_LEAD=\"generate_lead\",EventName.LOGIN=\"login\",EventName.PAGE_VIEW=\"page_view\",EventName.PURCHASE=\"purchase\",EventName.REFUND=\"refund\",EventName.REMOVE_FROM_CART=\"remove_from_cart\",EventName.SCREEN_VIEW=\"screen_view\",EventName.SEARCH=\"search\",EventName.SELECT_CONTENT=\"select_content\",EventName.SELECT_ITEM=\"select_item\",EventName.SELECT_PROMOTION=\"select_promotion\",EventName.SET_CHECKOUT_OPTION=\"set_checkout_option\",EventName.SHARE=\"share\",EventName.SIGN_UP=\"sign_up\",EventName.TIMING_COMPLETE=\"timing_complete\",EventName.VIEW_CART=\"view_cart\",EventName.VIEW_ITEM=\"view_item\",EventName.VIEW_ITEM_LIST=\"view_item_list\",EventName.VIEW_PROMOTION=\"view_promotion\",EventName.VIEW_SEARCH_RESULTS=\"view_search_results\",EventName}({}),dist_index_esm_logger=new logger_dist_index_esm.Logger(\"@firebase/analytics\");function gtagOnConfig(gtagCore,initializationPromisesMap,dynamicConfigPromisesList,measurementIdToAppId,measurementId,gtagParams){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var correspondingAppId,dynamicConfigResults,foundConfig,e_1;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:correspondingAppId=measurementIdToAppId[measurementId],_a.label=1;case 1:return _a.trys.push([1,7,,8]),correspondingAppId?[4,initializationPromisesMap[correspondingAppId]]:[3,3];case 2:return _a.sent(),[3,6];case 3:return[4,Promise.all(dynamicConfigPromisesList)];case 4:return dynamicConfigResults=_a.sent(),(foundConfig=dynamicConfigResults.find((function(config){return config.measurementId===measurementId})))?[4,initializationPromisesMap[foundConfig.appId]]:[3,6];case 5:_a.sent(),_a.label=6;case 6:return[3,8];case 7:return e_1=_a.sent(),dist_index_esm_logger.error(e_1),[3,8];case 8:return gtagCore(GtagCommand.CONFIG,measurementId,gtagParams),[2]}}))}))}function gtagOnEvent(gtagCore,initializationPromisesMap,dynamicConfigPromisesList,measurementId,gtagParams){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var initializationPromisesToWaitFor,gaSendToList,dynamicConfigResults,_loop_1,_i,gaSendToList_1,e_2;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,4,,5]),initializationPromisesToWaitFor=[],gtagParams&&gtagParams.send_to?(gaSendToList=gtagParams.send_to,Array.isArray(gaSendToList)||(gaSendToList=[gaSendToList]),[4,Promise.all(dynamicConfigPromisesList)]):[3,2];case 1:for(dynamicConfigResults=_a.sent(),_loop_1=function(sendToId){var foundConfig=dynamicConfigResults.find((function(config){return config.measurementId===sendToId})),initializationPromise=foundConfig&&initializationPromisesMap[foundConfig.appId];if(!initializationPromise)return initializationPromisesToWaitFor=[],\"break\";initializationPromisesToWaitFor.push(initializationPromise)},_i=0,gaSendToList_1=gaSendToList;_i<gaSendToList_1.length&&\"break\"!==_loop_1(gaSendToList_1[_i]);_i++);_a.label=2;case 2:return 0===initializationPromisesToWaitFor.length&&(initializationPromisesToWaitFor=Object.values(initializationPromisesMap)),[4,Promise.all(initializationPromisesToWaitFor)];case 3:return _a.sent(),gtagCore(GtagCommand.EVENT,measurementId,gtagParams||{}),[3,5];case 4:return e_2=_a.sent(),dist_index_esm_logger.error(e_2),[3,5];case 5:return[2]}}))}))}var ERRORS=((analytics_dist_index_esm_a={})[\"already-exists\"]=\"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.\",analytics_dist_index_esm_a[\"already-initialized\"]=\"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.\",analytics_dist_index_esm_a[\"interop-component-reg-failed\"]=\"Firebase Analytics Interop Component failed to instantiate: {$reason}\",analytics_dist_index_esm_a[\"invalid-analytics-context\"]=\"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}\",analytics_dist_index_esm_a[\"indexeddb-unavailable\"]=\"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}\",analytics_dist_index_esm_a[\"fetch-throttle\"]=\"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.\",analytics_dist_index_esm_a[\"config-fetch-failed\"]=\"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}\",analytics_dist_index_esm_a[\"no-api-key\"]='The \"apiKey\" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',analytics_dist_index_esm_a[\"no-app-id\"]='The \"appId\" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',analytics_dist_index_esm_a),analytics_dist_index_esm_ERROR_FACTORY=new util_dist_index_esm.ErrorFactory(\"analytics\",\"Analytics\",ERRORS),defaultRetryData=new(function(){function RetryData(throttleMetadata,intervalMillis){void 0===throttleMetadata&&(throttleMetadata={}),void 0===intervalMillis&&(intervalMillis=1e3),this.throttleMetadata=throttleMetadata,this.intervalMillis=intervalMillis}return RetryData.prototype.getThrottleMetadata=function(appId){return this.throttleMetadata[appId]},RetryData.prototype.setThrottleMetadata=function(appId,metadata){this.throttleMetadata[appId]=metadata},RetryData.prototype.deleteThrottleMetadata=function(appId){delete this.throttleMetadata[appId]},RetryData}());function fetchDynamicConfig(appFields){var _a;return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var appId,request,appUrl,response,errorMessage,jsonResponse;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return appId=appFields.appId,request={method:\"GET\",headers:(apiKey=appFields.apiKey,new Headers({Accept:\"application/json\",\"x-goog-api-key\":apiKey}))},appUrl=\"https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig\".replace(\"{app-id}\",appId),[4,fetch(appUrl,request)];case 1:if(200===(response=_b.sent()).status||304===response.status)return[3,6];errorMessage=\"\",_b.label=2;case 2:return _b.trys.push([2,4,,5]),[4,response.json()];case 3:return jsonResponse=_b.sent(),(null===(_a=jsonResponse.error)||void 0===_a?void 0:_a.message)&&(errorMessage=jsonResponse.error.message),[3,5];case 4:return _b.sent(),[3,5];case 5:throw analytics_dist_index_esm_ERROR_FACTORY.create(\"config-fetch-failed\",{httpStatus:response.status,responseMessage:errorMessage});case 6:return[2,response.json()]}var apiKey}))}))}function attemptFetchDynamicConfigWithRetry(appFields,_a,signal,retryData){var throttleEndTimeMillis=_a.throttleEndTimeMillis,backoffCount=_a.backoffCount;return void 0===retryData&&(retryData=defaultRetryData),Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var appId,measurementId,e_1,response,e_2,backoffMillis,throttleMetadata;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:appId=appFields.appId,measurementId=appFields.measurementId,_b.label=1;case 1:return _b.trys.push([1,3,,4]),[4,setAbortableTimeout(signal,throttleEndTimeMillis)];case 2:return _b.sent(),[3,4];case 3:if(e_1=_b.sent(),measurementId)return dist_index_esm_logger.warn(\"Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID \"+measurementId+' provided in the \"measurementId\" field in the local Firebase config. ['+e_1.message+\"]\"),[2,{appId:appId,measurementId:measurementId}];throw e_1;case 4:return _b.trys.push([4,6,,7]),[4,fetchDynamicConfig(appFields)];case 5:return response=_b.sent(),retryData.deleteThrottleMetadata(appId),[2,response];case 6:if(!function(e){if(!(e instanceof util_dist_index_esm.FirebaseError&&e.customData))return!1;var httpStatus=Number(e.customData.httpStatus);return 429===httpStatus||500===httpStatus||503===httpStatus||504===httpStatus}(e_2=_b.sent())){if(retryData.deleteThrottleMetadata(appId),measurementId)return dist_index_esm_logger.warn(\"Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID \"+measurementId+' provided in the \"measurementId\" field in the local Firebase config. ['+e_2.message+\"]\"),[2,{appId:appId,measurementId:measurementId}];throw e_2}return backoffMillis=503===Number(e_2.customData.httpStatus)?Object(util_dist_index_esm.calculateBackoffMillis)(backoffCount,retryData.intervalMillis,30):Object(util_dist_index_esm.calculateBackoffMillis)(backoffCount,retryData.intervalMillis),throttleMetadata={throttleEndTimeMillis:Date.now()+backoffMillis,backoffCount:backoffCount+1},retryData.setThrottleMetadata(appId,throttleMetadata),dist_index_esm_logger.debug(\"Calling attemptFetch again in \"+backoffMillis+\" millis\"),[2,attemptFetchDynamicConfigWithRetry(appFields,throttleMetadata,signal,retryData)];case 7:return[2]}}))}))}function setAbortableTimeout(signal,throttleEndTimeMillis){return new Promise((function(resolve,reject){var backoffMillis=Math.max(throttleEndTimeMillis-Date.now(),0),timeout=setTimeout(resolve,backoffMillis);signal.addEventListener((function(){clearTimeout(timeout),reject(analytics_dist_index_esm_ERROR_FACTORY.create(\"fetch-throttle\",{throttleEndTimeMillis:throttleEndTimeMillis}))}))}))}var gtagCoreFunction,wrappedGtagFunction,AnalyticsAbortSignal=function(){function AnalyticsAbortSignal(){this.listeners=[]}return AnalyticsAbortSignal.prototype.addEventListener=function(listener){this.listeners.push(listener)},AnalyticsAbortSignal.prototype.abort=function(){this.listeners.forEach((function(listener){return listener()}))},AnalyticsAbortSignal}(),index_esm_initializationPromisesMap={},index_esm_dynamicConfigPromisesList=[],index_esm_measurementIdToAppId={},index_esm_dataLayerName=\"dataLayer\",gtagName=\"gtag\",globalInitDone=!1;function settings(options){if(globalInitDone)throw analytics_dist_index_esm_ERROR_FACTORY.create(\"already-initialized\");options.dataLayerName&&(index_esm_dataLayerName=options.dataLayerName),options.gtagName&&(gtagName=options.gtagName)}function index_esm_isSupported(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:if(Object(util_dist_index_esm.isBrowserExtension)())return[2,!1];if(!Object(util_dist_index_esm.areCookiesEnabled)())return[2,!1];if(!Object(util_dist_index_esm.isIndexedDBAvailable)())return[2,!1];_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,Object(util_dist_index_esm.validateIndexedDBOpenable)()];case 2:return[2,_a.sent()];case 3:return _a.sent(),[2,!1];case 4:return[2]}}))}))}!function(instance){instance.INTERNAL.registerComponent(new component_dist_index_esm.Component(\"analytics\",(function(container){return function(app,installations){!function(){var mismatchedEnvMessages=[];if(Object(util_dist_index_esm.isBrowserExtension)()&&mismatchedEnvMessages.push(\"This is a browser extension environment.\"),Object(util_dist_index_esm.areCookiesEnabled)()||mismatchedEnvMessages.push(\"Cookies are not available.\"),mismatchedEnvMessages.length>0){var details=mismatchedEnvMessages.map((function(message,index){return\"(\"+(index+1)+\") \"+message})).join(\" \"),err=analytics_dist_index_esm_ERROR_FACTORY.create(\"invalid-analytics-context\",{errorInfo:details});dist_index_esm_logger.warn(err.message)}}();var dataLayerName,dataLayer,appId=app.options.appId;if(!appId)throw analytics_dist_index_esm_ERROR_FACTORY.create(\"no-app-id\");if(!app.options.apiKey){if(!app.options.measurementId)throw analytics_dist_index_esm_ERROR_FACTORY.create(\"no-api-key\");dist_index_esm_logger.warn('The \"apiKey\" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+app.options.measurementId+' provided in the \"measurementId\" field in the local Firebase config.')}if(null!=index_esm_initializationPromisesMap[appId])throw analytics_dist_index_esm_ERROR_FACTORY.create(\"already-exists\",{id:appId});if(!globalInitDone){dataLayerName=index_esm_dataLayerName,dataLayer=[],Array.isArray(window[dataLayerName])?dataLayer=window[dataLayerName]:window[dataLayerName]=dataLayer;var _a=function(initializationPromisesMap,dynamicConfigPromisesList,measurementIdToAppId,dataLayerName,gtagFunctionName){var gtagCore=function(){for(var _args=[],_i=0;_i<arguments.length;_i++)_args[_i]=arguments[_i];window[dataLayerName].push(arguments)};return window[gtagFunctionName]&&\"function\"==typeof window[gtagFunctionName]&&(gtagCore=window[gtagFunctionName]),window[gtagFunctionName]=function(gtagCore,initializationPromisesMap,dynamicConfigPromisesList,measurementIdToAppId){return function(command,idOrNameOrParams,gtagParams){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e_3;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,6,,7]),command!==GtagCommand.EVENT?[3,2]:[4,gtagOnEvent(gtagCore,initializationPromisesMap,dynamicConfigPromisesList,idOrNameOrParams,gtagParams)];case 1:return _a.sent(),[3,5];case 2:return command!==GtagCommand.CONFIG?[3,4]:[4,gtagOnConfig(gtagCore,initializationPromisesMap,dynamicConfigPromisesList,measurementIdToAppId,idOrNameOrParams,gtagParams)];case 3:return _a.sent(),[3,5];case 4:gtagCore(GtagCommand.SET,idOrNameOrParams),_a.label=5;case 5:return[3,7];case 6:return e_3=_a.sent(),dist_index_esm_logger.error(e_3),[3,7];case 7:return[2]}}))}))}}(gtagCore,initializationPromisesMap,dynamicConfigPromisesList,measurementIdToAppId),{gtagCore:gtagCore,wrappedGtag:window[gtagFunctionName]}}(index_esm_initializationPromisesMap,index_esm_dynamicConfigPromisesList,index_esm_measurementIdToAppId,index_esm_dataLayerName,gtagName);wrappedGtagFunction=_a.wrappedGtag,gtagCoreFunction=_a.gtagCore,globalInitDone=!0}return index_esm_initializationPromisesMap[appId]=function(app,dynamicConfigPromisesList,measurementIdToAppId,installations,gtagCore,dataLayerName){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var dynamicConfigPromise,fidPromise,_a,dynamicConfig,fid,configProperties,_b;return Object(tslib_es6.__generator)(this,(function(_c){switch(_c.label){case 0:return(dynamicConfigPromise=function(app,retryData,timeoutMillis){return void 0===retryData&&(retryData=defaultRetryData),Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var _a,appId,apiKey,measurementId,throttleMetadata,signal,_this=this;return Object(tslib_es6.__generator)(this,(function(_b){if(apiKey=(_a=app.options).apiKey,measurementId=_a.measurementId,!(appId=_a.appId))throw analytics_dist_index_esm_ERROR_FACTORY.create(\"no-app-id\");if(!apiKey){if(measurementId)return[2,{measurementId:measurementId,appId:appId}];throw analytics_dist_index_esm_ERROR_FACTORY.create(\"no-api-key\")}return throttleMetadata=retryData.getThrottleMetadata(appId)||{backoffCount:0,throttleEndTimeMillis:Date.now()},signal=new AnalyticsAbortSignal,setTimeout((function(){return Object(tslib_es6.__awaiter)(_this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(_a){return signal.abort(),[2]}))}))}),6e4),[2,attemptFetchDynamicConfigWithRetry({appId:appId,apiKey:apiKey,measurementId:measurementId},throttleMetadata,signal,retryData)]}))}))}(app)).then((function(config){measurementIdToAppId[config.measurementId]=config.appId,app.options.measurementId&&config.measurementId!==app.options.measurementId&&dist_index_esm_logger.warn(\"The measurement ID in the local Firebase config (\"+app.options.measurementId+\") does not match the measurement ID fetched from the server (\"+config.measurementId+\"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.\")})).catch((function(e){return dist_index_esm_logger.error(e)})),dynamicConfigPromisesList.push(dynamicConfigPromise),fidPromise=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var e_1;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return Object(util_dist_index_esm.isIndexedDBAvailable)()?[3,1]:(dist_index_esm_logger.warn(analytics_dist_index_esm_ERROR_FACTORY.create(\"indexeddb-unavailable\",{errorInfo:\"IndexedDB is not available in this environment.\"}).message),[2,!1]);case 1:return _a.trys.push([1,3,,4]),[4,Object(util_dist_index_esm.validateIndexedDBOpenable)()];case 2:return _a.sent(),[3,4];case 3:return e_1=_a.sent(),dist_index_esm_logger.warn(analytics_dist_index_esm_ERROR_FACTORY.create(\"indexeddb-unavailable\",{errorInfo:e_1}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(envIsValid){return envIsValid?installations.getId():void 0})),[4,Promise.all([dynamicConfigPromise,fidPromise])];case 1:return _a=_c.sent(),dynamicConfig=_a[0],fid=_a[1],function(){for(var scriptTags=window.document.getElementsByTagName(\"script\"),_i=0,_a=Object.values(scriptTags);_i<_a.length;_i++){var tag=_a[_i];if(tag.src&&tag.src.includes(GTAG_URL))return tag}return null}()||function(dataLayerName,measurementId){var script=document.createElement(\"script\");script.src=GTAG_URL+\"?l=\"+dataLayerName+\"&id=\"+measurementId,script.async=!0,document.head.appendChild(script)}(dataLayerName,dynamicConfig.measurementId),gtagCore(\"js\",new Date),(_b={}).origin=\"firebase\",_b.update=!0,configProperties=_b,null!=fid&&(configProperties.firebase_id=fid),gtagCore(GtagCommand.CONFIG,dynamicConfig.measurementId,configProperties),[2,dynamicConfig.measurementId]}}))}))}(app,index_esm_dynamicConfigPromisesList,index_esm_measurementIdToAppId,installations,gtagCoreFunction,index_esm_dataLayerName),{app:app,logEvent:function(eventName,eventParams,options){(function(gtagFunction,initializationPromise,eventName,eventParams,options){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var measurementId,params;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return options&&options.global?(gtagFunction(GtagCommand.EVENT,eventName,eventParams),[2]):[3,1];case 1:return[4,initializationPromise];case 2:measurementId=_a.sent(),params=Object(tslib_es6.__assign)(Object(tslib_es6.__assign)({},eventParams),{send_to:measurementId}),gtagFunction(GtagCommand.EVENT,eventName,params),_a.label=3;case 3:return[2]}}))}))})(wrappedGtagFunction,index_esm_initializationPromisesMap[appId],eventName,eventParams,options).catch((function(e){return dist_index_esm_logger.error(e)}))},setCurrentScreen:function(screenName,options){(function(gtagFunction,initializationPromise,screenName,options){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var measurementId;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return options&&options.global?(gtagFunction(GtagCommand.SET,{screen_name:screenName}),[2,Promise.resolve()]):[3,1];case 1:return[4,initializationPromise];case 2:measurementId=_a.sent(),gtagFunction(GtagCommand.CONFIG,measurementId,{update:!0,screen_name:screenName}),_a.label=3;case 3:return[2]}}))}))})(wrappedGtagFunction,index_esm_initializationPromisesMap[appId],screenName,options).catch((function(e){return dist_index_esm_logger.error(e)}))},setUserId:function(id,options){(function(gtagFunction,initializationPromise,id,options){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var measurementId;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return options&&options.global?(gtagFunction(GtagCommand.SET,{user_id:id}),[2,Promise.resolve()]):[3,1];case 1:return[4,initializationPromise];case 2:measurementId=_a.sent(),gtagFunction(GtagCommand.CONFIG,measurementId,{update:!0,user_id:id}),_a.label=3;case 3:return[2]}}))}))})(wrappedGtagFunction,index_esm_initializationPromisesMap[appId],id,options).catch((function(e){return dist_index_esm_logger.error(e)}))},setUserProperties:function(properties,options){(function(gtagFunction,initializationPromise,properties,options){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var flatProperties,_i,_a,key,measurementId;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:if(!options||!options.global)return[3,1];for(flatProperties={},_i=0,_a=Object.keys(properties);_i<_a.length;_i++)flatProperties[\"user_properties.\"+(key=_a[_i])]=properties[key];return gtagFunction(GtagCommand.SET,flatProperties),[2,Promise.resolve()];case 1:return[4,initializationPromise];case 2:measurementId=_b.sent(),gtagFunction(GtagCommand.CONFIG,measurementId,{update:!0,user_properties:properties}),_b.label=3;case 3:return[2]}}))}))})(wrappedGtagFunction,index_esm_initializationPromisesMap[appId],properties,options).catch((function(e){return dist_index_esm_logger.error(e)}))},setAnalyticsCollectionEnabled:function(enabled){(function(initializationPromise,enabled){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var measurementId;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,initializationPromise];case 1:return measurementId=_a.sent(),window[\"ga-disable-\"+measurementId]=!enabled,[2]}}))}))})(index_esm_initializationPromisesMap[appId],enabled).catch((function(e){return dist_index_esm_logger.error(e)}))},INTERNAL:{delete:function(){return delete index_esm_initializationPromisesMap[appId],Promise.resolve()}}}}(container.getProvider(\"app\").getImmediate(),container.getProvider(\"installations\").getImmediate())}),\"PUBLIC\").setServiceProps({settings:settings,EventName:EventName,isSupported:index_esm_isSupported})),instance.INTERNAL.registerComponent(new component_dist_index_esm.Component(\"analytics-internal\",(function(container){try{return{logEvent:container.getProvider(\"analytics\").getImmediate().logEvent}}catch(e){throw analytics_dist_index_esm_ERROR_FACTORY.create(\"interop-component-reg-failed\",{reason:e})}}),\"PRIVATE\")),instance.registerVersion(\"@firebase/analytics\",\"0.6.10\")}(index_esm.default);var remote_config_dist_index_esm_a,index_esm_CachingClient=function(){function CachingClient(client,storage,storageCache,logger){this.client=client,this.storage=storage,this.storageCache=storageCache,this.logger=logger}return CachingClient.prototype.isCachedDataFresh=function(cacheMaxAgeMillis,lastSuccessfulFetchTimestampMillis){if(!lastSuccessfulFetchTimestampMillis)return this.logger.debug(\"Config fetch cache check. Cache unpopulated.\"),!1;var cacheAgeMillis=Date.now()-lastSuccessfulFetchTimestampMillis,isCachedDataFresh=cacheAgeMillis<=cacheMaxAgeMillis;return this.logger.debug(\"Config fetch cache check. Cache age millis: \"+cacheAgeMillis+\". Cache max age millis (minimumFetchIntervalMillis setting): \"+cacheMaxAgeMillis+\". Is cache hit: \"+isCachedDataFresh+\".\"),isCachedDataFresh},CachingClient.prototype.fetch=function(request){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var _a,lastSuccessfulFetchTimestampMillis,lastSuccessfulFetchResponse,response,storageOperations;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return _a=_b.sent(),lastSuccessfulFetchTimestampMillis=_a[0],(lastSuccessfulFetchResponse=_a[1])&&this.isCachedDataFresh(request.cacheMaxAgeMillis,lastSuccessfulFetchTimestampMillis)?[2,lastSuccessfulFetchResponse]:(request.eTag=lastSuccessfulFetchResponse&&lastSuccessfulFetchResponse.eTag,[4,this.client.fetch(request)]);case 2:return response=_b.sent(),storageOperations=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===response.status&&storageOperations.push(this.storage.setLastSuccessfulFetchResponse(response)),[4,Promise.all(storageOperations)];case 3:return _b.sent(),[2,response]}}))}))},CachingClient}(),dist_index_esm_ERROR_DESCRIPTION_MAP=((remote_config_dist_index_esm_a={})[\"registration-window\"]=\"Undefined window object. This SDK only supports usage in a browser environment.\",remote_config_dist_index_esm_a[\"registration-project-id\"]=\"Undefined project identifier. Check Firebase app initialization.\",remote_config_dist_index_esm_a[\"registration-api-key\"]=\"Undefined API key. Check Firebase app initialization.\",remote_config_dist_index_esm_a[\"registration-app-id\"]=\"Undefined app identifier. Check Firebase app initialization.\",remote_config_dist_index_esm_a[\"storage-open\"]=\"Error thrown when opening storage. Original error: {$originalErrorMessage}.\",remote_config_dist_index_esm_a[\"storage-get\"]=\"Error thrown when reading from storage. Original error: {$originalErrorMessage}.\",remote_config_dist_index_esm_a[\"storage-set\"]=\"Error thrown when writing to storage. Original error: {$originalErrorMessage}.\",remote_config_dist_index_esm_a[\"storage-delete\"]=\"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.\",remote_config_dist_index_esm_a[\"fetch-client-network\"]=\"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.\",remote_config_dist_index_esm_a[\"fetch-timeout\"]='The config fetch request timed out.  Configure timeout using \"fetchTimeoutMillis\" SDK setting.',remote_config_dist_index_esm_a[\"fetch-throttle\"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using \"fetchTimeoutMillis\" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',remote_config_dist_index_esm_a[\"fetch-client-parse\"]=\"Fetch client could not parse response. Original error: {$originalErrorMessage}.\",remote_config_dist_index_esm_a[\"fetch-status\"]=\"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.\",remote_config_dist_index_esm_a),remote_config_dist_index_esm_ERROR_FACTORY=new util_dist_index_esm.ErrorFactory(\"remoteconfig\",\"Remote Config\",dist_index_esm_ERROR_DESCRIPTION_MAP),index_esm_RestClient=function(){function RestClient(firebaseInstallations,sdkVersion,namespace,projectId,apiKey,appId){this.firebaseInstallations=firebaseInstallations,this.sdkVersion=sdkVersion,this.namespace=namespace,this.projectId=projectId,this.apiKey=apiKey,this.appId=appId}return RestClient.prototype.fetch=function(request){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var _a,urlBase,url,requestBody,options,fetchPromise,timeoutPromise,response,originalError_1,errorCode,status,responseEtag,config,state,responseBody,originalError_2;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:_a=_b.sent(),urlBase=window.FIREBASE_REMOTE_CONFIG_URL_BASE||\"https://firebaseremoteconfig.googleapis.com\",url=urlBase+\"/v1/projects/\"+this.projectId+\"/namespaces/\"+this.namespace+\":fetch?key=\"+this.apiKey,requestBody={sdk_version:this.sdkVersion,app_instance_id:_a[0],app_instance_id_token:_a[1],app_id:this.appId,language_code:(void 0===navigatorLanguage&&(navigatorLanguage=navigator),navigatorLanguage.languages&&navigatorLanguage.languages[0]||navigatorLanguage.language)},options={method:\"POST\",headers:{\"Content-Type\":\"application/json\",\"Content-Encoding\":\"gzip\",\"If-None-Match\":request.eTag||\"*\"},body:JSON.stringify(requestBody)},fetchPromise=fetch(url,options),timeoutPromise=new Promise((function(_resolve,reject){request.signal.addEventListener((function(){var error=new Error(\"The operation was aborted.\");error.name=\"AbortError\",reject(error)}))})),_b.label=2;case 2:return _b.trys.push([2,5,,6]),[4,Promise.race([fetchPromise,timeoutPromise])];case 3:return _b.sent(),[4,fetchPromise];case 4:return response=_b.sent(),[3,6];case 5:throw originalError_1=_b.sent(),errorCode=\"fetch-client-network\",\"AbortError\"===originalError_1.name&&(errorCode=\"fetch-timeout\"),remote_config_dist_index_esm_ERROR_FACTORY.create(errorCode,{originalErrorMessage:originalError_1.message});case 6:if(status=response.status,responseEtag=response.headers.get(\"ETag\")||void 0,200!==response.status)return[3,11];responseBody=void 0,_b.label=7;case 7:return _b.trys.push([7,9,,10]),[4,response.json()];case 8:return responseBody=_b.sent(),[3,10];case 9:throw originalError_2=_b.sent(),remote_config_dist_index_esm_ERROR_FACTORY.create(\"fetch-client-parse\",{originalErrorMessage:originalError_2.message});case 10:config=responseBody.entries,state=responseBody.state,_b.label=11;case 11:if(\"INSTANCE_STATE_UNSPECIFIED\"===state?status=500:\"NO_CHANGE\"===state?status=304:\"NO_TEMPLATE\"!==state&&\"EMPTY_CONFIG\"!==state||(config={}),304!==status&&200!==status)throw remote_config_dist_index_esm_ERROR_FACTORY.create(\"fetch-status\",{httpStatus:status});return[2,{status:status,eTag:responseEtag,config:config}]}var navigatorLanguage}))}))},RestClient}(),RemoteConfigAbortSignal=function(){function RemoteConfigAbortSignal(){this.listeners=[]}return RemoteConfigAbortSignal.prototype.addEventListener=function(listener){this.listeners.push(listener)},RemoteConfigAbortSignal.prototype.abort=function(){this.listeners.forEach((function(listener){return listener()}))},RemoteConfigAbortSignal}(),BOOLEAN_TRUTHY_VALUES=[\"1\",\"true\",\"t\",\"yes\",\"y\",\"on\"],Value=function(){function Value(_source,_value){void 0===_value&&(_value=\"\"),this._source=_source,this._value=_value}return Value.prototype.asString=function(){return this._value},Value.prototype.asBoolean=function(){return\"static\"!==this._source&&BOOLEAN_TRUTHY_VALUES.indexOf(this._value.toLowerCase())>=0},Value.prototype.asNumber=function(){if(\"static\"===this._source)return 0;var num=Number(this._value);return isNaN(num)&&(num=0),num},Value.prototype.getSource=function(){return this._source},Value}(),index_esm_RemoteConfig=function(){function RemoteConfig(app,_client,_storageCache,_storage,_logger){this.app=app,this._client=_client,this._storageCache=_storageCache,this._storage=_storage,this._logger=_logger,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return RemoteConfig.prototype.setLogLevel=function(logLevel){switch(logLevel){case\"debug\":this._logger.logLevel=logger_dist_index_esm.LogLevel.DEBUG;break;case\"silent\":this._logger.logLevel=logger_dist_index_esm.LogLevel.SILENT;break;default:this._logger.logLevel=logger_dist_index_esm.LogLevel.ERROR}},Object.defineProperty(RemoteConfig.prototype,\"fetchTimeMillis\",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(RemoteConfig.prototype,\"lastFetchStatus\",{get:function(){return this._storageCache.getLastFetchStatus()||\"no-fetch-yet\"},enumerable:!1,configurable:!0}),RemoteConfig.prototype.activate=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var _a,lastSuccessfulFetchResponse,activeConfigEtag;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return _a=_b.sent(),activeConfigEtag=_a[1],(lastSuccessfulFetchResponse=_a[0])&&lastSuccessfulFetchResponse.config&&lastSuccessfulFetchResponse.eTag&&lastSuccessfulFetchResponse.eTag!==activeConfigEtag?[4,Promise.all([this._storageCache.setActiveConfig(lastSuccessfulFetchResponse.config),this._storage.setActiveConfigEtag(lastSuccessfulFetchResponse.eTag)])]:[2,!1];case 2:return _b.sent(),[2,!0]}}))}))},RemoteConfig.prototype.ensureInitialized=function(){var _this=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){_this._isInitializationComplete=!0}))),this._initializePromise},RemoteConfig.prototype.fetch=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var abortSignal,e_1,lastFetchStatus,_this=this;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:abortSignal=new RemoteConfigAbortSignal,setTimeout((function(){return Object(tslib_es6.__awaiter)(_this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(_a){return abortSignal.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),_a.label=1;case 1:return _a.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:abortSignal})];case 2:return _a.sent(),[4,this._storageCache.setLastFetchStatus(\"success\")];case 3:return _a.sent(),[3,6];case 4:return e_1=_a.sent(),lastFetchStatus=function(e,errorCode){return e instanceof util_dist_index_esm.FirebaseError&&-1!==e.code.indexOf(\"fetch-throttle\")}(e_1)?\"throttle\":\"failure\",[4,this._storageCache.setLastFetchStatus(lastFetchStatus)];case 5:throw _a.sent(),e_1;case 6:return[2]}}))}))},RemoteConfig.prototype.fetchAndActivate=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,this.fetch()];case 1:return _a.sent(),[2,this.activate()]}}))}))},RemoteConfig.prototype.getAll=function(){var obj1,obj2,_this=this;return(obj1=this._storageCache.getActiveConfig(),obj2=this.defaultConfig,void 0===obj1&&(obj1={}),void 0===obj2&&(obj2={}),Object.keys(Object(tslib_es6.__assign)(Object(tslib_es6.__assign)({},obj1),obj2))).reduce((function(allConfigs,key){return allConfigs[key]=_this.getValue(key),allConfigs}),{})},RemoteConfig.prototype.getBoolean=function(key){return this.getValue(key).asBoolean()},RemoteConfig.prototype.getNumber=function(key){return this.getValue(key).asNumber()},RemoteConfig.prototype.getString=function(key){return this.getValue(key).asString()},RemoteConfig.prototype.getValue=function(key){this._isInitializationComplete||this._logger.debug('A value was requested for key \"'+key+'\" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var activeConfig=this._storageCache.getActiveConfig();return activeConfig&&void 0!==activeConfig[key]?new Value(\"remote\",activeConfig[key]):this.defaultConfig&&void 0!==this.defaultConfig[key]?new Value(\"default\",String(this.defaultConfig[key])):(this._logger.debug('Returning static value for key \"'+key+'\". Define a default or remote value if this is unintentional.'),new Value(\"static\"))},RemoteConfig}();function toFirebaseError(event,errorCode){var originalError=event.target.error||void 0;return remote_config_dist_index_esm_ERROR_FACTORY.create(errorCode,{originalErrorMessage:originalError&&originalError.message})}var index_esm_Storage=function(){function Storage(appId,appName,namespace,openDbPromise){void 0===openDbPromise&&(openDbPromise=new Promise((function(resolve,reject){var request=indexedDB.open(\"firebase_remote_config\",1);request.onerror=function(event){reject(toFirebaseError(event,\"storage-open\"))},request.onsuccess=function(event){resolve(event.target.result)},request.onupgradeneeded=function(event){var db=event.target.result;switch(event.oldVersion){case 0:db.createObjectStore(\"app_namespace_store\",{keyPath:\"compositeKey\"})}}}))),this.appId=appId,this.appName=appName,this.namespace=namespace,this.openDbPromise=openDbPromise}return Storage.prototype.getLastFetchStatus=function(){return this.get(\"last_fetch_status\")},Storage.prototype.setLastFetchStatus=function(status){return this.set(\"last_fetch_status\",status)},Storage.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get(\"last_successful_fetch_timestamp_millis\")},Storage.prototype.setLastSuccessfulFetchTimestampMillis=function(timestamp){return this.set(\"last_successful_fetch_timestamp_millis\",timestamp)},Storage.prototype.getLastSuccessfulFetchResponse=function(){return this.get(\"last_successful_fetch_response\")},Storage.prototype.setLastSuccessfulFetchResponse=function(response){return this.set(\"last_successful_fetch_response\",response)},Storage.prototype.getActiveConfig=function(){return this.get(\"active_config\")},Storage.prototype.setActiveConfig=function(config){return this.set(\"active_config\",config)},Storage.prototype.getActiveConfigEtag=function(){return this.get(\"active_config_etag\")},Storage.prototype.setActiveConfigEtag=function(etag){return this.set(\"active_config_etag\",etag)},Storage.prototype.getThrottleMetadata=function(){return this.get(\"throttle_metadata\")},Storage.prototype.setThrottleMetadata=function(metadata){return this.set(\"throttle_metadata\",metadata)},Storage.prototype.deleteThrottleMetadata=function(){return this.delete(\"throttle_metadata\")},Storage.prototype.get=function(key){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var db,_this=this;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,this.openDbPromise];case 1:return db=_a.sent(),[2,new Promise((function(resolve,reject){var objectStore=db.transaction([\"app_namespace_store\"],\"readonly\").objectStore(\"app_namespace_store\"),compositeKey=_this.createCompositeKey(key);try{var request=objectStore.get(compositeKey);request.onerror=function(event){reject(toFirebaseError(event,\"storage-get\"))},request.onsuccess=function(event){var result=event.target.result;resolve(result?result.value:void 0)}}catch(e){reject(remote_config_dist_index_esm_ERROR_FACTORY.create(\"storage-get\",{originalErrorMessage:e&&e.message}))}}))]}}))}))},Storage.prototype.set=function(key,value){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var db,_this=this;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,this.openDbPromise];case 1:return db=_a.sent(),[2,new Promise((function(resolve,reject){var objectStore=db.transaction([\"app_namespace_store\"],\"readwrite\").objectStore(\"app_namespace_store\"),compositeKey=_this.createCompositeKey(key);try{var request=objectStore.put({compositeKey:compositeKey,value:value});request.onerror=function(event){reject(toFirebaseError(event,\"storage-set\"))},request.onsuccess=function(){resolve()}}catch(e){reject(remote_config_dist_index_esm_ERROR_FACTORY.create(\"storage-set\",{originalErrorMessage:e&&e.message}))}}))]}}))}))},Storage.prototype.delete=function(key){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var db,_this=this;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,this.openDbPromise];case 1:return db=_a.sent(),[2,new Promise((function(resolve,reject){var objectStore=db.transaction([\"app_namespace_store\"],\"readwrite\").objectStore(\"app_namespace_store\"),compositeKey=_this.createCompositeKey(key);try{var request=objectStore.delete(compositeKey);request.onerror=function(event){reject(toFirebaseError(event,\"storage-delete\"))},request.onsuccess=function(){resolve()}}catch(e){reject(remote_config_dist_index_esm_ERROR_FACTORY.create(\"storage-delete\",{originalErrorMessage:e&&e.message}))}}))]}}))}))},Storage.prototype.createCompositeKey=function(key){return[this.appId,this.appName,this.namespace,key].join()},Storage}(),index_esm_StorageCache=function(){function StorageCache(storage){this.storage=storage}return StorageCache.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},StorageCache.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},StorageCache.prototype.getActiveConfig=function(){return this.activeConfig},StorageCache.prototype.loadFromStorage=function(){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var lastFetchStatusPromise,lastSuccessfulFetchTimestampMillisPromise,activeConfigPromise,lastFetchStatus,lastSuccessfulFetchTimestampMillis,activeConfig;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return lastFetchStatusPromise=this.storage.getLastFetchStatus(),lastSuccessfulFetchTimestampMillisPromise=this.storage.getLastSuccessfulFetchTimestampMillis(),activeConfigPromise=this.storage.getActiveConfig(),[4,lastFetchStatusPromise];case 1:return(lastFetchStatus=_a.sent())&&(this.lastFetchStatus=lastFetchStatus),[4,lastSuccessfulFetchTimestampMillisPromise];case 2:return(lastSuccessfulFetchTimestampMillis=_a.sent())&&(this.lastSuccessfulFetchTimestampMillis=lastSuccessfulFetchTimestampMillis),[4,activeConfigPromise];case 3:return(activeConfig=_a.sent())&&(this.activeConfig=activeConfig),[2]}}))}))},StorageCache.prototype.setLastFetchStatus=function(status){return this.lastFetchStatus=status,this.storage.setLastFetchStatus(status)},StorageCache.prototype.setLastSuccessfulFetchTimestampMillis=function(timestampMillis){return this.lastSuccessfulFetchTimestampMillis=timestampMillis,this.storage.setLastSuccessfulFetchTimestampMillis(timestampMillis)},StorageCache.prototype.setActiveConfig=function(activeConfig){return this.activeConfig=activeConfig,this.storage.setActiveConfig(activeConfig)},StorageCache}();function index_esm_setAbortableTimeout(signal,throttleEndTimeMillis){return new Promise((function(resolve,reject){var backoffMillis=Math.max(throttleEndTimeMillis-Date.now(),0),timeout=setTimeout(resolve,backoffMillis);signal.addEventListener((function(){clearTimeout(timeout),reject(remote_config_dist_index_esm_ERROR_FACTORY.create(\"fetch-throttle\",{throttleEndTimeMillis:throttleEndTimeMillis}))}))}))}var firebaseInstance,index_esm_RetryingClient=function(){function RetryingClient(client,storage){this.client=client,this.storage=storage}return RetryingClient.prototype.fetch=function(request){return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var throttleMetadata;return Object(tslib_es6.__generator)(this,(function(_a){switch(_a.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return throttleMetadata=_a.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(request,throttleMetadata)]}}))}))},RetryingClient.prototype.attemptFetch=function(request,_a){var throttleEndTimeMillis=_a.throttleEndTimeMillis,backoffCount=_a.backoffCount;return Object(tslib_es6.__awaiter)(this,void 0,void 0,(function(){var response,e_1,throttleMetadata;return Object(tslib_es6.__generator)(this,(function(_b){switch(_b.label){case 0:return[4,index_esm_setAbortableTimeout(request.signal,throttleEndTimeMillis)];case 1:_b.sent(),_b.label=2;case 2:return _b.trys.push([2,5,,7]),[4,this.client.fetch(request)];case 3:return response=_b.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return _b.sent(),[2,response];case 5:if(!function(e){if(!(e instanceof util_dist_index_esm.FirebaseError&&e.customData))return!1;var httpStatus=Number(e.customData.httpStatus);return 429===httpStatus||500===httpStatus||503===httpStatus||504===httpStatus}(e_1=_b.sent()))throw e_1;return throttleMetadata={throttleEndTimeMillis:Date.now()+Object(util_dist_index_esm.calculateBackoffMillis)(backoffCount),backoffCount:backoffCount+1},[4,this.storage.setThrottleMetadata(throttleMetadata)];case 6:return _b.sent(),[2,this.attemptFetch(request,throttleMetadata)];case 7:return[2]}}))}))},RetryingClient}();(firebaseInstance=index_esm.default).INTERNAL.registerComponent(new component_dist_index_esm.Component(\"remoteConfig\",(function(container,_a){var namespace=_a.instanceIdentifier,app=container.getProvider(\"app\").getImmediate(),installations=container.getProvider(\"installations\").getImmediate();if(\"undefined\"==typeof window)throw remote_config_dist_index_esm_ERROR_FACTORY.create(\"registration-window\");var _b=app.options,projectId=_b.projectId,apiKey=_b.apiKey,appId=_b.appId;if(!projectId)throw remote_config_dist_index_esm_ERROR_FACTORY.create(\"registration-project-id\");if(!apiKey)throw remote_config_dist_index_esm_ERROR_FACTORY.create(\"registration-api-key\");if(!appId)throw remote_config_dist_index_esm_ERROR_FACTORY.create(\"registration-app-id\");var storage=new index_esm_Storage(appId,app.name,namespace=namespace||\"firebase\"),storageCache=new index_esm_StorageCache(storage),logger=new logger_dist_index_esm.Logger(\"@firebase/remote-config\");logger.logLevel=logger_dist_index_esm.LogLevel.ERROR;var restClient=new index_esm_RestClient(installations,firebaseInstance.SDK_VERSION,namespace,projectId,apiKey,appId),retryingClient=new index_esm_RetryingClient(restClient,storage),cachingClient=new index_esm_CachingClient(retryingClient,storage,storageCache,logger),remoteConfigInstance=new index_esm_RemoteConfig(app,cachingClient,storageCache,storage,logger);return remoteConfigInstance.ensureInitialized(),remoteConfigInstance}),\"PUBLIC\").setMultipleInstances(!0)),firebaseInstance.registerVersion(\"@firebase/remote-config\",\"0.1.37\"),__webpack_require__(\"X8/r\"),index_esm.default.registerVersion(\"firebase\",\"8.6.2\",\"app\"),console.warn(\"\\nIt looks like you're using the development build of the Firebase JS SDK.\\nWhen deploying Firebase apps to production, it is advisable to only import\\nthe individual SDK components you intend to use.\\n\\nFor the module builds, these are available in the following manner\\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\\n\\nCommonJS Modules:\\nconst firebase = require('firebase/app');\\nrequire('firebase/<PACKAGE>');\\n\\nES Modules:\\nimport firebase from 'firebase/app';\\nimport 'firebase/<PACKAGE>';\\n\\nTypescript:\\nimport firebase from 'firebase/app';\\nimport 'firebase/<PACKAGE>';\\n\"),index_esm.default.registerVersion(\"firebase\",\"8.6.2\");var environment=__webpack_require__(\"AytR\"),core=__webpack_require__(\"8Y7J\"),ionic_angular=__webpack_require__(\"sZkV\");let calling_service_CallingService=(()=>{class CallingService{constructor(platform){this.platform=platform,this.config=environment.a.config,this.appname=environment.a.appname,this.platform.ready().then(()=>{0==index_esm.default.apps.length&&index_esm.default.initializeApp(this.config)})}getMetaInfo(fn){index_esm.default.database().ref(this.appname+\"/metainfo\").once(\"value\").then((function(snapshot){let data=snapshot.val();fn(data)}))}insertMetaInfo(obj){index_esm.default.database().ref(this.appname+\"/metainfo\").set(obj)}deleteData(key,fn){index_esm.default.database().ref(this.appname+\"/data/\"+key+\"/\").remove((function(err){fn(err?JSON.stringify(err):\"Sikeresen törölve!!!\")}))}getBigFish(fn){index_esm.default.database().ref(this.appname+\"/bigfish\").once(\"value\").then((function(snapshot){let data=snapshot.val();fn(data)}))}insertBigFish(weight){index_esm.default.database().ref(this.appname+\"/bigfish/\").set(weight)}saveSponser(obj){index_esm.default.database().ref(this.appname+\"/sponser/\").set(obj)}insertClickedTime(fn){var time=(new Date).toISOString().split(\"T\")[0]+\" \"+(new Date).toTimeString().split(\"GMT\")[0].trim();index_esm.default.database().ref(this.appname+\"/timestamp/\").set(time).then((function(err){fn(\"ok\")}))}insertSektorCount(count){index_esm.default.database().ref(this.appname+\"/sektors/\").set(count)}gettSektorCount(){index_esm.default.database().ref(this.appname+\"/sektors/\").once(\"value\").then(val=>{alert(val.val())})}getSponser(){return index_esm.default.database().ref(this.appname+\"/sponser/\").once(\"value\")}getClickedTime(fn){index_esm.default.database().ref(this.appname+\"/timestamp\").once(\"value\").then((function(snapshot){let data=snapshot.val();fn(data)}))}insertColName(val){index_esm.default.database().ref(this.appname+\"/colname/\").set(val)}getData(fn){index_esm.default.database().ref(this.appname+\"/data/\").once(\"value\").then((function(snapshot){let data=snapshot.val();fn(data)}))}insertData(obj,fn){index_esm.default.database().ref(this.appname+\"/data/\").set(obj,(function(err){fn(err?JSON.stringify(err):\"Sikeresen mentve!!!\")}))}}return CallingService.ɵfac=function(t){return new(t||CallingService)(core.Nb(ionic_angular.x))},CallingService.ɵprov=core.Cb({token:CallingService,factory:CallingService.ɵfac,providedIn:\"root\"}),CallingService})()},mrSG:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"__extends\",(function(){return __extends})),__webpack_require__.d(__webpack_exports__,\"__assign\",(function(){return __assign})),__webpack_require__.d(__webpack_exports__,\"__rest\",(function(){return __rest})),__webpack_require__.d(__webpack_exports__,\"__decorate\",(function(){return __decorate})),__webpack_require__.d(__webpack_exports__,\"__param\",(function(){return __param})),__webpack_require__.d(__webpack_exports__,\"__metadata\",(function(){return __metadata})),__webpack_require__.d(__webpack_exports__,\"__awaiter\",(function(){return __awaiter})),__webpack_require__.d(__webpack_exports__,\"__generator\",(function(){return __generator})),__webpack_require__.d(__webpack_exports__,\"__createBinding\",(function(){return __createBinding})),__webpack_require__.d(__webpack_exports__,\"__exportStar\",(function(){return __exportStar})),__webpack_require__.d(__webpack_exports__,\"__values\",(function(){return __values})),__webpack_require__.d(__webpack_exports__,\"__read\",(function(){return __read})),__webpack_require__.d(__webpack_exports__,\"__spread\",(function(){return __spread})),__webpack_require__.d(__webpack_exports__,\"__spreadArrays\",(function(){return __spreadArrays})),__webpack_require__.d(__webpack_exports__,\"__spreadArray\",(function(){return __spreadArray})),__webpack_require__.d(__webpack_exports__,\"__await\",(function(){return __await})),__webpack_require__.d(__webpack_exports__,\"__asyncGenerator\",(function(){return __asyncGenerator})),__webpack_require__.d(__webpack_exports__,\"__asyncDelegator\",(function(){return __asyncDelegator})),__webpack_require__.d(__webpack_exports__,\"__asyncValues\",(function(){return __asyncValues})),__webpack_require__.d(__webpack_exports__,\"__makeTemplateObject\",(function(){return __makeTemplateObject})),__webpack_require__.d(__webpack_exports__,\"__importStar\",(function(){return __importStar})),__webpack_require__.d(__webpack_exports__,\"__importDefault\",(function(){return __importDefault})),__webpack_require__.d(__webpack_exports__,\"__classPrivateFieldGet\",(function(){return __classPrivateFieldGet})),__webpack_require__.d(__webpack_exports__,\"__classPrivateFieldSet\",(function(){return __classPrivateFieldSet}));var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)};function __extends(d,b){if(\"function\"!=typeof b&&null!==b)throw new TypeError(\"Class extends value \"+String(b)+\" is not a constructor or null\");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var __assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&\"function\"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function __decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}function __param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}function __metadata(metadataKey,metadataValue){if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.metadata)return Reflect.metadata(metadataKey,metadataValue)}function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}function __generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},\"function\"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError(\"Generator is already executing.\");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!((t=(t=_.trys).length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}var __createBinding=Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]};function __exportStar(m,o){for(var p in m)\"default\"===p||Object.prototype.hasOwnProperty.call(o,p)||__createBinding(o,m,p)}function __values(o){var s=\"function\"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&\"number\"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}function __read(o,n){var m=\"function\"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar}function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar}function __spreadArrays(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}function __spreadArray(to,from){for(var i=0,il=from.length,j=to.length;i<il;i++,j++)to[j]=from[i];return to}function __await(v){return this instanceof __await?(this.v=v,this):new __await(v)}function __asyncGenerator(thisArg,_arguments,generator){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var i,g=generator.apply(thisArg,_arguments||[]),q=[];return i={},verb(\"next\"),verb(\"throw\"),verb(\"return\"),i[Symbol.asyncIterator]=function(){return this},i;function verb(n){g[n]&&(i[n]=function(v){return new Promise((function(a,b){q.push([n,v,a,b])>1||resume(n,v)}))})}function resume(n,v){try{(r=g[n](v)).value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}catch(e){settle(q[0][3],e)}var r}function fulfill(value){resume(\"next\",value)}function reject(value){resume(\"throw\",value)}function settle(f,v){f(v),q.shift(),q.length&&resume(q[0][0],q[0][1])}}function __asyncDelegator(o){var i,p;return i={},verb(\"next\"),verb(\"throw\",(function(e){throw e})),verb(\"return\"),i[Symbol.iterator]=function(){return this},i;function verb(n,f){i[n]=o[n]?function(v){return(p=!p)?{value:__await(o[n](v)),done:\"return\"===n}:f?f(v):v}:f}}function __asyncValues(o){if(!Symbol.asyncIterator)throw new TypeError(\"Symbol.asyncIterator is not defined.\");var i,m=o[Symbol.asyncIterator];return m?m.call(o):(o=__values(o),i={},verb(\"next\"),verb(\"throw\"),verb(\"return\"),i[Symbol.asyncIterator]=function(){return this},i);function verb(n){i[n]=o[n]&&function(v){return new Promise((function(resolve,reject){!function(resolve,reject,d,v){Promise.resolve(v).then((function(v){resolve({value:v,done:d})}),reject)}(resolve,reject,(v=o[n](v)).done,v.value)}))}}}function __makeTemplateObject(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,\"raw\",{value:raw}):cooked.raw=raw,cooked}var __setModuleDefault=Object.create?function(o,v){Object.defineProperty(o,\"default\",{enumerable:!0,value:v})}:function(o,v){o.default=v};function __importStar(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)\"default\"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result}function __importDefault(mod){return mod&&mod.__esModule?mod:{default:mod}}function __classPrivateFieldGet(receiver,state,kind,f){if(\"a\"===kind&&!f)throw new TypeError(\"Private accessor was defined without a getter\");if(\"function\"==typeof state?receiver!==state||!f:!state.has(receiver))throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");return\"m\"===kind?f:\"a\"===kind?f.call(receiver):f?f.value:state.get(receiver)}function __classPrivateFieldSet(receiver,state,value,kind,f){if(\"m\"===kind)throw new TypeError(\"Private method is not writable\");if(\"a\"===kind&&!f)throw new TypeError(\"Private accessor was defined without a setter\");if(\"function\"==typeof state?receiver!==state||!f:!state.has(receiver))throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");return\"a\"===kind?f.call(receiver,value):f?f.value=value:state.set(receiver,value),value}},nbvr:function(module,exports,__webpack_require__){!function(exports){\"use strict\";function toArray(arr){return Array.prototype.slice.call(arr)}function promisifyRequest(request){return new Promise((function(resolve,reject){request.onsuccess=function(){resolve(request.result)},request.onerror=function(){reject(request.error)}}))}function promisifyRequestCall(obj,method,args){var request,p=new Promise((function(resolve,reject){promisifyRequest(request=obj[method].apply(obj,args)).then(resolve,reject)}));return p.request=request,p}function promisifyCursorRequestCall(obj,method,args){var p=promisifyRequestCall(obj,method,args);return p.then((function(value){if(value)return new Cursor(value,p.request)}))}function proxyProperties(ProxyClass,targetProp,properties){properties.forEach((function(prop){Object.defineProperty(ProxyClass.prototype,prop,{get:function(){return this[targetProp][prop]},set:function(val){this[targetProp][prop]=val}})}))}function proxyRequestMethods(ProxyClass,targetProp,Constructor,properties){properties.forEach((function(prop){prop in Constructor.prototype&&(ProxyClass.prototype[prop]=function(){return promisifyRequestCall(this[targetProp],prop,arguments)})}))}function proxyMethods(ProxyClass,targetProp,Constructor,properties){properties.forEach((function(prop){prop in Constructor.prototype&&(ProxyClass.prototype[prop]=function(){return this[targetProp][prop].apply(this[targetProp],arguments)})}))}function proxyCursorRequestMethods(ProxyClass,targetProp,Constructor,properties){properties.forEach((function(prop){prop in Constructor.prototype&&(ProxyClass.prototype[prop]=function(){return promisifyCursorRequestCall(this[targetProp],prop,arguments)})}))}function Index(index){this._index=index}function Cursor(cursor,request){this._cursor=cursor,this._request=request}function ObjectStore(store){this._store=store}function Transaction(idbTransaction){this._tx=idbTransaction,this.complete=new Promise((function(resolve,reject){idbTransaction.oncomplete=function(){resolve()},idbTransaction.onerror=function(){reject(idbTransaction.error)},idbTransaction.onabort=function(){reject(idbTransaction.error)}}))}function UpgradeDB(db,oldVersion,transaction){this._db=db,this.oldVersion=oldVersion,this.transaction=new Transaction(transaction)}function DB(db){this._db=db}proxyProperties(Index,\"_index\",[\"name\",\"keyPath\",\"multiEntry\",\"unique\"]),proxyRequestMethods(Index,\"_index\",IDBIndex,[\"get\",\"getKey\",\"getAll\",\"getAllKeys\",\"count\"]),proxyCursorRequestMethods(Index,\"_index\",IDBIndex,[\"openCursor\",\"openKeyCursor\"]),proxyProperties(Cursor,\"_cursor\",[\"direction\",\"key\",\"primaryKey\",\"value\"]),proxyRequestMethods(Cursor,\"_cursor\",IDBCursor,[\"update\",\"delete\"]),[\"advance\",\"continue\",\"continuePrimaryKey\"].forEach((function(methodName){methodName in IDBCursor.prototype&&(Cursor.prototype[methodName]=function(){var cursor=this,args=arguments;return Promise.resolve().then((function(){return cursor._cursor[methodName].apply(cursor._cursor,args),promisifyRequest(cursor._request).then((function(value){if(value)return new Cursor(value,cursor._request)}))}))})})),ObjectStore.prototype.createIndex=function(){return new Index(this._store.createIndex.apply(this._store,arguments))},ObjectStore.prototype.index=function(){return new Index(this._store.index.apply(this._store,arguments))},proxyProperties(ObjectStore,\"_store\",[\"name\",\"keyPath\",\"indexNames\",\"autoIncrement\"]),proxyRequestMethods(ObjectStore,\"_store\",IDBObjectStore,[\"put\",\"add\",\"delete\",\"clear\",\"get\",\"getAll\",\"getKey\",\"getAllKeys\",\"count\"]),proxyCursorRequestMethods(ObjectStore,\"_store\",IDBObjectStore,[\"openCursor\",\"openKeyCursor\"]),proxyMethods(ObjectStore,\"_store\",IDBObjectStore,[\"deleteIndex\"]),Transaction.prototype.objectStore=function(){return new ObjectStore(this._tx.objectStore.apply(this._tx,arguments))},proxyProperties(Transaction,\"_tx\",[\"objectStoreNames\",\"mode\"]),proxyMethods(Transaction,\"_tx\",IDBTransaction,[\"abort\"]),UpgradeDB.prototype.createObjectStore=function(){return new ObjectStore(this._db.createObjectStore.apply(this._db,arguments))},proxyProperties(UpgradeDB,\"_db\",[\"name\",\"version\",\"objectStoreNames\"]),proxyMethods(UpgradeDB,\"_db\",IDBDatabase,[\"deleteObjectStore\",\"close\"]),DB.prototype.transaction=function(){return new Transaction(this._db.transaction.apply(this._db,arguments))},proxyProperties(DB,\"_db\",[\"name\",\"version\",\"objectStoreNames\"]),proxyMethods(DB,\"_db\",IDBDatabase,[\"close\"]),[\"openCursor\",\"openKeyCursor\"].forEach((function(funcName){[ObjectStore,Index].forEach((function(Constructor){funcName in Constructor.prototype&&(Constructor.prototype[funcName.replace(\"open\",\"iterate\")]=function(){var args=toArray(arguments),callback=args[args.length-1],nativeObject=this._store||this._index,request=nativeObject[funcName].apply(nativeObject,args.slice(0,-1));request.onsuccess=function(){callback(request.result)}})}))})),[Index,ObjectStore].forEach((function(Constructor){Constructor.prototype.getAll||(Constructor.prototype.getAll=function(query,count){var instance=this,items=[];return new Promise((function(resolve){instance.iterateCursor(query,(function(cursor){cursor?(items.push(cursor.value),void 0===count||items.length!=count?cursor.continue():resolve(items)):resolve(items)}))}))})})),exports.openDb=function(name,version,upgradeCallback){var p=promisifyRequestCall(indexedDB,\"open\",[name,version]),request=p.request;return request&&(request.onupgradeneeded=function(event){upgradeCallback&&upgradeCallback(new UpgradeDB(request.result,event.oldVersion,request.transaction))}),p.then((function(db){return new DB(db)}))},exports.deleteDb=function(name){return promisifyRequestCall(indexedDB,\"deleteDatabase\",[name])},Object.defineProperty(exports,\"__esModule\",{value:!0})}(exports)},\"q/0M\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";function __spreadArrays(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}var _a;__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"LogLevel\",(function(){return LogLevel})),__webpack_require__.d(__webpack_exports__,\"Logger\",(function(){return Logger})),__webpack_require__.d(__webpack_exports__,\"setLogLevel\",(function(){return setLogLevel})),__webpack_require__.d(__webpack_exports__,\"setUserLogHandler\",(function(){return setUserLogHandler}));var instances=[],LogLevel=function(LogLevel){return LogLevel[LogLevel.DEBUG=0]=\"DEBUG\",LogLevel[LogLevel.VERBOSE=1]=\"VERBOSE\",LogLevel[LogLevel.INFO=2]=\"INFO\",LogLevel[LogLevel.WARN=3]=\"WARN\",LogLevel[LogLevel.ERROR=4]=\"ERROR\",LogLevel[LogLevel.SILENT=5]=\"SILENT\",LogLevel}({}),levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod=((_a={})[LogLevel.DEBUG]=\"log\",_a[LogLevel.VERBOSE]=\"log\",_a[LogLevel.INFO]=\"info\",_a[LogLevel.WARN]=\"warn\",_a[LogLevel.ERROR]=\"error\",_a),defaultLogHandler=function(instance,logType){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];if(!(logType<instance.logLevel)){var now=(new Date).toISOString(),method=ConsoleMethod[logType];if(!method)throw new Error(\"Attempted to log a message with an invalid logType (value: \"+logType+\")\");console[method].apply(console,__spreadArrays([\"[\"+now+\"]  \"+instance.name+\":\"],args))}},Logger=function(){function Logger(name){this.name=name,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null,instances.push(this)}return Object.defineProperty(Logger.prototype,\"logLevel\",{get:function(){return this._logLevel},set:function(val){if(!(val in LogLevel))throw new TypeError('Invalid value \"'+val+'\" assigned to `logLevel`');this._logLevel=val},enumerable:!1,configurable:!0}),Logger.prototype.setLogLevel=function(val){this._logLevel=\"string\"==typeof val?levelStringToEnum[val]:val},Object.defineProperty(Logger.prototype,\"logHandler\",{get:function(){return this._logHandler},set:function(val){if(\"function\"!=typeof val)throw new TypeError(\"Value assigned to `logHandler` must be a function\");this._logHandler=val},enumerable:!1,configurable:!0}),Object.defineProperty(Logger.prototype,\"userLogHandler\",{get:function(){return this._userLogHandler},set:function(val){this._userLogHandler=val},enumerable:!1,configurable:!0}),Logger.prototype.debug=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.DEBUG],args)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.DEBUG],args))},Logger.prototype.log=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.VERBOSE],args)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.VERBOSE],args))},Logger.prototype.info=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.INFO],args)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.INFO],args))},Logger.prototype.warn=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.WARN],args)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.WARN],args))},Logger.prototype.error=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.ERROR],args)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.ERROR],args))},Logger}();function setLogLevel(level){instances.forEach((function(inst){inst.setLogLevel(level)}))}function setUserLogHandler(logCallback,options){for(var _loop_1=function(instance){var customLogLevel=null;options&&options.level&&(customLogLevel=levelStringToEnum[options.level]),instance.userLogHandler=null===logCallback?null:function(instance,level){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];var message=args.map((function(arg){if(null==arg)return null;if(\"string\"==typeof arg)return arg;if(\"number\"==typeof arg||\"boolean\"==typeof arg)return arg.toString();if(arg instanceof Error)return arg.message;try{return JSON.stringify(arg)}catch(ignored){return null}})).filter((function(arg){return arg})).join(\" \");level>=(null!=customLogLevel?customLogLevel:instance.logLevel)&&logCallback({level:LogLevel[level].toLowerCase(),message:message,args:args,type:instance.name})}},_i=0,instances_1=instances;_i<instances_1.length;_i++)_loop_1(instances_1[_i])}},qOnz:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"CONSTANTS\",(function(){return CONSTANTS})),__webpack_require__.d(__webpack_exports__,\"Deferred\",(function(){return Deferred})),__webpack_require__.d(__webpack_exports__,\"ErrorFactory\",(function(){return ErrorFactory})),__webpack_require__.d(__webpack_exports__,\"FirebaseError\",(function(){return FirebaseError})),__webpack_require__.d(__webpack_exports__,\"MAX_VALUE_MILLIS\",(function(){return MAX_VALUE_MILLIS})),__webpack_require__.d(__webpack_exports__,\"RANDOM_FACTOR\",(function(){return RANDOM_FACTOR})),__webpack_require__.d(__webpack_exports__,\"Sha1\",(function(){return Sha1})),__webpack_require__.d(__webpack_exports__,\"areCookiesEnabled\",(function(){return areCookiesEnabled})),__webpack_require__.d(__webpack_exports__,\"assert\",(function(){return assert})),__webpack_require__.d(__webpack_exports__,\"assertionError\",(function(){return assertionError})),__webpack_require__.d(__webpack_exports__,\"async\",(function(){return async})),__webpack_require__.d(__webpack_exports__,\"base64\",(function(){return base64})),__webpack_require__.d(__webpack_exports__,\"base64Decode\",(function(){return base64Decode})),__webpack_require__.d(__webpack_exports__,\"base64Encode\",(function(){return base64Encode})),__webpack_require__.d(__webpack_exports__,\"calculateBackoffMillis\",(function(){return calculateBackoffMillis})),__webpack_require__.d(__webpack_exports__,\"contains\",(function(){return contains})),__webpack_require__.d(__webpack_exports__,\"createMockUserToken\",(function(){return createMockUserToken})),__webpack_require__.d(__webpack_exports__,\"createSubscribe\",(function(){return createSubscribe})),__webpack_require__.d(__webpack_exports__,\"decode\",(function(){return decode})),__webpack_require__.d(__webpack_exports__,\"deepCopy\",(function(){return deepCopy})),__webpack_require__.d(__webpack_exports__,\"deepExtend\",(function(){return deepExtend})),__webpack_require__.d(__webpack_exports__,\"errorPrefix\",(function(){return errorPrefix})),__webpack_require__.d(__webpack_exports__,\"extractQuerystring\",(function(){return extractQuerystring})),__webpack_require__.d(__webpack_exports__,\"getGlobal\",(function(){return getGlobal})),__webpack_require__.d(__webpack_exports__,\"getModularInstance\",(function(){return getModularInstance})),__webpack_require__.d(__webpack_exports__,\"getUA\",(function(){return getUA})),__webpack_require__.d(__webpack_exports__,\"isAdmin\",(function(){return isAdmin})),__webpack_require__.d(__webpack_exports__,\"isBrowser\",(function(){return isBrowser})),__webpack_require__.d(__webpack_exports__,\"isBrowserExtension\",(function(){return isBrowserExtension})),__webpack_require__.d(__webpack_exports__,\"isElectron\",(function(){return isElectron})),__webpack_require__.d(__webpack_exports__,\"isEmpty\",(function(){return isEmpty})),__webpack_require__.d(__webpack_exports__,\"isIE\",(function(){return isIE})),__webpack_require__.d(__webpack_exports__,\"isIndexedDBAvailable\",(function(){return isIndexedDBAvailable})),__webpack_require__.d(__webpack_exports__,\"isMobileCordova\",(function(){return isMobileCordova})),__webpack_require__.d(__webpack_exports__,\"isNode\",(function(){return isNode})),__webpack_require__.d(__webpack_exports__,\"isNodeSdk\",(function(){return isNodeSdk})),__webpack_require__.d(__webpack_exports__,\"isReactNative\",(function(){return isReactNative})),__webpack_require__.d(__webpack_exports__,\"isSafari\",(function(){return isSafari})),__webpack_require__.d(__webpack_exports__,\"isUWP\",(function(){return isUWP})),__webpack_require__.d(__webpack_exports__,\"isValidFormat\",(function(){return isValidFormat})),__webpack_require__.d(__webpack_exports__,\"isValidTimestamp\",(function(){return isValidTimestamp})),__webpack_require__.d(__webpack_exports__,\"issuedAtTime\",(function(){return issuedAtTime})),__webpack_require__.d(__webpack_exports__,\"jsonEval\",(function(){return jsonEval})),__webpack_require__.d(__webpack_exports__,\"map\",(function(){return map})),__webpack_require__.d(__webpack_exports__,\"ordinal\",(function(){return ordinal})),__webpack_require__.d(__webpack_exports__,\"querystring\",(function(){return querystring})),__webpack_require__.d(__webpack_exports__,\"querystringDecode\",(function(){return querystringDecode})),__webpack_require__.d(__webpack_exports__,\"safeGet\",(function(){return safeGet})),__webpack_require__.d(__webpack_exports__,\"stringLength\",(function(){return stringLength})),__webpack_require__.d(__webpack_exports__,\"stringToByteArray\",(function(){return stringToByteArray$1})),__webpack_require__.d(__webpack_exports__,\"stringify\",(function(){return stringify})),__webpack_require__.d(__webpack_exports__,\"validateArgCount\",(function(){return validateArgCount})),__webpack_require__.d(__webpack_exports__,\"validateCallback\",(function(){return validateCallback})),__webpack_require__.d(__webpack_exports__,\"validateContextObject\",(function(){return validateContextObject})),__webpack_require__.d(__webpack_exports__,\"validateIndexedDBOpenable\",(function(){return validateIndexedDBOpenable})),__webpack_require__.d(__webpack_exports__,\"validateNamespace\",(function(){return validateNamespace}));var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(\"mrSG\"),CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:\"${JSCORE_VERSION}\"},assert=function(assertion,message){if(!assertion)throw assertionError(message)},assertionError=function(message){return new Error(\"Firebase Database (\"+CONSTANTS.SDK_VERSION+\") INTERNAL ASSERT FAILED: \"+message)},stringToByteArray=function(str){for(var out=[],p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);c<128?out[p++]=c:c<2048?(out[p++]=c>>6|192,out[p++]=63&c|128):55296==(64512&c)&&i+1<str.length&&56320==(64512&str.charCodeAt(i+1))?(c=65536+((1023&c)<<10)+(1023&str.charCodeAt(++i)),out[p++]=c>>18|240,out[p++]=c>>12&63|128,out[p++]=c>>6&63|128,out[p++]=63&c|128):(out[p++]=c>>12|224,out[p++]=c>>6&63|128,out[p++]=63&c|128)}return out},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+\"+/=\"},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+\"-_.\"},HAS_NATIVE_SUPPORT:\"function\"==typeof atob,encodeByteArray:function(input,webSafe){if(!Array.isArray(input))throw Error(\"encodeByteArray takes an array as a parameter\");this.init_();for(var byteToCharMap=webSafe?this.byteToCharMapWebSafe_:this.byteToCharMap_,output=[],i=0;i<input.length;i+=3){var byte1=input[i],haveByte2=i+1<input.length,byte2=haveByte2?input[i+1]:0,haveByte3=i+2<input.length,byte3=haveByte3?input[i+2]:0,outByte3=(15&byte2)<<2|byte3>>6,outByte4=63&byte3;haveByte3||(outByte4=64,haveByte2||(outByte3=64)),output.push(byteToCharMap[byte1>>2],byteToCharMap[(3&byte1)<<4|byte2>>4],byteToCharMap[outByte3],byteToCharMap[outByte4])}return output.join(\"\")},encodeString:function(input,webSafe){return this.HAS_NATIVE_SUPPORT&&!webSafe?btoa(input):this.encodeByteArray(stringToByteArray(input),webSafe)},decodeString:function(input,webSafe){return this.HAS_NATIVE_SUPPORT&&!webSafe?atob(input):function(bytes){for(var out=[],pos=0,c=0;pos<bytes.length;){var c1=bytes[pos++];if(c1<128)out[c++]=String.fromCharCode(c1);else if(c1>191&&c1<224){var c2=bytes[pos++];out[c++]=String.fromCharCode((31&c1)<<6|63&c2)}else if(c1>239&&c1<365){var u=((7&c1)<<18|(63&(c2=bytes[pos++]))<<12|(63&(c3=bytes[pos++]))<<6|63&bytes[pos++])-65536;out[c++]=String.fromCharCode(55296+(u>>10)),out[c++]=String.fromCharCode(56320+(1023&u))}else{c2=bytes[pos++];var c3=bytes[pos++];out[c++]=String.fromCharCode((15&c1)<<12|(63&c2)<<6|63&c3)}}return out.join(\"\")}(this.decodeStringToByteArray(input,webSafe))},decodeStringToByteArray:function(input,webSafe){this.init_();for(var charToByteMap=webSafe?this.charToByteMapWebSafe_:this.charToByteMap_,output=[],i=0;i<input.length;){var byte1=charToByteMap[input.charAt(i++)],byte2=i<input.length?charToByteMap[input.charAt(i)]:0,byte3=++i<input.length?charToByteMap[input.charAt(i)]:64,byte4=++i<input.length?charToByteMap[input.charAt(i)]:64;if(++i,null==byte1||null==byte2||null==byte3||null==byte4)throw Error();output.push(byte1<<2|byte2>>4),64!==byte3&&(output.push(byte2<<4&240|byte3>>2),64!==byte4&&output.push(byte3<<6&192|byte4))}return output},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}},base64Encode=function(str){var utf8Bytes=stringToByteArray(str);return base64.encodeByteArray(utf8Bytes,!0)},base64Decode=function(str){try{return base64.decodeString(str,!0)}catch(e){console.error(\"base64Decode failed: \",e)}return null};function deepCopy(value){return deepExtend(void 0,value)}function deepExtend(target,source){if(!(source instanceof Object))return source;switch(source.constructor){case Date:return new Date(source.getTime());case Object:void 0===target&&(target={});break;case Array:target=[];break;default:return source}for(var prop in source)source.hasOwnProperty(prop)&&\"__proto__\"!==prop&&(target[prop]=deepExtend(target[prop],source[prop]));return target}var Deferred=function(){function Deferred(){var _this=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(resolve,reject){_this.resolve=resolve,_this.reject=reject}))}return Deferred.prototype.wrapCallback=function(callback){var _this=this;return function(error,value){error?_this.reject(error):_this.resolve(value),\"function\"==typeof callback&&(_this.promise.catch((function(){})),1===callback.length?callback(error):callback(error,value))}},Deferred}();function createMockUserToken(token,projectId){if(token.uid)throw new Error('The \"uid\" field is no longer supported by mockUserToken. Please use \"sub\" instead for Firebase Auth User ID.');var project=projectId||\"demo-project\",iat=token.iat||0,sub=token.sub||token.user_id;if(!sub)throw new Error(\"mockUserToken must contain 'sub' or 'user_id' field!\");var payload=Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({iss:\"https://securetoken.google.com/\"+project,aud:project,iat:iat,exp:iat+3600,auth_time:iat,sub:sub,user_id:sub,firebase:{sign_in_provider:\"custom\",identities:{}}},token);return[base64.encodeString(JSON.stringify({alg:\"none\",type:\"JWT\"}),!1),base64.encodeString(JSON.stringify(payload),!1),\"\"].join(\".\")}function getUA(){return\"undefined\"!=typeof navigator&&\"string\"==typeof navigator.userAgent?navigator.userAgent:\"\"}function isMobileCordova(){return\"undefined\"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isNode(){try{return\"[object process]\"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function isBrowser(){return\"object\"==typeof self&&self.self===self}function isBrowserExtension(){var runtime=\"object\"==typeof chrome?chrome.runtime:\"object\"==typeof browser?browser.runtime:void 0;return\"object\"==typeof runtime&&void 0!==runtime.id}function isReactNative(){return\"object\"==typeof navigator&&\"ReactNative\"===navigator.product}function isElectron(){return getUA().indexOf(\"Electron/\")>=0}function isIE(){var ua=getUA();return ua.indexOf(\"MSIE \")>=0||ua.indexOf(\"Trident/\")>=0}function isUWP(){return getUA().indexOf(\"MSAppHost/\")>=0}function isNodeSdk(){return!0===CONSTANTS.NODE_CLIENT||!0===CONSTANTS.NODE_ADMIN}function isSafari(){return!isNode()&&navigator.userAgent.includes(\"Safari\")&&!navigator.userAgent.includes(\"Chrome\")}function isIndexedDBAvailable(){return\"indexedDB\"in self&&null!=indexedDB}function validateIndexedDBOpenable(){return new Promise((function(resolve,reject){try{var preExist_1=!0,DB_CHECK_NAME_1=\"validate-browser-context-for-indexeddb-analytics-module\",request_1=self.indexedDB.open(DB_CHECK_NAME_1);request_1.onsuccess=function(){request_1.result.close(),preExist_1||self.indexedDB.deleteDatabase(DB_CHECK_NAME_1),resolve(!0)},request_1.onupgradeneeded=function(){preExist_1=!1},request_1.onerror=function(){var _a;reject((null===(_a=request_1.error)||void 0===_a?void 0:_a.message)||\"\")}}catch(error){reject(error)}}))}function areCookiesEnabled(){return!(!navigator||!navigator.cookieEnabled)}function getGlobal(){if(\"undefined\"!=typeof self)return self;if(\"undefined\"!=typeof window)return window;if(\"undefined\"!=typeof global)return global;throw new Error(\"Unable to locate global object.\")}var FirebaseError=function(_super){function FirebaseError(code,message,customData){var _this=_super.call(this,message)||this;return _this.code=code,_this.customData=customData,_this.name=\"FirebaseError\",Object.setPrototypeOf(_this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(_this,ErrorFactory.prototype.create),_this}return Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(FirebaseError,_super),FirebaseError}(Error),ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service,this.serviceName=serviceName,this.errors=errors}return ErrorFactory.prototype.create=function(code){for(var data=[],_i=1;_i<arguments.length;_i++)data[_i-1]=arguments[_i];var customData=data[0]||{},fullCode=this.service+\"/\"+code,template=this.errors[code],message=template?replaceTemplate(template,customData):\"Error\",fullMessage=this.serviceName+\": \"+message+\" (\"+fullCode+\").\",error=new FirebaseError(fullCode,fullMessage,customData);return error},ErrorFactory}();function replaceTemplate(template,data){return template.replace(PATTERN,(function(_,key){var value=data[key];return null!=value?String(value):\"<\"+key+\"?>\"}))}var PATTERN=/\\{\\$([^}]+)}/g;function jsonEval(str){return JSON.parse(str)}function stringify(data){return JSON.stringify(data)}var decode=function(token){var header={},claims={},data={},signature=\"\";try{var parts=token.split(\".\");header=jsonEval(base64Decode(parts[0])||\"\"),claims=jsonEval(base64Decode(parts[1])||\"\"),signature=parts[2],data=claims.d||{},delete claims.d}catch(e){}return{header:header,claims:claims,data:data,signature:signature}},isValidTimestamp=function(token){var claims=decode(token).claims,now=Math.floor((new Date).getTime()/1e3),validSince=0,validUntil=0;return\"object\"==typeof claims&&(claims.hasOwnProperty(\"nbf\")?validSince=claims.nbf:claims.hasOwnProperty(\"iat\")&&(validSince=claims.iat),validUntil=claims.hasOwnProperty(\"exp\")?claims.exp:validSince+86400),!!now&&!!validSince&&!!validUntil&&now>=validSince&&now<=validUntil},issuedAtTime=function(token){var claims=decode(token).claims;return\"object\"==typeof claims&&claims.hasOwnProperty(\"iat\")?claims.iat:null},isValidFormat=function(token){var claims=decode(token).claims;return!!claims&&\"object\"==typeof claims&&claims.hasOwnProperty(\"iat\")},isAdmin=function(token){var claims=decode(token).claims;return\"object\"==typeof claims&&!0===claims.admin};function contains(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}function safeGet(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)?obj[key]:void 0}function isEmpty(obj){for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key))return!1;return!0}function map(obj,fn,contextObj){var res={};for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(res[key]=fn.call(contextObj,obj[key],key,obj));return res}function querystring(querystringParams){for(var params=[],_loop_1=function(key,value){Array.isArray(value)?value.forEach((function(arrayVal){params.push(encodeURIComponent(key)+\"=\"+encodeURIComponent(arrayVal))})):params.push(encodeURIComponent(key)+\"=\"+encodeURIComponent(value))},_i=0,_a=Object.entries(querystringParams);_i<_a.length;_i++){var _b=_a[_i];_loop_1(_b[0],_b[1])}return params.length?\"&\"+params.join(\"&\"):\"\"}function querystringDecode(querystring){var obj={};return querystring.replace(/^\\?/,\"\").split(\"&\").forEach((function(token){if(token){var _a=token.split(\"=\"),value=_a[1];obj[decodeURIComponent(_a[0])]=decodeURIComponent(value)}})),obj}function extractQuerystring(url){var queryStart=url.indexOf(\"?\");if(!queryStart)return\"\";var fragmentStart=url.indexOf(\"#\",queryStart);return url.substring(queryStart,fragmentStart>0?fragmentStart:void 0)}var Sha1=function(){function Sha1(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var i=1;i<this.blockSize;++i)this.pad_[i]=0;this.reset()}return Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.compress_=function(buf,offset){offset||(offset=0);var W=this.W_;if(\"string\"==typeof buf)for(var i=0;i<16;i++)W[i]=buf.charCodeAt(offset)<<24|buf.charCodeAt(offset+1)<<16|buf.charCodeAt(offset+2)<<8|buf.charCodeAt(offset+3),offset+=4;else for(i=0;i<16;i++)W[i]=buf[offset]<<24|buf[offset+1]<<16|buf[offset+2]<<8|buf[offset+3],offset+=4;for(i=16;i<80;i++)W[i]=4294967295&((t=W[i-3]^W[i-8]^W[i-14]^W[i-16])<<1|t>>>31);var f,k,a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4];for(i=0;i<80;i++){i<40?i<20?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):i<60?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=(a<<5|a>>>27)+f+e+k+W[i]&4294967295;e=d,d=c,c=4294967295&(b<<30|b>>>2),b=a,a=t}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+b&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+d&4294967295,this.chain_[4]=this.chain_[4]+e&4294967295},Sha1.prototype.update=function(bytes,length){if(null!=bytes){void 0===length&&(length=bytes.length);for(var lengthMinusBlock=length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;n<length;){if(0===inbuf)for(;n<=lengthMinusBlock;)this.compress_(bytes,n),n+=this.blockSize;if(\"string\"==typeof bytes){for(;n<length;)if(buf[inbuf]=bytes.charCodeAt(n),++n,++inbuf===this.blockSize){this.compress_(buf),inbuf=0;break}}else for(;n<length;)if(buf[inbuf]=bytes[n],++n,++inbuf===this.blockSize){this.compress_(buf),inbuf=0;break}}this.inbuf_=inbuf,this.total_+=length}},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&totalBits,totalBits/=256;this.compress_(this.buf_);var n=0;for(i=0;i<5;i++)for(var j=24;j>=0;j-=8)digest[n]=this.chain_[i]>>j&255,++n;return digest},Sha1}();function createSubscribe(executor,onNoObservers){var proxy=new ObserverProxy(executor,onNoObservers);return proxy.subscribe.bind(proxy)}var ObserverProxy=function(){function ObserverProxy(executor,onNoObservers){var _this=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=onNoObservers,this.task.then((function(){executor(_this)})).catch((function(e){_this.error(e)}))}return ObserverProxy.prototype.next=function(value){this.forEachObserver((function(observer){observer.next(value)}))},ObserverProxy.prototype.error=function(error){this.forEachObserver((function(observer){observer.error(error)})),this.close(error)},ObserverProxy.prototype.complete=function(){this.forEachObserver((function(observer){observer.complete()})),this.close()},ObserverProxy.prototype.subscribe=function(nextOrObserver,error,complete){var observer,_this=this;if(void 0===nextOrObserver&&void 0===error&&void 0===complete)throw new Error(\"Missing Observer.\");void 0===(observer=function(obj,methods){if(\"object\"!=typeof obj||null===obj)return!1;for(var _i=0,methods_1=[\"next\",\"error\",\"complete\"];_i<methods_1.length;_i++){var method=methods_1[_i];if(method in obj&&\"function\"==typeof obj[method])return!0}return!1}(nextOrObserver)?nextOrObserver:{next:nextOrObserver,error:error,complete:complete}).next&&(observer.next=noop),void 0===observer.error&&(observer.error=noop),void 0===observer.complete&&(observer.complete=noop);var unsub=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{_this.finalError?observer.error(_this.finalError):observer.complete()}catch(e){}})),this.observers.push(observer),unsub},ObserverProxy.prototype.unsubscribeOne=function(i){void 0!==this.observers&&void 0!==this.observers[i]&&(delete this.observers[i],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},ObserverProxy.prototype.forEachObserver=function(fn){if(!this.finalized)for(var i=0;i<this.observers.length;i++)this.sendOne(i,fn)},ObserverProxy.prototype.sendOne=function(i,fn){var _this=this;this.task.then((function(){if(void 0!==_this.observers&&void 0!==_this.observers[i])try{fn(_this.observers[i])}catch(e){\"undefined\"!=typeof console&&console.error&&console.error(e)}}))},ObserverProxy.prototype.close=function(err){var _this=this;this.finalized||(this.finalized=!0,void 0!==err&&(this.finalError=err),this.task.then((function(){_this.observers=void 0,_this.onNoObservers=void 0})))},ObserverProxy}();function async(fn,onError){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];Promise.resolve(!0).then((function(){fn.apply(void 0,args)})).catch((function(error){onError&&onError(error)}))}}function noop(){}var validateArgCount=function(fnName,minCount,maxCount,argCount){var argError;if(argCount<minCount?argError=\"at least \"+minCount:argCount>maxCount&&(argError=0===maxCount?\"none\":\"no more than \"+maxCount),argError)throw new Error(fnName+\" failed: Was called with \"+argCount+(1===argCount?\" argument.\":\" arguments.\")+\" Expects \"+argError+\".\")};function errorPrefix(fnName,argName){return fnName+\" failed: \"+argName+\" argument \"}function validateNamespace(fnName,namespace,optional){if((!optional||namespace)&&\"string\"!=typeof namespace)throw new Error(errorPrefix(fnName,\"namespace\")+\"must be a valid firebase namespace.\")}function validateCallback(fnName,argumentName,callback,optional){if((!optional||callback)&&\"function\"!=typeof callback)throw new Error(errorPrefix(fnName,argumentName)+\"must be a valid function.\")}function validateContextObject(fnName,argumentName,context,optional){if((!optional||context)&&(\"object\"!=typeof context||null===context))throw new Error(errorPrefix(fnName,argumentName)+\"must be a valid context object.\")}var stringToByteArray$1=function(str){for(var out=[],p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c>=55296&&c<=56319){var high=c-55296;i++,assert(i<str.length,\"Surrogate pair missing trail surrogate.\"),c=65536+(high<<10)+(str.charCodeAt(i)-56320)}c<128?out[p++]=c:c<2048?(out[p++]=c>>6|192,out[p++]=63&c|128):c<65536?(out[p++]=c>>12|224,out[p++]=c>>6&63|128,out[p++]=63&c|128):(out[p++]=c>>18|240,out[p++]=c>>12&63|128,out[p++]=c>>6&63|128,out[p++]=63&c|128)}return out},stringLength=function(str){for(var p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);c<128?p++:c<2048?p+=2:c>=55296&&c<=56319?(p+=4,i++):p+=3}return p},MAX_VALUE_MILLIS=144e5,RANDOM_FACTOR=.5;function calculateBackoffMillis(backoffCount,intervalMillis,backoffFactor){void 0===intervalMillis&&(intervalMillis=1e3),void 0===backoffFactor&&(backoffFactor=2);var currBaseValue=intervalMillis*Math.pow(backoffFactor,backoffCount),randomWait=Math.round(RANDOM_FACTOR*currBaseValue*(Math.random()-.5)*2);return Math.min(MAX_VALUE_MILLIS,currBaseValue+randomWait)}function ordinal(i){return Number.isFinite(i)?i+function(i){var cent=(i=Math.abs(i))%100;if(cent>=10&&cent<=20)return\"th\";var dec=i%10;return 1===dec?\"st\":2===dec?\"nd\":3===dec?\"rd\":\"th\"}(i):\"\"+i}function getModularInstance(service){return service&&service._delegate?service._delegate:service}},zIRd:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"firebase\",(function(){return firebase$1}));var _a,_a$1,tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(\"mrSG\"),_firebase_util__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(\"qOnz\"),_firebase_component__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(\"/6Yf\"),_firebase_logger__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(\"q/0M\"),ERRORS=((_a={})[\"no-app\"]=\"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()\",_a[\"bad-app-name\"]=\"Illegal App name: '{$appName}\",_a[\"duplicate-app\"]=\"Firebase App named '{$appName}' already exists\",_a[\"app-deleted\"]=\"Firebase App named '{$appName}' already deleted\",_a[\"invalid-app-argument\"]=\"firebase.{$appName}() takes either no argument or a Firebase App instance.\",_a[\"invalid-log-argument\"]=\"First argument to `onLog` must be null or a function.\",_a),ERROR_FACTORY=new _firebase_util__WEBPACK_IMPORTED_MODULE_1__.ErrorFactory(\"app\",\"Firebase\",ERRORS),name=\"@firebase/app\",PLATFORM_LOG_STRING=((_a$1={})[name]=\"fire-core\",_a$1[\"@firebase/analytics\"]=\"fire-analytics\",_a$1[\"@firebase/app-check\"]=\"fire-app-check\",_a$1[\"@firebase/auth\"]=\"fire-auth\",_a$1[\"@firebase/database\"]=\"fire-rtdb\",_a$1[\"@firebase/functions\"]=\"fire-fn\",_a$1[\"@firebase/installations\"]=\"fire-iid\",_a$1[\"@firebase/messaging\"]=\"fire-fcm\",_a$1[\"@firebase/performance\"]=\"fire-perf\",_a$1[\"@firebase/remote-config\"]=\"fire-rc\",_a$1[\"@firebase/storage\"]=\"fire-gcs\",_a$1[\"@firebase/firestore\"]=\"fire-fst\",_a$1[\"fire-js\"]=\"fire-js\",_a$1[\"firebase-wrapper\"]=\"fire-js-all\",_a$1),logger=new _firebase_logger__WEBPACK_IMPORTED_MODULE_3__.Logger(\"@firebase/app\"),FirebaseAppImpl=function(){function FirebaseAppImpl(options,config,firebase_){var _this=this;this.firebase_=firebase_,this.isDeleted_=!1,this.name_=config.name,this.automaticDataCollectionEnabled_=config.automaticDataCollectionEnabled||!1,this.options_=Object(_firebase_util__WEBPACK_IMPORTED_MODULE_1__.deepCopy)(options),this.container=new _firebase_component__WEBPACK_IMPORTED_MODULE_2__.ComponentContainer(config.name),this._addComponent(new _firebase_component__WEBPACK_IMPORTED_MODULE_2__.Component(\"app\",(function(){return _this}),\"PUBLIC\")),this.firebase_.INTERNAL.components.forEach((function(component){return _this._addComponent(component)}))}return Object.defineProperty(FirebaseAppImpl.prototype,\"automaticDataCollectionEnabled\",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(val){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=val},enumerable:!1,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,\"name\",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,\"options\",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),FirebaseAppImpl.prototype.delete=function(){var _this=this;return new Promise((function(resolve){_this.checkDestroyed_(),resolve()})).then((function(){return _this.firebase_.INTERNAL.removeApp(_this.name_),Promise.all(_this.container.getProviders().map((function(provider){return provider.delete()})))})).then((function(){_this.isDeleted_=!0}))},FirebaseAppImpl.prototype._getService=function(name,instanceIdentifier){var _a;void 0===instanceIdentifier&&(instanceIdentifier=\"[DEFAULT]\"),this.checkDestroyed_();var provider=this.container.getProvider(name);return provider.isInitialized()||\"EXPLICIT\"!==(null===(_a=provider.getComponent())||void 0===_a?void 0:_a.instantiationMode)||provider.initialize(),provider.getImmediate({identifier:instanceIdentifier})},FirebaseAppImpl.prototype._removeServiceInstance=function(name,instanceIdentifier){void 0===instanceIdentifier&&(instanceIdentifier=\"[DEFAULT]\"),this.container.getProvider(name).clearInstance(instanceIdentifier)},FirebaseAppImpl.prototype._addComponent=function(component){try{this.container.addComponent(component)}catch(e){logger.debug(\"Component \"+component.name+\" failed to register with FirebaseApp \"+this.name,e)}},FirebaseAppImpl.prototype._addOrOverwriteComponent=function(component){this.container.addOrOverwriteComponent(component)},FirebaseAppImpl.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},FirebaseAppImpl.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw ERROR_FACTORY.create(\"app-deleted\",{appName:this.name_})},FirebaseAppImpl}();FirebaseAppImpl.prototype.name&&FirebaseAppImpl.prototype.options||FirebaseAppImpl.prototype.delete||console.log(\"dc\");var firebase=function createFirebaseNamespace(){var namespace=function(firebaseAppImpl){var apps={},components=new Map,namespace={__esModule:!0,initializeApp:function(options,rawConfig){void 0===rawConfig&&(rawConfig={}),\"object\"==typeof rawConfig&&null!==rawConfig||(rawConfig={name:rawConfig});var config=rawConfig;void 0===config.name&&(config.name=\"[DEFAULT]\");var name=config.name;if(\"string\"!=typeof name||!name)throw ERROR_FACTORY.create(\"bad-app-name\",{appName:String(name)});if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_1__.contains)(apps,name))throw ERROR_FACTORY.create(\"duplicate-app\",{appName:name});var app=new firebaseAppImpl(options,config,namespace);return apps[name]=app,app},app:app,registerVersion:function(libraryKeyOrName,version,variant){var _a,library=null!==(_a=PLATFORM_LOG_STRING[libraryKeyOrName])&&void 0!==_a?_a:libraryKeyOrName;variant&&(library+=\"-\"+variant);var libraryMismatch=library.match(/\\s|\\//),versionMismatch=version.match(/\\s|\\//);if(libraryMismatch||versionMismatch){var warning=['Unable to register library \"'+library+'\" with version \"'+version+'\":'];return libraryMismatch&&warning.push('library name \"'+library+'\" contains illegal characters (whitespace or \"/\")'),libraryMismatch&&versionMismatch&&warning.push(\"and\"),versionMismatch&&warning.push('version name \"'+version+'\" contains illegal characters (whitespace or \"/\")'),void logger.warn(warning.join(\" \"))}registerComponent(new _firebase_component__WEBPACK_IMPORTED_MODULE_2__.Component(library+\"-version\",(function(){return{library:library,version:version}}),\"VERSION\"))},setLogLevel:_firebase_logger__WEBPACK_IMPORTED_MODULE_3__.setLogLevel,onLog:function(logCallback,options){if(null!==logCallback&&\"function\"!=typeof logCallback)throw ERROR_FACTORY.create(\"invalid-log-argument\");Object(_firebase_logger__WEBPACK_IMPORTED_MODULE_3__.setUserLogHandler)(logCallback,options)},apps:null,SDK_VERSION:\"8.6.1\",INTERNAL:{registerComponent:registerComponent,removeApp:function(name){delete apps[name]},components:components,useAsService:function(app,name){return\"serverAuth\"===name?null:name}}};function app(name){if(name=name||\"[DEFAULT]\",!Object(_firebase_util__WEBPACK_IMPORTED_MODULE_1__.contains)(apps,name))throw ERROR_FACTORY.create(\"no-app\",{appName:name});return apps[name]}function registerComponent(component){var componentName=component.name;if(components.has(componentName))return logger.debug(\"There were multiple attempts to register component \"+componentName+\".\"),\"PUBLIC\"===component.type?namespace[componentName]:null;if(components.set(componentName,component),\"PUBLIC\"===component.type){var serviceNamespace=function(appArg){if(void 0===appArg&&(appArg=app()),\"function\"!=typeof appArg[componentName])throw ERROR_FACTORY.create(\"invalid-app-argument\",{appName:componentName});return appArg[componentName]()};void 0!==component.serviceProps&&Object(_firebase_util__WEBPACK_IMPORTED_MODULE_1__.deepExtend)(serviceNamespace,component.serviceProps),namespace[componentName]=serviceNamespace,firebaseAppImpl.prototype[componentName]=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var serviceFxn=this._getService.bind(this,componentName);return serviceFxn.apply(this,component.multipleInstances?args:[])}}for(var _i=0,_a=Object.keys(apps);_i<_a.length;_i++)apps[_a[_i]]._addComponent(component);return\"PUBLIC\"===component.type?namespace[componentName]:null}return namespace.default=namespace,Object.defineProperty(namespace,\"apps\",{get:function(){return Object.keys(apps).map((function(name){return apps[name]}))}}),app.App=firebaseAppImpl,namespace}(FirebaseAppImpl);return namespace.INTERNAL=Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)(Object(tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({},namespace.INTERNAL),{createFirebaseNamespace:createFirebaseNamespace,extendNamespace:function(props){Object(_firebase_util__WEBPACK_IMPORTED_MODULE_1__.deepExtend)(namespace,props)},createSubscribe:_firebase_util__WEBPACK_IMPORTED_MODULE_1__.createSubscribe,ErrorFactory:_firebase_util__WEBPACK_IMPORTED_MODULE_1__.ErrorFactory,deepExtend:_firebase_util__WEBPACK_IMPORTED_MODULE_1__.deepExtend}),namespace}(),PlatformLoggerService=function(){function PlatformLoggerService(container){this.container=container}return PlatformLoggerService.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(provider){if(function(provider){var component=provider.getComponent();return\"VERSION\"===(null==component?void 0:component.type)}(provider)){var service=provider.getImmediate();return service.library+\"/\"+service.version}return null})).filter((function(logString){return logString})).join(\" \")},PlatformLoggerService}();if(Object(_firebase_util__WEBPACK_IMPORTED_MODULE_1__.isBrowser)()&&void 0!==self.firebase){logger.warn(\"\\n    Warning: Firebase is already defined in the global scope. Please make sure\\n    Firebase library is only loaded once.\\n  \");var sdkVersion=self.firebase.SDK_VERSION;sdkVersion&&sdkVersion.indexOf(\"LITE\")>=0&&logger.warn(\"\\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\\n    \")}var initializeApp=firebase.initializeApp;firebase.initializeApp=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return Object(_firebase_util__WEBPACK_IMPORTED_MODULE_1__.isNode)()&&logger.warn('\\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\\n      run in a Node environment.  If running in a Node environment, make sure you\\n      are using the bundle specified by the \"main\" field in package.json.\\n      \\n      If you are using Webpack, you can specify \"main\" as the first item in\\n      \"resolve.mainFields\":\\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\\n      \\n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify \"main\"\\n      as the first item in \"mainFields\", e.g. [\\'main\\', \\'module\\'].\\n      https://github.com/rollup/@rollup/plugin-node-resolve\\n      '),initializeApp.apply(void 0,args)};var firebase$1=firebase;!function(firebase,variant){firebase.INTERNAL.registerComponent(new _firebase_component__WEBPACK_IMPORTED_MODULE_2__.Component(\"platform-logger\",(function(container){return new PlatformLoggerService(container)}),\"PRIVATE\")),firebase.registerVersion(name,\"0.6.22\",void 0),firebase.registerVersion(\"fire-js\",\"\")}(firebase$1),__webpack_exports__.default=firebase$1}}]);","extractedComments":[]}