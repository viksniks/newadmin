(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"/6Yf":function(t,e,n){"use strict";n.r(e),n.d(e,"Component",(function(){return o})),n.d(e,"ComponentContainer",(function(){return s})),n.d(e,"Provider",(function(){return a}));var r=n("mrSG"),i=n("qOnz"),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),a=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Set}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=Object(r.__assign)({identifier:"[DEFAULT]",optional:!1},t),n=e.optional,i=this.normalizeInstanceIdentifier(e.identifier);if(!this.isInitialized(i)&&!this.shouldAutoInitialize()){if(n)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(n)return null;throw o}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(l){}try{for(var i=Object(r.__values)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var a=Object(r.__read)(o.value,2),s=a[1],u=this.normalizeInstanceIdentifier(a[0]);try{var c=this.getOrInitializeService({instanceIdentifier:u});s.resolve(c)}catch(l){}}}catch(h){e={error:h}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Object(r.__spreadArray)(Object(r.__spreadArray)([],Object(r.__read)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),Object(r.__read)(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t="[DEFAULT]"),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var i=t.instanceIdentifier,o=t.options,a=void 0===o?{}:o,s=this.normalizeInstanceIdentifier(void 0===i?"[DEFAULT]":i);if(this.isInitialized(s))throw Error(this.name+"("+s+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var u=this.getOrInitializeService({instanceIdentifier:s,options:a});try{for(var c=Object(r.__values)(this.instancesDeferred.entries()),l=c.next();!l.done;l=c.next()){var h=Object(r.__read)(l.value,2),f=h[1];s===this.normalizeInstanceIdentifier(h[0])&&f.resolve(u)}}catch(d){e={error:d}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return this.invokeOnInitCallbacks(u,s),u},t.prototype.onInit=function(t){var e=this;return this.onInitCallbacks.add(t),function(){e.onInitCallbacks.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,i;try{for(var o=Object(r.__values)(this.onInitCallbacks),a=o.next();!a.done;a=o.next()){var s=a.value;try{s(t,e)}catch(u){}}}catch(c){n={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,"[DEFAULT]"===e?void 0:e),options:i}),this.instances.set(n,o),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(a){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}(),s=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new a(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},"3UD+":function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},"6Uf2":function(t,e,n){"use strict";(function(t){var e=n("zIRd"),r=n("/6Yf"),i=n("qOnz"),o=n("mrSG"),a=n("q/0M"),s="";function u(t){s=t}var c,l=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Object(i.stringify)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:Object(i.jsonEval)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),h=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return Object(i.contains)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),f=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new l(e)}}catch(n){}return new h},d=f("localStorage"),p=f("sessionStorage"),v=new a.Logger("@firebase/database"),g=(c=1,function(){return c++}),y=function(t){var e=Object(i.stringToByteArray)(t),n=new i.Sha1;n.update(e);var r=n.digest();return i.base64.encodeByteArray(r)},m=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var o=t[r];Array.isArray(o)||o&&"object"==typeof o&&"number"==typeof o.length?n+=m.apply(null,o):n+="object"==typeof o?Object(i.stringify)(o):o,n+=" "}return n},_=null,b=!0,w=function(t,e){Object(i.assert)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(v.logLevel=a.LogLevel.VERBOSE,_=v.log.bind(v),e&&p.set("logging_enabled",!0)):"function"==typeof t?_=t:(_=null,p.remove("logging_enabled"))},I=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===b&&(b=!1,null===_&&!0===p.get("logging_enabled")&&w(!0)),_){var n=m.apply(null,t);_(n)}},T=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];I.apply(void 0,Object(o.__spreadArray)([t],Object(o.__read)(e)))}},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+m.apply(void 0,Object(o.__spreadArray)([],Object(o.__read)(t)));v.error(n)},O=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+m.apply(void 0,Object(o.__spreadArray)([],Object(o.__read)(t)));throw v.error(n),new Error(n)},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+m.apply(void 0,Object(o.__spreadArray)([],Object(o.__read)(t)));v.warn(n)},C=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},k="[MIN_NAME]",A="[MAX_NAME]",N=function(t,e){if(t===e)return 0;if(t===k||e===A)return-1;if(e===k||t===A)return 1;var n=F(t),r=F(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},P=function(t,e){return t===e?0:t<e?-1:1},j=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Object(i.stringify)(e))},R=function(t){if("object"!=typeof t||null===t)return Object(i.stringify)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",o=0;o<e.length;o++)0!==o&&(r+=","),r+=Object(i.stringify)(e[o]),r+=":",r+=R(t[e[o]]);return r+"}"},x=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)r.push(t.substring(i,i+e>n?n:i+e));return r};function D(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var L=function(t){var e,n,r,o,a;Object(i.assert)(!C(t),"Invalid JSON number"),0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(o=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-o)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},M=new RegExp("^-?(0*)\\d{1,10}$"),F=function(t){if(M.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},U=function(t){try{t()}catch(e){setTimeout((function(){throw S("Exception was thrown by user callback.",e.stack||""),e}),Math.floor(0))}},q=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},V=function(){function t(t,e){var n=this;this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then((function(t){return n.appCheck=t}))}return t.prototype.getToken=function(t){var e=this;return this.appCheck?this.appCheck.getToken(t):new Promise((function(n,r){setTimeout((function(){e.appCheck?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((function(e){return e.addTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){S('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}(),B=function(){function t(t,e,n){var r=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(t){return r.auth_=t}))}return t.prototype.getToken=function(t){var e=this;return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(I("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):new Promise((function(n,r){setTimeout((function(){e.auth_?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)}))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';S(t+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.')},t}(),K=function(){function t(t){this.accessToken=t}return t.prototype.getToken=function(t){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(t){t(this.accessToken)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}(),W=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,H=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=d.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&d.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host+"/"+(this.includeNamespaceInQueryParams?"?ns="+this.namespace:"")},t}();function G(t,e,n){var r;if(Object(i.assert)("string"==typeof e,"typeof type must == string"),Object(i.assert)("object"==typeof n,"typeof params must == object"),"websocket"===e)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if("long_polling"!==e)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);var o=[];return D(n,(function(t,e){o.push(t+"="+e)})),r+o.join("&")}var z=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),Object(i.contains)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return Object(i.deepCopy)(this.counters_)},t}(),Q={},Y={};function X(t){var e=t.toString();return Q[e]||(Q[e]=new z),Q[e]}var J=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&U((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),$=function(){function t(t,e,n,r,i,o,a){var s=this;this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=T(t),this.stats_=X(e),this.urlFn=function(t){return s.appCheckToken&&(t.ac=s.appCheckToken),G(e,"long_polling",t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new J(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if(Object(i.isNodeSdk)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new Z((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Object(o.__read)(t,5),i=r[0],a=r[1],s=r[2];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===i)n.id=a,n.password=s;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Object(o.__read)(t,2),i=r[0],a=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,a)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),n.appCheckToken&&(t.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&W.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!(Object(i.isNodeSdk)()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=Object(i.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=Object(i.base64Encode)(e),r=x(n,1840),o=0;o<r.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[o]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!Object(i.isNodeSdk)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=Object(i.stringify)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),Z=function(){function t(e,n,r,o){if(this.onDisconnect=r,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(i.isNodeSdk)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=g(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(a='<script>document.domain="'+document.domain+'";<\/script>');var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(u){I("frame writing exception"),u.stack&&I(u.stack),I(u)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||I("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return this.addLongPollTag_(e+=n,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;Object(i.isNodeSdk)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){I("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},t}(),tt=null;"undefined"!=typeof MozWebSocket?tt=MozWebSocket:"undefined"!=typeof WebSocket&&(tt=WebSocket);var et=function(){function t(e,n,r,i,o,a,s){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=T(this.connId),this.stats_=X(n),this.connURL=t.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n,r){var o={v:"5"};return!Object(i.isNodeSdk)()&&"undefined"!=typeof location&&location.hostname&&W.test(location.hostname)&&(o.r="f"),e&&(o.s=e),n&&(o.ls=n),r&&(o.ac=r),G(t,"websocket",o)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,d.set("previous_websocket_failure",!0);try{if(Object(i.isNodeSdk)()){var r={headers:{"User-Agent":"Firebase/5/"+s+"/"+process.platform+"/"+(this.nodeAdmin?"AdminNode":"Node"),"X-Firebase-GMPID":this.applicationId||""}};this.nodeAdmin?r.headers.Authorization=this.authToken||"":r.headers["X-Firebase-AppCheck"]=this.appCheckToken||"";var o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a}),this.mySock=new tt(this.connURL,[],r)}else this.mySock=new tt(this.connURL,[],r={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(c){this.log_("Error instantiating WebSocket.");var u=c.message||c.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==tt&&!t.forceDisallow_},t.previouslyFailed=function(){return d.isInMemoryStorage||!0===d.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){d.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=Object(i.jsonEval)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(Object(i.assert)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=Object(i.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=x(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),nt=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[$,et]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=et&&et.isAvailable(),a=i&&!et.previouslyFailed();if(e.webSocketOnly&&(i||S("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),a=!0),a)this.transports_=[et];else{var s=this.transports_=[];try{for(var u=Object(o.__values)(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var l=c.value;l&&l.isAvailable()&&s.push(l)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),rt=function(){function t(t,e,n,r,i,o,a,s,u,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=T("c:"+this.id+":"),this.transportManager_=new nt(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=q((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){this.sendData_({t:"d",d:t})},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=j("t",t),n=j("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=j("t",t),n=j("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=j("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?E("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&S("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),q((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):q((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(d.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),it=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.refreshAppCheckToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),ot=function(){function t(t){this.allowedEvents_=t,this.listeners_={},Object(i.assert)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=Object(o.__spreadArray)([],Object(o.__read)(this.listeners_[t])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){Object(i.assert)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),at=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Object(i.isMobileCordova)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return Object(o.__extends)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Object(i.assert)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(ot),st=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();function ut(){return new st("")}function ct(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function lt(t){return t.pieces_.length-t.pieceNum_}function ht(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new st(t.pieces_,e)}function ft(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function dt(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function pt(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new st(e,0)}function vt(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof st)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new st(n,0)}function gt(t){return t.pieceNum_>=t.pieces_.length}function yt(t,e){var n=ct(t),r=ct(e);if(null===n)return e;if(n===r)return yt(ht(t),ht(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function mt(t,e){for(var n=dt(t,0),r=dt(e,0),i=0;i<n.length&&i<r.length;i++){var o=N(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function _t(t,e){if(lt(t)!==lt(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function bt(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(lt(t)>lt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var wt=function(){return function(t,e){this.errorPrefix_=e,this.parts_=dt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Object(i.stringLength)(this.parts_[n]);It(this)}}();function It(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Tt(t))}function Tt(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}var Et,Ot,St=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return Object(o.__extends)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Object(i.assert)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(ot),Ct=function(t){function e(n,r,o,a,s,u,c,l){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=o,h.onConnectStatus_=a,h.onServerInfoUpdate_=s,h.authTokenProvider_=u,h.appCheckTokenProvider_=c,h.authOverride_=l,h.id=e.nextPersistentConnectionId_++,h.log_=T("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=1e3,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,l&&!Object(i.isNodeSdk)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return St.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&at.getInstance().on("online",h.onOnline_,h),h}return Object(o.__extends)(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,o={r,a:t,b:e};this.log_(Object(i.stringify)(o)),Object(i.assert)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this;this.initConnection_();var n=new i.Deferred,r={p:t._path.toString(),q:t._queryObject},o={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[a];void 0!==t&&o===t&&(delete e.outstandingGets_[a],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(a),n.promise},e.prototype.listen=function(t,e,n,r){this.initConnection_();var o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),Object(i.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Object(i.assert)(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(a).set(o,s),this.connected_&&this.sendListen_(s)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&Object(i.contains)(t,"w")){var n=Object(i.safeGet)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e._queryParams.getIndex().toString()+'"',o=e._path.toString();S("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+o+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||Object(i.isAdmin)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.refreshAppCheckToken=function(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=Object(i.isValidFormat)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.tryAppCheck=function(){var t=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(e){var n=e.s,r=e.d||"error";"ok"===n?t.invalidAppCheckTokenCount_=0:t.onAppCheckRevoked_(n,r)}))},e.prototype.unlisten=function(t,e){var n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Object(i.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){this.initConnection_();var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){"ok"!==t.s&&e.log_("reportStats","Error sending stats: "+t.d)}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+Object(i.stringify)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):E("Unrecognized action received from server: "+Object(i.stringify)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;Object(i.assert)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,s,u,c,l,h,f,d,p,v,g=this;return Object(o.__generator)(this,(function(y){switch(y.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+e.nextConnectionId_++,s=this.lastSessionId,u=!1,c=null,this.realtime_={close:l=function(){c?c.close():(u=!0,r())},sendRequest:function(t){Object(i.assert)(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(t)}},h=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,y.label=1;case 1:return y.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)])];case 2:return f=o.__read.apply(void 0,[y.sent(),2]),d=f[0],p=f[1],u?I("getToken() completed but was canceled"):(I("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=p&&p.token,c=new rt(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,(function(t){S(t+" ("+g.repoInfo_.toString()+")"),g.interrupt("server_kill")}),s)),[3,4];case 3:return v=y.sent(),this.log_("Failed to get token: "+v),u||(this.repoInfo_.nodeAdmin&&S(v),l()),[3,4];case 4:return[2]}}))}))},e.prototype.interrupt=function(t){I("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){I("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Object(i.isEmpty)(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return R(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new st(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){I("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(t,e){I("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=Object(o.__values)(this.listens.values()),a=i.next();!a.done;a=i.next()){var s=a.value;try{for(var u=(n=void 0,Object(o.__values)(s.values())),c=u.next();!c.done;c=u.next())this.sendListen_(c.value)}catch(f){n={error:f}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(d){t={error:d}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},e.prototype.sendConnectStats_=function(){var t={},e="js";Object(i.isNodeSdk)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+s.replace(/\./g,"-")]=1,Object(i.isMobileCordova)()?t["framework.cordova"]=1:Object(i.isReactNative)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=at.getInstance().currentlyOnline();return Object(i.isEmpty)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(it),kt=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),At=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new kt(k,t),r=new kt(k,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return kt.MIN},t}(),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(o.__extends)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Et},set:function(t){Et=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return N(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw Object(i.assertionError)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return kt.MIN},e.prototype.maxPost=function(){return new kt(A,Et)},e.prototype.makePost=function(t,e){return Object(i.assert)("string"==typeof t,"KeyIndex indexValue must always be a string."),new kt(t,Et)},e.prototype.toString=function(){return".key"},e}(At),Pt=new Nt,jt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Rt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Dt.EMPTY_NODE,this.right=null!=o?o:Dt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Dt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Dt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),xt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Rt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Dt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Rt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Rt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new jt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new jt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new jt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new jt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new xt,t}();function Lt(t,e){return N(t.name,e.name)}function Mt(t,e){return N(t,e)}var Ft,Ut,qt,Vt,Bt,Kt=function(t){return"number"==typeof t?"number:"+L(t):"string:"+t},Wt=function(t){if(t.isLeafNode()){var e=t.val();Object(i.assert)("string"==typeof e||"number"==typeof e||"object"==typeof e&&Object(i.contains)(e,".sv"),"Priority must be a string or number.")}else Object(i.assert)(t===Ot||t.isEmpty(),"priority of unexpected type.");Object(i.assert)(t===Ot||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Ht=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Object(i.assert)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Wt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return Ft},set:function(t){Ft=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return gt(e)?this:".priority"===ct(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=ct(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:(Object(i.assert)(".priority"!==r||1===lt(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(ht(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Kt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?L(this.value_):this.value_,this.lazyHash_=y(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(Object(i.assert)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,o=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return Object(i.assert)(o>=0,"Unknown leaf type: "+n),Object(i.assert)(a>=0,"Unknown leaf type: "+r),o===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-o},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){return t===this||!!t.isLeafNode()&&this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),Gt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(o.__extends)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?N(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return kt.MIN},e.prototype.maxPost=function(){return new kt(A,new Ht("[PRIORITY-POST]",qt))},e.prototype.makePost=function(t,e){var n=Ut(t);return new kt(e,new Ht("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(At)),zt=Math.log(2),Qt=function(){function t(t){this.count=parseInt(Math.log(t+1)/zt,10),this.current_=this.count-1;var e=parseInt(Array(this.count+1).join("1"),2);this.bits_=t+1&e}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),Yt=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0===s)return null;if(1===s)return o=t[e],a=n?n(o):o,new Rt(a,o.node,Rt.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],a=n?n(o):o,new Rt(a,o.node,Rt.BLACK,c,l)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),l=t[o],h=n?n(l):l;u(new Rt(h,l.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?s(h,Rt.BLACK):(s(h,Rt.BLACK),s(h,Rt.RED))}return o}(new Qt(t.length));return new Dt(r||e,o)},Xt={},Jt=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return Object(i.assert)(Xt&&Gt,"ChildrenNode.ts has not been loaded"),Vt=Vt||new t({".priority":Xt},{".priority":Gt})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=Object(i.safeGet)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Dt?e:null},t.prototype.hasIndex=function(t){return Object(i.contains)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){Object(i.assert)(e!==Pt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,a=[],s=!1,u=n.getIterator(kt.Wrap),c=u.getNext();c;)s=s||e.isDefinedOn(c.node),a.push(c),c=u.getNext();r=s?Yt(a,e.getCompare()):Xt;var l=e.toString(),h=Object(o.__assign)({},this.indexSet_);h[l]=e;var f=Object(o.__assign)({},this.indexes_);return f[l]=r,new t(f,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(Object(i.map)(this.indexes_,(function(t,o){var a=Object(i.safeGet)(r.indexSet_,o);if(Object(i.assert)(a,"Missing index implementation for "+o),t===Xt){if(a.isDefinedOn(e.node)){for(var s=[],u=n.getIterator(kt.Wrap),c=u.getNext();c;)c.name!==e.name&&s.push(c),c=u.getNext();return s.push(e),Yt(s,a.getCompare())}return Xt}var l=n.get(e.name),h=t;return l&&(h=h.remove(new kt(e.name,l))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(Object(i.map)(this.indexes_,(function(t){if(t===Xt)return t;var r=n.get(e.name);return r?t.remove(new kt(e.name,r)):t})),this.indexSet_)},t}(),$t=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Wt(this.priorityNode_),this.children_.isEmpty()&&Object(i.assert)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Bt||(Bt=new t(new Dt(Mt),null,Jt.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Bt},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Bt:e},t.prototype.getChild=function(t){var e=ct(t);return null===e?this:this.getImmediateChild(e).getChild(ht(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(Object(i.assert)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new kt(e,n),o=void 0,a=void 0;n.isEmpty()?(o=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(o=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(r,this.children_));var s=o.isEmpty()?Bt:this.priorityNode_;return new t(o,s,a)},t.prototype.updateChild=function(t,e){var n=ct(t);if(null===n)return e;Object(i.assert)(".priority"!==ct(t)||1===lt(t),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(ht(t),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Gt,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Kt(this.getPriority().val())+":"),this.forEachChild(Gt,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":y(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new kt(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new kt(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new kt(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,kt.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,kt.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Zt?-1:0},t.prototype.withIndex=function(e){if(e===Pt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===Pt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(Gt),r=e.getIterator(Gt),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===Pt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),Zt=new(function(t){function e(){return t.call(this,new Dt(Mt),$t.EMPTY_NODE,Jt.Default)||this}return Object(o.__extends)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return $t.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}($t));function te(t,e){if(void 0===e&&(e=null),null===t)return $t.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),Object(i.assert)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Ht(t,te(e));if(t instanceof Array){var n=$t.EMPTY_NODE;return D(t,(function(e,r){if(Object(i.contains)(t,e)&&"."!==e.substring(0,1)){var o=te(r);!o.isLeafNode()&&o.isEmpty()||(n=n.updateImmediateChild(e,o))}})),n.updatePriority(te(e))}var r=[],o=!1;if(D(t,(function(t,e){if("."!==t.substring(0,1)){var n=te(e);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),r.push(new kt(t,n)))}})),0===r.length)return $t.EMPTY_NODE;var a=Yt(r,Lt,(function(t){return t.name}),Mt);if(o){var s=Yt(r,Gt.getCompare());return new $t(a,te(e),new Jt({".priority":s},{".priority":Gt}))}return new $t(a,te(e),Jt.Default)}Object.defineProperties(kt,{MIN:{value:new kt(k,$t.EMPTY_NODE)},MAX:{value:new kt(A,Zt)}}),Nt.__EMPTY_NODE=$t.EMPTY_NODE,Ht.__childrenNodeConstructor=$t,Ot=Zt,function(t){qt=t}(Zt),function(t){Ut=t}(te);var ee,ne,re=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,Object(i.assert)(!gt(e)&&".priority"!==ct(e),"Can't create PathIndex with empty path or .priority key"),n}return Object(o.__extends)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?N(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=te(t),r=$t.EMPTY_NODE.updateChild(this.indexPath_,n);return new kt(e,r)},e.prototype.maxPost=function(){var t=$t.EMPTY_NODE.updateChild(this.indexPath_,Zt);return new kt(A,t)},e.prototype.toString=function(){return dt(this.indexPath_,0).join("/")},e}(At),ie=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(o.__extends)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?N(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return kt.MIN},e.prototype.maxPost=function(){return kt.MAX},e.prototype.makePost=function(t,e){var n=te(t);return new kt(e,n)},e.prototype.toString=function(){return".value"},e}(At)),oe="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ae=(ee=0,ne=[],function(t){var e,n=t===ee;ee=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=oe.charAt(t%64),t=Math.floor(t/64);Object(i.assert)(0===t,"Cannot push at time == 0");var o=r.join("");if(n){for(e=11;e>=0&&63===ne[e];e--)ne[e]=0;ne[e]++}else for(e=0;e<12;e++)ne[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)o+=oe.charAt(ne[e]);return Object(i.assert)(20===o.length,"nextPushId: Length should be 20."),o}),se=function(t){if("2147483647"===t)return"-";var e=F(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return A;var o=oe.charAt(oe.indexOf(n[i])+1);return n[i]=o,n.slice(0,i+1).join("")},ue=function(t){if("-2147483648"===t)return k;var e=F(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=oe.charAt(oe.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function ce(t){return{type:"value",snapshotNode:t}}function le(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function he(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function fe(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var de=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,o,a){Object(i.assert)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=a&&(n.isEmpty()?t.hasChild(e)?a.trackChildChange(he(e,s)):Object(i.assert)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(le(e,n)):a.trackChildChange(fe(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Gt,(function(t,r){e.hasChild(t)||n.trackChildChange(he(t,r))})),e.isLeafNode()||e.forEachChild(Gt,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(fe(e,r,i))}else n.trackChildChange(le(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?$t.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),pe=function(){function t(e){this.indexedFilter_=new de(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new kt(e,n))||(n=$t.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=$t.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority($t.EMPTY_NODE);var i=this;return e.forEachChild(Gt,(function(t,e){i.matches(new kt(t,e))||(r=r.updateImmediateChild(t,$t.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),ve=function(){function t(t){this.rangedFilter_=new pe(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new kt(e,n))||(n=$t.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=$t.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=$t.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority($t.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)a=i.getNext(),!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,$t.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,o){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(t,e){return s(e,t)}}else a=this.index_.getCompare();var u=t;Object(i.assert)(u.numChildren()===this.limit_,"");var c=new kt(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),d=r.getChildAfterChild(this.index_,l,this.reverse_);null!=d&&(d.name===e||u.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:a(d,c);if(h&&!n.isEmpty()&&p>=0)return null!=o&&o.trackChildChange(fe(e,n,f)),u.updateImmediateChild(e,n);null!=o&&o.trackChildChange(he(e,f));var v=u.updateImmediateChild(e,$t.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=o&&o.trackChildChange(le(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}return n.isEmpty()?t:h&&a(l,c)>=0?(null!=o&&(o.trackChildChange(he(l.name,l.node)),o.trackChildChange(le(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,$t.EMPTY_NODE)):t},t}(),ge=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Gt}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return Object(i.assert)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return Object(i.assert)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:k},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return Object(i.assert)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return Object(i.assert)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:A},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return Object(i.assert)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Gt},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function ye(t,e,n){var r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function me(t,e,n){var r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function _e(t,e){var n=t.copy();return n.index_=e,n}function be(t){var e,n={};return t.isDefault()||(t.index_===Gt?e="$priority":t.index_===ie?e="$value":t.index_===Pt?e="$key":(Object(i.assert)(t.index_ instanceof re,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=Object(i.stringify)(e),t.startSet_&&(n.startAt=Object(i.stringify)(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+Object(i.stringify)(t.indexStartName_))),t.endSet_&&(n.endAt=Object(i.stringify)(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+Object(i.stringify)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}function we(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Gt&&(e.i=t.index_.toString()),e}var Ie=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.repoInfo_=e,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=T("p:rest:"),o.listens_={},o}return Object(o.__extends)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(Object(i.assert)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,r,o){var a=this,s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=be(t._queryParams);this.restRequest_(s+".json",l,(function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&a.onDataUpdate_(s,n,!1,r),Object(i.safeGet)(a.listens_,u)===c&&o(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=be(t._queryParams),r=t._path.toString(),o=new i.Deferred;return this.restRequest_(r+".json",n,(function(t,n){var i=n;404===t&&(i=null,t=null),null===t?(e.onDataUpdate_(r,i,!1,null),o.resolve(i)):o.reject(new Error(i))})),o.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;return void 0===e&&(e={}),e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(a){var s=Object(o.__read)(a,2),u=s[0],c=s[1];u&&u.accessToken&&(e.auth=u.accessToken),c&&c.token&&(e.ac=c.token);var l=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+Object(i.querystring)(e);r.log_("Sending REST request for "+l);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){r.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);var t=null;if(h.status>=200&&h.status<300){try{t=Object(i.jsonEval)(h.responseText)}catch(e){S("Failed to parse JSON response for "+l+": "+h.responseText)}n(null,t)}else 401!==h.status&&404!==h.status&&S("Got unsuccessful REST response for "+l+" Status: "+h.status),n(h.status);n=null}},h.open("GET",l,!0),h.send()}))},e}(it),Te=function(){function t(){this.rootNode_=$t.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();function Ee(){return{value:null,children:new Map}}function Oe(t,e,n){if(gt(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var r=ct(e);t.children.has(r)||t.children.set(r,Ee()),Oe(t.children.get(r),e=ht(e),n)}}function Se(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach((function(t,n){e(n,t)}))}(t,(function(t,r){Se(r,new st(e.toString()+"/"+t),n)}))}var Ce=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=Object(o.__assign)({},t);return this.last_&&D(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),ke=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Ce(t);var n=1e4+2e4*Math.random();q(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;D(e,(function(e,o){o>0&&Object(i.contains)(t.statsToReport_,e)&&(n[e]=o,r=!0)})),r&&this.server_.reportStats(n),q(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Ae=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}({});function Ne(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var Pe,je=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Ae.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return t.prototype.operationForChild=function(e){if(gt(this.path)){if(null!=this.affectedTree.value)return Object(i.assert)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new st(e));return new t(ut(),n,this.revert)}return Object(i.assert)(ct(this.path)===e,"operationForChild called for unrelated child."),new t(ht(this.path),this.affectedTree,this.revert)},t}(),Re=function(){function t(t,e){this.source=t,this.path=e,this.type=Ae.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return gt(this.path)?new t(this.source,ut()):new t(this.source,ht(this.path))},t}(),xe=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Ae.OVERWRITE}return t.prototype.operationForChild=function(e){return gt(this.path)?new t(this.source,ut(),this.snap.getImmediateChild(e)):new t(this.source,ht(this.path),this.snap)},t}(),De=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Ae.MERGE}return t.prototype.operationForChild=function(e){if(gt(this.path)){var n=this.children.subtree(new st(e));return n.isEmpty()?null:n.value?new xe(this.source,ut(),n.value):new t(this.source,ut(),n)}return Object(i.assert)(ct(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,ht(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Le=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(gt(t))return this.isFullyInitialized()&&!this.filtered_;var e=ct(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),Me=function(){return function(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}();function Fe(t,e,n,r,o,a){var s=r.filter((function(t){return t.type===n}));s.sort((function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw Object(i.assertionError)("Should only compare child_ events.");var r=new kt(e.childName,e.snapshotNode),o=new kt(n.childName,n.snapshotNode);return t.index_.compare(r,o)}(t,e,n)})),s.forEach((function(n){var r=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,a);o.forEach((function(i){i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function Ue(t,e){return{eventCache:t,serverCache:e}}function qe(t,e,n,r){return Ue(new Le(e,n,r),t.serverCache)}function Ve(t,e,n,r){return Ue(t.eventCache,new Le(e,n,r))}function Be(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ke(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var We=function(){function t(t,e){void 0===e&&(Pe||(Pe=new Dt(P)),e=Pe),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return D(e,(function(t,e){n=n.set(new st(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:ut(),value:this.value};if(gt(t))return null;var n=ct(t),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(ht(t),e);return null!=i?{path:vt(new st(n),i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(gt(e))return this;var n=ct(e),r=this.children.get(n);return null!==r?r.subtree(ht(e)):new t(null)},t.prototype.set=function(e,n){if(gt(e))return new t(n,this.children);var r=ct(e),i=(this.children.get(r)||new t(null)).set(ht(e),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(gt(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=ct(e),r=this.children.get(n);if(r){var i=r.remove(ht(e)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new t(null):new t(this.value,o)}return this},t.prototype.get=function(t){if(gt(t))return this.value;var e=ct(t),n=this.children.get(e);return n?n.get(ht(t)):null},t.prototype.setTree=function(e,n){if(gt(e))return n;var r,i=ct(e),o=(this.children.get(i)||new t(null)).setTree(ht(e),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(ut(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(vt(t,r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,ut(),e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(gt(t))return null;var i=ct(t),o=this.children.get(i);return o?o.findOnPath_(ht(t),vt(e,i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,ut(),e)},t.prototype.foreachOnPath_=function(e,n,r){if(gt(e))return this;this.value&&r(n,this.value);var i=ct(e),o=this.children.get(i);return o?o.foreachOnPath_(ht(e),vt(n,i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(ut(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(vt(t,n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),He=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new We(null))},t}();function Ge(t,e,n){if(gt(e))return new He(new We(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=yt(i,e);return o=o.updateChild(a,n),new He(t.writeTree_.set(i,o))}var s=new We(n),u=t.writeTree_.setTree(e,s);return new He(u)}function ze(t,e,n){var r=t;return D(n,(function(t,n){r=Ge(r,vt(e,t),n)})),r}function Qe(t,e){if(gt(e))return He.empty();var n=t.writeTree_.setTree(e,new We(null));return new He(n)}function Ye(t,e){return null!=Xe(t,e)}function Xe(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(yt(n.path,e)):null}function Je(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Gt,(function(t,n){e.push(new kt(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new kt(t,n.value))})),e}function $e(t,e){if(gt(e))return t;var n=Xe(t,e);return new He(null!=n?new We(n):t.writeTree_.subtree(e))}function Ze(t){return t.writeTree_.isEmpty()}function tn(t,e){return function t(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var o=null;return n.children.inorderTraversal((function(n,a){".priority"===n?(Object(i.assert)(null!==a.value,"Priority writes must always be leaf nodes"),o=a.value):r=t(vt(e,n),a,r)})),r.getChild(e).isEmpty()||null===o||(r=r.updateChild(vt(e,".priority"),o)),r}(ut(),t.writeTree_,e)}function en(t,e){return dn(e,t)}function nn(t,e){if(t.snap)return bt(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&bt(vt(t.path,n),e))return!0;return!1}function rn(t){return t.visible}function on(t,e,n){for(var r=He.empty(),o=0;o<t.length;++o){var a=t[o];if(e(a)){var s=a.path,u=void 0;if(a.snap)bt(n,s)?r=Ge(r,u=yt(n,s),a.snap):bt(s,n)&&(u=yt(s,n),r=Ge(r,ut(),a.snap.getChild(u)));else{if(!a.children)throw Object(i.assertionError)("WriteRecord should have .snap or .children");if(bt(n,s))r=ze(r,u=yt(n,s),a.children);else if(bt(s,n))if(gt(u=yt(s,n)))r=ze(r,ut(),a.children);else{var c=Object(i.safeGet)(a.children,ct(u));if(c){var l=c.getChild(ht(u));r=Ge(r,ut(),l)}}}}}return r}function an(t,e,n,r,i){if(r||i){var o=$e(t.visibleWrites,e);return!i&&Ze(o)?n:i||null!=n||Ye(o,ut())?tn(on(t.allWrites,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(bt(t.path,e)||bt(e,t.path))}),e),n||$t.EMPTY_NODE):null}var a=Xe(t.visibleWrites,e);if(null!=a)return a;var s=$e(t.visibleWrites,e);return Ze(s)?n:null!=n||Ye(s,ut())?tn(s,n||$t.EMPTY_NODE):null}function sn(t,e,n,r){return an(t.writeTree,t.treePath,e,n,r)}function un(t,e){return function(t,e,n){var r=$t.EMPTY_NODE,i=Xe(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Gt,(function(t,e){r=r.updateImmediateChild(t,e)})),r;if(n){var o=$e(t.visibleWrites,e);return n.forEachChild(Gt,(function(t,e){var n=tn($e(o,new st(t)),e);r=r.updateImmediateChild(t,n)})),Je(o).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}return Je($e(t.visibleWrites,e)).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}(t.writeTree,t.treePath,e)}function cn(t,e,n,r){return function(t,e,n,r,o){Object(i.assert)(r||o,"Either existingEventSnap or existingServerSnap must exist");var a=vt(e,n);if(Ye(t.visibleWrites,a))return null;var s=$e(t.visibleWrites,a);return Ze(s)?o.getChild(n):tn(s,o.getChild(n))}(t.writeTree,t.treePath,e,n,r)}function ln(t,e){return function(t,e){return Xe(t.visibleWrites,e)}(t.writeTree,vt(t.treePath,e))}function hn(t,e,n){return function(t,e,n,r){var i=vt(e,n),o=Xe(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?tn($e(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function fn(t,e){return dn(vt(t.treePath,e),t.writeTree)}function dn(t,e){return{treePath:t,writeTree:e}}var pn=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;Object(i.assert)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),Object(i.assert)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var o=r.type;if("child_added"===e&&"child_removed"===o)this.changeMap.set(n,fe(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===o)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===o)this.changeMap.set(n,he(n,r.oldSnap));else if("child_changed"===e&&"child_added"===o)this.changeMap.set(n,le(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==o)throw Object(i.assertionError)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,fe(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),vn=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),gn=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Le(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return hn(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ke(this.viewCache_),i=function(t,e,n,r,i,o){return function(t,e,n,r,i,o,a){var s,u=$e(t.visibleWrites,e),c=Xe(u,ut());if(null!=c)s=c;else{if(null==n)return[];s=tn(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),d=f.getNext();d&&l.length<1;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(t.writeTree,t.treePath,e,n,0,i,o)}(this.writes_,r,e,0,n,t);return 0===i.length?null:i[0]},t}();function yn(t,e,n,r,o,a){var s=e.eventCache;if(null!=ln(r,n))return e;var u=void 0,c=void 0;if(gt(n))if(Object(i.assert)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var l=Ke(e),h=un(r,l instanceof $t?l:$t.EMPTY_NODE);u=t.filter.updateFullNode(e.eventCache.getNode(),h,a)}else{var f=sn(r,Ke(e));u=t.filter.updateFullNode(e.eventCache.getNode(),f,a)}else{var d=ct(n);if(".priority"===d){Object(i.assert)(1===lt(n),"Can't have a priority with additional path components");var p=s.getNode(),v=cn(r,n,p,c=e.serverCache.getNode());u=null!=v?t.filter.updatePriority(p,v):s.getNode()}else{var g=ht(n),y=void 0;if(s.isCompleteForChild(d)){c=e.serverCache.getNode();var m=cn(r,n,s.getNode(),c);y=null!=m?s.getNode().getImmediateChild(d).updateChild(g,m):s.getNode().getImmediateChild(d)}else y=hn(r,d,e.serverCache);u=null!=y?t.filter.updateChild(s.getNode(),d,y,g,o,a):s.getNode()}}return qe(e,u,s.isFullyInitialized()||gt(n),t.filter.filtersNodes())}function mn(t,e,n,r,i,o,a,s){var u,c=e.serverCache,l=a?t.filter:t.filter.getIndexedFilter();if(gt(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=ct(n);if(!c.isCompleteForPath(n)&&lt(n)>1)return e;var d=ht(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),f,p,d,vn,null)}var v=Ve(e,u,c.isFullyInitialized()||gt(n),l.filtersNodes());return yn(t,v,n,i,new gn(i,v,o),s)}function _n(t,e,n,r,i,o,a){var s,u,c=e.eventCache,l=new gn(i,e,o);if(gt(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,a),s=qe(e,u,!0,t.filter.filtersNodes());else{var h=ct(n);if(".priority"===h)u=t.filter.updatePriority(e.eventCache.getNode(),r),s=qe(e,u,c.isFullyInitialized(),c.isFiltered());else{var f=ht(n),d=c.getNode().getImmediateChild(h),p=void 0;if(gt(f))p=r;else{var v=l.getCompleteChild(h);p=null!=v?".priority"===ft(f)&&v.getChild(pt(f)).isEmpty()?v:v.updateChild(f,r):$t.EMPTY_NODE}s=d.equals(p)?e:qe(e,t.filter.updateChild(c.getNode(),h,p,f,l,a),c.isFullyInitialized(),t.filter.filtersNodes())}}return s}function bn(t,e){return t.eventCache.isCompleteForChild(e)}function wn(t,e,n){return n.foreach((function(t,n){e=e.updateChild(t,n)})),e}function In(t,e,n,r,i,o,a,s){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var u,c=e;u=gt(n)?r:new We(null).setTree(n,r);var l=e.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=wn(0,e.serverCache.getNode().getImmediateChild(n),r);c=mn(t,c,new st(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!e.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=wn(0,e.serverCache.getNode().getImmediateChild(n),r);c=mn(t,c,new st(n),h,i,o,a,s)}})),c}var Tn,En=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new de(r.getIndex()),o=(n=r).loadsAllData()?new de(n.getIndex()):n.hasLimit()?new ve(n):new pe(n);this.processor_=function(t){return{filter:t}}(o);var a=e.serverCache,s=e.eventCache,u=i.updateFullNode($t.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode($t.EMPTY_NODE,s.getNode(),null),l=new Le(u,a.isFullyInitialized(),i.filtersNodes()),h=new Le(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Ue(h,l),this.eventGenerator_=new Me(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function On(t,e){var n=Ke(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!gt(e)&&!n.getImmediateChild(ct(e)).isEmpty())?n.getChild(e):null}function Sn(t){return 0===t.eventRegistrations_.length}function Cn(t,e,n){var r=[];if(n){Object(i.assert)(null==e,"A cancel should cancel all event registrations.");var o=t.query._path;t.eventRegistrations_.forEach((function(t){var e=t.createCancelEvent(n,o);e&&r.push(e)}))}if(e){for(var a=[],s=0;s<t.eventRegistrations_.length;++s){var u=t.eventRegistrations_[s];if(u.matches(e)){if(e.hasAnyCallback()){a=a.concat(t.eventRegistrations_.slice(s+1));break}}else a.push(u)}t.eventRegistrations_=a}else t.eventRegistrations_=[];return r}function kn(t,e,n,r){e.type===Ae.MERGE&&null!==e.source.queryId&&(Object(i.assert)(Ke(t.viewCache_),"We should always have a full cache before handling merges"),Object(i.assert)(Be(t.viewCache_),"Missing event cache, even though we have a server cache"));var o,a,s=t.viewCache_,u=function(t,e,n,r,o){var a,s,u=new pn;if(n.type===Ae.OVERWRITE){var c=n;c.source.fromUser?a=_n(t,e,c.path,c.snap,r,o,u):(Object(i.assert)(c.source.fromServer,"Unknown source."),s=c.source.tagged||e.serverCache.isFiltered()&&!gt(c.path),a=mn(t,e,c.path,c.snap,r,o,s,u))}else if(n.type===Ae.MERGE){var l=n;l.source.fromUser?a=function(t,e,n,r,i,o,a){var s=e;return r.foreach((function(r,u){var c=vt(n,r);bn(e,ct(c))&&(s=_n(t,s,c,u,i,o,a))})),r.foreach((function(r,u){var c=vt(n,r);bn(e,ct(c))||(s=_n(t,s,c,u,i,o,a))})),s}(t,e,l.path,l.children,r,o,u):(Object(i.assert)(l.source.fromServer,"Unknown source."),s=l.source.tagged||e.serverCache.isFiltered(),a=In(t,e,l.path,l.children,r,o,s,u))}else if(n.type===Ae.ACK_USER_WRITE){var h=n;a=h.revert?function(t,e,n,r,o,a){var s;if(null!=ln(r,n))return e;var u=new gn(r,e,o),c=e.eventCache.getNode(),l=void 0;if(gt(n)||".priority"===ct(n)){var h=void 0;if(e.serverCache.isFullyInitialized())h=sn(r,Ke(e));else{var f=e.serverCache.getNode();Object(i.assert)(f instanceof $t,"serverChildren would be complete if leaf node"),h=un(r,f)}l=t.filter.updateFullNode(c,h=h,a)}else{var d=ct(n),p=hn(r,d,e.serverCache);null==p&&e.serverCache.isCompleteForChild(d)&&(p=c.getImmediateChild(d)),(l=null!=p?t.filter.updateChild(c,d,p,ht(n),u,a):e.eventCache.getNode().hasChild(d)?t.filter.updateChild(c,d,$t.EMPTY_NODE,ht(n),u,a):c).isEmpty()&&e.serverCache.isFullyInitialized()&&(s=sn(r,Ke(e))).isLeafNode()&&(l=t.filter.updateFullNode(l,s,a))}return s=e.serverCache.isFullyInitialized()||null!=ln(r,ut()),qe(e,l,s,t.filter.filtersNodes())}(t,e,h.path,r,o,u):function(t,e,n,r,i,o,a){if(null!=ln(i,n))return e;var s=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(gt(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return mn(t,e,n,u.getNode().getChild(n),i,o,s,a);if(gt(n)){var c=new We(null);return u.getNode().forEachChild(Pt,(function(t,e){c=c.set(new st(t),e)})),In(t,e,n,c,i,o,s,a)}return e}var l=new We(null);return r.foreach((function(t,e){var r=vt(n,t);u.isCompleteForPath(r)&&(l=l.set(t,u.getNode().getChild(r)))})),In(t,e,n,l,i,o,s,a)}(t,e,h.path,h.affectedTree,r,o,u)}else{if(n.type!==Ae.LISTEN_COMPLETE)throw Object(i.assertionError)("Unknown operation type: "+n.type);a=function(t,e,n,r,i){var o=e.serverCache;return yn(t,Ve(e,o.getNode(),o.isFullyInitialized()||gt(n),o.isFiltered()),n,r,vn,i)}(t,e,n.path,r,u)}var f=u.getChanges();return function(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Be(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(ce(Be(e)))}}(e,a,f),{viewCache:a,changes:f}}(t.processor_,s,e,n,r);return o=t.processor_,a=u.viewCache,Object(i.assert)(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),Object(i.assert)(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),Object(i.assert)(u.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=u.viewCache,An(t,u.changes,u.viewCache.eventCache.getNode(),null)}function An(t,e,n,r){return function(t,e,n,r){var i=[],o=[];return e.forEach((function(e){"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push({type:"child_moved",snapshotNode:e.snapshotNode,childName:e.childName})})),Fe(t,i,"child_removed",e,r,n),Fe(t,i,"child_added",e,r,n),Fe(t,i,"child_moved",o,r,n),Fe(t,i,"child_changed",e,r,n),Fe(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,r?[r]:t.eventRegistrations_)}var Nn,Pn=function(){return function(){this.views=new Map}}();function jn(t,e,n,r){var a,s,u=e.source.queryId;if(null!==u){var c=t.views.get(u);return Object(i.assert)(null!=c,"SyncTree gave us an op for an invalid query."),kn(c,e,n,r)}var l=[];try{for(var h=Object(o.__values)(t.views.values()),f=h.next();!f.done;f=h.next())l=l.concat(kn(c=f.value,e,n,r))}catch(d){a={error:d}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}return l}function Rn(t,e,n,r,i){var o=t.views.get(e._queryIdentifier);if(!o){var a=sn(n,i?r:null),s=!1;a?s=!0:r instanceof $t?(a=un(n,r),s=!1):(a=$t.EMPTY_NODE,s=!1);var u=Ue(new Le(a,s,!1),new Le(r,i,!1));return new En(e,u)}return o}function xn(t){var e,n,r=[];try{for(var i=Object(o.__values)(t.views.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.query._queryParams.loadsAllData()||r.push(s)}}catch(u){e={error:u}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Dn(t,e){var n,r,i=null;try{for(var a=Object(o.__values)(t.views.values()),s=a.next();!s.done;s=a.next())i=i||On(s.value,e)}catch(u){n={error:u}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function Ln(t,e){return e._queryParams.loadsAllData()?Un(t):t.views.get(e._queryIdentifier)}function Mn(t,e){return null!=Ln(t,e)}function Fn(t){return null!=Un(t)}function Un(t){var e,n;try{for(var r=Object(o.__values)(t.views.values()),i=r.next();!i.done;i=r.next()){var a=i.value;if(a.query._queryParams.loadsAllData())return a}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}var qn=1,Vn=function(){return function(t){this.listenProvider_=t,this.syncPointTree_=new We(null),this.pendingWriteTree_={visibleWrites:He.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}();function Bn(t,e,n,r,o){return function(t,e,n,r,o){Object(i.assert)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:o}),o&&(t.visibleWrites=Ge(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,o),o?Qn(t,new xe({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function Kn(t,e,n){void 0===n&&(n=!1);var r=function(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(function(t,e){var n=t.allWrites.findIndex((function(t){return t.writeId===e}));Object(i.assert)(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);for(var o=r.visible,a=!1,s=t.allWrites.length-1;o&&s>=0;){var u=t.allWrites[s];u.visible&&(s>=n&&nn(u,r.path)?o=!1:bt(r.path,u.path)&&(a=!0)),s--}return!!o&&(a?(function(t){t.visibleWrites=on(t.allWrites,rn,ut()),t.lastWriteId=t.allWrites.length>0?t.allWrites[t.allWrites.length-1].writeId:-1}(t),!0):(r.snap?t.visibleWrites=Qe(t.visibleWrites,r.path):D(r.children,(function(e){t.visibleWrites=Qe(t.visibleWrites,vt(r.path,e))})),!0))}(t.pendingWriteTree_,e)){var o=new We(null);return null!=r.snap?o=o.set(ut(),!0):D(r.children,(function(t){o=o.set(new st(t),!0)})),Qn(t,new je(r.path,o,n))}return[]}function Wn(t,e,n){return Qn(t,new xe({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function Hn(t,e,n,r){var a=e._path,s=t.syncPointTree_.get(a),u=[];if(s&&("default"===e._queryIdentifier||Mn(s,e))){var c=function(t,e,n,r){var a,s,u=e._queryIdentifier,c=[],l=[],h=Fn(t);if("default"===u)try{for(var f=Object(o.__values)(t.views.entries()),d=f.next();!d.done;d=f.next()){var p,v=Object(o.__read)(d.value,2),g=v[0];l=l.concat(Cn(p=v[1],n,r)),Sn(p)&&(t.views.delete(g),p.query._queryParams.loadsAllData()||c.push(p.query))}}catch(y){a={error:y}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}else(p=t.views.get(u))&&(l=l.concat(Cn(p,n,r)),Sn(p)&&(t.views.delete(u),p.query._queryParams.loadsAllData()||c.push(p.query)));return h&&!Fn(t)&&c.push(new(Object(i.assert)(Tn,"Reference.ts has not been loaded"),Tn)(e._repo,e._path)),{removed:c,events:l}}(s,e,n,r);0===s.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(a));var l=c.removed;u=c.events;var h=-1!==l.findIndex((function(t){return t._queryParams.loadsAllData()})),f=t.syncPointTree_.findOnPath(a,(function(t,e){return Fn(e)}));if(h&&!f){var d=t.syncPointTree_.subtree(a);if(!d.isEmpty())for(var p=function(t){return t.fold((function(t,e,n){if(e&&Fn(e))return[Un(e)];var r=[];return e&&(r=xn(e)),D(n,(function(t,e){r=r.concat(e)})),r}))}(d),v=0;v<p.length;++v){var g=p[v],y=g.query,m=Yn(t,g);t.listenProvider_.startListening(er(y),Xn(t,y),m.hashFn,m.onComplete)}}!f&&l.length>0&&!r&&(h?t.listenProvider_.stopListening(er(e),null):l.forEach((function(e){var n=t.queryToTagMap.get(Jn(e));t.listenProvider_.stopListening(er(e),n)}))),function(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var i=Jn(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,l)}return u}function Gn(t,e,n){var r=e._path,o=null,a=!1;t.syncPointTree_.foreachOnPath(r,(function(t,e){var n=yt(t,r);o=o||Dn(e,n),a=a||Fn(e)}));var s,u=t.syncPointTree_.get(r);u?(a=a||Fn(u),o=o||Dn(u,ut())):(u=new Pn,t.syncPointTree_=t.syncPointTree_.set(r,u)),null!=o?s=!0:(s=!1,o=$t.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=Dn(e,ut());n&&(o=o.updateImmediateChild(t,n))})));var c=Mn(u,e);if(!c&&!e._queryParams.loadsAllData()){var l=Jn(e);Object(i.assert)(!t.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=qn++;t.queryToTagMap.set(l,h),t.tagToQueryMap.set(h,l)}var f=function(t,e,n,r,i,o){var a=Rn(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),function(t,e){t.eventRegistrations_.push(e)}(a,n),function(t,e){var n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Gt,(function(t,e){r.push(le(t,e))})),n.isFullyInitialized()&&r.push(ce(n.getNode())),An(t,r,n.getNode(),e)}(a,n)}(u,e,n,en(t.pendingWriteTree_,r),o,s);if(!c&&!a){var d=Ln(u,e);f=f.concat(function(t,e,n){var r=e._path,o=Xn(t,e),a=Yn(t,n),s=t.listenProvider_.startListening(er(e),o,a.hashFn,a.onComplete),u=t.syncPointTree_.subtree(r);if(o)Object(i.assert)(!Fn(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!gt(t)&&e&&Fn(e))return[Un(e).query];var r=[];return e&&(r=r.concat(xn(e).map((function(t){return t.query})))),D(n,(function(t,e){r=r.concat(e)})),r})),l=0;l<c.length;++l){var h=c[l];t.listenProvider_.stopListening(er(h),Xn(t,h))}return s}(t,e,d))}return f}function zn(t,e,n){var r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(function(t,n){var r=Dn(n,yt(t,e));if(r)return r}));return an(r,e,i,n,!0)}function Qn(t,e){return function t(e,n,r,i){if(gt(e.path))return function t(e,n,r,i){var o=n.get(ut());null==r&&null!=o&&(r=Dn(o,ut()));var a=[];return n.children.inorderTraversal((function(n,o){var s=r?r.getImmediateChild(n):null,u=fn(i,n),c=e.operationForChild(n);c&&(a=a.concat(t(c,o,s,u)))})),o&&(a=a.concat(jn(o,e,i,r))),a}(e,n,r,i);var o=n.get(ut());null==r&&null!=o&&(r=Dn(o,ut()));var a=[],s=ct(e.path),u=e.operationForChild(s),c=n.children.get(s);if(c&&u){var l=r?r.getImmediateChild(s):null,h=fn(i,s);a=a.concat(t(u,c,l,h))}return o&&(a=a.concat(jn(o,e,i,r))),a}(e,t.syncPointTree_,null,en(t.pendingWriteTree_,ut()))}function Yn(t,e){var n=e.query,r=Xn(t,n);return{hashFn:function(){return(function(t){return t.viewCache_.serverCache.getNode()}(e)||$t.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?function(t,e,n){var r=$n(t,n);if(r){var i=Zn(r),o=i.path,a=i.queryId,s=yt(o,e);return tr(t,o,new Re(Ne(a),s))}return[]}(t,n._path,r):function(t,e){return Qn(t,new Re({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(e,n);return Hn(t,n,null,i)}}}function Xn(t,e){var n=Jn(e);return t.queryToTagMap.get(n)}function Jn(t){return t._path.toString()+"$"+t._queryIdentifier}function $n(t,e){return t.tagToQueryMap.get(e)}function Zn(t){var e=t.indexOf("$");return Object(i.assert)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new st(t.substr(0,e))}}function tr(t,e,n){var r=t.syncPointTree_.get(e);return Object(i.assert)(r,"Missing sync point for query tag that we're tracking"),jn(r,n,en(t.pendingWriteTree_,e),null)}function er(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Object(i.assert)(Nn,"Reference.ts has not been loaded"),Nn)(t._repo,t._path):t}var nr=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),rr=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=vt(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return zn(this.syncTree_,this.path_)},t}(),ir=function(t,e,n){return t&&"object"==typeof t?(Object(i.assert)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?or(t[".sv"],e,n):"object"==typeof t[".sv"]?ar(t[".sv"],e):void Object(i.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},or=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:Object(i.assert)(!1,"Unexpected server value: "+t)}},ar=function(t,e,n){t.hasOwnProperty("increment")||Object(i.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&Object(i.assert)(!1,"Unexpected increment value: "+r);var o=e.node();if(Object(i.assert)(null!=o,"Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;var a=o.getValue();return"number"!=typeof a?r:a+r},sr=function(t,e,n,r){return cr(e,new rr(n,t),r)},ur=function(t,e,n){return cr(t,new nr(e),n)};function cr(t,e,n){var r,i=t.getPriority().val(),o=ir(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var a=t,s=ir(a.getValue(),e,n);return s!==a.getValue()||o!==a.getPriority().val()?new Ht(s,te(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Ht(o))),u.forEachChild(Gt,(function(t,i){var o=cr(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var lr=function(){return function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n}}();function hr(t,e){for(var n=e instanceof st?e:new st(e),r=t,o=ct(n);null!==o;){var a=Object(i.safeGet)(r.node.children,o)||{children:{},childCount:0};r=new lr(o,r,a),o=ct(n=ht(n))}return r}function fr(t){return t.node.value}function dr(t,e){t.node.value=e,function t(e){null!==e.parent&&function(e,n,r){var o=function(t){return void 0===fr(t)&&!pr(t)}(r),a=Object(i.contains)(e.node.children,n);o&&a?(delete e.node.children[n],e.node.childCount--,t(e)):o||a||(e.node.children[n]=r.node,e.node.childCount++,t(e))}(e.parent,e.name,e)}(t)}function pr(t){return t.node.childCount>0}function vr(t,e){D(t.node.children,(function(n,r){e(new lr(n,t,r))}))}function gr(t){return new st(null===t.parent?t.name:gr(t.parent)+"/"+t.name)}var yr=/[\[\].#$\/\u0000-\u001F\u007F]/,mr=/[\[\].#$\u0000-\u001F\u007F]/,_r=function(t){return"string"==typeof t&&0!==t.length&&!yr.test(t)},br=function(t){return"string"==typeof t&&0!==t.length&&!mr.test(t)},wr=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!C(t)||t&&"object"==typeof t&&Object(i.contains)(t,".sv")},Ir=function(t,e,n,r){r&&void 0===e||Tr(Object(i.errorPrefix)(t,"value"),e,n)},Tr=function(t,e,n){var r=n instanceof st?new wt(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+Tt(r));if("function"==typeof e)throw new Error(t+"contains a function "+Tt(r)+" with contents = "+e.toString());if(C(e))throw new Error(t+"contains "+e.toString()+" "+Tt(r));if("string"==typeof e&&e.length>10485760/3&&Object(i.stringLength)(e)>10485760)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+Tt(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var o=!1,a=!1;if(D(e,(function(e,n){if(".value"===e)o=!0;else if(".priority"!==e&&".sv"!==e&&(a=!0,!_r(e)))throw new Error(t+" contains an invalid key ("+e+") "+Tt(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var s,u;!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Object(i.stringLength)(e),It(t)}(r,e),Tr(t,n,r),u=(s=r).parts_.pop(),s.byteLength_-=Object(i.stringLength)(u),s.parts_.length>0&&(s.byteLength_-=1)})),o&&a)throw new Error(t+' contains ".value" child '+Tt(r)+" in addition to actual children.")}},Er=function(t,e,n,r){if(!r||void 0!==e){var o=Object(i.errorPrefix)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(o+" must be an object containing the children to replace.");var a=[];D(e,(function(t,e){var r=new st(t);if(Tr(o,e,vt(n,r)),".priority"===ft(r)&&!wr(e))throw new Error(o+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=dt(r=e[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!_r(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(mt);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&bt(a,r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(o,a)}},Or=function(t,e,n){if(!n||void 0!==e){if(C(e))throw new Error(Object(i.errorPrefix)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!wr(e))throw new Error(Object(i.errorPrefix)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Sr=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(i.errorPrefix)(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Cr=function(t,e,n,r){if(!(r&&void 0===n||_r(n)))throw new Error(Object(i.errorPrefix)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},kr=function(t,e,n,r){if(!(r&&void 0===n||br(n)))throw new Error(Object(i.errorPrefix)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ar=function(t,e){if(".info"===ct(e))throw new Error(t+" failed = Can't modify data under /.info/")},Nr=function(t,e){var n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!_r(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),br(t)}(n))throw new Error(Object(i.errorPrefix)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Pr=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Object(i.errorPrefix)(t,e)+"must be a boolean.")},jr=function(){return function(){this.eventLists_=[],this.recursionDepth_=0}}();function Rr(t,e){for(var n=null,r=0;r<e.length;r++){var i=e[r],o=i.getPath();null===n||_t(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function xr(t,e,n){Rr(t,n),Lr(t,(function(t){return _t(t,e)}))}function Dr(t,e,n){Rr(t,n),Lr(t,(function(t){return bt(t,e)||bt(e,t)}))}function Lr(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var i=t.eventLists_[r];i&&(e(i.path)?(Mr(t.eventLists_[r]),t.eventLists_[r]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function Mr(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var r=n.getEventRunner();_&&I("event: "+n.toString()),U(r)}}}var Fr=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new jr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ee(),this.transactionQueueTree_=new lr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function Ur(t){var e=t.infoData_.getNode(new st(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function qr(t){return(e=(e={timestamp:Ur(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function Vr(t,e,n,r,o){t.dataUpdateCount++;var a=new st(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var s=[];if(o)if(r){var u=Object(i.map)(n,(function(t){return te(t)}));s=function(t,e,n,r){var i=$n(t,r);if(i){var o=Zn(i),a=o.path,s=o.queryId,u=yt(a,e),c=We.fromObject(n);return tr(t,a,new De(Ne(s),u,c))}return[]}(t.serverSyncTree_,a,u,o)}else{var c=te(n);s=function(t,e,n,r){var i=$n(t,r);if(null!=i){var o=Zn(i),a=o.path,s=o.queryId,u=yt(a,e);return tr(t,a,new xe(Ne(s),u,n))}return[]}(t.serverSyncTree_,a,c,o)}else if(r){var l=Object(i.map)(n,(function(t){return te(t)}));s=function(t,e,n){var r=We.fromObject(n);return Qn(t,new De({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,a,l)}else{var h=te(n);s=Wn(t.serverSyncTree_,a,h)}var f=a;s.length>0&&(f=Zr(t,a)),Dr(t.eventQueue_,f,s)}function Br(t,e){Kr(t,"connected",e),!1===e&&function(t){Yr(t,"onDisconnectEvents");var e=qr(t),n=Ee();Se(t.onDisconnect_,ut(),(function(r,i){var o=sr(r,i,t.serverSyncTree_,e);Oe(n,r,o)}));var r=[];Se(n,ut(),(function(e,n){r=r.concat(Wn(t.serverSyncTree_,e,n));var i=ri(t,e);Zr(t,i)})),t.onDisconnect_=Ee(),Dr(t.eventQueue_,ut(),r)}(t)}function Kr(t,e,n){var r=new st("/.info/"+e),i=te(n);t.infoData_.updateSnapshot(r,i);var o=Wn(t.infoSyncTree_,r,i);Dr(t.eventQueue_,r,o)}function Wr(t){return t.nextWriteId_++}function Hr(t,e,n,r,i){Yr(t,"set",{path:e.toString(),value:n,priority:r});var o=qr(t),a=te(n,r),s=zn(t.serverSyncTree_,e),u=ur(a,s,o),c=Wr(t),l=Bn(t.serverSyncTree_,e,u,c,!0);Rr(t.eventQueue_,l),t.server_.put(e.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||S("set at "+e+" failed: "+n);var a=Kn(t.serverSyncTree_,c,!o);Dr(t.eventQueue_,e,a),Xr(0,i,n,r)}));var h=ri(t,e);Zr(t,h),Dr(t.eventQueue_,h,[])}function Gr(t,e,n,r){var i=te(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(function(n,o){"ok"===n&&Oe(t.onDisconnect_,e,i),Xr(0,r,n,o)}))}function zr(t,e,n){var r;r=".info"===ct(e._path)?Hn(t.infoSyncTree_,e,n):Hn(t.serverSyncTree_,e,n),xr(t.eventQueue_,e._path,r)}function Qr(t){t.persistentConnection_&&t.persistentConnection_.interrupt("repo_interrupt")}function Yr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),I.apply(void 0,Object(o.__spreadArray)([r],Object(o.__read)(e)))}function Xr(t,e,n,r){e&&U((function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),i=t;r&&(i+=": "+r);var o=new Error(i);o.code=t,e(o)}}))}function Jr(t,e,n){return zn(t.serverSyncTree_,e,n)||$t.EMPTY_NODE}function $r(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||ni(t,e),fr(e)){var n=ei(t,e);Object(i.assert)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return 0===t.status}))&&function(t,e,n){for(var r=n.map((function(t){return t.currentWriteId})),o=Jr(t,e,r),a=o,s=o.hash(),u=0;u<n.length;u++){var c=n[u];Object(i.assert)(0===c.status,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;var l=yt(e,c.path);a=a.updateChild(l,c.currentOutputSnapshotRaw)}var h=a.val(!0),f=e;t.server_.put(f.toString(),h,(function(r){Yr(t,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(e){n[e].status=2,i=i.concat(Kn(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&o.push((function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)})),n[e].unwatcher()},s=0;s<n.length;s++)a(s);for(ni(t,hr(t.transactionQueueTree_,e)),$r(t,t.transactionQueueTree_),Dr(t.eventQueue_,e,i),s=0;s<o.length;s++)U(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)n[s].status=3===n[s].status?4:0;else for(S("transaction at "+f.toString()+" failed: "+r),s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r;Zr(t,e)}}),s)}(t,gr(e),n)}else pr(e)&&vr(e,(function(e){$r(t,e)}))}function Zr(t,e){var n=ti(t,e),r=gr(n);return function(t,e,n){if(0!==e.length){for(var r=[],o=[],a=e.filter((function(t){return 0===t.status})).map((function(t){return t.currentWriteId})),s=function(s){var u,c=e[s],l=yt(n,c.path),h=!1;if(Object(i.assert)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,u=c.abortReason,o=o.concat(Kn(t.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)h=!0,u="maxretry",o=o.concat(Kn(t.serverSyncTree_,c.currentWriteId,!0));else{var f=Jr(t,c.path,a);c.currentInputSnapshot=f;var d=e[s].update(f.val());if(void 0!==d){Tr("transaction failed: Data returned ",d,c.path);var p=te(d);"object"==typeof d&&null!=d&&Object(i.contains)(d,".priority")||(p=p.updatePriority(f.getPriority()));var v=c.currentWriteId,g=qr(t),y=ur(p,f,g);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=y,c.currentWriteId=Wr(t),a.splice(a.indexOf(v),1),o=(o=o.concat(Bn(t.serverSyncTree_,c.path,y,c.currentWriteId,c.applyLocally))).concat(Kn(t.serverSyncTree_,v,!0))}else h=!0,u="nodata",o=o.concat(Kn(t.serverSyncTree_,c.currentWriteId,!0))}Dr(t.eventQueue_,n,o),o=[],h&&(e[s].status=2,setTimeout(e[s].unwatcher,Math.floor(0)),e[s].onComplete&&r.push("nodata"===u?function(){return e[s].onComplete(null,!1,e[s].currentInputSnapshot)}:function(){return e[s].onComplete(new Error(u),!1,null)}))},u=0;u<e.length;u++)s(u);for(ni(t,t.transactionQueueTree_),u=0;u<r.length;u++)U(r[u]);$r(t,t.transactionQueueTree_)}}(t,ei(t,n),r),r}function ti(t,e){var n,r=t.transactionQueueTree_;for(n=ct(e);null!==n&&void 0===fr(r);)r=hr(r,n),n=ct(e=ht(e));return r}function ei(t,e){var n=[];return function t(e,n,r){var i=fr(n);if(i)for(var o=0;o<i.length;o++)r.push(i[o]);vr(n,(function(n){t(e,n,r)}))}(t,e,n),n.sort((function(t,e){return t.order-e.order})),n}function ni(t,e){var n=fr(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,dr(e,n.length>0?n:void 0)}vr(e,(function(e){ni(t,e)}))}function ri(t,e){var n=gr(ti(t,e)),r=hr(t.transactionQueueTree_,e);return function(t,e,n){for(var r=t.parent;null!==r;){if(e(r))return!0;r=r.parent}}(r,(function(e){ii(t,e)})),ii(t,r),function t(e,n,r,i){r&&!i&&n(e),vr(e,(function(e){t(e,n,!0,i)})),r&&i&&n(e)}(r,(function(e){ii(t,e)})),n}function ii(t,e){var n=fr(e);if(n){for(var r=[],o=[],a=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?(Object(i.assert)(a===s-1,"All SENT items should be at beginning of queue."),a=s,n[s].status=3,n[s].abortReason="set"):(Object(i.assert)(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),o=o.concat(Kn(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));for(-1===a?dr(e,void 0):n.length=a+1,Dr(t.eventQueue_,gr(e),o),s=0;s<r.length;s++)U(r[s])}}var oi=function(t,e){var n=ai(t),r=n.namespace;return"firebase.com"===n.domain&&O(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||O("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&S("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new H(n.host,n.secure,r,e,"ws"===n.scheme||"wss"===n.scheme,"",r!==n.subdomain),path:new st(n.pathString)}},ai=function(t){var e="",n="",r="",i="",a="",s=!0,u="https",c=443;if("string"==typeof t){var l=t.indexOf("//");l>=0&&(u=t.substring(0,l-1),t=t.substring(l+2));var h=t.indexOf("/");-1===h&&(h=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}e+="/"+i}return e}(t.substring(h,f)));var d=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=Object(o.__values)(t.split("&")),a=i.next();!a.done;a=i.next()){var s=a.value;if(0!==s.length){var u=s.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):S("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(l=e.indexOf(":"))>=0?(s="https"===u||"wss"===u,c=parseInt(e.substring(l+1),10)):l=e.length;var p=e.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),a=r}"ns"in d&&(a=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:s,scheme:u,pathString:i,namespace:a}},si=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Object(i.stringify)(this.snapshot.exportVal())},t}(),ui=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),ci=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return Object(i.assert)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),li=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t,e,n,r=new i.Deferred;return t=this._repo,e=this._path,n=r.wrapCallback((function(){})),t.server_.onDisconnectCancel(e.toString(),(function(r,i){"ok"===r&&function t(e,n){if(gt(n))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var r=e.value;return e.value=null,r.forEachChild(Gt,(function(t,n){Oe(e,new st(t),n)})),t(e,n)}if(e.children.size>0){var i=ct(n);return n=ht(n),e.children.has(i)&&t(e.children.get(i),n)&&e.children.delete(i),0===e.children.size}return!0}(t.onDisconnect_,e),Xr(0,n,r,i)})),r.promise},t.prototype.remove=function(){Ar("OnDisconnect.remove",this._path);var t=new i.Deferred;return Gr(this._repo,this._path,null,t.wrapCallback((function(){}))),t.promise},t.prototype.set=function(t){Ar("OnDisconnect.set",this._path),Ir("OnDisconnect.set",t,this._path,!1);var e=new i.Deferred;return Gr(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t.prototype.setWithPriority=function(t,e){Ar("OnDisconnect.setWithPriority",this._path),Ir("OnDisconnect.setWithPriority",t,this._path,!1),Or("OnDisconnect.setWithPriority",e,!1);var n=new i.Deferred;return function(t,e,n,r,i){var o=te(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(function(n,r){"ok"===n&&Oe(t.onDisconnect_,e,o),Xr(0,i,n,r)}))}(this._repo,this._path,t,e,n.wrapCallback((function(){}))),n.promise},t.prototype.update=function(t){Ar("OnDisconnect.update",this._path),Er("OnDisconnect.update",t,this._path,!1);var e=new i.Deferred;return function(t,e,n,r){if(Object(i.isEmpty)(n))return I("onDisconnect().update() called with empty data.  Don't do anything."),void Xr(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(function(i,o){"ok"===i&&D(n,(function(n,r){var i=te(r);Oe(t.onDisconnect_,vt(e,n),i)})),Xr(0,r,i,o)}))}(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t}(),hi=function(){function t(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(t.prototype,"key",{get:function(){return gt(this._path)?null:ft(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new vi(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=we(this._queryParams),e=R(t);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return we(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!((e=Object(i.getModularInstance)(e))instanceof t))return!1;var n=this._repo===e._repo,r=_t(this._path,e._path);return n&&r&&this._queryIdentifier===e._queryIdentifier},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+function(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)},t}();function fi(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function di(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Pt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",o="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==k)throw new Error(r);if("string"!=typeof e)throw new Error(o)}if(t.hasEnd()){if(t.getIndexEndName()!==A)throw new Error(r);if("string"!=typeof n)throw new Error(o)}}else if(t.getIndex()===Gt){if(null!=e&&!wr(e)||null!=n&&!wr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(i.assert)(t.getIndex()instanceof re||t.getIndex()===ie,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function pi(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var vi=function(t){function e(e,n){return t.call(this,e,n,new ge,!1)||this}return Object(o.__extends)(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=pt(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(hi),gi=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new st(e),r=_i(this.ref,e);return new t(this._node.getChild(n),r,Gt)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return e(new t(i,_i(n.ref,r),Gt))}))},t.prototype.hasChild=function(t){var e=new st(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function yi(t,e){return(t=Object(i.getModularInstance)(t))._checkNotDeleted("ref"),void 0!==e?_i(t._root,e):t._root}function mi(t,e){(t=Object(i.getModularInstance)(t))._checkNotDeleted("refFromURL");var n=oi(e,t._repo.repoInfo_.nodeAdmin);Nr("refFromURL",n);var r=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||r.host===t._repo.repoInfo_.host||O("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),yi(t,n.path.toString())}function _i(t,e){var n;return null===ct((t=Object(i.getModularInstance)(t))._path)?((n=e)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),kr("child","path",n,!1)):kr("child","path",e,!1),new vi(t._repo,vt(t._path,e))}function bi(t,e){t=Object(i.getModularInstance)(t),Ar("push",t._path),Ir("push",e,t._path,!0);var n,r=Ur(t._repo),o=ae(r),a=_i(t,o),s=_i(t,o);return n=null!=e?Ii(s,e).then((function(){return s})):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function wi(t){return Ar("remove",t._path),Ii(t,null)}function Ii(t,e){t=Object(i.getModularInstance)(t),Ar("set",t._path),Ir("set",e,t._path,!1);var n=new i.Deferred;return Hr(t._repo,t._path,e,null,n.wrapCallback((function(){}))),n.promise}function Ti(t,e){t=Object(i.getModularInstance)(t),Ar("setPriority",t._path),Or("setPriority",e,!1);var n=new i.Deferred;return Hr(t._repo,vt(t._path,".priority"),e,null,n.wrapCallback((function(){}))),n.promise}function Ei(t,e,n){if(Ar("setWithPriority",t._path),Ir("setWithPriority",e,t._path,!1),Or("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new i.Deferred;return Hr(t._repo,t._path,e,n,r.wrapCallback((function(){}))),r.promise}function Oi(t,e){Er("update",e,t._path,!1);var n=new i.Deferred;return function(t,e,n,r){Yr(t,"update",{path:e.toString(),value:n});var o=!0,a=qr(t),s={};if(D(n,(function(n,r){o=!1,s[n]=sr(vt(e,n),te(r),t.serverSyncTree_,a)})),o)I("update() called with empty data.  Don't do anything."),Xr(0,r,"ok",void 0);else{var u=Wr(t),c=function(t,e,n,r){!function(t,e,n,r){Object(i.assert)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=ze(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);var o=We.fromObject(n);return Qn(t,new De({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,o))}(t.serverSyncTree_,e,s,u);Rr(t.eventQueue_,c),t.server_.merge(e.toString(),n,(function(n,i){var o="ok"===n;o||S("update at "+e+" failed: "+n);var a=Kn(t.serverSyncTree_,u,!o),s=a.length>0?Zr(t,e):e;Dr(t.eventQueue_,s,a),Xr(0,r,n,i)})),D(n,(function(n){var r=ri(t,vt(e,n));Zr(t,r)})),Dr(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback((function(){}))),n.promise}var Si=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new si("value",this,new gi(t.snapshotNode,new vi(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new ui(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),Ci=function(){function t(t,e){this.eventType=t,this.callbackContext=e}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return this.eventType===("children_removed"===e?"child_removed":e)},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new ui(this,t,e):null},t.prototype.createEvent=function(t,e){Object(i.assert)(null!=t.childName,"Child events should have a childName.");var n=_i(new vi(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new si(t.type,this,new gi(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){return e instanceof t&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function ki(t,e,n,r,i){var o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(e,n){zr(t._repo,t,c),a(e,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new ci(n,o||void 0),c="value"===e?new Si(u):new Ci(e,u);return function(t,e,n){var r;r=".info"===ct(e._path)?Gn(t.infoSyncTree_,e,n):Gn(t.serverSyncTree_,e,n),xr(t.eventQueue_,e._path,r)}(t._repo,t,c),function(){return zr(t._repo,t,c)}}function Ai(t,e,n,r){return ki(t,"value",e,n,r)}function Ni(t,e,n,r){return ki(t,"child_added",e,n,r)}function Pi(t,e,n,r){return ki(t,"child_changed",e,n,r)}function ji(t,e,n,r){return ki(t,"child_moved",e,n,r)}function Ri(t,e,n,r){return ki(t,"child_removed",e,n,r)}function xi(t,e,n){var r=null,i=n?new ci(n):null;"value"===e?r=new Si(i):e&&(r=new Ci(e,i)),zr(t._repo,t,r)}var Di=function(){return function(){}}(),Li=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return Object(o.__extends)(e,t),e.prototype._apply=function(t){Ir("endAt",this._value,t._path,!0);var e=me(t._queryParams,this._value,this._key);if(pi(e),di(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new hi(t._repo,t._path,e,t._orderByCalled)},e}(Di);function Mi(t,e){return Cr("endAt","key",e,!0),new Li(t,e)}var Fi=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return Object(o.__extends)(e,t),e.prototype._apply=function(t){Ir("endBefore",this._value,t._path,!1);var e,n,r,i,o=(n=this._value,r=this._key,(e=t._queryParams).index_===Pt?("string"==typeof n&&(n=ue(n)),i=me(e,n,r)):i=me(e,n,null==r?k:ue(r)),i.endBeforeSet_=!0,i);if(pi(o),di(o),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new hi(t._repo,t._path,o,t._orderByCalled)},e}(Di);function Ui(t,e){return Cr("endBefore","key",e,!0),new Fi(t,e)}var qi=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return Object(o.__extends)(e,t),e.prototype._apply=function(t){Ir("startAt",this._value,t._path,!0);var e=ye(t._queryParams,this._value,this._key);if(pi(e),di(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new hi(t._repo,t._path,e,t._orderByCalled)},e}(Di);function Vi(t,e){return void 0===t&&(t=null),Cr("startAt","key",e,!0),new qi(t,e)}var Bi=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return Object(o.__extends)(e,t),e.prototype._apply=function(t){Ir("startAfter",this._value,t._path,!1);var e,n,r,i,o=(n=this._value,r=this._key,(e=t._queryParams).index_===Pt?("string"==typeof n&&(n=se(n)),i=ye(e,n,r)):i=ye(e,n,null==r?A:se(r)),i.startAfterSet_=!0,i);if(pi(o),di(o),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new hi(t._repo,t._path,o,t._orderByCalled)},e}(Di);function Ki(t,e){return Cr("startAfter","key",e,!0),new Bi(t,e)}var Wi=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return Object(o.__extends)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new hi(t._repo,t._path,(e=this._limit,(n=t._queryParams.copy()).limitSet_=!0,n.limit_=e,n.viewFrom_="l",n),t._orderByCalled);var e,n},e}(Di);function Hi(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Wi(t)}var Gi=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return Object(o.__extends)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new hi(t._repo,t._path,(e=this._limit,(n=t._queryParams.copy()).limitSet_=!0,n.limit_=e,n.viewFrom_="r",n),t._orderByCalled);var e,n},e}(Di);function zi(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Gi(t)}var Qi=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return Object(o.__extends)(e,t),e.prototype._apply=function(t){fi(t,"orderByChild");var e=new st(this._path);if(gt(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new re(e),r=_e(t._queryParams,n);return di(r),new hi(t._repo,t._path,r,!0)},e}(Di);function Yi(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return kr("orderByChild","path",t,!1),new Qi(t)}var Xi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(o.__extends)(e,t),e.prototype._apply=function(t){fi(t,"orderByKey");var e=_e(t._queryParams,Pt);return di(e),new hi(t._repo,t._path,e,!0)},e}(Di);function Ji(){return new Xi}var $i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(o.__extends)(e,t),e.prototype._apply=function(t){fi(t,"orderByPriority");var e=_e(t._queryParams,Gt);return di(e),new hi(t._repo,t._path,e,!0)},e}(Di);function Zi(){return new $i}var to=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(o.__extends)(e,t),e.prototype._apply=function(t){fi(t,"orderByValue");var e=_e(t._queryParams,ie);return di(e),new hi(t._repo,t._path,e,!0)},e}(Di);function eo(){return new to}var no=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return Object(o.__extends)(e,t),e.prototype._apply=function(t){if(Ir("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Li(this._value,this._key)._apply(new qi(this._value,this._key)._apply(t))},e}(Di);function ro(t,e){return Cr("equalTo","key",e,!0),new no(t,e)}function io(t){for(var e,n,r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];var s=Object(i.getModularInstance)(t);try{for(var u=Object(o.__values)(r),c=u.next();!c.done;c=u.next()){var l=c.value;s=l._apply(s)}}catch(h){e={error:h}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return s}!function(t){Object(i.assert)(!Tn,"__referenceConstructor has already been defined"),Tn=t}(vi),function(t){Object(i.assert)(!Nn,"__referenceConstructor has already been defined"),Nn=t}(vi);var oo={},ao=!1;function so(t,e,n,r,i){var o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||O("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),I("Using default host for project ",t.options.projectId),o=t.options.projectId+"-default-rtdb.firebaseio.com");var a,s=oi(o,i),u=s.repoInfo,c=void 0;"undefined"!=typeof process&&(c=process.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(a=!0,u=(s=oi(o="http://"+c+"?ns="+u.namespace,i)).repoInfo):a=!s.repoInfo.secure;var l=i&&a?new K(K.OWNER):new B(t.name,t.options,e);Nr("Invalid Firebase Database URL",s),gt(s.path)||O("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(t,e,n,r){var i=oo[e.name];i||(oo[e.name]=i={});var o=i[t.toURLString()];return o&&O("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Fr(t,ao,n,r),i[t.toURLString()]=o,o}(u,t,l,new V(t.name,n));return new uo(h,t)}var uo=function(){function t(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(function(t,e,n){if(t.stats_=X(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new Ie(t.repoInfo_,(function(e,n,r,i){Vr(t,e,n,r,i)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((function(){return Br(t,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(i.stringify)(n)}catch(a){throw new Error("Invalid authOverride provided: "+a)}}t.persistentConnection_=new Ct(t.repoInfo_,e,(function(e,n,r,i){Vr(t,e,n,r,i)}),(function(e){Br(t,e)}),(function(e){!function(t,e){D(e,(function(e,n){Kr(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}var r,o;t.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((function(e){t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=(r=function(){return new ke(t.stats_,t.server_)},o=t.repoInfo_.toString(),Y[o]||(Y[o]=r()),Y[o]),t.infoData_=new Te,t.infoSyncTree_=new Vn({startListening:function(e,n,r,i){var o=[],a=t.infoData_.getNode(e._path);return a.isEmpty()||(o=Wn(t.infoSyncTree_,e._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),Kr(t,"connected",!1),t.serverSyncTree_=new Vn({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);Dr(t.eventQueue_,e._path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new vi(this._repo,ut())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){var t,e,n;return this._checkNotDeleted("delete"),t=this._repo,(n=oo[e=this.app.name])&&n[t.key]===t||O("Database "+e+"("+t.repoInfo_+") has already been deleted."),Qr(t),delete n[t.key],this._repoInternal=null,this._rootInternal=null,Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&O("Cannot call "+t+" on a deleted database.")},t}();function co(t){(t=Object(i.getModularInstance)(t))._checkNotDeleted("goOffline"),Qr(t._repo)}function lo(t){var e;(t=Object(i.getModularInstance)(t))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume("repo_interrupt")}var ho={".sv":"timestamp"},fo=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function po(t,e,n){var r;if(t=Object(i.getModularInstance)(t),Ar("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var o=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,a=new i.Deferred,s=Ai(t,(function(){}));return function(e,n,r,o,s,u){Yr(e,"transaction on "+n);var c={path:n,update:r,onComplete:function(e,n,r){var i=null;e?a.reject(e):(i=new gi(r,new vi(t._repo,t._path),Gt),a.resolve(new fo(n,i)))},status:null,order:g(),applyLocally:u,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=Jr(e,n,void 0);c.currentInputSnapshot=l;var h=c.update(l.val());if(void 0===h)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Tr("transaction failed: Data returned ",h,c.path),c.status=0;var f=hr(e.transactionQueueTree_,n),d=fr(f)||[];d.push(c),dr(f,d);var p=void 0;"object"==typeof h&&null!==h&&Object(i.contains)(h,".priority")?(p=Object(i.safeGet)(h,".priority"),Object(i.assert)(wr(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(zn(e.serverSyncTree_,n)||$t.EMPTY_NODE).getPriority().val();var v=qr(e),y=te(h,p),m=ur(y,l,v);c.currentOutputSnapshotRaw=y,c.currentOutputSnapshotResolved=m,c.currentWriteId=Wr(e);var _=Bn(e.serverSyncTree_,n,m,c.currentWriteId,c.applyLocally);Dr(e.eventQueue_,n,_),$r(e,e.transactionQueueTree_)}}(t._repo,t._path,e,0,s,o),a.promise}var vo=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){Object(i.validateArgCount)("OnDisconnect.cancel",0,1,arguments.length),Object(i.validateCallback)("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.remove=function(t){Object(i.validateArgCount)("OnDisconnect.remove",0,1,arguments.length),Object(i.validateCallback)("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.set=function(t,e){Object(i.validateArgCount)("OnDisconnect.set",1,2,arguments.length),Object(i.validateCallback)("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},t.prototype.setWithPriority=function(t,e,n){Object(i.validateArgCount)("OnDisconnect.setWithPriority",2,3,arguments.length),Object(i.validateCallback)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},t.prototype.update=function(t,e){if(Object(i.validateArgCount)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,S("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Object(i.validateCallback)("OnDisconnect.update","onComplete",e,!0);var o=this._delegate.update(t);return e&&o.then((function(){return e(null)}),(function(t){return e(t)})),o},t}(),go=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return Object(i.validateArgCount)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),yo=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return Object(i.validateArgCount)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return Object(i.validateArgCount)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return Object(i.validateArgCount)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return Object(i.validateArgCount)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return Object(i.validateArgCount)("DataSnapshot.child",0,1,arguments.length),e=String(e),kr("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return Object(i.validateArgCount)("DataSnapshot.hasChild",1,1,arguments.length),kr("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return Object(i.validateArgCount)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return Object(i.validateArgCount)("DataSnapshot.forEach",1,1,arguments.length),Object(i.validateCallback)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((function(r){return e(new t(n._database,r))}))},t.prototype.hasChildren=function(){return Object(i.validateArgCount)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return Object(i.validateArgCount)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return Object(i.validateArgCount)("DataSnapshot.ref",0,0,arguments.length),new _o(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),mo=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,r,o){var a,s=this;Object(i.validateArgCount)("Query.on",2,4,arguments.length),Object(i.validateCallback)("Query.on","callback",n,!1);var u=t.getCancelAndContextArgs_("Query.on",r,o),c=function(t,e){n.call(u.context,new yo(s.database,t),e)};c.userCallback=n,c.context=u.context;var l=null===(a=u.cancel)||void 0===a?void 0:a.bind(u.context);switch(e){case"value":return Ai(this._delegate,c,l),n;case"child_added":return Ni(this._delegate,c,l),n;case"child_removed":return Ri(this._delegate,c,l),n;case"child_changed":return Pi(this._delegate,c,l),n;case"child_moved":return ji(this._delegate,c,l),n;default:throw new Error(Object(i.errorPrefix)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if(Object(i.validateArgCount)("Query.off",0,3,arguments.length),Sr("Query.off",t,!0),Object(i.validateCallback)("Query.off","callback",e,!0),Object(i.validateContextObject)("Query.off","context",n,!0),e){var r=function(){};r.userCallback=e,r.context=n,xi(this._delegate,t,r)}else xi(this._delegate,t)},t.prototype.get=function(){var t=this;return function(t){return function(t,e){var n=function(t,e){var n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(function(t,e){var i=yt(t,n);r=r||Dn(e,i)}));var i=t.syncPointTree_.get(n);i?r=r||Dn(i,ut()):(i=new Pn,t.syncPointTree_=t.syncPointTree_.set(n,i));var o=null!=r,a=o?new Le(r,!0,!1):null;return Be(Rn(i,e,en(t.pendingWriteTree_,e._path),o?a.getNode():$t.EMPTY_NODE,o).viewCache_)}(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then((function(n){var r=te(n),i=Wn(t.serverSyncTree_,e._path,r);return xr(t.eventQueue_,e._path,i),Promise.resolve(r)}),(function(n){return Yr(t,"get for query "+Object(i.stringify)(e)+" failed: "+n),Promise.reject(new Error(n))}))}((t=Object(i.getModularInstance)(t))._repo,t).then((function(e){return new gi(e,new vi(t._repo,t._path),t._queryParams.getIndex())}))}(this._delegate).then((function(e){return new yo(t.database,e)}))},t.prototype.once=function(e,n,r,o){var a=this;Object(i.validateArgCount)("Query.once",1,4,arguments.length),Object(i.validateCallback)("Query.once","callback",n,!0);var s=t.getCancelAndContextArgs_("Query.once",r,o),u=new i.Deferred,c=function(t,e){var r=new yo(a.database,t);n&&n.call(s.context,r,e),u.resolve(r)};c.userCallback=n,c.context=s.context;var l=function(t){s.cancel&&s.cancel.call(s.context,t),u.reject(t)};switch(e){case"value":Ai(this._delegate,c,l,{onlyOnce:!0});break;case"child_added":Ni(this._delegate,c,l,{onlyOnce:!0});break;case"child_removed":Ri(this._delegate,c,l,{onlyOnce:!0});break;case"child_changed":Pi(this._delegate,c,l,{onlyOnce:!0});break;case"child_moved":ji(this._delegate,c,l,{onlyOnce:!0});break;default:throw new Error(Object(i.errorPrefix)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise},t.prototype.limitToFirst=function(e){return Object(i.validateArgCount)("Query.limitToFirst",1,1,arguments.length),new t(this.database,io(this._delegate,Hi(e)))},t.prototype.limitToLast=function(e){return Object(i.validateArgCount)("Query.limitToLast",1,1,arguments.length),new t(this.database,io(this._delegate,zi(e)))},t.prototype.orderByChild=function(e){return Object(i.validateArgCount)("Query.orderByChild",1,1,arguments.length),new t(this.database,io(this._delegate,Yi(e)))},t.prototype.orderByKey=function(){return Object(i.validateArgCount)("Query.orderByKey",0,0,arguments.length),new t(this.database,io(this._delegate,Ji()))},t.prototype.orderByPriority=function(){return Object(i.validateArgCount)("Query.orderByPriority",0,0,arguments.length),new t(this.database,io(this._delegate,Zi()))},t.prototype.orderByValue=function(){return Object(i.validateArgCount)("Query.orderByValue",0,0,arguments.length),new t(this.database,io(this._delegate,eo()))},t.prototype.startAt=function(e,n){return void 0===e&&(e=null),Object(i.validateArgCount)("Query.startAt",0,2,arguments.length),new t(this.database,io(this._delegate,Vi(e,n)))},t.prototype.startAfter=function(e,n){return void 0===e&&(e=null),Object(i.validateArgCount)("Query.startAfter",0,2,arguments.length),new t(this.database,io(this._delegate,Ki(e,n)))},t.prototype.endAt=function(e,n){return void 0===e&&(e=null),Object(i.validateArgCount)("Query.endAt",0,2,arguments.length),new t(this.database,io(this._delegate,Mi(e,n)))},t.prototype.endBefore=function(e,n){return void 0===e&&(e=null),Object(i.validateArgCount)("Query.endBefore",0,2,arguments.length),new t(this.database,io(this._delegate,Ui(e,n)))},t.prototype.equalTo=function(e,n){return Object(i.validateArgCount)("Query.equalTo",1,2,arguments.length),new t(this.database,io(this._delegate,ro(e,n)))},t.prototype.toString=function(){return Object(i.validateArgCount)("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return Object(i.validateArgCount)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if(Object(i.validateArgCount)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:void 0,context:void 0};if(e&&n)r.cancel=e,Object(i.validateCallback)(t,"cancel",r.cancel,!0),r.context=n,Object(i.validateContextObject)(t,"context",r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(Object(i.errorPrefix)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return new _o(this.database,new vi(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),_o=function(t){function e(e,n){var r=t.call(this,e,new hi(n._repo,n._path,new ge,!1))||this;return r.database=e,r._delegate=n,r}return Object(o.__extends)(e,t),e.prototype.getKey=function(){return Object(i.validateArgCount)("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return Object(i.validateArgCount)("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new e(this.database,_i(this._delegate,t))},e.prototype.getParent=function(){Object(i.validateArgCount)("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return Object(i.validateArgCount)("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){Object(i.validateArgCount)("Reference.set",1,2,arguments.length),Object(i.validateCallback)("Reference.set","onComplete",e,!0);var n=Ii(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.update=function(t,e){if(Object(i.validateArgCount)("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,S("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ar("Reference.update",this._delegate._path),Object(i.validateCallback)("Reference.update","onComplete",e,!0);var o=Oi(this._delegate,t);return e&&o.then((function(){return e(null)}),(function(t){return e(t)})),o},e.prototype.setWithPriority=function(t,e,n){Object(i.validateArgCount)("Reference.setWithPriority",2,3,arguments.length),Object(i.validateCallback)("Reference.setWithPriority","onComplete",n,!0);var r=Ei(this._delegate,t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},e.prototype.remove=function(t){Object(i.validateArgCount)("Reference.remove",0,1,arguments.length),Object(i.validateCallback)("Reference.remove","onComplete",t,!0);var e=wi(this._delegate);return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},e.prototype.transaction=function(t,e,n){var r=this;Object(i.validateArgCount)("Reference.transaction",1,3,arguments.length),Object(i.validateCallback)("Reference.transaction","transactionUpdate",t,!1),Object(i.validateCallback)("Reference.transaction","onComplete",e,!0),Pr("Reference.transaction","applyLocally",n,!0);var o=po(this._delegate,t,{applyLocally:n}).then((function(t){return new go(t.committed,new yo(r.database,t.snapshot))}));return e&&o.then((function(t){return e(null,t.committed,t.snapshot)}),(function(t){return e(t,!1,null)})),o},e.prototype.setPriority=function(t,e){Object(i.validateArgCount)("Reference.setPriority",1,2,arguments.length),Object(i.validateCallback)("Reference.setPriority","onComplete",e,!0);var n=Ti(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.push=function(t,n){var r=this;Object(i.validateArgCount)("Reference.push",0,2,arguments.length),Object(i.validateCallback)("Reference.push","onComplete",n,!0);var o=bi(this._delegate,t),a=o.then((function(t){return new e(r.database,t)}));n&&a.then((function(){return n(null)}),(function(t){return n(t)}));var s=new e(this.database,o);return s.then=a.then.bind(a),s.catch=a.catch.bind(a,void 0),s},e.prototype.onDisconnect=function(){return Ar("Reference.onDisconnect",this._delegate._path),new vo(new li(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(mo),bo=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={}),(t=Object(i.getModularInstance)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&O("Cannot call useEmulator() after instance has already been initialized.");var o=t._repoInternal,a=void 0;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&O('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new K(K.OWNER);else if(r.mockUserToken){var s=Object(i.createMockUserToken)(r.mockUserToken,t.app.options.projectId);a=new K(s)}!function(t,e,n,r){t.repoInfo_=new H(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}(o,e,n,a)}(this._delegate,t,e,n)},t.prototype.ref=function(t){if(Object(i.validateArgCount)("database.ref",0,1,arguments.length),t instanceof _o){var e=mi(this._delegate,t.toString());return new _o(this,e)}return e=yi(this._delegate,t),new _o(this,e)},t.prototype.refFromURL=function(t){var e="database.refFromURL";Object(i.validateArgCount)(e,1,1,arguments.length);var n=mi(this._delegate,t);return new _o(this,n)},t.prototype.goOffline=function(){return Object(i.validateArgCount)("database.goOffline",0,0,arguments.length),co(this._delegate)},t.prototype.goOnline=function(){return Object(i.validateArgCount)("database.goOnline",0,0,arguments.length),lo(this._delegate)},t.ServerValue={TIMESTAMP:ho,increment:function(t){return function(t){return{".sv":{increment:t}}}(t)}},t}(),wo=Object.freeze({__proto__:null,forceLongPolling:function(){et.forceDisallow(),$.forceAllow()},forceWebSockets:function(){$.forceDisallow()},isWebSocketsAvailable:function(){return et.isAvailable()},setSecurityDebugCallback:function(t,e){t._delegate._repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var n;e?(t.statsListener_||(t.statsListener_=new Ce(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var r=Object.keys(n).reduce((function(t,e){return Math.max(e.length,t)}),0);D(n,(function(t,e){for(var n=t,i=t.length;i<r+2;i++)n+=" ";console.log(n+e)}))}}(t._delegate._repo,e)},statsIncrementCounter:function(t,e){!function(t,e){t.stats_.incrementCounter(e),t.statsReporter_.statsToReport_[e]=!0}(t._delegate._repo,e)},dataUpdateCount:function(t){return t._delegate._repo.dataUpdateCount},interceptServerData:function(t,e){return function(t,e){t.interceptServerDataCallback_=e}(t._delegate._repo,e)},initStandalone:function(t){var e=t.app,n=t.url,i=t.customAuthImpl,o=t.namespace,a=t.nodeAdmin,s=void 0!==a&&a;u(t.version);var c=new r.Provider("auth-internal",new r.ComponentContainer("database-standalone"));return c.setComponent(new r.Component("auth-internal",(function(){return i}),"PRIVATE")),{instance:new bo(so(e,c,void 0,n,s),e),namespace:o}}}),Io=Ct;Ct.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Ct.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var To=Object.freeze({__proto__:null,DataConnection:Io,RealTimeConnection:rt,hijackHash:function(t){var e=Ct.prototype.put;return Ct.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){Ct.prototype.put=e}},ConnectionTarget:H,queryIdentifier:function(t){return t._delegate._queryIdentifier},forceRestClient:function(t){!function(t){ao=t}(t)}}),Eo=bo.ServerValue;!function(e){u(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new r.Component("database",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new bo(so(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:_o,Query:mo,Database:bo,DataSnapshot:yo,enableLogging:w,INTERNAL:wo,ServerValue:Eo,TEST_ACCESS:To}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.10.1"),Object(i.isNodeSdk)()&&(t.exports=n)}(e.default)}).call(this,n("3UD+")(t))},"X8/r":function(t,e,n){"use strict";var r=n("zIRd"),i=n("/6Yf"),o=n("mrSG"),a=n("qOnz"),s=n("q/0M");function u(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var c,l=u(r),h=((c={})["already-activated"]="You are trying to activate AppCheck for FirebaseApp {$appName}, while it is already activated. AppCheck can only be activated once.",c["use-before-activation"]="AppCheck is being used before activate() is called for FirebaseApp {$appName}. Please make sure you call activate() before instantiating other Firebase services.",c["fetch-network-error"]="Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",c["fetch-parse-error"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",c["fetch-status-error"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",c["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",c["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",c["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",c["recaptcha-error"]="ReCAPTCHA error.",c),f=new a.ErrorFactory("appCheck","AppCheck",h),d=new Map,p={activated:!1,tokenListeners:[]},v={enabled:!1};function g(t){return d.get(t)||p}function y(t,e){d.set(t,e)}function m(){return v}function _(){return self.grecaptcha}function b(t){if(!g(t).activated)throw f.create("use-before-activation",{appName:t.name})}function w(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return b(t),[4,g(t).reCAPTCHAState.initialized.promise];case 1:return e=n.sent(),[2,new Promise((function(n,r){var i=g(t).reCAPTCHAState;e.ready((function(){n(e.execute(i.widgetId,{action:"fire_app_check"}))}))}))]}}))}))}function I(t,e,n,r){var i=n.render(r,{sitekey:e,size:"invisible"}),a=g(t);y(t,o.__assign(o.__assign({},a),{reCAPTCHAState:o.__assign(o.__assign({},a.reCAPTCHAState),{widgetId:i})}))}var T="https://content-firebaseappcheck.googleapis.com/v1beta",E=function(){function t(t,e,n,r,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}return t.prototype.start=function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((function(){}))},t.prototype.stop=function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)},t.prototype.isRunning=function(){return!!this.pending},t.prototype.process=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:this.stop(),n.label=1;case 1:return n.trys.push([1,6,,7]),this.pending=new a.Deferred,[4,(r=this.getNextRun(t),new Promise((function(t){setTimeout(t,r)})))];case 2:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 3:return n.sent(),this.pending=new a.Deferred,[4,this.operation()];case 4:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 5:return n.sent(),this.process(!0).catch((function(){})),[3,7];case 6:return e=n.sent(),this.retryPolicy(e)?this.process(!1).catch((function(){})):this.stop(),[3,7];case 7:return[2]}var r}))}))},t.prototype.getNextRun=function(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e},t}();function O(t,e){var n=t.url,r=t.body;return o.__awaiter(this,void 0,void 0,(function(){var t,i,a,s,u,c,l,h,d,p;return o.__generator(this,(function(o){switch(o.label){case 0:t={"Content-Type":"application/json"},(i=e.getImmediate({optional:!0}))&&(t["X-Firebase-Client"]=i.getPlatformInfoString()),a={method:"POST",body:JSON.stringify(r),headers:t},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(n,a)];case 2:return s=o.sent(),[3,4];case 3:throw u=o.sent(),f.create("fetch-network-error",{originalErrorMessage:u.message});case 4:if(200!==s.status)throw f.create("fetch-status-error",{httpStatus:s.status});o.label=5;case 5:return o.trys.push([5,7,,8]),[4,s.json()];case 6:return c=o.sent(),[3,8];case 7:throw l=o.sent(),f.create("fetch-parse-error",{originalErrorMessage:l.message});case 8:if(!(h=c.ttl.match(/^([\d.]+)(s)$/))||!h[2]||isNaN(Number(h[1])))throw f.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: "+c.ttl});return d=1e3*Number(h[1]),p=Date.now(),[2,{token:c.attestationToken,expireTimeMillis:p+d,issuedAtTimeMillis:p}]}}))}))}function S(t,e){var n=t.options;return{url:T+"/projects/"+n.projectId+"/apps/"+n.appId+":exchangeRecaptchaToken?key="+n.apiKey,body:{recaptcha_token:e}}}function C(t,e){var n=t.options;return{url:T+"/projects/"+n.projectId+"/apps/"+n.appId+":exchangeDebugToken?key="+n.apiKey,body:{debug_token:e}}}var k="firebase-app-check-store",A=null;function N(){return A||(A=new Promise((function(t,e){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(e){t(e.target.result)},n.onerror=function(t){var n;e(f.create("storage-open",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(k,{keyPath:"compositeKey"})}}}catch(r){e(f.create("storage-open",{originalErrorMessage:r.message}))}})))}function P(t){return R(x(t))}function j(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,a;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,N()];case 1:return n=o.sent(),r=n.transaction(k,"readwrite"),i=r.objectStore(k),a=i.put({compositeKey:t,value:e}),[2,new Promise((function(t,e){a.onsuccess=function(e){t()},r.onerror=function(t){var n;e(f.create("storage-set",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function R(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,N()];case 1:return e=o.sent(),n=e.transaction(k,"readonly"),r=n.objectStore(k),i=r.get(t),[2,new Promise((function(t,e){i.onsuccess=function(e){var n=e.target.result;t(n?n.value:void 0)},n.onerror=function(t){var n;e(f.create("storage-get",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function x(t){return t.options.appId+"-"+t.name}var D=new s.Logger("@firebase/app-check");function L(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n;return o.__generator(this,(function(r){switch(r.label){case 0:if(!a.isIndexedDBAvailable())return[3,5];e=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,P(t)];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),D.warn("Failed to read token from indexeddb. Error: "+n),[3,4];case 4:return[2,e];case 5:return[2,void 0]}}))}))}function M(t,e){return a.isIndexedDBAvailable()?function(t,e){return j(x(t),e)}(t,e).catch((function(t){D.warn("Failed to write token to indexeddb. Error: "+t)})):Promise.resolve()}function F(){return m().enabled}function U(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){if((t=m()).enabled&&t.token)return[2,t.token.promise];throw Error("\n            Can't get debug token in production mode.\n        ")}))}))}var q={error:"UNKNOWN_ERROR"};function V(t,e,n){return void 0===n&&(n=!1),o.__awaiter(this,void 0,void 0,(function(){var r,i,s,u,c,l,h,d,p,v,m,_,I;return o.__generator(this,(function(T){switch(T.label){case 0:return b(t),F()?(r=O,i=C,s=[t],[4,U()]):[3,3];case 1:return[4,r.apply(void 0,[i.apply(void 0,s.concat([T.sent()])),e])];case 2:return[2,{token:T.sent().token}];case 3:return u=g(t),l=void 0,(c=u.token)?[3,5]:[4,L(t)];case 4:(h=T.sent())&&K(h)&&(c=h,y(t,o.__assign(o.__assign({},u),{token:c})),B(t,{token:c.token})),T.label=5;case 5:if(!n&&c&&K(c))return[2,{token:c.token}];T.label=6;case 6:return T.trys.push([6,12,,13]),u.customProvider?[4,u.customProvider.getToken()]:[3,8];case 7:return d=T.sent(),p=a.issuedAtTime(d.token),v=null!==p&&p<Date.now()&&p>0?1e3*p:Date.now(),c=o.__assign(o.__assign({},d),{issuedAtTimeMillis:v}),[3,11];case 8:return[4,w(t).catch((function(t){throw f.create("recaptcha-error")}))];case 9:return m=T.sent(),[4,O(S(t,m),e)];case 10:c=T.sent(),T.label=11;case 11:return[3,13];case 12:return _=T.sent(),D.error(_),l=_,[3,13];case 13:return c?[3,14]:(I=function(t){return{token:(e=q,a.base64.encodeString(JSON.stringify(e),!1)),error:t};var e}(l),[3,16]);case 14:return I={token:c.token},y(t,o.__assign(o.__assign({},u),{token:c})),[4,M(t,c)];case 15:T.sent(),T.label=16;case 16:return B(t,I),[2,I]}}))}))}function B(t,e){for(var n=0,r=g(t).tokenListeners;n<r.length;n++){var i=r[n];try{i(e)}catch(o){}}}function K(t){return t.expireTimeMillis-Date.now()>0}!function(t){t.INTERNAL.registerComponent(new i.Component("appCheck",(function(t){return e=t.getProvider("app").getImmediate(),{activate:function(t,n){return function(t,e,n){var r=g(t);if(r.activated)throw f.create("already-activated",{appName:t.name});var i=o.__assign(o.__assign({},r),{activated:!0});"string"==typeof e?i.siteKey=e:i.customProvider=e,i.isTokenAutoRefreshEnabled=void 0===n?t.automaticDataCollectionEnabled:n,y(t,i),i.siteKey&&function(t,e){var n=g(t),r=new a.Deferred;y(t,o.__assign(o.__assign({},n),{reCAPTCHAState:{initialized:r}}));var i="fire_app_check_"+t.name,s=document.createElement("div");s.id=i,s.style.display="none",document.body.appendChild(s);var u,c,l=_();return l?l.ready((function(){I(t,e,l,i),r.resolve(l)})):(u=function(){var n=_();if(!n)throw new Error("no recaptcha");n.ready((function(){I(t,e,n,i),r.resolve(n)}))},(c=document.createElement("script")).src="https://www.google.com/recaptcha/api.js",c.onload=u,document.head.appendChild(c)),r.promise}(t,i.siteKey).catch((function(){}))}(e,t,n)},setTokenAutoRefreshEnabled:function(t){return function(t,e){var n=g(t);n.tokenRefresher&&(!0===e?n.tokenRefresher.start():n.tokenRefresher.stop()),y(t,o.__assign(o.__assign({},n),{isTokenAutoRefreshEnabled:e}))}(e,t)}};var e}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(t,e,n){t.getProvider("app-check-internal").initialize()}))),t.INTERNAL.registerComponent(new i.Component("app-check-internal",(function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("platform-logger"),{getToken:function(t){return V(e,n,t)},addTokenListener:function(t){return function(t,e,n){var r=g(t),i=o.__assign(o.__assign({},r),{tokenListeners:o.__spreadArray(o.__spreadArray([],r.tokenListeners),[n])});if(F()){var a=m();a.enabled&&a.token&&a.token.promise.then((function(t){return n({token:t})})).catch((function(){}))}else{if(!i.tokenRefresher){var s=function(t,e){var n=this;return new E((function(){return o.__awaiter(n,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return g(t).token?[3,2]:[4,V(t,e)];case 1:return n=r.sent(),[3,4];case 2:return[4,V(t,e,!0)];case 3:n=r.sent(),r.label=4;case 4:if(n.error)throw n.error;return[2]}}))}))}),(function(){return!0}),(function(){var e=g(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0}),3e4,96e4)}(t,e);i.tokenRefresher=s}if(i.tokenRefresher.isRunning()||!0!==r.isTokenAutoRefreshEnabled||i.tokenRefresher.start(),r.token&&K(r.token)){var u=r.token;Promise.resolve().then((function(){return n({token:u.token})})).catch((function(){}))}}y(t,i)}(e,n,t)},removeTokenListener:function(t){return function(t,e){var n=g(t),r=n.tokenListeners.filter((function(t){return t!==e}));0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),y(t,o.__assign(o.__assign({},n),{tokenListeners:r}))}(e,t)}};var e,n}),"PUBLIC").setInstantiationMode("EXPLICIT")),t.registerVersion("@firebase/app-check","0.1.1")}(l.default),function(){var t=a.getGlobal();if("string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===t.FIREBASE_APPCHECK_DEBUG_TOKEN){var e=m();e.enabled=!0;var n=new a.Deferred;e.token=n,n.resolve("string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN?t.FIREBASE_APPCHECK_DEBUG_TOKEN:function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:t=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,R("debug-token")];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return t?[2,t]:((r=e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),j("debug-token",r)).catch((function(t){return D.warn("Failed to persist debug token to indexeddb. Error: "+t)})),console.log("AppCheck debug token: "+e+". You will need to whitelist it in the Firebase console for it to work"),[2,e])}var r}))}))}())}}()},eTA4:function(t,e,n){"use strict";n.d(e,"a",(function(){return Wy}));var r=n("zIRd");(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},n=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function i(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function o(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:i(t)}}!function(t,r){if(r){var i=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in i||(i[a]={}),i=i[a]}(r=r(o=i[t=t[t.length-1]]))!=o&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function r(){this.a=null}function i(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;r.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var a=n.setTimeout;r.prototype.c=function(t){a(t,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.f(r)}}}this.a=null},r.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new r;return e.prototype.s=function(t){var e=this.f();t.Qa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(Tn){o(Tn)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.Qa(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Qa=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=i,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var r=o(t),a=r.next();!a.done;a=r.next())i(a.value).Qa(e,n)}))},e.all=function(t){var n=o(t),r=n.next();return r.done?i([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,i(r.value).Qa(o(a.length-1),e),r=n.next()}while(!r.done)}))},e}));var a=a||{},s=this||self,u=/^[\w+/_-]+[=]{0,2}$/,c=null;function l(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&u.test(t)?t:""}function h(){}function f(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function d(t){var e=f(t);return"array"==e||"object"==e&&"number"==typeof t.length}function p(t){return"function"==f(t)}function v(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function g(t){return Object.prototype.hasOwnProperty.call(t,y)&&t[y]||(t[y]=++m)}var y="closure_uid_"+(1e9*Math.random()>>>0),m=0;function _(t,e,n){return t.call.apply(t.bind,arguments)}function b(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:b).apply(null,arguments)}function I(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var T=Date.now;function E(t,e){function n(){}n.prototype=e.prototype,t.ab=e.prototype,t.prototype=new n,t.prototype.constructor=t}function O(t){return t}function S(t,e,n){this.code=A+t,this.message=e||N[t]||"",this.a=n||null}function C(t){var e=t&&t.code;return e?new S(e.substring(A.length),t.message,t.serverResponse):null}E(S,Error),S.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},S.prototype.toJSON=function(){return this.w()};var k,A="auth/",N={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},P={ld:{Ta:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ta:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://securetoken.googleapis.com/v1/token",Wa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ta:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ta:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Za:"https://test-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function j(t){for(var e in P)if(P[e].id===t)return{firebaseEndpoint:(t=P[e]).Ta,secureTokenEndpoint:t.Za,identityPlatformEndpoint:t.Wa};return null}function R(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function x(t){if(Error.captureStackTrace)Error.captureStackTrace(this,x);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function D(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");x.call(this,n+t[r])}function L(t,e){throw new D("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function M(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function F(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function U(){this.b=this.a=null}k=j("__EID__")?"__EID__":void 0,E(x,Error),x.prototype.name="CustomError",E(D,x),D.prototype.name="AssertionError",M.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var q=new M((function(){return new B}),(function(t){t.reset()}));function V(){var t=me,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function B(){this.next=this.b=this.a=null}U.prototype.add=function(t,e){var n=q.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},B.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},B.prototype.reset=function(){this.next=this.b=this.a=null};var K=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},W=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},H=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(r[i++]=s)}return r},G=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},z=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function Q(t,e){return 0<=K(t,e)}function Y(t,e){var n;return(n=0<=(e=K(t,e)))&&Array.prototype.splice.call(t,e,1),n}function X(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1)}))}function J(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var Z,tt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},et=/&/g,nt=/</g,rt=/>/g,it=/"/g,ot=/'/g,at=/\x00/g,st=/[\x00&<>"']/;function ut(t,e){return-1!=t.indexOf(e)}function ct(t,e){return t<e?-1:t>e?1:0}t:{var lt=s.navigator;if(lt){var ht=lt.userAgent;if(ht){Z=ht;break t}}Z=""}function ft(t){return ut(Z,t)}function dt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function pt(t){for(var e in t)return!1;return!0}function vt(t){var e,n={};for(e in t)n[e]=t[e];return n}var gt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<gt.length;o++)n=gt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function mt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||s).Element&&r.Location){var i=r;break t}}catch(a){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(v(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(a){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;L("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function _t(t,e){this.a=t===Tt&&e||"",this.b=It}function bt(t){return t instanceof _t&&t.constructor===_t&&t.b===It?t.a:(L("expected object of type Const, got '"+t+"'"),"type_error:Const")}_t.prototype.sa=!0,_t.prototype.ra=function(){return this.a},_t.prototype.toString=function(){return"Const{"+this.a+"}"};var wt,It={},Tt={};function Et(){if(void 0===wt){var t=null,e=s.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:O,createScript:O,createScriptURL:O})}catch(n){s.console&&s.console.error(n.message)}wt=t}else wt=t}return wt}function Ot(t,e){this.a=e===Nt?t:""}function St(t){return t instanceof Ot&&t.constructor===Ot?t.a:(L("expected object of type TrustedResourceUrl, got '"+t+"' of type "+f(t)),"type_error:TrustedResourceUrl")}function Ct(t,e){var n=bt(t);if(!At.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=Et();return new Ot(t=e?e.createScriptURL(t):t,Nt)}(t=n.replace(kt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof _t?bt(t):encodeURIComponent(String(t))})))}Ot.prototype.sa=!0,Ot.prototype.ra=function(){return this.a.toString()},Ot.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var kt=/%{(\w+)}/g,At=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Nt={};function Pt(t,e){this.a=e===Ft?t:""}function jt(t){return t instanceof Pt&&t.constructor===Pt?t.a:(L("expected object of type SafeUrl, got '"+t+"' of type "+f(t)),"type_error:SafeUrl")}Pt.prototype.sa=!0,Pt.prototype.ra=function(){return this.a.toString()},Pt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Rt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,xt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Dt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Lt(t){if(t instanceof Pt)return t;if(t="object"==typeof t&&t.sa?t.ra():String(t),Dt.test(t))t=new Pt(t,Ft);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(xt);t=e&&Rt.test(e[1])?new Pt(t,Ft):null}return t}function Mt(t){return t instanceof Pt?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Dt.test(t)||(t="about:invalid#zClosurez"),new Pt(t,Ft))}var Ft={},Ut=new Pt("about:invalid#zClosurez",Ft);function qt(t,e,n){this.a=n===Vt?t:""}qt.prototype.sa=!0,qt.prototype.ra=function(){return this.a.toString()},qt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Vt={};function Bt(t,e,n,r){return t=t instanceof Pt?t:Mt(t),e=e||s,n=n instanceof _t?bt(n):n||"",e.open(jt(t),n,r,void 0)}function Kt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Wt(t){return st.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(et,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(nt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(rt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(it,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(ot,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(at,"&#0;"))),t}function Ht(t){return Ht[" "](t),t}Ht[" "]=h;var Gt,zt,Qt=ft("Opera"),Yt=ft("Trident")||ft("MSIE"),Xt=ft("Edge"),Jt=Xt||Yt,$t=ft("Gecko")&&!(ut(Z.toLowerCase(),"webkit")&&!ft("Edge"))&&!(ft("Trident")||ft("MSIE"))&&!ft("Edge"),Zt=ut(Z.toLowerCase(),"webkit")&&!ft("Edge");function te(){var t=s.document;return t?t.documentMode:void 0}t:{var ee="",ne=(zt=Z,$t?/rv:([^\);]+)(\)|;)/.exec(zt):Xt?/Edge\/([\d\.]+)/.exec(zt):Yt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(zt):Zt?/WebKit\/(\S+)/.exec(zt):Qt?/(?:Version)[ \/]?(\S+)/.exec(zt):void 0);if(ne&&(ee=ne?ne[1]:""),Yt){var re=te();if(null!=re&&re>parseFloat(ee)){Gt=String(re);break t}}Gt=ee}var ie={};function oe(t){return function(t,e){var n=ie;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=tt(String(Gt)).split("."),r=tt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=ct(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ct(0==a[2].length,0==s[2].length)||ct(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}var ae=s.document&&Yt&&(te()||parseInt(Gt,10))||void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(zt){}var se=!Yt||9<=Number(ae);function ue(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function ce(t,e){dt(e,(function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:fe.hasOwnProperty(n)?t.setAttribute(fe[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var le,he,fe={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function de(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!d(o)||v(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(v(o)){var a="function"==typeof o.item||"string"==typeof o.item;break t}if(p(o)){a="function"==typeof o.item;break t}}a=!1}W(a?$(o):o,r)}}}function pe(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function ve(t){s.setTimeout((function(){throw t}),0)}function ge(t,e){he||function(){if(s.Promise&&s.Promise.resolve){var t=s.Promise.resolve(void 0);he=function(){t.then(_e)}}else he=function(){var t=_e;!p(s.setImmediate)||s.Window&&s.Window.prototype&&!ft("Edge")&&s.Window.prototype.setImmediate==s.setImmediate?(le||(le=function(){var t=s.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ft("Presto")&&(t=function(){var t=pe(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=w((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!ft("Trident")&&!ft("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Gb;n.Gb=null,t()}},function(t){r.next={Gb:t},r=r.next,e.port2.postMessage(0)}}return function(t){s.setTimeout(t,0)}}()),le(t)):s.setImmediate(t)}}(),ye||(he(),ye=!0),me.add(t,e)}var ye=!1,me=new U;function _e(){for(var t;t=V();){try{t.a.call(t.b)}catch(e){ve(e)}F(q,t)}ye=!1}function be(t,e){if(this.a=we,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=h)try{var n=this;t.call(e,(function(t){Re(n,Ie,t)}),(function(t){if(!(t instanceof qe))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(yd){}Re(n,Te,t)}))}catch(r){Re(this,Te,r)}}var we=0,Ie=2,Te=3;function Ee(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ee.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Oe=new M((function(){return new Ee}),(function(t){t.reset()}));function Se(t,e,n){var r=Oe.get();return r.g=t,r.b=e,r.f=n,r}function Ce(t){if(t instanceof be)return t;var e=new be(h);return Re(e,Ie,t),e}function ke(t){return new be((function(e,n){n(t)}))}function Ae(t,e,n){xe(t,e,n,null)||ge(I(e,t))}function Ne(t){return new be((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Pb:!0,value:o}:{Pb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Ae(t[o],I(i,o,!0),I(i,o,!1));else e(r)}))}function Pe(t,e){t.b||t.a!=Ie&&t.a!=Te||De(t),t.f?t.f.next=e:t.b=e,t.f=e}function je(t,e,n,r){var i=Se(null,null,null);return i.a=new be((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(a){o(a)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof qe?o(e):t(i)}catch(a){o(a)}}:o})),i.a.c=t,Pe(t,i),i.a}function Re(t,e,n){t.a==we&&(t===n&&(e=Te,n=new TypeError("Promise cannot resolve to itself")),t.a=1,xe(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,De(t),e!=Te||n instanceof qe||function(t,e){t.g=!0,ge((function(){t.g&&Ue.call(null,e)}))}(t,n)))}function xe(t,e,n,r){if(t instanceof be)return Pe(t,Se(e||h,n||null,r)),!0;if(R(t))return t.then(e,n,r),!0;if(v(t))try{var i=t.then;if(p(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,n.call(i,t))}),o)}catch(s){o(s)}}(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function De(t){t.h||(t.h=!0,ge(t.gc,t))}function Le(t){var e=null;return t.b&&(t.b=(e=t.b).next,e.next=null),t.b||(t.f=null),e}function Me(t,e,n,r){if(n==Te&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Fe(e,n,r);else try{e.c?e.g.call(e.f):Fe(e,n,r)}catch(yd){Ue.call(null,yd)}F(Oe,e)}function Fe(t,e,n){e==Ie?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}be.prototype.then=function(t,e,n){return je(this,p(t)?t:null,p(e)?e:null,n)},be.prototype.$goog_Thenable=!0,(t=be.prototype).oa=function(t,e){return(t=Se(t,t,e)).c=!0,Pe(this,t),this},t.o=function(t,e){return je(this,null,t,e)},t.cancel=function(t){if(this.a==we){var e=new qe(t);ge((function(){!function t(e,n){if(e.a==we)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==we&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):Le(r),Me(r,o,Te,n)))}e.c=null}else Re(e,Te,n)}(this,e)}),this)}},t.$c=function(t){this.a=we,Re(this,Ie,t)},t.ad=function(t){this.a=we,Re(this,Te,t)},t.gc=function(){for(var t;t=Le(this);)Me(this,t,this.a,this.i);this.h=!1};var Ue=ve;function qe(t){x.call(this,t)}function Ve(){0!=Be&&(Ke[g(this)]=this),this.xa=this.xa,this.pa=this.pa}E(qe,x),qe.prototype.name="cancel";var Be=0,Ke={};function We(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=Be)){var e=g(t);if(0!=Be&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Ke[e]}}Ve.prototype.xa=!1,Ve.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var He=Object.freeze||function(t){return t},Ge=!Yt||9<=Number(ae),ze=Yt&&!oe("9"),Qe=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",h,e),s.removeEventListener("test",h,e)}catch(n){}return t}();function Ye(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Xe(t,e){if(Ye.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if($t){t:{try{Ht(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Je[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ye.prototype.preventDefault=function(){this.defaultPrevented=!0},E(Xe,Ye);var Je=He({2:"touch",3:"pen",4:"mouse"});Xe.prototype.preventDefault=function(){Xe.ab.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ze)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},Xe.prototype.g=function(){return this.a};var $e="closure_listenable_"+(1e6*Math.random()|0),Ze=0;function tn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Va=i,this.key=++Ze,this.va=this.Pa=!1}function en(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Va=null}function nn(t){this.src=t,this.a={},this.b=0}function rn(t,e){var n=e.type;n in t.a&&Y(t.a[n],e)&&(en(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function on(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Va==r)return i}return-1}nn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=on(t,e,r,i);return-1<a?(e=t[a],n||(e.Pa=!1)):((e=new tn(e,this.src,o,!!r,i)).Pa=n,t.push(e)),e};var an="closure_lm_"+(1e6*Math.random()|0),sn={};function un(t,e,n,r,i){if(r&&r.once)ln(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)un(t,e[o],n,r,i);else n=_n(n),t&&t[$e]?wn(t,e,n,v(r)?!!r.capture:!!r,i):cn(t,e,n,!1,r,i)}function cn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=v(i)?!!i.capture:!!i,s=yn(t);if(s||(t[an]=s=new nn(t)),!(n=s.add(e,n,r,a,o)).proxy)if(r=function(){var t=gn,e=Ge?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Qe||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(dn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function ln(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)ln(t,e[o],n,r,i);else n=_n(n),t&&t[$e]?In(t,e,n,v(r)?!!r.capture:!!r,i):cn(t,e,n,!0,r,i)}function hn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)hn(t,e[o],n,r,i);else r=v(r)?!!r.capture:!!r,n=_n(n),t&&t[$e]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=on(o=t.a[e],n,r,i))&&(en(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=yn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=on(e,n,r,i)),(n=-1<t?e[t]:null)&&fn(n))}function fn(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[$e])rn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(dn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=yn(e))?(rn(n,t),0==n.b&&(n.src=null,e[an]=null)):en(t)}}}function dn(t){return t in sn?sn[t]:sn[t]="on"+t}function pn(t,e,n,r){var i=!0;if((t=yn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=vn(o,r),i=i&&!1!==o)}return i}function vn(t,e){var n=t.listener,r=t.Va||t.src;return t.Pa&&fn(t),n.call(r,e)}function gn(t,e){if(t.va)return!0;if(!Ge){if(!e)t:{e=["window","event"];for(var n=s,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Xe(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(a){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=pn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=pn(r[i],t,!1,e),n=n&&o}return n}return vn(t,new Xe(e,this))}function yn(t){return(t=t[an])instanceof nn?t:null}var mn="__closure_events_fn_"+(1e9*Math.random()>>>0);function _n(t){return p(t)?t:(t[mn]||(t[mn]=function(e){return t.handleEvent(e)}),t[mn])}function bn(){Ve.call(this),this.v=new nn(this),this.ac=this,this.gb=null}function wn(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function In(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function En(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.va&&a.capture==n){var s=a.listener,u=a.Va||a.src;a.Pa&&rn(t.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function On(t,e,n){if(p(t))n&&(t=w(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function Sn(t){var e=null;return new be((function(n,r){-1==(e=On((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw s.clearTimeout(e),t}))}function Cn(t){if(t.W&&"function"==typeof t.W)return t.W();if("string"==typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function kn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.W||"function"!=typeof t.W){if(d(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function An(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof An)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Nn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Pn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Pn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Pn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}E(bn,Ve),bn.prototype[$e]=!0,bn.prototype.addEventListener=function(t,e,n,r){un(this,t,e,n,r)},bn.prototype.removeEventListener=function(t,e,n,r){hn(this,t,e,n,r)},bn.prototype.dispatchEvent=function(t){var e,n=this.gb;if(n)for(e=[];n;n=n.gb)e.push(n);n=this.ac;var r=t.type||t;if("string"==typeof t)t=new Ye(t,n);else if(t instanceof Ye)t.target=t.target||n;else{var i=t;yt(t=new Ye(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=En(a,r,!0,t)&&i}if(i=En(a=t.b=n,r,!0,t)&&i,i=En(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=En(a=t.b=e[o],r,!1,t)&&i;return i},bn.prototype.Da=function(){if(bn.ab.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)en(n[r]);delete e.a[t],e.b--}}this.gb=null},(t=An.prototype).W=function(){Nn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return Nn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Pn(this.b,t)?this.b[t]:e},t.set=function(t,e){Pn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var jn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rn(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Rn?(this.i=void 0!==e?e:t.i,xn(this,t.c),this.l=t.l,this.a=t.a,Dn(this,t.g),this.f=t.f,Ln(this,er(t.b)),this.h=t.h):t&&(n=String(t).match(jn))?(this.i=!!e,xn(this,n[1]||"",!0),this.l=Vn(n[2]||""),this.a=Vn(n[3]||"",!0),Dn(this,n[4]),this.f=Vn(n[5]||"",!0),Ln(this,n[6]||"",!0),this.h=Vn(n[7]||"")):(this.i=!!e,this.b=new Yn(null,this.i))}function xn(t,e,n){t.c=n?Vn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Dn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Ln(t,e,n){e instanceof Yn?(t.b=e,function(t,e){e&&!t.f&&(Xn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&($n(this,e),tr(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Bn(e,zn)),t.b=new Yn(e,t.i))}function Mn(t,e,n){t.b.set(e,n)}function Fn(t,e){return t.b.get(e)}function Un(t){return t instanceof Rn?new Rn(t):new Rn(t,void 0)}function qn(t,e,n,r){var i=new Rn(null,void 0);return t&&xn(i,t),e&&(i.a=e),n&&Dn(i,n),r&&(i.f=r),i}function Vn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Bn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Kn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Kn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Rn.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Bn(e,Wn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Bn(e,Wn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Bn(n,"/"==n.charAt(0)?Gn:Hn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Bn(n,Qn)),t.join("")},Rn.prototype.resolve=function(t){var e=new Rn(this),n=!!t.c;n?xn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)Dn(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ut(i,"./")||ut(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?Ln(e,er(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Wn=/[#\/\?@]/g,Hn=/[#\?:]/g,Gn=/[#\?]/g,zn=/[#\?@]/g,Qn=/#/g;function Yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Xn(t){t.a||(t.a=new An,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Jn(t){var e=kn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Yn(null,void 0);t=Cn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?tr(n,i,o):n.add(i,o)}return n}function $n(t,e){Xn(t),e=nr(t,e),Pn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Pn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Nn(t)))}function Zn(t,e){return Xn(t),e=nr(t,e),Pn(t.a.b,e)}function tr(t,e,n){$n(t,e),0<n.length&&(t.c=null,t.a.set(nr(t,e),$(n)),t.b+=n.length)}function er(t){var e=new Yn;return e.c=t.c,t.a&&(e.a=new An(t.a),e.b=t.b),e}function nr(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function rr(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),t(e,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(a=n[i])&&(r.push(o),sr(i,r),r.push(":"),t(e,a,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":sr(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new ir,t,e),e.join("")}function ir(){}(t=Yn.prototype).add=function(t,e){Xn(this),this.c=null,t=nr(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Xn(this),this.a.forEach((function(n,r){W(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){Xn(this);for(var t=this.a.W(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.W=function(t){Xn(this);var e=[];if("string"==typeof t)Zn(this,t)&&(e=J(e,this.a.get(nr(this,t))));else{t=this.a.W();for(var n=0;n<t.length;n++)e=J(e,t[n])}return e},t.set=function(t,e){return Xn(this),this.c=null,Zn(this,t=nr(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.W(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var or={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},ar=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function sr(t,e){e.push('"',t.replace(ar,(function(t){var e=or[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),or[t]=e),e})),'"')}function ur(){var t=Sr();return Yt&&!!ae&&11==ae||/Edge\/\d+/.test(t)}function cr(){return s.window&&s.window.location.href||self&&self.location&&self.location.href||""}function lr(t,e){e=e||s.window;var n="about:blank";t&&(n=jt(Lt(t)||Ut)),e.location.href=n}function hr(t){return!!((t=(t||Sr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function fr(t){t=t||s.window;try{t.close()}catch(e){}}function dr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Sr().toLowerCase(),r&&(e.target=r,ut(n,"crios/")&&(e.target="_blank")),Tr(Sr())==Ir&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Pt?n:Lt(void 0!==n.href?n.href:String(n))||Ut,n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((ft("iPhone")&&!ft("iPod")&&!ft("iPad")||ft("iPad")||ft("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(mt(a=pe(document,"A"),"HTMLAnchorElement"),e=e instanceof Pt?e:Mt(e),a.href=jt(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=Bt("",r,n,a),t=jt(e),a&&(Jt&&ut(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Wt(t)+'">',t=new qt(t=(r=Et())?r.createHTML(t):t,null,Vt),r=a.document)&&(r.write(function(t){return t instanceof qt&&t.constructor===qt?t.a:(L("expected object of type SafeHtml, got '"+t+"' of type "+f(t)),"type_error:SafeHtml")}(t)),r.close())):(a=Bt(e,r,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var pr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vr=/^[^@]+@[^@]+$/;function gr(){var t=null;return new be((function(e){"complete"==s.document.readyState?e():(t=function(){e()},ln(window,"load",t))})).o((function(e){throw hn(window,"load",t),e}))}function yr(t){return t=t||Sr(),!("file:"!==Pr()&&"ionic:"!==Pr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function mr(){var t=s.window;try{return!(!t||t==t.top)}catch(e){return!1}}function _r(){return void 0!==s.WorkerGlobalScope&&"function"==typeof s.importScripts}function br(){return r.default.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.default.INTERNAL.hasOwnProperty("node")?"Node":_r()?"Worker":"Browser"}function wr(){var t=br();return"ReactNative"===t||"Node"===t}var Ir="Firefox";function Tr(t){var e=t.toLowerCase();return ut(e,"opera/")||ut(e,"opr/")||ut(e,"opios/")?"Opera":ut(e,"iemobile")?"IEMobile":ut(e,"msie")||ut(e,"trident/")?"IE":ut(e,"edge/")?"Edge":ut(e,"firefox/")?Ir:ut(e,"silk/")?"Silk":ut(e,"blackberry")?"Blackberry":ut(e,"webos")?"Webos":!ut(e,"safari/")||ut(e,"chrome/")||ut(e,"crios/")||ut(e,"android")?!ut(e,"chrome/")&&!ut(e,"crios/")||ut(e,"edge/")?ut(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":"Chrome":"Safari"}var Er={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Or(t,e){e=e||[];var n,r=[],i={};for(n in Er)i[Er[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=br())?r=Tr(i=Sr()):"Worker"===r&&(r=Tr(i=Sr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Sr(){return s.navigator&&s.navigator.userAgent||""}function Cr(t,e){t=t.split("."),e=e||s;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function kr(){try{var t=s.localStorage,e=Lr();if(t)return t.setItem(e,"1"),t.removeItem(e),!ur()||!!s.indexedDB}catch(n){return _r()&&!!s.indexedDB}return!1}function Ar(){return(Nr()||"chrome-extension:"===Pr()||yr())&&!wr()&&kr()&&!_r()}function Nr(){return"http:"===Pr()||"https:"===Pr()}function Pr(){return s.location&&s.location.protocol||null}function jr(t){return!hr(t=t||Sr())&&Tr(t)!=Ir}function Rr(t){return void 0===t?null:rr(t)}function xr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!=t[e]&&(n[e]=t[e]);return n}function Dr(t){if(null!==t)return JSON.parse(t)}function Lr(t){return t||Math.floor(1e9*Math.random()).toString()}function Mr(t){return"Safari"!=Tr(t=t||Sr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Fr(){var t=s.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Ur(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Sr(),e=br(),this.b=hr(t)||"ReactNative"===e}function qr(){var t=s.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Vr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function Br(){return!(!Cr("fireauth.oauthhelper",s)&&!Cr("fireauth.iframe",s))}Ur.prototype.get=function(){var t=s.navigator;return!t||"boolean"!=typeof t.onLine||!Nr()&&"chrome-extension:"!==Pr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Kr,Wr={};function Hr(t){Wr[t]||(Wr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Gr={};Object.defineProperty(Gr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Gr,"abcd",{configurable:!0,enumerable:!0,value:2}),Kr=2==Gr.abcd}catch(zt){Kr=!1}function zr(t,e,n){Kr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Qr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&zr(t,n,e[n])}function Yr(t){var e={};return Qr(e,t),e}function Xr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)zr(e,n,Xr(t[n]));return e}function Jr(t){var e=t&&(t[ni]?"phone":null);if(!(e&&t&&t[ei]))throw new S("internal-error","Internal assert: invalid MultiFactorInfo object");zr(this,"uid",t[ei]),zr(this,"displayName",t[Zr]||null);var n=null;t[ti]&&(n=new Date(t[ti]).toUTCString()),zr(this,"enrollmentTime",n),zr(this,"factorId",e)}function $r(t){try{var e=new ri(t)}catch(n){e=null}return e}Jr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Zr="displayName",ti="enrolledAt",ei="mfaEnrollmentId",ni="phoneInfo";function ri(t){Jr.call(this,t),zr(this,"phoneNumber",t[ni])}function ii(t){var e={},n=t[ui],r=t[li],i=t[hi];if(t=$r(t[ci]),!i||i!=ai&&i!=si&&!n||i==si&&!r||i==oi&&!t)throw Error("Invalid checkActionCode response!");i==si?(e[di]=n||null,e[vi]=n||null,e[fi]=r):(e[di]=r||null,e[vi]=r||null,e[fi]=n||null),e[pi]=t||null,zr(this,yi,i),zr(this,gi,Xr(e))}E(ri,Jr),ri.prototype.w=function(){var t=ri.ab.w.call(this);return t.phoneNumber=this.phoneNumber,t};var oi="REVERT_SECOND_FACTOR_ADDITION",ai="EMAIL_SIGNIN",si="VERIFY_AND_CHANGE_EMAIL",ui="email",ci="mfaInfo",li="newEmail",hi="requestType",fi="email",di="fromEmail",pi="multiFactorInfo",vi="previousEmail",gi="data",yi="operation";function mi(t){var e=Fn(t=Un(t),_i)||null,n=Fn(t,bi)||null,r=Fn(t,Ti)||null;if(r=r&&Oi[r]||null,!e||!n||!r)throw new S("argument-error",_i+", "+bi+"and "+Ti+" are required in a valid action code URL.");Qr(this,{apiKey:e,operation:r,code:n,continueUrl:Fn(t,wi)||null,languageCode:Fn(t,Ii)||null,tenantId:Fn(t,Ei)||null})}var _i="apiKey",bi="oobCode",wi="continueUrl",Ii="languageCode",Ti="mode",Ei="tenantId",Oi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:oi,signIn:ai,verifyAndChangeEmail:si,verifyEmail:"VERIFY_EMAIL"};function Si(t){try{return new mi(t)}catch(e){return null}}function Ci(t){var e=t[ji];if(void 0===e)throw new S("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new S("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[ki];if(n&&"object"==typeof n){e=n[Di];var r=n[Ri];if(n=n[xi],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new S("argument-error",Ri+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new S("argument-error",xi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new S("argument-error",Di+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new S("missing-android-pkg-name")}}else if(void 0!==n)throw new S("argument-error",ki+" property must be a non null object when specified.");if(this.f=null,(e=t[Pi])&&"object"==typeof e){if("string"==typeof(e=e[Li])&&e.length)this.f=e;else if(void 0!==e)throw new S("argument-error",Li+" property must be a non empty string when specified.")}else if(void 0!==e)throw new S("argument-error",Pi+" property must be a non null object when specified.");if(void 0!==(e=t[Ni])&&"boolean"!=typeof e)throw new S("argument-error",Ni+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Ai])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new S("argument-error",Ai+" property must be a non empty string when specified.");this.i=t||null}var ki="android",Ai="dynamicLinkDomain",Ni="handleCodeInApp",Pi="iOS",ji="url",Ri="installApp",xi="minimumVersion",Di="packageName",Li="bundleId";function Mi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Fi=null;function Ui(t){var e=Vi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function qi(t){try{return new Ui(t)}catch(e){return null}}function Vi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=function(t){var e=[];return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Fi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Fi){Fi={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Fi[o]&&(Fi[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e.push(t)})),e}(t);for(t=[],n=e=0;e<r.length;){var i=r[e++];if(128>i)t[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[e++];var a=r[e++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[e++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else o=r[e++],a=r[e++],t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(t.join(""))}catch(u){}return null}Ui.prototype.T=function(){return this.f},Ui.prototype.l=function(){return this.c},Ui.prototype.toString=function(){return this.h};var Bi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Ki=["client_id","response_type","scope","redirect_uri","state"],Wi={nd:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Xa:Ki},pd:{Ja:null,ua:500,ta:750,fa:"github.com",Xa:Ki},qd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Xa:Ki},wd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Xa:Bi},kd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Xa:[]}};function Hi(t){for(var e in Wi)if(Wi[e].fa==t)return Wi[e];return null}function Gi(t){var e={};e["facebook.com"]=Ji,e["google.com"]=Zi,e["github.com"]=$i,e["twitter.com"]=to;var n=t&&t[Qi];try{if(n)return e[n]?new e[n](t):new Xi(t);if(void 0!==t[zi])return new Yi(t)}catch(r){}return null}var zi="idToken",Qi="providerId";function Yi(t){var e=t[Qi];if(!e&&t[zi]){var n=qi(t[zi]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),zr(this,"providerId",e),zr(this,"isNewUser",n)}function Xi(t){Yi.call(this,t),zr(this,"profile",Xr((t=Dr(t.rawUserInfo||"{}"))||{}))}function Ji(t){if(Xi.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function $i(t){if(Xi.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");zr(this,"username",this.profile&&this.profile.login||null)}function Zi(t){if(Xi.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function to(t){if(Xi.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");zr(this,"username",t.screenName||null)}function eo(t){var e=Un(t),n=Fn(e,"link"),r=Fn(Un(n),"link");return e=Fn(e,"deep_link_id"),Fn(Un(e),"link")||e||r||n||t}function no(t,e){if(!t&&!e)throw new S("internal-error","Internal assert: no raw session string available");if(t&&e)throw new S("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?ro:io}E(Xi,Yi),E(Ji,Xi),E($i,Xi),E(Zi,Xi),E(to,Xi);var ro="enroll",io="signin";function oo(){}function ao(t,e){return t.then((function(t){if(t[Ga]){var n=qi(t[Ga]);if(!n||e!=n.i)throw new S("user-mismatch");return t}throw new S("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==A+"user-not-found"?new S("user-mismatch"):t}))}function so(t,e){if(!e)throw new S("internal-error","failed to construct a credential");this.a=e,zr(this,"providerId",t),zr(this,"signInMethod",t)}function uo(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function co(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new so(t.providerId,t.pendingToken)}catch(e){}return null}function lo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&zr(this,"idToken",e.idToken),e.accessToken&&zr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&zr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new S("internal-error","failed to construct a credential");zr(this,"accessToken",e.oauthToken),zr(this,"secret",e.oauthTokenSecret)}zr(this,"providerId",t),zr(this,"signInMethod",n)}function ho(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Jn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function fo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new lo(t.providerId,e,t.signInMethod)}catch(n){}}return null}function po(t,e){this.Qc=e||[],Qr(this,{providerId:t,isOAuthProvider:!0}),this.Ib={},this.pb=(Hi(t)||{}).Ja||null,this.ob=null}function vo(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new S("argument-error",'SAML provider IDs must be prefixed with "saml."');po.call(this,t,[])}function go(t){po.call(this,t,Ki),this.a=[]}function yo(){go.call(this,"facebook.com")}function mo(t){if(!t)throw new S("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new yo).credential({accessToken:e})}function _o(){go.call(this,"github.com")}function bo(t){if(!t)throw new S("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new _o).credential({accessToken:e})}function wo(){go.call(this,"google.com"),this.Ca("profile")}function Io(t,e){var n=t;return v(t)&&(n=t.idToken,e=t.accessToken),(new wo).credential({idToken:n,accessToken:e})}function To(){po.call(this,"twitter.com",Bi)}function Eo(t,e){var n=t;if(v(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new S("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new lo("twitter.com",n,"twitter.com")}function Oo(t,e,n){this.a=t,this.f=e,zr(this,"providerId","password"),zr(this,"signInMethod",n===Co.EMAIL_LINK_SIGN_IN_METHOD?Co.EMAIL_LINK_SIGN_IN_METHOD:Co.EMAIL_PASSWORD_SIGN_IN_METHOD)}function So(t){return t&&t.email&&t.password?new Oo(t.email,t.password,t.signInMethod):null}function Co(){Qr(this,{providerId:"password",isOAuthProvider:!1})}function ko(t,e){if(!(e=Ao(e)))throw new S("argument-error","Invalid email link!");return new Oo(t,e.code,Co.EMAIL_LINK_SIGN_IN_METHOD)}function Ao(t){return(t=Si(t=eo(t)))&&t.operation===ai?t:null}function No(t){if(!(t.eb&&t.cb||t.La&&t.ea))throw new S("internal-error");this.a=t,zr(this,"providerId","phone"),this.fa="phone",zr(this,"signInMethod","phone")}function Po(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return W(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new No(e)}return null}function jo(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.eb,code:t.a.cb}}function Ro(t){try{this.a=t||r.default.auth()}catch(e){throw new S("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Qr(this,{providerId:"phone",isOAuthProvider:!1})}function xo(t,e){if(!t)throw new S("missing-verification-id");if(!e)throw new S("missing-verification-code");return new No({eb:t,cb:e})}function Do(t){if(t.temporaryProof&&t.phoneNumber)return new No({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return Io(o,n);case"facebook.com":return mo(n);case"github.com":return bo(n);case"twitter.com":return Eo(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new so(e,a):new lo(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new go(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Lo(t){if(!t.isOAuthProvider)throw new S("invalid-oauth-provider")}function Mo(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new S("invalid-auth-event");if(this.g&&this.a)throw new S("invalid-auth-event");if(this.g&&!this.f)throw new S("invalid-auth-event")}function Fo(t){return(t=t||{}).type?new Mo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&C(t.error),t.postBody,t.tenantId):null}function Uo(){this.b=null,this.a=[]}no.prototype.Ha=function(){return Ce(this.a?this.a:this.b)},no.prototype.w=function(){return this.type==ro?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},oo.prototype.ka=function(){},oo.prototype.b=function(){},oo.prototype.c=function(){},oo.prototype.w=function(){},so.prototype.ka=function(t){return ds(t,uo(this))},so.prototype.b=function(t,e){var n=uo(this);return n.idToken=e,ps(t,n)},so.prototype.c=function(t,e){return ao(vs(t,uo(this)),e)},so.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},lo.prototype.ka=function(t){return ds(t,ho(this))},lo.prototype.b=function(t,e){var n=ho(this);return n.idToken=e,ps(t,n)},lo.prototype.c=function(t,e){return ao(vs(t,ho(this)),e)},lo.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},po.prototype.Ka=function(t){return this.Ib=vt(t),this},E(vo,po),E(go,po),go.prototype.Ca=function(t){return Q(this.a,t)||this.a.push(t),this},go.prototype.Qb=function(){return $(this.a)},go.prototype.credential=function(t,e){var n;if(!(n=v(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new S("argument-error","credential failed: must provide the ID token and/or the access token.");return new lo(this.providerId,n,this.providerId)},E(yo,go),zr(yo,"PROVIDER_ID","facebook.com"),zr(yo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),E(_o,go),zr(_o,"PROVIDER_ID","github.com"),zr(_o,"GITHUB_SIGN_IN_METHOD","github.com"),E(wo,go),zr(wo,"PROVIDER_ID","google.com"),zr(wo,"GOOGLE_SIGN_IN_METHOD","google.com"),E(To,po),zr(To,"PROVIDER_ID","twitter.com"),zr(To,"TWITTER_SIGN_IN_METHOD","twitter.com"),Oo.prototype.ka=function(t){return this.signInMethod==Co.EMAIL_LINK_SIGN_IN_METHOD?Xs(t,Ts,{email:this.a,oobCode:this.f}):Xs(t,Hs,{email:this.a,password:this.f})},Oo.prototype.b=function(t,e){return this.signInMethod==Co.EMAIL_LINK_SIGN_IN_METHOD?Xs(t,Es,{idToken:e,email:this.a,oobCode:this.f}):Xs(t,Ms,{idToken:e,email:this.a,password:this.f})},Oo.prototype.c=function(t,e){return ao(this.ka(t),e)},Oo.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Qr(Co,{PROVIDER_ID:"password"}),Qr(Co,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Qr(Co,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),No.prototype.ka=function(t){return t.fb(jo(this))},No.prototype.b=function(t,e){var n=jo(this);return n.idToken=e,Xs(t,zs,n)},No.prototype.c=function(t,e){var n=jo(this);return n.operation="REAUTH",ao(t=Xs(t,Qs,n),e)},No.prototype.w=function(){var t={providerId:"phone"};return this.a.eb&&(t.verificationId=this.a.eb),this.a.cb&&(t.verificationCode=this.a.cb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Ro.prototype.fb=function(t,e){var n=this.a.a;return Ce(e.verify()).then((function(r){if("string"!=typeof r)throw new S("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=v(t)?t.session:null,o=v(t)?t.phoneNumber:t;return(i&&i.type==ro?i.Ha().then((function(t){return function(t,e){return Xs(t,Us,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==io?i.Ha().then((function(e){return function(t,e){return Xs(t,qs,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return Xs(t,Ds,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new S("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Qr(Ro,{PROVIDER_ID:"phone"}),Qr(Ro,{PHONE_SIGN_IN_METHOD:"phone"}),Mo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Mo.prototype.T=function(){return this.h},Mo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var qo,Vo=null;function Bo(t){var e="unauthorized-domain",n=void 0,r=Un(t);t=r.a,"chrome-extension"==(r=r.c)?n=Kt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Kt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",S.call(this,e,n)}function Ko(t,e,n){S.call(this,t,n),(t=e||{}).Jb&&zr(this,"email",t.Jb),t.ea&&zr(this,"phoneNumber",t.ea),t.credential&&zr(this,"credential",t.credential),t.Zb&&zr(this,"tenantId",t.Zb)}function Wo(t){if(t.code){var e=t.code||"";0==e.indexOf(A)&&(e=e.substring(A.length));var n={credential:Do(t),Zb:t.tenantId};if(t.email)n.Jb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new S(e,t.message||void 0);return new Ko(e,n,t.message)}return null}function Ho(){}function Go(){}function zo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(yd){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Qo(){}function Yo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=w(this.qc,this),this.a.onerror=w(this.Sb,this),this.a.onprogress=w(this.rc,this),this.a.ontimeout=w(this.vc,this)}function Xo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Jo(t,e,n){this.reset(t,e,n,void 0,void 0)}function $o(t){this.f=t,this.b=this.c=this.a=null}function Zo(t,e){this.name=t,this.value=e}E(Bo,S),E(Ko,S),Ko.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&yt(t,e),t},Ko.prototype.toJSON=function(){return this.w()},Ho.prototype.c=null,E(Go,Ho),Go.prototype.a=function(){var t=zo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Go.prototype.b=function(){var t={};return zo(this)&&(t[0]=!0,t[1]=!0),t},qo=new Go,E(Qo,Ho),Qo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Yo;throw Error("Unsupported browser")},Qo.prototype.b=function(){return{}},(t=Yo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Xo(this,4)},t.Sb=function(){this.status=500,this.response=this.responseText="",Xo(this,4)},t.vc=function(){this.Sb()},t.rc=function(){this.status=200,Xo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Jo.prototype.a=null,Jo.prototype.reset=function(t,e,n,r,i){r||T(),delete this.a},Zo.prototype.toString=function(){return this.name};var ta=new Zo("SEVERE",1e3),ea=new Zo("WARNING",900),na=new Zo("CONFIG",700),ra=new Zo("FINE",500);$o.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(L("Root logger has no level set."),null)}(this).value)for(p(e)&&(e=e()),t=new Jo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var ia={},oa=null;function aa(t){var e;if(oa||(oa=new $o(""),ia[""]=oa,oa.c=na),!(e=ia[t])){e=new $o(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=aa(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,ia[t]=e}return e}function sa(t,e){t&&t.log(ra,e,void 0)}function ua(t){this.f=t}function ca(t){bn.call(this),this.u=t,this.h=void 0,this.readyState=la,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=aa("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}E(ua,Ho),ua.prototype.a=function(){return new ca(this.f)},ua.prototype.b=function(t){return function(){return t}}({}),E(ca,bn);var la=0;function ha(t){t.c.read().then(t.pc.bind(t)).catch(t.Ua.bind(t))}function fa(t){t.readyState=4,t.g=null,t.c=null,t.m=null,da(t)}function da(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function pa(t){bn.call(this),this.headers=new An,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.R=this.l="",this.f=this.O=this.i=this.J=!1,this.g=0,this.s=null,this.m=va,this.u=this.S=!1}(t=ca.prototype).open=function(t,e){if(this.readyState!=la)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,da(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Ua.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,fa(this)),this.readyState=la},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,da(this)),this.a&&(this.readyState=3,da(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Ua.bind(this)):void 0!==s.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,ha(this)):t.text().then(this.tc.bind(this),this.Ua.bind(this)))))},t.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?fa(this):da(this),3==this.readyState&&ha(this)}},t.tc=function(t){this.a&&(this.response=this.responseText=t,fa(this))},t.sc=function(t){this.a&&(this.response=t,fa(this))},t.Ua=function(t){var e=this.i;e&&e.log(ea,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&fa(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(ea,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(ea,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),E(pa,bn);var va="";pa.prototype.b=aa("goog.net.XhrIo");var ga=/^https?$/i,ya=["POST","PUT"];function ma(t){return"content-type"==t.toLowerCase()}function _a(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ba(t),Ia(t)}function ba(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function wa(t){if(t.c&&void 0!==a)if(t.C[1]&&4==Ea(t)&&2==Oa(t))sa(t.b,Sa(t,"Local request error detected and ignored"));else if(t.i&&4==Ea(t))On(t.Vb,0,t);else if(t.dispatchEvent("readystatechange"),4==Ea(t)){sa(t.b,Sa(t,"Request complete")),t.c=!1;try{var e,n=Oa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(jn)[1]||null;if(!o&&s.self&&s.self.location){var u=s.self.location.protocol;o=u.substr(0,u.length-1)}i=!ga.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Ea(t)?t.a.statusText:""}catch(l){sa(t.b,"Can not get status: "+l.message),c=""}t.h=c+" ["+Oa(t)+"]",ba(t)}}finally{Ia(t)}}}function Ia(t,e){if(t.a){Ta(t);var n=t.a,r=t.C[0]?h:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(yd){(t=t.b)&&t.log(ta,"Problem encountered resetting onreadystatechange: "+yd.message,void 0)}}}function Ta(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(s.clearTimeout(t.s),t.s=null)}function Ea(t){return t.a?t.a.readyState:0}function Oa(t){try{return 2<Ea(t)?t.a.status:-1}catch(e){return-1}}function Sa(t,e){return e+" ["+t.R+" "+t.l+" "+Oa(t)+"]"}function Ca(t){var e=Fa;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function ka(t,e,n){t.a=!0,t.c=n,t.f=!e,ja(t)}function Aa(t){if(t.a){if(!t.v)throw new Ra(t);t.v=!1}}function Na(t,e,n,r){t.g.push([e,n,r]),t.a&&ja(t)}function Pa(t){return z(t.g,(function(t){return p(t[1])}))}function ja(t){if(t.h&&t.a&&Pa(t)){var e=t.h,n=La[e];n&&(s.clearTimeout(n.a),delete La[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var u=o.call(i||t.s,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(R(e)||"function"==typeof s.Promise&&e instanceof s.Promise)&&(r=!0,t.i=!0)}catch(c){e=c,t.f=!0,Pa(t)||(n=!0)}}t.c=e,r&&(u=w(t.m,t,!0),r=w(t.m,t,!1),e instanceof Ca?(Na(e,u,r),e.C=!0):e.then(u,r)),n&&(e=new Da(e),La[e.a]=e,t.h=e.a)}function Ra(){x.call(this)}function xa(){x.call(this)}function Da(t){this.a=s.setTimeout(w(this.c,this),0),this.b=t}(t=pa.prototype).Ma=function(){void 0!==a&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",sa(this.b,Sa(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(sa(this.b,Sa(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ia(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Ia(this,!0)),pa.ab.Da.call(this)},t.Vb=function(){this.xa||(this.O||this.i||this.f?wa(this):this.Jc())},t.Jc=function(){wa(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case va:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(ta,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return sa(this.b,"Can not get response: "+e.message),null}},Ca.prototype.cancel=function(t){if(this.a)this.c instanceof Ca&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new xa(this),Aa(this),ka(this,!1,t))}},Ca.prototype.m=function(t,e){this.i=!1,ka(this,t,e)},Ca.prototype.then=function(t,e,n){var r,i,o=new be((function(t,e){r=t,i=e}));return Na(this,r,(function(t){t instanceof xa?o.cancel():i(t)})),o.then(t,e,n)},Ca.prototype.$goog_Thenable=!0,E(Ra,x),Ra.prototype.message="Deferred has already fired",Ra.prototype.name="AlreadyCalledError",E(xa,x),xa.prototype.message="Deferred was canceled",xa.prototype.name="CanceledError",Da.prototype.c=function(){throw delete La[this.a],this.b};var La={};function Ma(t){var e={},n=e.document||document,r=St(t).toString(),i=pe(document,"SCRIPT"),o={Wb:i,Ma:void 0},a=new Ca(o),u=null,h=null!=e.timeout?e.timeout:5e3;return 0<h&&(u=window.setTimeout((function(){Ua(i,!0);var t=new Ba(Va,"Timeout reached for loading script "+r);Aa(a),ka(a,!1,t)}),h),o.Ma=u),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ua(i,e.xd||!1,u),Aa(a),ka(a,!0,null))},i.onerror=function(){Ua(i,!0,u);var t=new Ba(qa,"Error while loading script "+r);Aa(a),ka(a,!1,t)},yt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),ce(i,o),function(t,e){mt(t,"HTMLScriptElement"),t.src=St(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=s?e=l(e.document):(null===c&&(c=l(s.document)),e=c),e&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function Fa(){if(this&&this.Wb){var t=this.Wb;t&&"SCRIPT"==t.tagName&&Ua(t,!0,this.Ma)}}function Ua(t,e,n){null!=n&&s.clearTimeout(n),t.onload=h,t.onerror=h,t.onreadystatechange=h,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var qa=0,Va=1;function Ba(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),x.call(this,n),this.code=t}function Ka(t){this.f=t}function Wa(t,e,n){if(this.c=t,this.l=(t=e||{}).secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||za,this.g=vt(t.secureTokenHeaders||Qa),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||Ya,this.a=vt(t.firebaseHeaders||Xa),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==br(),!(n=s.XMLHttpRequest||n&&r.default.INTERNAL.node&&r.default.INTERNAL.node.XMLHttpRequest)&&!_r())throw new S("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,this.f=_r()?new ua(self):wr()?new Ka(n):new Qo,this.b=null}E(Ba,x),E(Ka,Ho),Ka.prototype.a=function(){return new this.f},Ka.prototype.b=function(){return{}};var Ha,Ga="idToken",za=new Ur(3e4,6e4),Qa={"Content-Type":"application/x-www-form-urlencoded"},Ya=new Ur(3e4,6e4),Xa={"Content-Type":"application/json"};function Ja(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function $a(t,e){e&&(t.l=Za("https://securetoken.googleapis.com/v1/token",e),t.h=Za("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=Za("https://identitytoolkit.googleapis.com/v2/",e))}function Za(t,e){return t=Un(t),e=Un(e.url),t.f=t.a+t.f,xn(t,e.c),t.a=e.a,Dn(t,e.g),t.toString()}function ts(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function es(t,e,n,r,i,o,a){(function(){var t=Sr();return!((t="Chrome"!=Tr(t)?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Yt&&ae&&!(9<ae))})()||_r()?t=w(t.u,t):(Ha||(Ha=new be((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(s[rs]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Na(t,null,e,void 0)}(Ma(Ct(ns,{onload:rs})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=w(t.s,t)),t(e,n,r,i,o,a)}Wa.prototype.T=function(){return this.b},Wa.prototype.u=function(t,e,n,r,i,o){if(_r()&&(void 0===s.fetch||void 0===s.Headers||void 0===s.Request))throw new S("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new pa(this.f);if(o){a.g=Math.max(0,o);var u=setTimeout((function(){a.dispatchEvent("timeout")}),o)}wn(a,"complete",(function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return sa(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)})),In(a,"ready",(function(){u&&clearTimeout(u),We(this)})),In(a,"timeout",(function(){u&&clearTimeout(u),We(this),e&&e(null)})),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.R=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():qo.a(),t.C=function(t){return t.c||(t.c=t.b())}(t.D?t.D:qo),t.a.onreadystatechange=w(t.Vb,t);try{sa(t.b,Sa(t,"Opening Xhr")),t.O=!0,t.a.open(n,String(e),!0),t.O=!1}catch(a){return sa(t.b,Sa(t,"Error opening Xhr: "+a.message)),void _a(t,a)}e=r||"";var o=new An(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"==typeof t)W(t,e,void 0);else for(var n=kn(t),r=Cn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=ma,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=s.FormData&&e instanceof s.FormData,!Q(ya,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{Ta(t),0<t.g&&(t.u=function(t){return Yt&&oe(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),sa(t.b,Sa(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=w(t.Ma,t)):t.s=On(t.Ma,t.g,t)),sa(t.b,Sa(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(a){sa(t.b,Sa(t,"Send error: "+a.message)),_a(t,a)}}(a,t,n,r,i)};var ns=new _t(Tt,"https://apis.google.com/js/client.js?onload=%{onload}"),rs="__fcb"+Math.floor(1e6*Math.random()).toString();function is(t){if("string"!=typeof(t=t.email)||!vr.test(t))throw new S("invalid-email")}function os(t){"email"in t&&is(t)}function as(t){if(!t[Ga]){if(t.mfaPendingCredential)throw new S("multi-factor-auth-required",null,vt(t));throw new S("internal-error")}}function ss(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new S("internal-error")}else{if(!t.sessionInfo)throw new S("missing-verification-id");if(!t.code)throw new S("missing-verification-code")}}Wa.prototype.s=function(t,e,n,r,i){var o=this;Ha.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Wa.prototype.zb=function(){return Xs(this,Fs,{})},Wa.prototype.Bb=function(t,e){return Xs(this,Ls,{idToken:t,email:e})},Wa.prototype.Cb=function(t,e){return Xs(this,Ms,{idToken:t,password:e})};var us={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function cs(t){if(!t.phoneVerificationInfo)throw new S("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new S("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new S("missing-verification-code")}function ls(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new S("internal-error")}function hs(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&Zn(t=new Yn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function fs(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Wo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Wo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Wo(t)):t.errorMessage&&(e=Js(t.errorMessage)),e)throw e;as(t)}function ds(t,e){return e.returnIdpCredential=!0,Xs(t,Vs,e)}function ps(t,e){return e.returnIdpCredential=!0,Xs(t,Ks,e)}function vs(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Xs(t,Bs,e)}function gs(t){if(!t.oobCode)throw new S("invalid-action-code")}(t=Wa.prototype).Db=function(t,e){var n={idToken:t},r=[];return dt(us,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),Xs(this,Ls,n)},t.vb=function(t,e){return yt(t={requestType:"PASSWORD_RESET",email:t},e),Xs(this,Ps,t)},t.wb=function(t,e){return yt(t={requestType:"EMAIL_SIGNIN",email:t},e),Xs(this,ks,t)},t.ub=function(t,e){return yt(t={requestType:"VERIFY_EMAIL",idToken:t},e),Xs(this,As,t)},t.Eb=function(t,e,n){return yt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),Xs(this,Ns,t)},t.fb=function(t){return Xs(this,Gs,t)},t.nb=function(t,e){return Xs(this,xs,{oobCode:t,newPassword:e})},t.Ra=function(t){return Xs(this,ms,{oobCode:t})},t.jb=function(t){return Xs(this,ys,{oobCode:t})};var ys={endpoint:"setAccountInfo",A:gs,Z:"email",B:!0},ms={endpoint:"resetPassword",A:gs,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new S("internal-error")},B:!0},_s={endpoint:"signupNewUser",A:function(t){if(is(t),!t.password)throw new S("weak-password")},G:as,V:!0,B:!0},bs={endpoint:"createAuthUri",B:!0},ws={endpoint:"deleteAccount",N:["idToken"]},Is={endpoint:"setAccountInfo",N:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new S("internal-error")}},Ts={endpoint:"emailLinkSignin",N:["email","oobCode"],A:is,G:as,V:!0,B:!0},Es={endpoint:"emailLinkSignin",N:["idToken","email","oobCode"],A:is,G:as,V:!0},Os={endpoint:"accounts/mfaEnrollment:finalize",N:["idToken","phoneVerificationInfo"],A:cs,G:as,B:!0,Na:!0},Ss={endpoint:"accounts/mfaSignIn:finalize",N:["mfaPendingCredential","phoneVerificationInfo"],A:cs,G:as,B:!0,Na:!0},Cs={endpoint:"getAccountInfo"},ks={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new S("internal-error");is(t)},Z:"email",B:!0},As={endpoint:"getOobConfirmationCode",N:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new S("internal-error")},Z:"email",B:!0},Ns={endpoint:"getOobConfirmationCode",N:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new S("internal-error")},Z:"email",B:!0},Ps={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new S("internal-error");is(t)},Z:"email",B:!0},js={lb:!0,endpoint:"getProjectConfig",Ub:"GET"},Rs={lb:!0,endpoint:"getRecaptchaParam",Ub:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new S("internal-error")}},xs={endpoint:"resetPassword",A:gs,Z:"email",B:!0},Ds={endpoint:"sendVerificationCode",N:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Ls={endpoint:"setAccountInfo",N:["idToken"],A:os,V:!0},Ms={endpoint:"setAccountInfo",N:["idToken"],A:function(t){if(os(t),!t.password)throw new S("weak-password")},G:as,V:!0},Fs={endpoint:"signupNewUser",G:as,V:!0,B:!0},Us={endpoint:"accounts/mfaEnrollment:start",N:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new S("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new S("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new S("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new S("internal-error")},B:!0,Na:!0},qs={endpoint:"accounts/mfaSignIn:start",N:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new S("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new S("internal-error")},B:!0,Na:!0},Vs={endpoint:"verifyAssertion",A:ls,Ya:hs,G:fs,V:!0,B:!0},Bs={endpoint:"verifyAssertion",A:ls,Ya:hs,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new S("user-not-found");if(t.errorMessage)throw Js(t.errorMessage);as(t)},V:!0,B:!0},Ks={endpoint:"verifyAssertion",A:function(t){if(ls(t),!t.idToken)throw new S("internal-error")},Ya:hs,G:fs,V:!0},Ws={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new S("invalid-custom-token")},G:as,V:!0,B:!0},Hs={endpoint:"verifyPassword",A:function(t){if(is(t),!t.password)throw new S("wrong-password")},G:as,V:!0,B:!0},Gs={endpoint:"verifyPhoneNumber",A:ss,G:as,B:!0},zs={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new S("internal-error");ss(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Wo(t);as(t)}},Qs={Hb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ss,G:as,B:!0},Ys={endpoint:"accounts/mfaEnrollment:withdraw",N:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[Ga]^!!t.refreshToken)throw new S("internal-error")},B:!0,Na:!0};function Xs(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.N))return ke(new S("internal-error"));var r,i=!!e.Na,o=e.Ub||"POST";return Ce(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o,a){var s=Un(e+n);Mn(s,"key",t.c),a&&Mn(s,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Mn(s,c,i[c]);return new be((function(e,n){es(t,s.toString(),(function(t){t?t.error?n($s(t,o||{})):e(t):n(new S("network-request-failed"))}),r,u?void 0:rr(xr(i)),t.a,t.v.get())}))}(t,i?t.i:t.h,e.endpoint,o,n,e.Hb,e.lb||!1)})).then((function(t){return r=t,e.Ya?e.Ya(n,r):r})).then(e.G).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new S("internal-error");return r[e.Z]}))}function Js(t){return $s({error:{errors:[{message:t}],code:400,message:t}})}function $s(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new S(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",yt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new S(r[i],e);return!e&&t&&(e=Rr(t)),new S("internal-error",e)}function Zs(t){this.b=t,this.a=null,this.rb=function(t){return(ru||(ru=new be((function(t,e){function n(){Fr(),Cr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Fr(),e(Error("Network Error"))},timeout:eu.get()})}if(Cr("gapi.iframes.Iframe"))t();else if(Cr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();s[r]=function(){Cr("gapi.load")?n():e(Error("Network Error"))},Ce(Ma(r=Ct(tu,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw ru=null,t})))).then((function(){return new be((function(e,n){Cr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),nu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var tu=new _t(Tt,"https://apis.google.com/js/api.js?onload=%{onload}"),eu=new Ur(3e4,6e4),nu=new Ur(5e3,15e3),ru=null;function iu(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,t=this.g?qn((t=Un(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):qn("https",this.l,null,"/__/auth/iframe"),this.a=t,Mn(this.a,"apiKey",this.h),Mn(this.a,"appName",this.i),this.b=null,this.c=[]}function ou(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function au(t){try{return r.default.app(t).auth().Ga()}catch(e){return[]}}function su(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function uu(t){var e=cr();return function(t){return Xs(t,js,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Un(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Un(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:pr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Bo(cr())}))}function cu(t){return t.m||(t.m=gr().then((function(){if(!t.u){var e=t.c,n=t.i,r=au(t.b),i=new iu(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=$(r||[]),t.u=i.toString()}t.v=new Zs(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.rb.then((function(){t.a.register("authEvent",e,Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.v,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Fo(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Ce(n)}return n.status="ERROR",Ce(n)}))}(t)}))),t.m}function lu(t){return t.l||(t.C=t.c?Or(t.c,au(t.b)):null,t.l=new Wa(t.g,j(t.i),t.C),t.f&&$a(t.l,t.f)),t.l}function hu(t,e,n,r,i,o,a,s,u,c,l,h){return(t=new ou(t,e,n,r,i,h)).l=o,t.g=a,t.i=s,t.b=vt(u||null),t.f=c,t.yb(l).toString()}function fu(t){if(this.a=t||r.default.INTERNAL.reactNative&&r.default.INTERNAL.reactNative.AsyncStorage,!this.a)throw new S("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function du(t){this.b=t,this.a={},this.f=w(this.c,this)}iu.prototype.toString=function(){return this.f?Mn(this.a,"v",this.f):$n(this.a.b,"v"),this.b?Mn(this.a,"eid",this.b):$n(this.a.b,"eid"),this.c.length?Mn(this.a,"fw",this.c.join(",")):$n(this.a.b,"fw"),this.a.toString()},ou.prototype.yb=function(t){return this.h=t,this},ou.prototype.toString=function(){if(this.v){var t=Un(this.v.url);t=qn(t.c,t.a,t.g,"/emulator/auth/handler")}else t=qn("https",this.u,null,"/__/auth/handler");if(Mn(t,"apiKey",this.s),Mn(t,"appName",this.c),Mn(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=r.default.app(this.c).auth().la()}catch(u){n=null}for(var i in e.ob=n,Mn(t,"providerId",this.a.providerId),e=xr((n=this.a).Ib))e[i]=e[i].toString();i=n.Qc,e=vt(e);for(var o=0;o<i.length;o++){var a=i[o];a in e&&delete e[a]}n.pb&&n.ob&&!e[n.pb]&&(e[n.pb]=n.ob),pt(e)||Mn(t,"customParameters",Rr(e))}if("function"==typeof this.a.Qb&&(n=this.a.Qb()).length&&Mn(t,"scopes",n.join(",")),this.l?Mn(t,"redirectUrl",this.l):$n(t.b,"redirectUrl"),this.g?Mn(t,"eventId",this.g):$n(t.b,"eventId"),this.i?Mn(t,"v",this.i):$n(t.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!Fn(t,s)&&Mn(t,s,this.b[s]);return this.h?Mn(t,"tid",this.h):$n(t.b,"tid"),this.f?Mn(t,"eid",this.f):$n(t.b,"eid"),(s=au(this.c)).length&&Mn(t,"fw",s.join(",")),t.toString()},(t=su.prototype).Ob=function(t,e,n){var r=new S("popup-closed-by-user"),i=new S("web-storage-unsupported"),o=this,a=!1;return this.ma().then((function(){(function(t){var e={type:"webStorageSupport"};return cu(t).then((function(){return function(t,e){return t.rb.then((function(){return new be((function(n){t.a.send(e.type,e,n,Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.v,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&fr(t),e(i),a=!0)}))})).o((function(){})).then((function(){if(!a)return function(t){return new be((function(e){return function n(){Sn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return Sn(n).then((function(){e(r)}))}))},t.Xb=function(){var t=Sr();return!jr(t)&&!Mr(t)},t.Tb=function(){return!1},t.Mb=function(t,e,n,r,i,o,a,s){if(!t)return ke(new S("popup-blocked"));if(a&&!jr())return this.ma().o((function(e){fr(t),i(e)})),r(),Ce();this.a||(this.a=uu(lu(this)));var u=this;return this.a.then((function(){var e=u.ma().o((function(e){throw fr(t),i(e),e}));return r(),e})).then((function(){Lo(n),a||lr(hu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Nb=function(t,e,n,r){this.a||(this.a=uu(lu(this)));var i=this;return this.a.then((function(){Lo(e),lr(hu(i.s,i.g,i.b,t,e,cr(),n,i.c,void 0,i.i,r,i.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ma=function(){var t=this;return cu(this).then((function(){return t.v.rb})).o((function(){throw t.a=null,new S("network-request-failed")}))},t.$b=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Sa=function(t){X(this.h,(function(e){return e==t}))},(t=fu.prototype).get=function(t){return Ce(this.a.getItem(t)).then((function(t){return t&&Dr(t)}))},t.set=function(t,e){return Ce(this.a.setItem(t,Rr(e)))},t.U=function(t){return Ce(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var pu,vu=[];function gu(t,e,n){pt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function yu(t){this.a=t}function mu(t){this.c=t,this.b=!1,this.a=[]}function _u(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return ke(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new be((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),l),t.a.push(c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}}),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return bu(t,c),e})).o((function(e){throw bu(t,c),e}))}function bu(t,e){if(e){var n=e.messageChannel;n&&(n.port1.removeEventListener("message",e.onMessage),n.port1.close()),X(t.a,(function(t){return t==e}))}}function wu(){if(!Eu())throw new S("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=s.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;_r()&&self?(this.v=function(){var t=_r()?self:null;if(W(vu,(function(n){n.b==t&&(e=n)})),!e){var e=new du(t);vu.push(e)}return e}(),gu(this.v,"keyChanged",(function(e,n){return Au(t).then((function(e){return 0<e.length&&W(t.a,(function(t){t(e)})),{keyProcessed:Q(e,n.key)}}))})),gu(this.v,"ping",(function(){return Ce(["keyChanged"])}))):function(){var t=s.navigator;return t&&t.serviceWorker?Ce().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):Ce(null)}().then((function(e){(t.h=e)&&(t.g=new mu(new yu(e)),_u(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&Q(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Iu(t){return t.i||(t.i=function t(e){return new be((function(n,r){var i=e.m.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(e){}r(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){r(e)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?n(i):function(t){return new be((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(e).then((function(){return t(e)})).then((function(t){n(t)})).o((function(t){r(t)}))}}))}(t)),t.i}function Tu(t,e){var n=0;return new be((function r(i,o){Iu(t).then(e).then(i).o((function(e){if(!(3<++n))return Iu(t).then((function(e){return e.close(),t.i=void 0,r(i,o)})).o((function(t){o(t)}));o(e)}))}))}function Eu(){try{return!!s.indexedDB}catch(zt){return!1}}function Ou(t){return t.objectStore("firebaseLocalStorage")}function Su(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Cu(t){return new be((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function ku(t,e){return t.g&&t.h&&function(){var t=s.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?_u(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):Ce()}function Au(t){return Iu(t).then((function(t){var e=Ou(Su(t,!1));return e.getAll?Cu(e.getAll()):new be((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r}))}function Nu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Pu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ce().then((function(){if(Eu()){var t=Lr(),r="__sak"+t;return pu||(pu=new wu),(n=pu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){W(e.a,(function(e){e(t)}))})),t}))}function ju(){this.a={},this.type="inMemory"}function Ru(){if(!function(){var t="Node"==br();if(!(t=xu()||t&&r.default.INTERNAL.node&&r.default.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==br())throw new S("internal-error","The LocalStorage compatibility library was not found.");throw new S("web-storage-unsupported")}this.a=xu()||r.default.INTERNAL.node.localStorage,this.type="localStorage"}function xu(){try{var t=s.localStorage,e=Lr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Du(){this.type="nullStorage"}function Lu(){if(!function(){var t="Node"==br();if(!(t=Mu()||t&&r.default.INTERNAL.node&&r.default.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==br())throw new S("internal-error","The SessionStorage compatibility library was not found.");throw new S("web-storage-unsupported")}this.a=Mu()||r.default.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Mu(){try{var t=s.sessionStorage,e=Lr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Fu(){var t={};t.Browser=Vu,t.Node=Bu,t.ReactNative=Ku,t.Worker=Wu,this.a=t[br()]}du.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];W(r,(function(e){i.push(Ce().then((function(){return e(t.origin,t.data.data)})))})),Ne(i).then((function(r){var i=[];W(r,(function(t){i.push({fulfilled:t.Pb,value:t.value,reason:t.reason?t.reason.message:void 0})})),W(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},yu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},mu.prototype.close=function(){for(;0<this.a.length;)bu(this,this.a[0]);this.b=!0},(t=wu.prototype).set=function(t,e){var n=this,r=!1;return Tu(this,(function(e){return Cu((e=Ou(Su(e,!0))).get(t))})).then((function(i){return Tu(n,(function(o){if(o=Ou(Su(o,!0)),i)return i.value=e,Cu(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=t,a.value=e,Cu(o.add(a))}))})).then((function(){return n.c[t]=e,ku(n,t)})).oa((function(){r&&n.b--}))},t.get=function(t){return Tu(this,(function(e){return Cu(Ou(Su(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.U=function(t){var e=this,n=!1;return Tu(this,(function(r){return n=!0,e.b++,Cu(Ou(Su(r,!0)).delete(t))})).then((function(){return delete e.c[t],ku(e,t)})).oa((function(){n&&e.b--}))},t.ca=function(t){0==this.a.length&&function(t){Nu(t),function e(){t.f=setTimeout((function(){t.l=Au(t).then((function(e){0<e.length&&W(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},t.ia=function(t){X(this.a,(function(e){return e==t})),0==this.a.length&&Nu(this)},(t=Pu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.U=function(t){return this.b.then((function(e){return e.U(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){X(this.a,(function(e){return e==t}))},(t=ju.prototype).get=function(t){return Ce(this.a[t])},t.set=function(t,e){return this.a[t]=e,Ce()},t.U=function(t){return delete this.a[t],Ce()},t.ca=function(){},t.ia=function(){},(t=Ru.prototype).get=function(t){var e=this;return Ce().then((function(){return Dr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Ce().then((function(){var r=Rr(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Ce().then((function(){e.a.removeItem(t)}))},t.ca=function(t){s.window&&un(s.window,"storage",t)},t.ia=function(t){s.window&&hn(s.window,"storage",t)},(t=Du.prototype).get=function(){return Ce(null)},t.set=function(){return Ce()},t.U=function(){return Ce()},t.ca=function(){},t.ia=function(){},(t=Lu.prototype).get=function(t){var e=this;return Ce().then((function(){return Dr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Ce().then((function(){var r=Rr(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Ce().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var Uu,qu,Vu={F:Ru,bb:Lu},Bu={F:Ru,bb:Lu},Ku={F:fu,bb:Du},Wu={F:Ru,bb:Du},Hu={rd:"local",NONE:"none",td:"session"};function Gu(){var t=!(Mr(Sr())||!mr()),e=jr(),n=kr();this.m=t,this.h=e,this.l=n,this.a={},Uu||(Uu=new Fu),t=Uu;try{this.g=!ur()&&Br()||!s.indexedDB?new t.a.F:new Pu(_r()?new ju:new t.a.F)}catch(r){this.g=new ju,this.h=!0}try{this.i=new t.a.bb}catch(r){this.i=new ju}this.v=new ju,this.f=w(this.Yb,this),this.b={}}function zu(){return qu||(qu=new Gu),qu}function Qu(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function Yu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Xu(t,e,n){return n=Yu(e,n),"local"==e.F&&(t.b[n]=null),Qu(t,e.F).U(n)}function Ju(t){t.c&&(clearInterval(t.c),t.c=null)}function $u(t){this.a=t,this.b=zu()}(t=Gu.prototype).get=function(t,e){return Qu(this,t.F).get(Yu(t,e))},t.set=function(t,e,n){var r=Yu(t,n),i=this,o=Qu(this,t.F);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=Yu(t,e),this.l&&(this.b[t]=s.localStorage.getItem(t)),pt(this.a)&&(Qu(this,"local").ca(this.f),this.h||(ur()||!Br())&&s.indexedDB||!this.l||function(t){Ju(t),t.c=setInterval((function(){for(var e in t.a){var n=s.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Xe({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Yb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=Yu(t,e),this.a[t]&&(X(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),pt(this.a)&&(Qu(this,"local").ia(this.f),Ju(this))},t.Yb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=s.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.mb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Qu(this,"local").ia(this.f):Ju(this),this.m)if(n=s.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?s.localStorage.setItem(e,r):s.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===s.localStorage.getItem(e)||(o.b[e]=s.localStorage.getItem(e),o.mb(e))},Yt&&ae&&10==ae&&s.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else W(t,w(this.mb,this))},t.mb=function(t){this.a[t]&&W(this.a[t],(function(t){t()}))};var Zu,tc={name:"authEvent",F:"local"};function ec(){this.a=zu()}function nc(t,e){this.b=rc,this.f=s.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=s.Int32Array?new Int32Array(64):Array(64),void 0===Zu&&(Zu=s.Int32Array?new Int32Array(lc):lc),this.reset()}E(nc,(function(){this.b=-1}));for(var rc=64,ic=rc-1,oc=[],ac=0;ac<ic;ac++)oc[ac]=0;var sc=J(128,oc);function uc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){var o=(0|n[e-16])+(((i=0|n[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+(((r=0|n[e-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|Zu[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function cc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(uc(t),i=0);else{if(!d(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(uc(t),i=0)}}t.c=i,t.g+=n}nc.prototype.reset=function(){this.g=this.c=0,this.a=s.Int32Array?new Int32Array(this.h):$(this.h)};var lc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function hc(){nc.call(this,8,fc)}E(hc,nc);var fc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function dc(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new ec,this.g=new $u(this.h),this.f=null,this.b=[],this.a=this.c=null}function pc(t){return new S("invalid-cordova-configuration",t)}function vc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function gc(t){return t.f||(t.f=t.ma().then((function(){return new be((function(e){t.Ea((function n(r){return e(r),t.Sa(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),yc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=eo(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Dr(Fn(o=Un(i),"firebaseError")||null))?C(o):null)?new Mo(r.c,r.b,null,null,o,null,r.T()):new Mo(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}vc(t,i)}))}var n=new Mo("unknown",null,null,null,new S("no-auth-event")),r=!1,i=Sn(500).then((function(){return yc(t).then((function(){r||vc(t,n)}))})),o=s.handleOpenURL;s.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Cr("BuildInfo.packageName",s).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(n){console.error(n)}},Vo||(Vo=new Uo),function(t){var e=Vo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Cr("universalLinks.subscribe",s))&&t(null,e.b))}(e)}(t)}))}))),t.f}function yc(t){var e=null;return function(t){return t.b.get(tc,t.a).then((function(t){return Fo(t)}))}(t.g).then((function(n){return e=n,Xu((n=t.g).b,tc,n.a)})).then((function(){return e}))}function mc(t){this.a=t,this.b=zu()}(t=dc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(yr(void 0)?gr().then((function(){return new be((function(t,e){var n=s.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):ke(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Cr("universalLinks.subscribe",s))throw pc("cordova-universal-links-plugin-fix is not installed");if(void 0===Cr("BuildInfo.packageName",s))throw pc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Cr("cordova.plugins.browsertab.openUrl",s))throw pc("cordova-plugin-browsertab is not installed");if("function"!=typeof Cr("cordova.InAppBrowser.open",s))throw pc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new S("cordova-not-ready")}))},t.Ob=function(t,e){return e(new S("operation-not-supported-in-this-environment")),Ce()},t.Mb=function(){return ke(new S("operation-not-supported-in-this-environment"))},t.$b=function(){return!1},t.Xb=function(){return!0},t.Tb=function(){return!0},t.Nb=function(t,e,n,r){if(this.c)return ke(new S("redirect-operation-pending"));var i=this,o=s.document,a=null,u=null,c=null,l=null;return this.c=Ce().then((function(){return Lo(e),gc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Mo(e,r,null,o,new S("no-auth-event"),null,i),u=Cr("BuildInfo.packageName",s);if("string"!=typeof u)throw new S("invalid-cordova-configuration");var c=Cr("BuildInfo.displayName",s),l={};if(Sr().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=u;else{if(!Sr().toLowerCase().match(/android/))return ke(new S("operation-not-supported-in-this-environment"));l.apn=u}c&&(l.appDisplayName=c),o=function(t){var e=new hc;cc(e,t),t=[];var n=8*e.g;cc(e,sc,56>e.c?56-e.c:e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(uc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return G(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(o),l.sessionId=o;var h=hu(t.v,t.i,t.l,e,n,null,r,t.m,l,t.u,i,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(tc,a.w(),e)})).then((function(){var e=Cr("cordova.plugins.browsertab.isAvailable",s);if("function"!=typeof e)throw new S("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Cr("cordova.plugins.browsertab.openUrl",s)))throw new S("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Cr("cordova.InAppBrowser.open",s)))throw new S("invalid-cordova-configuration");e=Sr(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new be((function(t,e){u=function(){var e=Cr("cordova.plugins.browsertab.close",s);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(u),l=function(){qr()&&c()},o.addEventListener("resume",c=function(){a||(a=Sn(2e3).then((function(){e(new S("redirect-cancelled-by-user"))})))},!1),Sr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).o((function(t){return yc(i).then((function(){throw t}))}))})).oa((function(){c&&o.removeEventListener("resume",c,!1),l&&o.removeEventListener("visibilitychange",l,!1),a&&a.cancel(),u&&i.Sa(u),i.c=null}))},t.Ea=function(t){this.b.push(t),gc(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Mo("unknown",null,null,null,new S("no-auth-event")),t(e))}))},t.Sa=function(t){X(this.b,(function(e){return e==t}))};var _c={name:"pendingRedirect",F:"session"};function bc(t){return Xu(t.b,_c,t.a)}function wc(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=w(this.s,this),this.b=new Lc,this.C=new Vc,this.g=new mc(xc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Ic(this.D,this.v,this.m,k,this.J)}function Ic(t,e,n,i,o){var a=r.default.SDK_VERSION||null;return yr()?new dc(t,e,n,a,i,o):new su(t,e,n,a,i,o)}function Tc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function Ec(t){t.a.Xb()&&Tc(t).o((function(e){var n=new Mo("unknown",null,null,null,new S("operation-not-supported-in-this-environment"));Nc(e)&&t.s(n)})),t.a.Tb()||Mc(t.b)}function Oc(t,e){Q(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(_c,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?bc(t.g).then((function(){Tc(t).o((function(e){var n=new Mo("unknown",null,null,null,new S("operation-not-supported-in-this-environment"));Nc(e)&&t.s(n)}))})):Ec(t)})).o((function(){Ec(t)}))}function Sc(t,e){X(t.h,(function(t){return t==e}))}wc.prototype.reset=function(){this.f=!1,this.a.Sa(this.l),this.a=Ic(this.D,this.v,this.m,null,this.J),this.i={}},wc.prototype.s=function(t){if(!t)throw new S("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Fb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return Mc(this.b),e};var Cc=new Ur(2e3,1e4),kc=new Ur(3e4,6e4);function Ac(t,e,n,r,i,o,a){return t.a.Mb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,a)}function Nc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Pc(t,e,n,r,i){var o;return function(t){return t.b.set(_c,"pending",t.a)}(t.g).then((function(){return t.a.Nb(e,n,r,i).o((function(e){if(Nc(e))throw new S("operation-not-supported-in-this-environment");return o=e,bc(t.g).then((function(){throw o}))})).then((function(){return t.a.$b()?new be((function(){})):bc(t.g).then((function(){return t.qa()})).then((function(){})).o((function(){}))}))}))}function jc(t,e,n,r,i){return t.a.Ob(r,(function(t){e.na(n,null,t,i)}),Cc.get())}wc.prototype.qa=function(){return this.b.qa()};var Rc={};function xc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Dc(t,e,n,r){var i=xc(e,n,r);return Rc[i]||(Rc[i]=new wc(t,e,n,r)),Rc[i]}function Lc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Mc(t){t.g||(t.g=!0,qc(t,!1,null,null))}function Fc(t){t.g&&!t.i&&qc(t,!1,null,null)}function Uc(t,e){if(t.b=function(){return Ce(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function qc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return ke(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Uc(t,n):Uc(t,{user:null}),t.f=[],t.c=[]}function Vc(){}function Bc(){this.ib=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ib},set:function(t){this.ib=t},enumerable:!1})}function Kc(t,e){this.a=e,zr(this,"verificationId",t)}function Wc(t,e,n,r){return new Ro(t).fb(e,n).then((function(t){return new Kc(t,r)}))}function Hc(t){var e=Vi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new S("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Qr(this,{token:t,expirationTime:Vr(1e3*e.exp),authTime:Vr(1e3*e.auth_time),issuedAtTime:Vr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function Gc(t,e,n){var r=e&&e[Qc];if(!r)throw new S("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=vt(e),this.g=n,this.c=new no(null,r),this.b=[];var i=this;W(e[zc]||[],(function(t){(t=$r(t))&&i.b.push(t)})),zr(this,"auth",this.a),zr(this,"session",this.c),zr(this,"hints",this.b)}Lc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Lc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(qc(this,!0,null,t.a),Ce()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.T(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){qc(t,s,e,null)})).o((function(e){qc(t,s,null,e)}))}(this,t,e):ke(new S("invalid-auth-event")):(qc(this,!1,null,null),Ce())}else ke(new S("invalid-auth-event"))},Lc.prototype.qa=function(){var t=this;return new be((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new S("timeout");t.a&&t.a.cancel(),t.a=Sn(kc.get()).then((function(){t.b||(t.g=!0,qc(t,!0,null,e))}))}(t))}))},Vc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),Ce()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(r,t,null,n)})).o((function(t){e.na(r,null,t,n)}))}(t,e):ke(new S("invalid-auth-event"))}else ke(new S("invalid-auth-event"))},Kc.prototype.confirm=function(t){return t=xo(this.verificationId,t),this.a(t)};var zc="mfaInfo",Qc="mfaPendingCredential";function Yc(t,e,n,r){S.call(this,"multi-factor-auth-required",r,e),this.b=new Gc(t,e,n),zr(this,"resolver",this.b)}function Xc(t,e,n){if(t&&v(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new Yc(e,t.serverResponse,n,t.message)}catch(r){}return null}function Jc(){}function $c(t){zr(this,"factorId",t.fa),this.a=t}function Zc(t){if($c.call(this,t),this.a.fa!=Ro.PROVIDER_ID)throw new S("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function tl(t,e){for(var n in Ye.call(this,t),e)this[n]=e[n]}function el(t,e){this.a=t,this.b=[],this.c=w(this.yc,this),un(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&W(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[ei]=t.uid),t.displayName&&(r[Zr]=t.displayName),t.enrollmentTime&&(r[ti]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[ni]=t.phoneNumber);try{e=new ri(r)}catch(i){}t=e}else t=null;t&&n.push(t)})),nl(this,n)}function nl(t,e){t.b=e,zr(t,"enrolledFactors",e)}function rl(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function il(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function ol(t,e){void 0===e&&(e=t.b?(e=t.b).a-e.g:0),t.c=Date.now()+1e3*e}function al(t,e){t.b=qi(e[Ga]||""),t.a=e.refreshToken,ol(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function sl(t,e){this.a=t||null,this.b=e||null,Qr(this,{lastSignInTime:Vr(e||null),creationTime:Vr(t||null)})}function ul(t,e,n,r,i,o){Qr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function cl(t,e,n){this.J=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var i=r.default.SDK_VERSION?Or(r.default.SDK_VERSION):null;this.a=new Wa(this.l,j(k),i),t.emulatorConfig&&$a(this.a,t.emulatorConfig),this.b=new il(this.a),yl(this,e[Ga]),al(this.b,e),zr(this,"refreshToken",this.b.a),bl(this,n||{}),bn.call(this),this.R=!1,this.s&&Ar()&&(this.i=Dc(this.s,this.l,this.m)),this.S=[],this.h=null,this.u=function(t){return new rl((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.b.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.aa=w(this.hb,this);var o=this;this.ya=null,this.Oa=function(t){o.wa(t.h)},this.ja=null,this.Aa=function(t){$a(o.a,t.c)},this.X=null,this.$=[],this.Ba=function(t){fl(o,t.f)},this.ba=null,this.O=new el(this,n),zr(this,"multiFactor",this.O)}function ll(t,e){t.ja&&hn(t.ja,"languageCodeChanged",t.Oa),(t.ja=e)&&un(e,"languageCodeChanged",t.Oa)}function hl(t,e){t.X&&hn(t.X,"emulatorConfigChanged",t.Aa),(t.X=e)&&un(e,"emulatorConfigChanged",t.Aa)}function fl(t,e){t.$=e,ts(t.a,r.default.SDK_VERSION?Or(r.default.SDK_VERSION,t.$):null)}function dl(t,e){t.ba&&hn(t.ba,"frameworkChanged",t.Ba),(t.ba=e)&&un(e,"frameworkChanged",t.Ba)}function pl(t){try{return r.default.app(t.m).auth()}catch(e){throw new S("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function vl(t){t.D||t.u.b||(t.u.start(),hn(t,"tokenChanged",t.aa),un(t,"tokenChanged",t.aa))}function gl(t){hn(t,"tokenChanged",t.aa),t.u.stop()}function yl(t,e){t.za=e,zr(t,"_lat",e)}function ml(t){for(var e=[],n=0;n<t.S.length;n++)e.push(t.S[n](t));return Ne(e).then((function(){return t}))}function _l(t){t.i&&!t.R&&(t.R=!0,Oc(t.i,t))}function bl(t,e){Qr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new sl(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function wl(){}function Il(t){return Ce().then((function(){if(t.D)throw new S("app-deleted")}))}function Tl(t){return G(t.providerData,(function(t){return t.providerId}))}function El(t,e){e&&(Ol(t,e.providerId),t.providerData.push(e))}function Ol(t,e){X(t.providerData,(function(t){return t.providerId==e}))}function Sl(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&zr(t,e,n)}function Cl(t,e){t!=e&&(Qr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),zr(t,"metadata",e.metadata?function(t){return new sl(t.a,t.b)}(e.metadata):new sl),W(e.providerData,(function(e){El(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),zr(t,"refreshToken",t.b.a),nl(t.O,e.O.b))}function kl(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return Xs(t.a,Cs,{idToken:e}).then(w(t.Kc,t))}(t,e).then((function(){return n||Sl(t,"isAnonymous",!1),e}))}))}function Al(t,e){e[Ga]&&t.za!=e[Ga]&&(al(t.b,e),t.dispatchEvent(new tl("tokenChanged")),yl(t,e[Ga]),Sl(t,"refreshToken",t.b.a))}function Nl(t,e){return kl(t).then((function(){if(Q(Tl(t),e))return ml(t).then((function(){throw new S("provider-already-linked")}))}))}function Pl(t,e,n){return Yr({user:t,credential:Do(e),additionalUserInfo:e=Gi(e),operationType:n})}function jl(t,e){return Al(t,e),t.reload().then((function(){return t}))}function Rl(t,e,n,i,o){if(!Ar())return ke(new S("operation-not-supported-in-this-environment"));if(t.h&&!o)return ke(t.h);var a=Hi(n.providerId),s=Lr(t.uid+":::"),u=null;(!jr()||mr())&&t.s&&n.isOAuthProvider&&(u=hu(t.s,t.l,t.m,e,n,null,s,r.default.SDK_VERSION||null,null,null,t.tenantId));var c=dr(u,a&&a.ua,a&&a.ta);return i=i().then((function(){if(Dl(t),!o)return t.I().then((function(){}))})).then((function(){return Ac(t.i,c,e,n,s,!!u,t.tenantId)})).then((function(){return new be((function(n,r){t.na(e,null,new S("cancelled-popup-request"),t.g||null),t.f=n,t.C=r,t.g=s,t.c=jc(t.i,t,e,c,s)}))})).then((function(t){return c&&fr(c),t?Yr(t):null})).o((function(t){throw c&&fr(c),t})),Ll(t,i,o)}function xl(t,e,n,r,i){if(!Ar())return ke(new S("operation-not-supported-in-this-environment"));if(t.h&&!i)return ke(t.h);var o=null,a=Lr(t.uid+":::");return r=r().then((function(){if(Dl(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=a,ml(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(Ul,t.w(),e.a)),e})).then((function(){return Pc(t.i,e,n,a,t.tenantId)})).o((function(e){if(o=e,t.ha)return ql(t.ha);throw o})).then((function(){if(o)throw o})),Ll(t,r,i)}function Dl(t){if(!t.i||!t.R){if(t.i&&!t.R)throw new S("internal-error");throw new S("auth-domain-config-required")}}function Ll(t,e,n){var r=function(t,e,n){return t.h&&!n?(e.cancel(),ke(t.h)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new tl("userInvalidated")),t.h=e),e}))}(t,e,n);return t.J.push(r),r.oa((function(){Y(t.J,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Xc(e.w(),pl(t),w(t.jc,t))),n||e}))}function Ml(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Ga]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new cl(e,n,t);return t.providerData&&W(t.providerData,(function(t){t&&El(i,Yr(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function Fl(t){this.a=t,this.b=zu()}Gc.prototype.Rc=function(t){var e=this;return t.sb(this.a.a,this.c).then((function(t){var n=vt(e.f);return delete n[zc],delete n[Qc],yt(n,t),e.g(n)}))},E(Yc,S),Jc.prototype.sb=function(t,e,n){return e.type==ro?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),yt(n,{phoneVerificationInfo:jo(t.a)}),Xs(e,Os,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return yt(n={mfaPendingCredential:n},{phoneVerificationInfo:jo(t.a)}),Xs(e,Ss,n)}))}(this,t,e)},E($c,Jc),E(Zc,$c),E(tl,Ye),(t=el.prototype).yc=function(t){nl(this,function(t){var e=[];return W(t.mfaInfo||[],(function(t){(t=$r(t))&&e.push(t)})),e}(t.hd))},t.Rb=function(){return this.a.I().then((function(t){return new no(t,null)}))},t.fc=function(t,e){var n=this,r=this.a.a;return this.Rb().then((function(n){return t.sb(r,n,e)})).then((function(t){return Al(n.a,t),n.a.reload()}))},t.bd=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return Xs(r,Ys,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=H(e.b,(function(t){return t.uid!=n}));return nl(e,r),Al(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:G(this.b,(function(t){return t.w()}))}}},rl.prototype.start=function(){this.a=this.c,function t(e,n){e.stop(),e.b=Sn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then((function(){return function(){var t=s.document,e=null;return qr()||!t?Ce():new be((function(n){e=function(){qr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return e.h()})).then((function(){t(e,!0)})).o((function(n){e.i(n)&&t(e,!1)}))}(this,!0)},rl.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},il.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},il.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?ke(new S("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?function(t,e){return function(t,e){return new be((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?es(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r($s(t)):t.access_token&&t.refresh_token?n(t):r(new S("internal-error")):r(new S("network-request-failed"))}),"POST",Jn(e).toString(),t.g,t.m.get()):r(new S("internal-error"))}))}(t.f,e).then((function(e){return t.b=qi(e.access_token),t.a=e.refresh_token,ol(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):Ce(null):Ce({accessToken:this.b.toString(),refreshToken:this.a})},sl.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},E(cl,bn),cl.prototype.wa=function(t){this.ya=t,Ja(this.a,t)},cl.prototype.la=function(){return this.ya},cl.prototype.Ga=function(){return $(this.$)},cl.prototype.hb=function(){this.u.b&&(this.u.stop(),this.u.start())},zr(cl.prototype,"providerId","firebase"),(t=cl.prototype).reload=function(){var t=this;return Ll(this,Il(this).then((function(){return kl(t).then((function(){return ml(t)})).then(wl)})))},t.oc=function(t){return this.I(t).then((function(t){return new Hc(t)}))},t.I=function(t){var e=this;return Ll(this,Il(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new S("internal-error");return t.accessToken!=e.za&&(yl(e,t.accessToken),e.dispatchEvent(new tl("tokenChanged"))),Sl(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Kc=function(t){if(!(t=t.users)||!t.length)throw new S("internal-error");bl(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?G(t,(function(t){return new ul(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)El(this,e[n]);Sl(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new tl("userReloaded",{hd:t}))},t.Lc=function(t){return Hr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.tb(t)},t.tb=function(t){var e=this,n=null;return Ll(this,t.c(this.a,this.uid).then((function(t){return Al(e,t),n=Pl(e,t,"reauthenticate"),e.h=null,e.reload()})).then((function(){return n})),!0)},t.Cc=function(t){return Hr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.qb(t)},t.qb=function(t){var e=this,n=null;return Ll(this,Nl(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=Pl(e,t,"link"),jl(e,t)})).then((function(){return n})))},t.Dc=function(t,e){var n=this;return Ll(this,Nl(this,"phone").then((function(){return Wc(pl(n),t,e,w(n.qb,n))})))},t.Mc=function(t,e){var n=this;return Ll(this,Ce().then((function(){return Wc(pl(n),t,e,w(n.tb,n))})),!0)},t.Bb=function(t){var e=this;return Ll(this,this.I().then((function(n){return e.a.Bb(n,t)})).then((function(t){return Al(e,t),e.reload()})))},t.ed=function(t){var e=this;return Ll(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return Al(e,t),e.reload()})))},t.Cb=function(t){var e=this;return Ll(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return Al(e,t),e.reload()})))},t.Db=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Il(this);var e=this;return Ll(this,this.I().then((function(n){return e.a.Db(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return Al(e,t),Sl(e,"displayName",t.displayName||null),Sl(e,"photoURL",t.photoUrl||null),W(e.providerData,(function(t){"password"===t.providerId&&(zr(t,"displayName",e.displayName),zr(t,"photoURL",e.photoURL))})),ml(e)})).then(wl))},t.cd=function(t){var e=this;return Ll(this,kl(this).then((function(n){return Q(Tl(e),t)?function(t,e,n){return Xs(t,Is,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return W(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),W(Tl(e),(function(t){n[t]||Ol(e,t)})),n[Ro.PROVIDER_ID]||zr(e,"phoneNumber",null),ml(e)})):ml(e).then((function(){throw new S("no-such-provider")}))})))},t.delete=function(){var t=this;return Ll(this,this.I().then((function(e){return Xs(t.a,ws,{idToken:e})})).then((function(){t.dispatchEvent(new tl("userDeleted"))}))).then((function(){for(var e=0;e<t.J.length;e++)t.J[e].cancel("app-deleted");ll(t,null),hl(t,null),dl(t,null),t.J=[],t.D=!0,gl(t),zr(t,"refreshToken",null),t.i&&Sc(t.i,t)}))},t.Fb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?w(this.Kb,this):"reauthViaPopup"==t&&e==(this.g||null)?w(this.Lb,this):"linkViaRedirect"==t&&(this.ga||null)==e?w(this.Kb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?w(this.Lb,this):null},t.Ec=function(t){var e=this;return Rl(this,"linkViaPopup",t,(function(){return Nl(e,t.providerId).then((function(){return ml(e)}))}),!1)},t.Nc=function(t){return Rl(this,"reauthViaPopup",t,(function(){return Ce()}),!0)},t.Fc=function(t){var e=this;return xl(this,"linkViaRedirect",t,(function(){return Nl(e,t.providerId)}),!1)},t.Oc=function(t){return xl(this,"reauthViaRedirect",t,(function(){return Ce()}),!0)},t.Kb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Ll(this,this.I().then((function(n){return ps(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=Pl(i,t,"link"),jl(i,t)})).then((function(){return o})))},t.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Ll(this,Ce().then((function(){return ao(vs(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=Pl(i,t,"reauthenticate"),Al(i,t),i.h=null,i.reload()})).then((function(){return o})),!0)},t.ub=function(t){var e=this,n=null;return Ll(this,this.I().then((function(e){return n=e,void 0===t||pt(t)?{}:Mi(new Ci(t))})).then((function(t){return e.a.ub(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Eb=function(t,e){var n=this,r=null;return Ll(this,this.I().then((function(t){return r=t,void 0===e||pt(e)?{}:Mi(new Ci(e))})).then((function(e){return n.a.Eb(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.jc=function(t){var e=null,n=this;return Ll(this,t=ao(Ce(t),n.uid).then((function(t){return e=Pl(n,t,"reauthenticate"),Al(n,t),n.h=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&yt(t,this.metadata.w()),W(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),yt(t,this.O.w()),t};var Ul={name:"redirectUser",F:"session"};function ql(t){return Xu(t.b,Ul,t.a)}function Vl(t){this.a=t,this.b=zu(),this.c=null,this.f=function(t){var e=Wl("local"),n=Wl("session"),r=Wl("none");return function(t,e,n){var r=Yu(e,n),i=Qu(t,e.F);return t.get(e,n).then((function(o){var a=null;try{a=Dr(s.localStorage.getItem(r))}catch(u){}if(a&&!o)return s.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&s.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Kl,t.a).then((function(t){return t?Wl(t):e}))}))}))})).then((function(e){return t.c=e,Bl(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener(Wl("local"),this.a,w(this.g,this))}function Bl(t,e){var n,r=[];for(n in Hu)Hu[n]!==e&&r.push(Xu(t.b,Wl(Hu[n]),t.a));return r.push(Xu(t.b,Kl,t.a)),function(t){return new be((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)Ae(t[s],I(o,s),a);else e(i)}))}(r)}Vl.prototype.g=function(){var t=this,e=Wl("local");Ql(this,(function(){return Ce().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return Bl(t,"local").then((function(){t.c=e}))}))}))};var Kl={name:"persistence",F:"session"};function Wl(t){return{name:"authUser",F:t}}function Hl(t,e){return Ql(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function Gl(t){return Ql(t,(function(){return Xu(t.b,t.c,t.a)}))}function zl(t,e,n){return Ql(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Ml(t||{})}))}))}function Ql(t,e){return t.f=t.f.then(e,e),t.f}function Yl(t){if(this.l=!1,zr(this,"settings",new Bc),zr(this,"app",t),!rh(this).options||!rh(this).options.apiKey)throw new S("invalid-api-key");t=r.default.SDK_VERSION?Or(r.default.SDK_VERSION):null,this.a=new Wa(rh(this).options&&rh(this).options.apiKey,j(k),t),this.R=[],this.s=[],this.O=[],this.hb=r.default.INTERNAL.createSubscribe(w(this.zc,this)),this.X=void 0,this.bc=r.default.INTERNAL.createSubscribe(w(this.Ac,this)),eh(this,null),this.i=new Vl(rh(this).options.apiKey+":"+rh(this).name),this.D=new Fl(rh(this).options.apiKey+":"+rh(this).name),this.$=sh(this,function(t){var e=rh(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Ul,t.a).then((function(t){return t&&e&&(t.authDomain=e),Ml(t||{})}))}(t.D,rh(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),ql(t.D)}));return sh(t,e)}(t).then((function(){return zl(t.i,e,t.P)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return Hl(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:Gl(t.i)}))):null})).then((function(e){eh(t,e||null)}));return sh(t,n)}(this)),this.h=sh(this,function(t){return t.$.then((function(){return th(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener(Wl("local"),e.a,t.ja)}}))}(this)),this.ba=!1,this.ja=w(this.Zc,this),this.Ba=w(this.da,this),this.ya=w(this.mc,this),this.za=w(this.wc,this),this.Aa=w(this.xc,this),this.b=null,function(t){var e=rh(t).options.authDomain,n=rh(t).options.apiKey;e&&Ar()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=Dc(e,n,rh(t).name,t.P),Oc(t.b,t),ih(t)&&_l(ih(t)),t.m){_l(t.m);var r=t.m;r.wa(t.la()),ll(r,t),fl(r=t.m,t.J),dl(r,t),$a((r=t.m).a,t.P),hl(r,t),t.m=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=w(this.delete,this),this.INTERNAL.logFramework=w(this.Gc,this),this.u=0,bn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.yb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.P){var t=Un(this.P.url);t=Yr({protocol:t.c,host:t.a,port:t.g,options:Yr({disableWarnings:this.P.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.P=null}function Xl(t){Ye.call(this,"languageCodeChanged"),this.h=t}function Jl(t){Ye.call(this,"emulatorConfigChanged"),this.c=t}function $l(t){Ye.call(this,"frameworkChanged"),this.f=t}function Zl(t){return t.Oa||ke(new S("auth-domain-config-required"))}function th(t){if(!Ar())return ke(new S("operation-not-supported-in-this-environment"));var e=Zl(t).then((function(){return t.b.qa()})).then((function(t){return t?Yr(t):null}));return sh(t,e)}function eh(t,e){ih(t)&&(function(t,e){X(t.S,(function(t){return t==e}))}(ih(t),t.Ba),hn(ih(t),"tokenChanged",t.ya),hn(ih(t),"userDeleted",t.za),hn(ih(t),"userInvalidated",t.Aa),gl(ih(t))),e&&(e.S.push(t.Ba),un(e,"tokenChanged",t.ya),un(e,"userDeleted",t.za),un(e,"userInvalidated",t.Aa),0<t.u&&vl(e)),zr(t,"currentUser",e),e&&(e.wa(t.la()),ll(e,t),fl(e,t.J),dl(e,t),$a(e.a,t.P),hl(e,t))}function nh(t,e){var n=null,r=null;return sh(t,e.then((function(e){return n=Do(e),r=Gi(e),function(t,e){var n={};return n.apiKey=rh(t).options.apiKey,n.authDomain=rh(t).options.authDomain,n.appName=rh(t).name,t.P&&(n.emulatorConfig=t.P),t.$.then((function(){return function(t,e,n,r){var i=new cl(t,e);return n&&(i.ha=n),r&&fl(i,r),i.reload().then((function(){return i}))}(n,e,t.D,t.Ga())})).then((function(e){return ih(t)&&e.uid==ih(t).uid?(Cl(ih(t),e),t.da(e)):(eh(t,e),_l(e),t.da(e))})).then((function(){ah(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Xc(e.w(),t,w(t.kc,t))),n||e})).then((function(){return Yr({user:ih(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function rh(t){return t.app}function ih(t){return t.currentUser}function oh(t){return ih(t)&&ih(t)._lat||null}function ah(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](oh(t));if(t.X!==t.getUid()&&t.O.length)for(t.X=t.getUid(),e=0;e<t.O.length;e++)t.O[e]&&t.O[e](oh(t))}}function sh(t,e){return t.R.push(e),e.oa((function(){Y(t.R,e)})),e}function uh(){}function ch(){this.a={},this.b=1e12}Vl.prototype.xb=function(t){var e=null,n=this;return function(t){var e=new S("invalid-persistence-type"),n=new S("unsupported-persistence-type");t:{for(r in Hu)if(Hu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(br()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Eu()&&"none"!==t)throw n;break;default:if(!kr()&&"none"!==t)throw n}}(t),Ql(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,Bl(n,t)})).then((function(){if(n.c=Wl(t),e)return n.b.set(n.c,e,n.a)})):Ce()}))},E(Yl,bn),E(Xl,Ye),E(Jl,Ye),E($l,Ye),(t=Yl.prototype).xb=function(t){return sh(this,t=this.i.xb(t))},t.wa=function(t){this.aa===t||this.l||(this.aa=t,Ja(this.a,this.aa),this.dispatchEvent(new Xl(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=s.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.P){if(!/^https?:\/\//.test(t))throw new S("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),s.document&&!t&&gr().then((function(){var t=s.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#b50000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),s.document.body.appendChild(t)}))})(e=!!e&&!!e.disableWarnings),this.P={url:t,ec:e},this.settings.ib=!0,$a(this.a,this.P),this.dispatchEvent(new Jl(this.P))}},t.Gc=function(t){this.J.push(t),ts(this.a,r.default.SDK_VERSION?Or(r.default.SDK_VERSION,this.J):null),this.dispatchEvent(new $l(this.J))},t.Ga=function(){return $(this.J)},t.yb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:rh(this).options.apiKey,authDomain:rh(this).options.authDomain,appName:rh(this).name,currentUser:ih(this)&&ih(this).w()}},t.Fb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?w(this.ic,this):null},t.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return nh(i,ds(i.a,o))}))},t.Xc=function(t){if(!Ar())return ke(new S("operation-not-supported-in-this-environment"));var e=this,n=Hi(t.providerId),i=Lr(),o=null;(!jr()||mr())&&rh(this).options.authDomain&&t.isOAuthProvider&&(o=hu(rh(this).options.authDomain,rh(this).options.apiKey,rh(this).name,"signInViaPopup",t,null,i,r.default.SDK_VERSION||null,null,null,this.T(),this.P));var a=dr(o,n&&n.ua,n&&n.ta);return sh(this,n=Zl(this).then((function(n){return Ac(n,a,"signInViaPopup",t,i,!!o,e.T())})).then((function(){return new be((function(t,n){e.na("signInViaPopup",null,new S("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=i,e.c=jc(e.b,e,"signInViaPopup",a,i)}))})).then((function(t){return a&&fr(a),t?Yr(t):null})).o((function(t){throw a&&fr(a),t})))},t.Yc=function(t){if(!Ar())return ke(new S("operation-not-supported-in-this-environment"));var e=this;return sh(this,Zl(this).then((function(){return function(t){return Ql(t,(function(){return t.b.set(Kl,t.c.F,t.a)}))}(e.i)})).then((function(){return Pc(e.b,"signInViaRedirect",t,void 0,e.T())})))},t.qa=function(){var t=this;return th(this).then((function(e){return t.b&&Fc(t.b.b),e})).o((function(e){throw t.b&&Fc(t.b.b),e}))},t.dd=function(t){if(!t)return ke(new S("null-user"));if(this.S!=t.tenantId)return ke(new S("tenant-id-mismatch"));var e=this,n={};n.apiKey=rh(this).options.apiKey,n.authDomain=rh(this).options.authDomain,n.appName=rh(this).name;var r=function(t,e,n,r){var i=t.b,o={};return o[Ga]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new cl(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&fl(e,r),Cl(e,t),e}(t,n,e.D,e.Ga());return sh(this,this.h.then((function(){if(rh(e).options.apiKey!=t.l)return r.reload()})).then((function(){return ih(e)&&t.uid==ih(e).uid?(Cl(ih(e),t),e.da(t)):(eh(e,r),_l(r),e.da(r))})).then((function(){ah(e)})))},t.Ab=function(){var t=this;return sh(this,this.h.then((function(){return t.b&&Fc(t.b.b),ih(t)?(eh(t,null),Gl(t.i).then((function(){ah(t)}))):Ce()})))},t.Zc=function(){var t=this;return zl(this.i,rh(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=ih(t)&&e){n=ih(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Cl(ih(t),e),ih(t).I();(ih(t)||e)&&(eh(t,e),e&&(_l(e),e.ha=t.D),t.b&&Oc(t.b,t),ah(t))}}))},t.da=function(t){return Hl(this.i,t)},t.mc=function(){ah(this),this.da(ih(this))},t.wc=function(){this.Ab()},t.xc=function(){this.Ab()},t.kc=function(t){var e=this;return this.h.then((function(){return nh(e,Ce(t))}))},t.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(ih(e))}))},t.Ac=function(t){var e=this;!function(t,e){t.O.push(e),sh(t,t.h.then((function(){!t.l&&Q(t.O,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(oh(t)))})))}(this,(function(){t.next(ih(e))}))},t.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(ih(r)):"function"==typeof t.next&&t.next(ih(r))})),this.hb(t,e,n)},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.X=r.getUid(),"function"==typeof t?t(ih(r)):"function"==typeof t.next&&t.next(ih(r))})),this.bc(t,e,n)},t.nc=function(t){var e=this;return sh(this,this.h.then((function(){return ih(e)?ih(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Tc=function(t){var e=this;return this.h.then((function(){return nh(e,Xs(e.a,Ws,{token:t}))})).then((function(t){var n=t.user;return Sl(n,"isAnonymous",!1),e.da(n),t}))},t.Uc=function(t,e){var n=this;return this.h.then((function(){return nh(n,Xs(n.a,Hs,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.h.then((function(){return nh(n,Xs(n.a,_s,{email:t,password:e}))}))},t.$a=function(t){var e=this;return this.h.then((function(){return nh(e,t.ka(e.a))}))},t.Sc=function(t){return Hr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.$a(t)},t.zb=function(){var t=this;return this.h.then((function(){var e=ih(t);if(e&&e.isAnonymous){var n=Yr({providerId:null,isNewUser:!1});return Yr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return nh(t,t.a.zb()).then((function(e){var n=e.user;return Sl(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return ih(this)&&ih(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&ih(this)&&vl(ih(this))},t.Pc=function(t){var e=this;W(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&ih(this)&&gl(ih(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),sh(this,this.h.then((function(){e.l||Q(e.s,t)&&t(oh(e))})))},t.removeAuthTokenListener=function(t){X(this.s,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.i&&(t=this.i).b.removeListener(Wl("local"),t.a,this.ja),this.b&&(Sc(this.b,this),Fc(this.b.b)),Promise.resolve()},t.hc=function(t){return sh(this,function(t,e){return Xs(t,bs,{identifier:e,continueUri:Nr()?cr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Bc=function(t){return!!Ao(t)},t.wb=function(t,e){var n=this;return sh(this,Ce().then((function(){var t=new Ci(e);if(!t.c)throw new S("argument-error",Ni+" must be true when sending sign in link to email");return Mi(t)})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},t.jd=function(t){return this.Ra(t).then((function(t){return t.data.email}))},t.nb=function(t,e){return sh(this,this.a.nb(t,e).then((function(){})))},t.Ra=function(t){return sh(this,this.a.Ra(t).then((function(t){return new ii(t)})))},t.jb=function(t){return sh(this,this.a.jb(t).then((function(){})))},t.vb=function(t,e){var n=this;return sh(this,Ce().then((function(){return void 0===e||pt(e)?{}:Mi(new Ci(e))})).then((function(e){return n.a.vb(t,e)})).then((function(){})))},t.Wc=function(t,e){return sh(this,Wc(this,t,e,w(this.$a,this)))},t.Vc=function(t,e){var n=this;return sh(this,Ce().then((function(){var r=e||cr(),i=ko(t,r);if(!(r=Ao(r)))throw new S("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new S("tenant-id-mismatch");return n.$a(i)})))},uh.prototype.render=function(){},uh.prototype.reset=function(){},uh.prototype.getResponse=function(){},uh.prototype.execute=function(){};var lh=null;function hh(t,e){return(e=fh(e))&&t.a[e]||null}function fh(t){return(t=void 0===t?1e12:t)?t.toString():null}function dh(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=ue(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():un(this.f,"click",this.i)}function ph(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function vh(){}function gh(){}ch.prototype.render=function(t,e){return this.a[this.b.toString()]=new dh(t,e),this.b++},ch.prototype.reset=function(t){var e=hh(this,t);t=fh(t),e&&t&&(e.delete(),delete this.a[t])},ch.prototype.getResponse=function(t){return(t=hh(this,t))?t.getResponse():null},ch.prototype.execute=function(t){(t=hh(this,t))&&t.execute()},dh.prototype.getResponse=function(){return ph(this),this.b},dh.prototype.execute=function(){ph(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()}),6e4)}),500))},dh.prototype.delete=function(){ph(this),this.g=!0,clearTimeout(this.a),this.a=null,hn(this.f,"click",this.i)},zr(vh,"FACTOR_ID","phone"),gh.prototype.g=function(){return lh||(lh=new ch),Ce(lh)},gh.prototype.c=function(){};var yh=null;function mh(){this.b=s.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var _h=new _t(Tt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),bh=new Ur(3e4,6e4);mh.prototype.g=function(t){var e=this;return new be((function(n,r){var i=setTimeout((function(){r(new S("network-request-failed"))}),bh.get());!s.grecaptcha||t!==e.f&&!e.b?(s[e.a]=function(){if(s.grecaptcha){e.f=t;var o=s.grecaptcha.render;s.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(s.grecaptcha)}else clearTimeout(i),r(new S("internal-error"));delete s[e.a]},Ce(Ma(Ct(_h,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new S("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(s.grecaptcha))}))},mh.prototype.c=function(){this.b--};var wh=null;function Ih(t,e,n,r,i,o,a){if(zr(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.v=e,this.g=null,a?(yh||(yh=new gh),a=yh):(wh||(wh=new mh),a=wh),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Oh])throw new S("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Sh],!s.document)throw new S("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ue(e)||!this.i&&ue(e).hasChildNodes())throw new S("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Wa(t,o||null,i||null),this.u=r||function(){return null};var u=this;this.l=[];var c=this.a[Th];this.a[Th]=function(t){if(Ch(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Cr(c,s);"function"==typeof e&&e(t)}};var l=this.a[Eh];this.a[Eh]=function(){if(Ch(u,null),"function"==typeof l)l();else if("string"==typeof l){var t=Cr(l,s);"function"==typeof t&&t()}}}var Th="callback",Eh="expired-callback",Oh="sitekey",Sh="size";function Ch(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function kh(t,e){return t.h.push(e),e.oa((function(){Y(t.h,e)})),e}function Ah(t){if(t.D)throw new S("internal-error","RecaptchaVerifier instance has been destroyed.")}function Nh(t,e,n){var i=!1;try{this.b=n||r.default.app()}catch(s){throw new S("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new S("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ga()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=r.default.SDK_VERSION?Or(r.default.SDK_VERSION,a):null,Ih.call(this,n,t,e,(function(){try{var t=o.b.auth().la()}catch(e){t=null}return t}),a,j(k),i)}function Ph(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new S("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=jh.length)throw new S("internal-error","Argument validator received an unsupported number of arguments.");n=jh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new S("argument-error",t+" failed: "+r)}(t=Ih.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=kh(this,Ce().then((function(){if(Nr()&&!_r())return gr();throw new S("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,Xs(t.s,Rs,{})})).then((function(e){t.a[Oh]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){Ah(this);var t=this;return kh(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=ue(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!se&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Wt(a.name),'"'),a.type){o.push(' type="',Wt(a.type),'"');var s={};yt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=pe(i,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):ce(o,a)),2<r.length&&de(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Ah(this);var t=this;return kh(this,this.render().then((function(e){return new be((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){X(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Ah(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Ah(this),this.D=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=ue(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},E(Nh,Ih);var jh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Rh(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function xh(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function Dh(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:v}}function Lh(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function Mh(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function Fh(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){return!!e&&!(!e.ka||t&&e.providerId!==t)}}}function Uh(t,e){return v(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function qh(t){return v(t)&&"string"==typeof t.uid}function Vh(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function Bh(t,e){for(var n in e){var r=e[n].name;t[r]=Hh(r,t[n],e[n].j)}}function Kh(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:I((function(t){return this[t]}),n),set:I((function(t,e,n,r){Ph(t,[n],[r],!0),this[e]=r}),r,n,e[n].kb),enumerable:!0})}}function Wh(t,e,n,r){t[e]=Hh(e,n,r)}function Hh(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Ph(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}Bh(Yl.prototype,{jb:{name:"applyActionCode",j:[Rh("code")]},Ra:{name:"checkActionCode",j:[Rh("code")]},nb:{name:"confirmPasswordReset",j:[Rh("code"),Rh("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Rh("email"),Rh("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Rh("email")]},qa:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Rh("emailLink")]},Hc:{name:"onAuthStateChanged",j:[Vh(Dh(),Lh(),"nextOrObserver"),Lh("opt_error",!0),Lh("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[Vh(Dh(),Lh(),"nextOrObserver"),Lh("opt_error",!0),Lh("opt_completed",!0)]},vb:{name:"sendPasswordResetEmail",j:[Rh("email"),Vh(Dh("opt_actionCodeSettings",!0),Mh(null,!0),"opt_actionCodeSettings",!0)]},wb:{name:"sendSignInLinkToEmail",j:[Rh("email"),Dh("actionCodeSettings")]},xb:{name:"setPersistence",j:[Rh("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Fh()]},zb:{name:"signInAnonymously",j:[]},$a:{name:"signInWithCredential",j:[Fh()]},Tc:{name:"signInWithCustomToken",j:[Rh("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Rh("email"),Rh("password")]},Vc:{name:"signInWithEmailLink",j:[Rh("email"),Rh("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Rh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[Vh({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof cl)}},Mh(),"user")]},Ab:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Rh(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Rh("url"),Dh("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Rh("code")]}}),Kh(Yl.prototype,{lc:{name:"languageCode",kb:Vh(Rh(),Mh(),"languageCode")},ti:{name:"tenantId",kb:Vh(Rh(),Mh(),"tenantId")}}),(Yl.Persistence=Hu).LOCAL="local",Yl.Persistence.SESSION="session",Yl.Persistence.NONE="none",Bh(cl.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[xh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[xh("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Fh()]},qb:{name:"linkWithCredential",j:[Fh()]},Dc:{name:"linkWithPhoneNumber",j:[Rh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Fh()]},tb:{name:"reauthenticateWithCredential",j:[Fh()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Rh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},ub:{name:"sendEmailVerification",j:[Vh(Dh("opt_actionCodeSettings",!0),Mh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Rh(null,!0)]},cd:{name:"unlink",j:[Rh("provider")]},Bb:{name:"updateEmail",j:[Rh("email")]},Cb:{name:"updatePassword",j:[Rh("password")]},ed:{name:"updatePhoneNumber",j:[Fh("phone")]},Db:{name:"updateProfile",j:[Dh("profile")]},Eb:{name:"verifyBeforeUpdateEmail",j:[Rh("email"),Vh(Dh("opt_actionCodeSettings",!0),Mh(null,!0),"opt_actionCodeSettings",!0)]}}),Bh(ch.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Bh(uh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Bh(be.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Kh(Bc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",kb:xh("appVerificationDisabledForTesting")}}),Bh(Kc.prototype,{confirm:{name:"confirm",j:[Rh("verificationCode")]}}),Wh(oo,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[fo,So,Po,co],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[Vh(Rh(),Dh(),"json")]),Wh(Co,"credential",(function(t,e){return new Oo(t,e)}),[Rh("email"),Rh("password")]),Bh(Oo.prototype,{w:{name:"toJSON",j:[Rh(null,!0)]}}),Bh(yo.prototype,{Ca:{name:"addScope",j:[Rh("scope")]},Ka:{name:"setCustomParameters",j:[Dh("customOAuthParameters")]}}),Wh(yo,"credential",mo,[Vh(Rh(),Dh(),"token")]),Wh(Co,"credentialWithLink",ko,[Rh("email"),Rh("emailLink")]),Bh(_o.prototype,{Ca:{name:"addScope",j:[Rh("scope")]},Ka:{name:"setCustomParameters",j:[Dh("customOAuthParameters")]}}),Wh(_o,"credential",bo,[Vh(Rh(),Dh(),"token")]),Bh(wo.prototype,{Ca:{name:"addScope",j:[Rh("scope")]},Ka:{name:"setCustomParameters",j:[Dh("customOAuthParameters")]}}),Wh(wo,"credential",Io,[Vh(Rh(),Vh(Dh(),Mh()),"idToken"),Vh(Rh(),Mh(),"accessToken",!0)]),Bh(To.prototype,{Ka:{name:"setCustomParameters",j:[Dh("customOAuthParameters")]}}),Wh(To,"credential",Eo,[Vh(Rh(),Dh(),"token"),Rh("secret",!0)]),Bh(go.prototype,{Ca:{name:"addScope",j:[Rh("scope")]},credential:{name:"credential",j:[Vh(Rh(),Vh(Dh(),Mh()),"optionsOrIdToken"),Vh(Rh(),Mh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Dh("customOAuthParameters")]}}),Bh(lo.prototype,{w:{name:"toJSON",j:[Rh(null,!0)]}}),Bh(so.prototype,{w:{name:"toJSON",j:[Rh(null,!0)]}}),Wh(Ro,"credential",xo,[Rh("verificationId"),Rh("verificationCode")]),Bh(Ro.prototype,{fb:{name:"verifyPhoneNumber",j:[Vh(Rh(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?Uh(t.session,ro)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Uh(t.session,io)&&qh(t.multiFactorHint):t.session&&t.multiFactorUid?Uh(t.session,io)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),Bh(No.prototype,{w:{name:"toJSON",j:[Rh(null,!0)]}}),Bh(S.prototype,{toJSON:{name:"toJSON",j:[Rh(null,!0)]}}),Bh(Ko.prototype,{toJSON:{name:"toJSON",j:[Rh(null,!0)]}}),Bh(Bo.prototype,{toJSON:{name:"toJSON",j:[Rh(null,!0)]}}),Bh(Yc.prototype,{toJSON:{name:"toJSON",j:[Rh(null,!0)]}}),Bh(Gc.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}}]}}),Bh(el.prototype,{Rb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}},Rh("displayName",!0)]},bd:{name:"unenroll",j:[Vh({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:qh},Rh(),"multiFactorInfoIdentifier")]}}),Bh(Nh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Wh(mi,"parseLink",Si,[Rh("link")]),Wh(vh,"assertion",(function(t){return new Zc(t)}),[Fh("phone")]),function(){if(void 0===r.default||!r.default.INTERNAL||!r.default.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ai,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:oi,VERIFY_AND_CHANGE_EMAIL:si,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Yl,AuthCredential:oo,Error:S};Wh(t,"EmailAuthProvider",Co,[]),Wh(t,"FacebookAuthProvider",yo,[]),Wh(t,"GithubAuthProvider",_o,[]),Wh(t,"GoogleAuthProvider",wo,[]),Wh(t,"TwitterAuthProvider",To,[]),Wh(t,"OAuthProvider",go,[Rh("providerId")]),Wh(t,"SAMLAuthProvider",vo,[Rh("providerId")]),Wh(t,"PhoneAuthProvider",Ro,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof Yl)}}]),Wh(t,"RecaptchaVerifier",Nh,[Vh(Rh(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Dh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof r.default.app.App)}}]),Wh(t,"ActionCodeURL",mi,[]),Wh(t,"PhoneMultiFactorGenerator",vh,[]),r.default.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new Yl(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),r.default.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:w((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:w(t.nc,t),addAuthTokenListener:w(t.cc,t),removeAuthTokenListener:w(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.default.registerVersion("@firebase/auth","0.16.6"),r.default.INTERNAL.extendNamespace({User:cl})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),n("6Uf2");var i=n("qOnz"),o=n("q/0M"),a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function s(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var u,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},l=l||{},h=c||self;function f(){}function d(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var v="closure_uid_"+(1e9*Math.random()>>>0),g=0;function y(t,e,n){return t.call.apply(t.bind,arguments)}function m(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:m).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function w(){return Date.now()}function I(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function T(){this.j=this.j,this.i=this.i}T.prototype.j=!1,T.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++g)}(this)},T.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var E=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},O=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function S(t){return Array.prototype.concat.apply([],arguments)}function C(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function k(t){return/^[\s\xa0]*$/.test(t)}var A,N=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function P(t,e){return-1!=t.indexOf(e)}function j(t,e){return t<e?-1:t>e?1:0}t:{var R=h.navigator;if(R){var x=R.userAgent;if(x){A=x;break t}}A=""}function D(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function L(t){var e={};for(var n in t)e[n]=t[n];return e}var M="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<M.length;o++)n=M[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function U(t){return U[" "](t),t}U[" "]=f;var q,V,B=P(A,"Opera"),K=P(A,"Trident")||P(A,"MSIE"),W=P(A,"Edge"),H=W||K,G=P(A,"Gecko")&&!(P(A.toLowerCase(),"webkit")&&!P(A,"Edge"))&&!(P(A,"Trident")||P(A,"MSIE"))&&!P(A,"Edge"),z=P(A.toLowerCase(),"webkit")&&!P(A,"Edge");function Q(){var t=h.document;return t?t.documentMode:void 0}t:{var Y="",X=(V=A,G?/rv:([^\);]+)(\)|;)/.exec(V):W?/Edge\/([\d\.]+)/.exec(V):K?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(V):z?/WebKit\/(\S+)/.exec(V):B?/(?:Version)[ \/]?(\S+)/.exec(V):void 0);if(X&&(Y=X?X[1]:""),K){var J=Q();if(null!=J&&J>parseFloat(Y)){q=String(J);break t}}q=Y}var $={};function Z(t){return function(t,e){var n=$;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=N(String(q)).split("."),r=N(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=j(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||j(0==a[2].length,0==s[2].length)||j(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}var tt=h.document&&K&&(Q()||parseInt(q,10))||void 0,et=!K||9<=Number(tt),nt=K&&!Z("9"),rt=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{h.addEventListener("test",f,e),h.removeEventListener("test",f,e)}catch(n){}return t}();function it(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function ot(t,e){if(it.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(G){t:{try{U(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:at[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}it.prototype.b=function(){this.defaultPrevented=!0},I(ot,it);var at={2:"touch",3:"pen",4:"mouse"};ot.prototype.b=function(){ot.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,nt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var st="closure_listenable_"+(1e6*Math.random()|0),ut=0;function ct(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++ut,this.Y=this.Z=!1}function lt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ht(t){this.src=t,this.a={},this.b=0}function ft(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=E(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}ht.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=dt(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new ct(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var pt="closure_lm_"+(1e6*Math.random()|0),vt={};function gt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);return null}return r=Et(r),e&&e[st]?e.wa(n,r,p(i)?!!i.capture:!!i,o):yt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)gt(t,e[o],n,r,i);return null}return n=Et(n),t&&t[st]?t.va(e,n,p(r)?!!r.capture:!!r,i):yt(t,e,n,!1,r,i)}function yt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=p(i)?!!i.capture:!!i;if(a&&!et)return null;var s=It(t);if(s||(t[pt]=s=new ht(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=wt,e=et?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)rt||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(_t(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function mt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[st])ft(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(_t(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=It(e))?(ft(n,t),0==n.b&&(n.src=null,e[pt]=null)):lt(t)}}}function _t(t){return t in vt?vt[t]:vt[t]="on"+t}function bt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&mt(t),n.call(r,e)}function wt(t,e){if(t.Y)return!0;if(!et){if(!e)t:{e=["window","event"];for(var n=h,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return bt(t,e=new ot(e,this))}return bt(t,new ot(e,this))}function It(t){return(t=t[pt])instanceof ht?t:null}var Tt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Et(t){return"function"==typeof t?t:(t[Tt]||(t[Tt]=function(e){return t.handleEvent(e)}),t[Tt])}function Ot(){T.call(this),this.c=new ht(this),this.J=this,this.C=null}function St(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new it(e,t);else if(e instanceof it)e.target=e.target||t;else{var i=e;F(e=new it(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=e.a=n[o];i=Ct(a,r,!0,e)&&i}if(i=Ct(a=e.a=t,r,!0,e)&&i,i=Ct(a,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Ct(a=e.a=n[o],r,!1,e)&&i}function Ct(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.Y&&a.capture==n){var s=a.listener,u=a.ca||a.src;a.Z&&ft(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}I(Ot,T),Ot.prototype[st]=!0,(u=Ot.prototype).addEventListener=function(t,e,n,r){gt(this,t,e,n,r)},u.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=p(i)?!!i.capture:!!i,r=Et(r),e&&e[st]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=dt(a=e.a[n],r,i,o))&&(lt(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete e.a[n],e.b--))):e&&(e=It(e))&&(n=e.a[n.toString()],e=-1,n&&(e=dt(n,r,i,o)),(r=-1<e?n[e]:null)&&mt(r))}(this,t,e,n,r)},u.G=function(){if(Ot.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)lt(n[r]);delete e.a[t],e.b--}}this.C=null},u.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},u.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var kt=h.JSON.stringify;function At(){this.b=this.a=null}var Nt,Pt=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())((function(){return new Rt}),(function(t){t.reset()}));function jt(){var t=Mt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Rt(){this.next=this.b=this.a=null}function xt(t){h.setTimeout((function(){throw t}),0)}function Dt(t,e){Nt||function(){var t=h.Promise.resolve(void 0);Nt=function(){t.then(Ft)}}(),Lt||(Nt(),Lt=!0),Mt.add(t,e)}At.prototype.add=function(t,e){var n=Pt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Rt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Rt.prototype.reset=function(){this.next=this.b=this.a=null};var Lt=!1,Mt=new At;function Ft(){for(var t;t=jt();){try{t.a.call(t.b)}catch(n){xt(n)}var e=Pt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Lt=!1}function Ut(t,e){Ot.call(this),this.b=t||1,this.a=e||h,this.f=_(this.Za,this),this.g=w()}function qt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Vt(t,e,n){if("function"==typeof t)n&&(t=_(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:h.setTimeout(t,e||0)}function Bt(t){t.a=Vt((function(){t.a=null,t.c&&(t.c=!1,Bt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}I(Ut,Ot),(u=Ut.prototype).aa=!1,u.M=null,u.Za=function(){if(this.aa){var t=w()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),St(this,"tick"),this.aa&&(qt(this),this.start()))}},u.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=w())},u.G=function(){Ut.X.G.call(this),qt(this),delete this.a};var Kt=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Bt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(h.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(T);function Wt(t){T.call(this),this.b=t,this.a={}}I(Wt,T);var Ht=[];function Gt(t,e,n,r){Array.isArray(n)||(n&&(Ht[0]=n.toString()),n=Ht);for(var i=0;i<n.length;i++){var o=gt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function zt(t){D(t.a,(function(t,e){this.a.hasOwnProperty(e)&&mt(t)}),t),t.a={}}function Qt(){this.a=!0}function Yt(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return kt(n)}catch(s){return e}}(t,n)+(r?" "+r:"")}))}Wt.prototype.G=function(){Wt.X.G.call(this),zt(this)},Wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Qt.prototype.info=function(){};var Xt={},Jt=null;function $t(){return Jt=Jt||new Ot}function Zt(t){it.call(this,Xt.Fa,t)}function te(t){var e=$t();St(e,new Zt(e,t))}function ee(t,e){it.call(this,Xt.STAT_EVENT,t),this.stat=e}function ne(t){var e=$t();St(e,new ee(e,t))}function re(t){it.call(this,Xt.Ga,t)}function ie(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return h.setTimeout((function(){t()}),e)}Xt.Fa="serverreachability",I(Zt,it),Xt.STAT_EVENT="statevent",I(ee,it),Xt.Ga="timingevent",I(re,it);var oe={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},ae={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function se(){}function ue(){}se.prototype.a=null;var ce,le={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function he(){it.call(this,"d")}function fe(){it.call(this,"c")}function de(){}function pe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Wt(this),this.P=ve,this.R=new Ut(t=H?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}I(he,it),I(fe,it),I(de,se),ce=new de;var ve=45e3,ge={},ye={};function me(t,e,n){t.H=1,t.i=qe(xe(e)),t.j=n,t.I=!0,_e(t,null)}function _e(t,e){t.u=w(),Ie(t),t.l=xe(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Ze(n.b,"t",r),t.D=0,t.a=Qn(t.g,t.g.C?e:null),0<t.O&&(t.F=new Kt(_(t.Ca,t,t.a),t.O)),Gt(t.J,t.a,"readystatechange",t.Xa),e=t.B?L(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),te(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function be(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=we(t,n);if(i==ye){4==e&&(t.h=4,ne(14),r=!1),Yt(t.c,t.f,null,"[Incomplete Response]");break}if(i==ge){t.h=4,ne(15),Yt(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Yt(t.c,t.f,i,null),Ce(t,i)}4==e&&0==n.length&&(t.h=1,ne(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),qn(e),e.F=!0,ne(11))):(Yt(t.c,t.f,n,"[Invalid Chunked Response]"),Se(t),Oe(t))}function we(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?ye:(n=Number(e.substring(n,r)),isNaN(n)?ge:(r+=1)+n>e.length?ye:(e=e.substr(r,n),t.D=r+n,e))}function Ie(t){t.T=w()+t.P,Te(t,t.P)}function Te(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ie(_(t.Va,t),e)}function Ee(t){t.o&&(h.clearTimeout(t.o),t.o=null)}function Oe(t){0==t.g.v||t.A||Kn(t.g,t)}function Se(t){Ee(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,qt(t.R),zt(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ce(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||sn(n.b,t)))if(n.I=t.N,!t.C&&sn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Bn(n),Pn(n)}Un(n),ne(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=ie(_(n.Sa,n),6e3));if(1>=an(n.b)&&n.ea){try{n.ea()}catch(g){}n.ea=void 0}}else Hn(n,11)}else if((t.C||n.a==t)&&Bn(n),!k(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var a=i[4];null!=a&&(n.pa=a,n.c.info("SVER="+n.pa));var s=i[5];if(null!=s&&"number"==typeof s&&0<s){var u=1.5*s;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var l=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=u.b;!h.a&&(P(l,"spdy")||P(l,"quic")||P(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(un(h,h.b),h.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,Ue(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=w()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).la=zn(u,u.C?u.ga:null,u.fa),d.C){cn(u.b,d);var p=d,v=u.D;v&&p.setTimeout(v),p.o&&(Ee(p),Ie(p)),u.a=d}else Fn(u);0<n.g.length&&xn(n)}else"stop"!=i[0]&&"close"!=i[0]||Hn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Hn(n,7):Nn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);te(4)}catch(g){}}function ke(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"==typeof t)O(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(d(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ae(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ae)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ne(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Pe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Pe(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Pe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(u=pe.prototype).setTimeout=function(t){this.P=t},u.Xa=function(t){t=t.target;var e=this.F;e&&3==Sn(t)?e.f():this.Ca(t)},u.Ca=function(t){try{if(t==this.a)t:{var e=Sn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!H&&!this.a.$())){this.A||4!=e||7==n||te(8==n||0>=r?3:2),Ee(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var a,s=this.a;if((a=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(a)){var u=a;break e}}u=null}if(!u){this.b=!1,this.h=3,ne(12),Se(this),Oe(this);break t}Yt(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ce(this,u)}this.I?(be(this,e,o),H&&this.b&&3==e&&(Gt(this.J,this.R,"tick",this.Wa),this.R.start())):(Yt(this.c,this.f,o,null),Ce(this,o)),4==e&&Se(this),this.b&&!this.A&&(4==e?Kn(this.g,this):(this.b=!1,Ie(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,ne(12)):(this.h=0,ne(13)),Se(this),Oe(this)}}}catch(c){}},u.Wa=function(){if(this.a){var t=Sn(this.a),e=this.a.$();this.D<e.length&&(Ee(this),be(this,t,e),this.b&&4!=t&&Ie(this))}},u.cancel=function(){this.A=!0,Se(this)},u.Va=function(){this.o=null;var t=w();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(te(3),ne(17)),Se(this),this.h=2,Oe(this)):Te(this,this.T-t)},(u=Ae.prototype).K=function(){Ne(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},u.L=function(){return Ne(this),this.a.concat()},u.get=function(t,e){return Pe(this.b,t)?this.b[t]:e},u.set=function(t,e){Pe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},u.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Re(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Re){this.a=void 0!==e?e:t.a,De(this,t.f),this.j=t.j,Le(this,t.c),Me(this,t.h),this.g=t.g,e=t.b;var n=new Ye;n.c=e.c,e.a&&(n.a=new Ae(e.a),n.b=e.b),Fe(this,n),this.i=t.i}else t&&(n=String(t).match(je))?(this.a=!!e,De(this,n[1]||"",!0),this.j=Ve(n[2]||""),Le(this,n[3]||"",!0),Me(this,n[4]),this.g=Ve(n[5]||"",!0),Fe(this,n[6]||"",!0),this.i=Ve(n[7]||"")):(this.a=!!e,this.b=new Ye(null,this.a))}function xe(t){return new Re(t)}function De(t,e,n){t.f=n?Ve(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Le(t,e,n){t.c=n?Ve(e,!0):e}function Me(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Fe(t,e,n){e instanceof Ye?(t.b=e,function(t,e){e&&!t.f&&(Xe(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Je(this,e),Ze(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Be(e,ze)),t.b=new Ye(e,t.a))}function Ue(t,e,n){t.b.set(e,n)}function qe(t){return Ue(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^w()).toString(36)),t}function Ve(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Be(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ke),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ke(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Re.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Be(e,We,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Be(e,We,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Be(n,"/"==n.charAt(0)?Ge:He,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Be(n,Qe)),t.join("")};var We=/[#\/\?@]/g,He=/[#\?:]/g,Ge=/[#\?]/g,ze=/[#\?@]/g,Qe=/#/g;function Ye(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Xe(t){t.a||(t.a=new Ae,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Je(t,e){Xe(t),e=tn(t,e),Pe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Pe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ne(t)))}function $e(t,e){return Xe(t),e=tn(t,e),Pe(t.a.b,e)}function Ze(t,e,n){Je(t,e),0<n.length&&(t.c=null,t.a.set(tn(t,e),C(n)),t.b+=n.length)}function tn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(u=Ye.prototype).add=function(t,e){Xe(this),this.c=null,t=tn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},u.forEach=function(t,e){Xe(this),this.a.forEach((function(n,r){O(n,(function(n){t.call(e,n,r,this)}),this)}),this)},u.L=function(){Xe(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},u.K=function(t){Xe(this);var e=[];if("string"==typeof t)$e(this,t)&&(e=S(e,this.a.get(tn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=S(e,t[n])}return e},u.set=function(t,e){return Xe(this),this.c=null,$e(this,t=tn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},u.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},u.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var en=function(){return function(t,e){this.b=t,this.a=e}}();function nn(t){this.g=t||rn,t=h.PerformanceNavigationTiming?0<(t=h.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(h.ia&&h.ia.ya&&h.ia.ya()&&h.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var rn=10;function on(t){return!!t.b||!!t.a&&t.a.size>=t.f}function an(t){return t.b?1:t.a?t.a.size:0}function sn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function un(t,e){t.a?t.a.add(e):t.b=e}function cn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function ln(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=s(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(a){e={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return C(t.c)}function hn(){}function fn(){this.a=new hn}function dn(t,e,n){var r=n||"";try{ke(t,(function(t,n){var i=t;p(t)&&(i=kt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(yd){throw e.push(r+"type="+encodeURIComponent("_badmap")),yd}}function pn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}nn.prototype.cancel=function(){var t,e;if(this.c=ln(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=s(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},hn.prototype.stringify=function(t){return h.JSON.stringify(t,void 0)},hn.prototype.parse=function(t){return h.JSON.parse(t,void 0)};var vn=h.JSON.parse;function gn(t){Ot.call(this),this.headers=new Ae,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=yn,this.D=this.F=!1}I(gn,Ot);var yn="",mn=/^https?$/i,_n=["POST","PUT"];function bn(t){return"content-type"==t.toLowerCase()}function wn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,In(t),En(t)}function In(t){t.u||(t.u=!0,St(t,"complete"),St(t,"error"))}function Tn(t){if(t.b&&void 0!==l&&(!t.s[1]||4!=Sn(t)||2!=t.W()))if(t.l&&4==Sn(t))Vt(t.za,0,t);else if(St(t,"readystatechange"),4==Sn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(je)[1]||null;if(!o&&h.self&&h.self.location){var a=h.self.location.protocol;o=a.substr(0,a.length-1)}i=!mn.test(o?o.toLowerCase():"")}e=i}if(e)St(t,"complete"),St(t,"success");else{t.h=6;try{var s=2<Sn(t)?t.a.statusText:""}catch(n){s=""}t.f=s+" ["+t.W()+"]",In(t)}}finally{En(t)}}}function En(t,e){if(t.a){On(t);var n=t.a,r=t.s[0]?f:null;t.a=null,t.s=null,e||St(t,"ready");try{n.onreadystatechange=r}catch(yd){}}}function On(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(h.clearTimeout(t.m),t.m=null)}function Sn(t){return t.a?t.a.readyState:0}function Cn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return D(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ue(t,e,n))}function kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function An(t){this.pa=0,this.g=[],this.c=new Qt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=kn("baseRetryDelayMs",5e3,t),this.Ra=kn("retryDelaySeedMs",1e4,t),this.Ma=kn("forwardChannelMaxRetries",2,t),this.ma=kn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new nn(t&&t.concurrentRequestLimit),this.ka=new fn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Nn(t){if(jn(t),3==t.v){var e=t.R++,n=xe(t.B);Ue(n,"SID",t.J),Ue(n,"RID",e),Ue(n,"TYPE","terminate"),Ln(t,n),(e=new pe(t,t.c,e,void 0)).H=2,e.i=qe(xe(n)),n=!1,h.navigator&&h.navigator.sendBeacon&&(n=h.navigator.sendBeacon(e.i.toString(),"")),!n&&h.Image&&((new Image).src=e.i,n=!0),n||(e.a=Qn(e.g,null),e.a.ba(e.i)),e.u=w(),Ie(e)}Gn(t)}function Pn(t){t.a&&(qn(t),t.a.cancel(),t.a=null)}function jn(t){Pn(t),t.j&&(h.clearTimeout(t.j),t.j=null),Bn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&h.clearTimeout(t.h),t.h=null)}function Rn(t,e){t.g.push(new en(t.Oa++,e)),3==t.v&&xn(t)}function xn(t){on(t.b)||t.h||(t.h=!0,Dt(t.Ba,t),t.u=0)}function Dn(t,e){var n;n=e?e.f:t.R++;var r=xe(t.B);Ue(r,"SID",t.J),Ue(r,"RID",n),Ue(r,"AID",t.P),Ln(t,r),t.i&&t.l&&Cn(r,t.i,t.l),n=new pe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Mn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),un(t.b,n),me(n,r,e)}function Ln(t,e){t.f&&ke({},(function(t,n){Ue(e,n,t)}))}function Mn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?_(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var a=["count="+n];-1==o?0<n?a.push("ofs="+(o=i[0].b)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{dn(l,a,"req"+c+"_")}catch(Or){r&&r(l)}}if(s){r=a.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Fn(t){t.a||t.j||(t.T=1,Dt(t.Aa,t),t.o=0)}function Un(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=ie(_(t.Aa,t),Wn(t,t.o)),t.o++,0))}function qn(t){null!=t.s&&(h.clearTimeout(t.s),t.s=null)}function Vn(t){t.a=new pe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=xe(t.la);Ue(e,"RID","rpc"),Ue(e,"SID",t.J),Ue(e,"CI",t.H?"0":"1"),Ue(e,"AID",t.P),Ln(t,e),Ue(e,"TYPE","xmlhttp"),t.i&&t.l&&Cn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=qe(xe(e)),n.j=null,n.I=!0,_e(n,t)}function Bn(t){null!=t.m&&(h.clearTimeout(t.m),t.m=null)}function Kn(t,e){var n=null;if(t.a==e){Bn(t),qn(t),t.a=null;var r=2}else{if(!sn(t.b,e))return;n=e.s,cn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=w()-e.u;var i=t.u;St(r=$t(),new re(r,n,e,i)),xn(t)}else Fn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(an(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=ie(_(t.Ba,t,e),Wn(t,t.u)),t.u++,0)))}(t,e)||2==r&&Un(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Hn(t,5);break;case 4:Hn(t,10);break;case 3:Hn(t,6);break;default:Hn(t,2)}}function Wn(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Hn(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=_(t.Ya,t);n||(n=new Re("//www.google.com/images/cleardot.gif"),h.location&&"http"==h.location.protocol||De(n,"https"),qe(n)),function(t,e){var n=new Qt;if(h.Image){var r=new Image;r.onload=b(pn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=b(pn,n,r,"TestLoadImage: error",!1,e),r.onabort=b(pn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=b(pn,n,r,"TestLoadImage: timeout",!1,e),h.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else ne(2);t.v=0,t.f&&t.f.ra(e),Gn(t),jn(t)}function Gn(t){t.v=0,t.I=-1,t.f&&(0==ln(t.b).length&&0==t.g.length||(t.b.c.length=0,C(t.g),t.g.length=0),t.f.qa())}function zn(t,e,n){var r=function(t){return t instanceof Re?xe(t):new Re(t,void 0)}(n);if(""!=r.c)e&&Le(r,e+"."+r.c),Me(r,r.h);else{var i=h.location;r=function(t,e,n,r){var i=new Re(null,void 0);return t&&De(i,t),e&&Le(i,e),n&&Me(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&D(t.V,(function(t,e){Ue(r,e,t)})),n=t.na,(e=t.A)&&n&&Ue(r,e,n),Ue(r,"VER",t.ha),Ln(t,r),r}function Qn(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new gn(t.Na)).F=t.C,e}function Yn(){}function Xn(){if(K&&!(10<=Number(tt)))throw Error("Environmental error: no available transport.")}function Jn(t,e){Ot.call(this),this.a=new An(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!k(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!k(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new tr(this)}function $n(t){he.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Zn(){fe.call(this),this.status=1}function tr(t){this.a=t}(u=gn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:ce),this.a.onreadystatechange=_(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void wn(this,o)}t=n||"";var i=new Ae(this.headers);r&&ke(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=bn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=h.FormData&&t instanceof h.FormData,!(0<=E(_n,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{On(this),0<this.o&&((this.D=function(t){return K&&Z(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=_(this.xa,this)):this.m=Vt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){wn(this,o)}},u.xa=function(){void 0!==l&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,St(this,"timeout"),this.abort(8))},u.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,St(this,"complete"),St(this,"abort"),En(this))},u.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),En(this,!0)),gn.X.G.call(this)},u.za=function(){this.j||(this.A||this.l||this.g?Tn(this):this.Ua())},u.Ua=function(){Tn(this)},u.W=function(){try{return 2<Sn(this)?this.a.status:-1}catch(V){return-1}},u.$=function(){try{return this.a?this.a.responseText:""}catch(V){return""}},u.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),vn(e)}},u.ua=function(){return this.h},u.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(u=An.prototype).ha=8,u.v=1,u.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new pe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?F(r=L(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Mn(this,n,e),Ue(i=xe(this.B),"RID",t),Ue(i,"CVER",22),this.A&&Ue(i,"X-HTTP-Session-Id",this.A),Ln(this,i),this.i&&r&&Cn(i,this.i,r),un(this.b,n),this.Ia&&Ue(i,"TYPE","init"),this.da?(Ue(i,"$req",e),Ue(i,"SID","null"),n.U=!0,me(n,i,null)):me(n,i,e),this.v=2}}else 3==this.v&&(t?Dn(this,t):0==this.g.length||on(this.b)||Dn(this))},u.Aa=function(){if(this.j=null,Vn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ie(_(this.Ta,this),t)}},u.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,ne(10),Pn(this),Vn(this))},u.Sa=function(){null!=this.m&&(this.m=null,Pn(this),Un(this),ne(19))},u.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),ne(2)):(this.c.info("Failed to ping google.com"),ne(1))},(u=Yn.prototype).ta=function(){},u.sa=function(){},u.ra=function(){},u.qa=function(){},u.Ja=function(){},Xn.prototype.a=function(t,e){return new Jn(t,e)},I(Jn,Ot),Jn.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;ne(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=zn(t,null,t.fa),xn(t)},Jn.prototype.close=function(){Nn(this.a)},Jn.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Rn(this.a,e)}else this.l?((e={}).__data__=kt(t),Rn(this.a,e)):Rn(this.a,t)},Jn.prototype.G=function(){this.a.f=null,delete this.f,Nn(this.a),delete this.a,Jn.X.G.call(this)},I($n,he),I(Zn,fe),I(tr,Yn),tr.prototype.ta=function(){St(this.a,"a")},tr.prototype.sa=function(t){St(this.a,new $n(t))},tr.prototype.ra=function(t){St(this.a,new Zn(t))},tr.prototype.qa=function(){St(this.a,"b")},Xn.prototype.createWebChannel=Xn.prototype.a,Jn.prototype.send=Jn.prototype.h,Jn.prototype.open=Jn.prototype.g,Jn.prototype.close=Jn.prototype.close,oe.NO_ERROR=0,oe.TIMEOUT=8,oe.HTTP_ERROR=6,ae.COMPLETE="complete",ue.EventType=le,le.OPEN="a",le.CLOSE="b",le.ERROR="c",le.MESSAGE="d",Ot.prototype.listen=Ot.prototype.va,gn.prototype.listenOnce=gn.prototype.wa,gn.prototype.getLastError=gn.prototype.Qa,gn.prototype.getLastErrorCode=gn.prototype.ua,gn.prototype.getStatus=gn.prototype.W,gn.prototype.getResponseJson=gn.prototype.Pa,gn.prototype.getResponseText=gn.prototype.$,gn.prototype.send=gn.prototype.ba;var er=oe,nr=ae,rr=Xt,ir=ue,or=gn,ar=n("mrSG"),sr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();sr.o=-1;var ur={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},cr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(ar.__extends)(e,t),e}(Error),lr=new o.Logger("@firebase/firestore");function hr(){return lr.logLevel}function fr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(lr.logLevel<=o.LogLevel.DEBUG){var r=e.map(vr);lr.debug.apply(lr,Object(ar.__spreadArray)(["Firestore (8.6.2): "+t],r))}}function dr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(lr.logLevel<=o.LogLevel.ERROR){var r=e.map(vr);lr.error.apply(lr,Object(ar.__spreadArray)(["Firestore (8.6.2): "+t],r))}}function pr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(lr.logLevel<=o.LogLevel.WARN){var r=e.map(vr);lr.warn.apply(lr,Object(ar.__spreadArray)(["Firestore (8.6.2): "+t],r))}}function vr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(yd){return t}}function gr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.6.2) INTERNAL ASSERTION FAILED: "+t;throw dr(e),new Error(e)}function yr(t,e){t||gr()}function mr(t,e){return t}function _r(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var br=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=_r(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function wr(t,e){return t<e?-1:t>e?1:0}function Ir(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Tr(t){return t+"\0"}var Er=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new cr(ur.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new cr(ur.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new cr(ur.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new cr(ur.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?wr(this.nanoseconds,t.nanoseconds):wr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Or=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Er(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function Sr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Cr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function kr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ar=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&gr(),void 0===n?n=t.length-e:n>t.length-e&&gr(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Nr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ar.__extends)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new cr(ur.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Ar),Pr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,jr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ar.__extends)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Pr.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new cr(ur.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new cr(ur.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new cr(ur.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new cr(ur.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Ar),Rr=function(){function t(t){this.fields=t,t.sort(jr.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Ir(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),xr=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return wr(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();xr.EMPTY_BYTE_STRING=new xr("");var Dr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Lr(t){if(yr(!!t),"string"==typeof t){var e=0,n=Dr.exec(t);if(yr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Mr(t.seconds),nanos:Mr(t.nanos)}}function Mr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Fr(t){return"string"==typeof t?xr.fromBase64String(t):xr.fromUint8Array(t)}function Ur(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function qr(t){var e=Lr(t.mapValue.fields.__local_write_time__.timestampValue);return new Er(e.seconds,e.nanos)}function Vr(t){return null==t}function Br(t){return 0===t&&1/t==-1/0}function Kr(t){return"number"==typeof t&&Number.isInteger(t)&&!Br(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Wr=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(Nr.fromString(e))},t.fromName=function(e){return new t(Nr.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Nr.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Nr.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Nr(e.slice()))},t}();function Hr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ur(t)?4:10:gr()}function Gr(t,e){var n=Hr(t);if(n!==Hr(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return qr(t).isEqual(qr(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Lr(t.timestampValue),r=Lr(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Fr(t.bytesValue).isEqual(Fr(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Mr(t.geoPointValue.latitude)===Mr(e.geoPointValue.latitude)&&Mr(t.geoPointValue.longitude)===Mr(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Mr(t.integerValue)===Mr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Mr(t.doubleValue),r=Mr(e.doubleValue);return n===r?Br(n)===Br(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ir(t.arrayValue.values||[],e.arrayValue.values||[],Gr);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Sr(n)!==Sr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Gr(n[i],r[i])))return!1;return!0}(t,e);default:return gr()}}function zr(t,e){return void 0!==(t.values||[]).find((function(t){return Gr(t,e)}))}function Qr(t,e){var n=Hr(t),r=Hr(e);if(n!==r)return wr(n,r);switch(n){case 0:return 0;case 1:return wr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Mr(t.integerValue||t.doubleValue),r=Mr(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Yr(t.timestampValue,e.timestampValue);case 4:return Yr(qr(t),qr(e));case 5:return wr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Fr(t),r=Fr(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=wr(n[i],r[i]);if(0!==o)return o}return wr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=wr(Mr(t.latitude),Mr(e.latitude));return 0!==n?n:wr(Mr(t.longitude),Mr(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Qr(n[i],r[i]);if(o)return o}return wr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=wr(r[a],o[a]);if(0!==s)return s;var u=Qr(n[r[a]],i[o[a]]);if(0!==u)return u}return wr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw gr()}}function Yr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return wr(t,e);var n=Lr(t),r=Lr(e),i=wr(n.seconds,r.seconds);return 0!==i?i:wr(n.nanos,r.nanos)}function Xr(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=Lr(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Fr(e.bytesValue).toBase64():"referenceValue"in e?Wr.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var a=o[i];r?r=!1:n+=",",n+=a+":"+t(e.fields[a])}return n+"}"}(e.mapValue):gr();var n}(t)}function Jr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function $r(t){return!!t&&"integerValue"in t}function Zr(t){return!!t&&"arrayValue"in t}function ti(t){return!!t&&"nullValue"in t}function ei(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ni(t){return!!t&&"mapValue"in t}var ri=function(){function t(t){this.overlayMap=new Map,this.partialValue=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(e){return t.extractNestedValue(this.buildProto(),e)},t.prototype.toProto=function(){return this.field(jr.emptyPath())},t.prototype.set=function(t,e){this.setOverlay(t,e)},t.prototype.setAll=function(t){var e=this;t.forEach((function(t,n){t?e.set(n,t):e.delete(n)}))},t.prototype.delete=function(t){this.setOverlay(t,null)},t.prototype.isEqual=function(t){return Gr(this.buildProto(),t.buildProto())},t.prototype.setOverlay=function(t,e){for(var n=this.overlayMap,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Hr(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.lastSegment(),e)},t.prototype.applyOverlay=function(e,n){var r=this,i=!1,o=t.extractNestedValue(this.partialValue,e),a=ni(o)?Object.assign({},o.mapValue.fields):{};return n.forEach((function(t,n){if(t instanceof Map){var o=r.applyOverlay(e.child(n),t);null!=o&&(a[n]=o,i=!0)}else null!==t?(a[n]=t,i=!0):a.hasOwnProperty(n)&&(delete a[n],i=!0)})),i?{mapValue:{fields:a}}:null},t.prototype.buildProto=function(){var t=this.applyOverlay(jr.emptyPath(),this.overlayMap);return null!=t&&(this.partialValue=t,this.overlayMap.clear()),this.partialValue},t.extractNestedValue=function(t,e){if(e.isEmpty())return t;for(var n=t,r=0;r<e.length-1;++r){if(!n.mapValue.fields)return null;if(!ni(n=n.mapValue.fields[e.get(r)]))return null}return(n=(n.mapValue.fields||{})[e.lastSegment()])||null},t.prototype.clone=function(){return new t(this.buildProto())},t}();function ii(t){var e=[];return Cr(t.fields||{},(function(t,n){var r=new jr([t]);if(ni(n)){var i=ii(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,a=i;o<a.length;o++)e.push(r.child(a[o]))}else e.push(r)})),new Rr(e)}var oi=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,Or.min(),ri.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,ri.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,ri.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=ri.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=ri.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.toProto())+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),ai=function(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};function si(t,e,n,r,i,o,a){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new ai(t,e,n,r,i,o,a)}function ui(t){var e=mr(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Xr(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),Vr(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=wi(e.startAt)),e.endAt&&(n+="|ub:",n+=wi(e.endAt)),e.h=n}return e.h}function ci(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Ti(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Gr(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Oi(t.startAt,e.startAt)&&Oi(t.endAt,e.endAt)}function li(t){return Wr.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var hi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(ar.__extends)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new fi(t,n,r):"array-contains"===n?new gi(t,r):"in"===n?new yi(t,r):"not-in"===n?new mi(t,r):"array-contains-any"===n?new _i(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new di(t,n):new pi(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Qr(e,this.value)):null!==e&&Hr(this.value)===Hr(e)&&this.m(Qr(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return gr()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),fi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Wr.fromName(r.referenceValue),i}return Object(ar.__extends)(e,t),e.prototype.matches=function(t){var e=Wr.comparator(t.key,this.key);return this.m(e)},e}(hi),di=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=vi(0,n),r}return Object(ar.__extends)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(hi),pi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=vi(0,n),r}return Object(ar.__extends)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(hi);function vi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Wr.fromName(t.referenceValue)}))}var gi=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(ar.__extends)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Zr(e)&&zr(e.arrayValue,this.value)},e}(hi),yi=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(ar.__extends)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&zr(this.value.arrayValue,e)},e}(hi),mi=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(ar.__extends)(e,t),e.prototype.matches=function(t){if(zr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!zr(this.value.arrayValue,e)},e}(hi),_i=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(ar.__extends)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Zr(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return zr(e.value.arrayValue,t)}))},e}(hi),bi=function(t,e){this.position=t,this.before=e};function wi(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Xr(t)})).join(",")}var Ii=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ti(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Ei(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.isKeyField()?Wr.comparator(Wr.fromName(a.referenceValue),n.key):Qr(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Oi(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Gr(t.position[n],e.position[n]))return!1;return!0}var Si=function(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null};function Ci(t,e,n,r,i,o,a,s){return new Si(t,e,n,r,i,o,a,s)}function ki(t){return new Si(t)}function Ai(t){return!Vr(t.limit)&&"F"===t.limitType}function Ni(t){return!Vr(t.limit)&&"L"===t.limitType}function Pi(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function ji(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Ri(t){return null!==t.collectionGroup}function xi(t){var e=mr(t);if(null===e.p){e.p=[];var n=ji(e),r=Pi(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Ii(n)),e.p.push(new Ii(jr.keyField(),"asc"));else{for(var i=!1,o=0,a=e.explicitOrderBy;o<a.length;o++){var s=a[o];e.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Ii(jr.keyField(),u))}}}return e.p}function Di(t){var e=mr(t);if(!e.T)if("F"===e.limitType)e.T=si(e.path,e.collectionGroup,xi(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=xi(e);r<i.length;r++){var o=i[r];n.push(new Ii(o.field,"desc"===o.dir?"asc":"desc"))}var a=e.endAt?new bi(e.endAt.position,!e.endAt.before):null,s=e.startAt?new bi(e.startAt.position,!e.startAt.before):null;e.T=si(e.path,e.collectionGroup,n,e.filters,e.limit,a,s)}return e.T}function Li(t,e,n){return new Si(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Mi(t,e){return ci(Di(t),Di(e))&&t.limitType===e.limitType}function Fi(t){return ui(Di(t))+"|lt:"+t.limitType}function Ui(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Xr(e.value);var e})).join(", ")+"]"),Vr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+wi(t.startAt)),t.endAt&&(e+=", endAt: "+wi(t.endAt)),"Target("+e+")"}(Di(t))+"; limitType="+t.limitType+")"}function qi(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Wr.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Ei(t.startAt,xi(t),e)||t.endAt&&Ei(t.endAt,xi(t),e))}(t,e)}function Vi(t){return function(e,n){for(var r=!1,i=0,o=xi(t);i<o.length;i++){var a=o[i],s=Bi(a,e,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function Bi(t,e,n){var r=t.field.isKeyField()?Wr.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Qr(r,i):gr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return gr()}}function Ki(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Br(e)?"-0":e}}function Wi(t){return{integerValue:""+t}}function Hi(t,e){return Kr(e)?Wi(e):Ki(t,e)}var Gi=function(){this._=void 0};function zi(t,e,n){return t instanceof Xi?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ji?$i(t,e):t instanceof Zi?to(t,e):function(t,e){var n=Yi(t,e),r=no(n)+no(t.A);return $r(n)&&$r(t.A)?Wi(r):Ki(t.R,r)}(t,e)}function Qi(t,e,n){return t instanceof Ji?$i(t,e):t instanceof Zi?to(t,e):n}function Yi(t,e){return t instanceof eo?$r(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Xi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ar.__extends)(e,t),e}(Gi),Ji=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(ar.__extends)(e,t),e}(Gi);function $i(t,e){for(var n=ro(e),r=function(t){n.some((function(e){return Gr(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Zi=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(ar.__extends)(e,t),e}(Gi);function to(t,e){for(var n=ro(e),r=function(t){n=n.filter((function(e){return!Gr(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var eo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(ar.__extends)(e,t),e}(Gi);function no(t){return Mr(t.integerValue||t.doubleValue)}function ro(t){return Zr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var io=function(t,e){this.field=t,this.transform=e},oo=function(t,e){this.version=t,this.transformResults=e},ao=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function so(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var uo=function(){};function co(t,e,n){t instanceof vo?function(t,e,n){var r=t.value.clone(),i=mo(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof go?function(t,e,n){if(so(t.precondition,e)){var r=mo(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(yo(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function lo(t,e,n){t instanceof vo?function(t,e,n){if(so(t.precondition,e)){var r=t.value.clone(),i=_o(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(po(e),r).setHasLocalMutations()}}(t,e,n):t instanceof go?function(t,e,n){if(so(t.precondition,e)){var r=_o(t.fieldTransforms,n,e),i=e.data;i.setAll(yo(t)),i.setAll(r),e.convertToFoundDocument(po(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){so(t.precondition,e)&&e.convertToNoDocument(Or.min())}(t,e)}function ho(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],a=e.data.field(o.field),s=Yi(o.transform,a||null);null!=s&&(null==n&&(n=ri.empty()),n.set(o.field,s))}return n||null}function fo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Ir(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ji&&e instanceof Ji||t instanceof Zi&&e instanceof Zi?Ir(t.elements,e.elements,Gr):t instanceof eo&&e instanceof eo?Gr(t.A,e.A):t instanceof Xi&&e instanceof Xi}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function po(t){return t.isFoundDocument()?t.version:Or.min()}var vo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(ar.__extends)(e,t),e}(uo),go=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=t.call(this)||this).key=e,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return Object(ar.__extends)(e,t),e}(uo);function yo(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function mo(t,e,n){var r=new Map;yr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,s=e.data.field(o.field);r.set(o.field,Qi(a,s,n[i]))}return r}function _o(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var a=o[i],s=a.transform,u=n.data.field(a.field);r.set(a.field,zi(s,u,e))}return r}var bo,wo,Io=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(ar.__extends)(e,t),e}(uo),To=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(ar.__extends)(e,t),e}(uo),Eo=function(t){this.count=t};function Oo(t){switch(t){case ur.OK:return gr();case ur.CANCELLED:case ur.UNKNOWN:case ur.DEADLINE_EXCEEDED:case ur.RESOURCE_EXHAUSTED:case ur.INTERNAL:case ur.UNAVAILABLE:case ur.UNAUTHENTICATED:return!1;case ur.INVALID_ARGUMENT:case ur.NOT_FOUND:case ur.ALREADY_EXISTS:case ur.PERMISSION_DENIED:case ur.FAILED_PRECONDITION:case ur.ABORTED:case ur.OUT_OF_RANGE:case ur.UNIMPLEMENTED:case ur.DATA_LOSS:return!0;default:return gr()}}function So(t){if(void 0===t)return dr("GRPC error has no .code"),ur.UNKNOWN;switch(t){case bo.OK:return ur.OK;case bo.CANCELLED:return ur.CANCELLED;case bo.UNKNOWN:return ur.UNKNOWN;case bo.DEADLINE_EXCEEDED:return ur.DEADLINE_EXCEEDED;case bo.RESOURCE_EXHAUSTED:return ur.RESOURCE_EXHAUSTED;case bo.INTERNAL:return ur.INTERNAL;case bo.UNAVAILABLE:return ur.UNAVAILABLE;case bo.UNAUTHENTICATED:return ur.UNAUTHENTICATED;case bo.INVALID_ARGUMENT:return ur.INVALID_ARGUMENT;case bo.NOT_FOUND:return ur.NOT_FOUND;case bo.ALREADY_EXISTS:return ur.ALREADY_EXISTS;case bo.PERMISSION_DENIED:return ur.PERMISSION_DENIED;case bo.FAILED_PRECONDITION:return ur.FAILED_PRECONDITION;case bo.ABORTED:return ur.ABORTED;case bo.OUT_OF_RANGE:return ur.OUT_OF_RANGE;case bo.UNIMPLEMENTED:return ur.UNIMPLEMENTED;case bo.DATA_LOSS:return ur.DATA_LOSS;default:return gr()}}(wo=bo||(bo={}))[wo.OK=0]="OK",wo[wo.CANCELLED=1]="CANCELLED",wo[wo.UNKNOWN=2]="UNKNOWN",wo[wo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wo[wo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wo[wo.NOT_FOUND=5]="NOT_FOUND",wo[wo.ALREADY_EXISTS=6]="ALREADY_EXISTS",wo[wo.PERMISSION_DENIED=7]="PERMISSION_DENIED",wo[wo.UNAUTHENTICATED=16]="UNAUTHENTICATED",wo[wo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wo[wo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wo[wo.ABORTED=10]="ABORTED",wo[wo.OUT_OF_RANGE=11]="OUT_OF_RANGE",wo[wo.UNIMPLEMENTED=12]="UNIMPLEMENTED",wo[wo.INTERNAL=13]="INTERNAL",wo[wo.UNAVAILABLE=14]="UNAVAILABLE",wo[wo.DATA_LOSS=15]="DATA_LOSS";var Co=function(){function t(t,e){this.comparator=t,this.root=e||Ao.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ao.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ao.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new ko(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new ko(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new ko(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new ko(this.root,t,this.comparator,!0)},t}(),ko=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Ao=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw gr();if(this.right.isRed())throw gr();var t=this.left.check();if(t!==this.right.check())throw gr();return t+(this.isRed()?0:1)},t}();Ao.EMPTY=null,Ao.RED=!0,Ao.BLACK=!1,Ao.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw gr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw gr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw gr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw gr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw gr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Ao(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var No=function(){function t(t){this.comparator=t,this.data=new Co(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Po(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Po(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Po=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),jo=new Co(Wr.comparator);function Ro(){return jo}var xo=new Co(Wr.comparator);function Do(){return xo}var Lo=new Co(Wr.comparator);function Mo(){return Lo}var Fo=new No(Wr.comparator);function Uo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Fo,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var qo=new No(wr);function Vo(){return qo}var Bo=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Ko.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Or.min(),r,Vo(),Ro(),Uo())},t}(),Ko=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(xr.EMPTY_BYTE_STRING,n,Uo(),Uo(),Uo())},t}(),Wo=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Ho=function(t,e){this.targetId=t,this.V=e},Go=function(t,e,n,r){void 0===n&&(n=xr.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},zo=function(){function t(){this.S=0,this.D=Xo(),this.C=xr.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"O",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.$=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Uo(),e=Uo(),n=Uo();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:gr()}})),new Ko(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Xo()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),Qo=function(){function t(t){this.W=t,this.G=new Map,this.H=Ro(),this.J=Yo(),this.Y=new No(wr)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.tt(r=o[i],t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.$(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.$(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.$(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.$(t.resumeToken));break;default:gr()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(li(i))if(0===n){var o=new Wr(i.path);this.tt(e,o,oi.newNoDocument(o,Or.min()))}else yr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.at=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&li(o.target)){var a=new Wr(o.target.path);null!==e.H.get(a)||e.ut(i,a)||e.tt(i,a,oi.newNoDocument(a,t))}r.O&&(n.set(i,r.M()),r.L())}}));var r=Uo();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Bo(t,n,this.Y,this.H,r);return this.H=Ro(),this.J=Yo(),this.Y=new No(wr),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.ut(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.ut(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new zo,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new No(wr),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||fr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new zo),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.ut=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Yo(){return new Co(Wr.comparator)}function Xo(){return new Co(Wr.comparator)}var Jo={asc:"ASCENDING",desc:"DESCENDING"},$o={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Zo=function(t,e){this.databaseId=t,this.I=e};function ta(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ea(t,e){return t.I?e.toBase64():e.toUint8Array()}function na(t,e){return ta(t,e.toTimestamp())}function ra(t){return yr(!!t),Or.fromTimestamp(function(t){var e=Lr(t);return new Er(e.seconds,e.nanos)}(t))}function ia(t,e){return function(t){return new Nr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function oa(t){var e=Nr.fromString(t);return yr(ka(e)),e}function aa(t,e){return ia(t.databaseId,e.path)}function sa(t,e){var n=oa(e);if(n.get(1)!==t.databaseId.projectId)throw new cr(ur.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new cr(ur.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Wr(ha(n))}function ua(t,e){return ia(t.databaseId,e)}function ca(t){var e=oa(t);return 4===e.length?Nr.emptyPath():ha(e)}function la(t){return new Nr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ha(t){return yr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function fa(t,e,n){return{name:aa(t,e),fields:n.toProto().mapValue.fields}}function da(t,e,n){var r=sa(t,e.name),i=ra(e.updateTime),o=new ri({mapValue:{fields:e.fields}}),a=oi.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function pa(t,e){var n;if(e instanceof vo)n={update:fa(t,e.key,e.value)};else if(e instanceof Io)n={delete:aa(t,e.key)};else if(e instanceof go)n={update:fa(t,e.key,e.data),updateMask:Ca(e.fieldMask)};else{if(!(e instanceof To))return gr();n={verify:aa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Xi)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ji)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Zi)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof eo)return{fieldPath:e.field.canonicalString(),increment:n.A};throw gr()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:na(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:gr()}(t,e.precondition)),n}function va(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?ao.updateTime(ra(t.updateTime)):void 0!==t.exists?ao.exists(t.exists):ao.none()}(e.currentDocument):ao.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;"setToServerValue"in e?(yr("REQUEST_TIME"===e.setToServerValue),n=new Xi):"appendMissingElements"in e?n=new Ji(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Zi(e.removeAllFromArray.values||[]):"increment"in e?n=new eo(t,e.increment):gr();var r=jr.fromServerFormat(e.fieldPath);return new io(r,n)}(t,e)})):[];if(e.update){var i=sa(t,e.update.name),o=new ri({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=function(t){return new Rr((t.fieldPaths||[]).map((function(t){return jr.fromServerFormat(t)})))}(e.updateMask);return new go(i,o,a,n,r)}return new vo(i,o,n,r)}if(e.delete){var s=sa(t,e.delete);return new Io(s,n)}if(e.verify){var u=sa(t,e.verify);return new To(u,n)}return gr()}function ga(t,e){return{documents:[ua(t,e.path)]}}function ya(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ua(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ua(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(ei(t.value))return{unaryFilter:{field:Ta(t.field),op:"IS_NAN"}};if(ti(t.value))return{unaryFilter:{field:Ta(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ei(t.value))return{unaryFilter:{field:Ta(t.field),op:"IS_NOT_NAN"}};if(ti(t.value))return{unaryFilter:{field:Ta(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ta(t.field),op:Ia(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Ta(t.field),direction:wa(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(t,e){return t.I||Vr(e)?e:{value:e}}(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=_a(e.startAt)),e.endAt&&(n.structuredQuery.endAt=_a(e.endAt)),n}function ma(t){var e=ca(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){yr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=function t(e){return e?void 0!==e.unaryFilter?[Sa(e)]:void 0!==e.fieldFilter?[Oa(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):gr():[]}(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new Ii(Ea(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return Vr(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ba(n.startAt));var l=null;return n.endAt&&(l=ba(n.endAt)),Ci(e,i,s,a,u,"F",c,l)}function _a(t){return{before:t.before,values:t.position}}function ba(t){return new bi(t.values||[],!!t.before)}function wa(t){return Jo[t]}function Ia(t){return $o[t]}function Ta(t){return{fieldPath:t.canonicalString()}}function Ea(t){return jr.fromServerFormat(t.fieldPath)}function Oa(t){return hi.create(Ea(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return gr()}}(t.fieldFilter.op),t.fieldFilter.value)}function Sa(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ea(t.unaryFilter.field);return hi.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ea(t.unaryFilter.field);return hi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ea(t.unaryFilter.field);return hi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ea(t.unaryFilter.field);return hi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return gr()}}function Ca(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function ka(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Aa(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Pa(e)),e=Na(t.get(n),e);return Pa(e)}function Na(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Pa(t){return t+"\x01\x01"}function ja(t){var e=t.length;if(yr(e>=2),2===e)return yr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Nr.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf("\x01",o);switch((a<0||a>n)&&gr(),t.charAt(a+1)){case"\x01":var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"\x10":i+=t.substring(o,a),i+="\0";break;case"\x11":i+=t.substring(o,a+1);break;default:gr()}o=a+2}return new Nr(r)}var Ra=function(t,e){this.seconds=t,this.nanoseconds=e},xa=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};xa.store="owner",xa.key="owner";var Da=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Da.store="mutationQueues",Da.keyPath="userId";var La=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};La.store="mutations",La.keyPath="batchId",La.userMutationsIndex="userMutationsIndex",La.userMutationsKeyPath=["userId","batchId"];var Ma=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Aa(e)]},t.key=function(t,e,n){return[t,Aa(e),n]},t}();Ma.store="documentMutations",Ma.PLACEHOLDER=new Ma;var Fa=function(t,e){this.path=t,this.readTime=e},Ua=function(t,e){this.path=t,this.version=e},qa=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};qa.store="remoteDocuments",qa.readTimeIndex="readTimeIndex",qa.readTimeIndexPath="readTime",qa.collectionReadTimeIndex="collectionReadTimeIndex",qa.collectionReadTimeIndexPath=["parentPath","readTime"];var Va=function(t){this.byteSize=t};Va.store="remoteDocumentGlobal",Va.key="remoteDocumentGlobalKey";var Ba=function(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};Ba.store="targets",Ba.keyPath="targetId",Ba.queryTargetsIndexName="queryTargetsIndex",Ba.queryTargetsKeyPath=["canonicalId","targetId"];var Ka=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ka.store="targetDocuments",Ka.keyPath=["targetId","path"],Ka.documentTargetsIndex="documentTargetsIndex",Ka.documentTargetsKeyPath=["path","targetId"];var Wa=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Wa.key="targetGlobalKey",Wa.store="targetGlobal";var Ha=function(t,e){this.collectionId=t,this.parent=e};Ha.store="collectionParents",Ha.keyPath=["collectionId","parent"];var Ga=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ga.store="clientMetadata",Ga.keyPath="clientId";var za=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};za.store="bundles",za.keyPath="bundleId";var Qa=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Qa.store="namedQueries",Qa.keyPath="name";var Ya=Object(ar.__spreadArray)(Object(ar.__spreadArray)([],Object(ar.__spreadArray)(Object(ar.__spreadArray)([],Object(ar.__spreadArray)(Object(ar.__spreadArray)([],Object(ar.__spreadArray)(Object(ar.__spreadArray)([],[Da.store,La.store,Ma.store,qa.store,Ba.store,xa.store,Wa.store,Ka.store]),[Ga.store])),[Va.store])),[Ha.store])),[za.store,Qa.store]),Xa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ja=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),$a=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Za=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&gr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),ts=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new $a,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new rs(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=us(e.target.error);n.ft.reject(new rs(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new rs(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(fr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new os(e)},t}(),es=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Object(i.getUA)())&&dr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return fr("SimpleDb","Removing database:",t),as(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Object(i.getUA)(),n=t._t(e),r=0<n&&n<10,o=t.Et(e),a=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(fr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new rs(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new cr(ur.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new rs(t,n))},i.onupgradeneeded=function(t){fr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.wt.Rt(t.target.result,i.transaction,t.oldVersion,n.version).next((function(){fr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u;return Object(ar.__generator)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,u,c,l;return Object(ar.__generator)(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,s.At(t)];case 2:return s.db=h.sent(),e=ts.open(s.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),Za.reject(t)})).toPromise(),u={},a.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(h.sent(),a),u)];case 4:return fr("SimpleDb","Transaction failed with error:",(c=h.sent()).message,"Retrying:",l="FirebaseError"!==c.name&&o<3),s.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},s=this,c.label=1;case 1:return[5,a()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),ns=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return as(this.Pt.delete())},t}(),rs=function(t){function e(e,n){var r=this;return(r=t.call(this,ur.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(ar.__extends)(e,t),e}(cr);function is(t){return"IndexedDbTransactionError"===t.name}var os=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(fr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(fr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),as(n)},t.prototype.add=function(t){return fr("SimpleDb","ADD",this.store.name,t,t),as(this.store.add(t))},t.prototype.get=function(t){var e=this;return as(this.store.get(t)).next((function(n){return void 0===n&&(n=null),fr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return fr("SimpleDb","DELETE",this.store.name,t),as(this.store.delete(t))},t.prototype.count=function(){return fr("SimpleDb","COUNT",this.store.name),as(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){fr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.Ot=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.$t=function(t){var e=this.cursor({});return new Za((function(n,r){e.onerror=function(t){var e=us(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Za((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ns(i),a=e(i.primaryKey,i.value,o);if(a instanceof Za){var s=a.catch((function(t){return o.done(),Za.reject(t)}));n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Za.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function as(t){return new Za((function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=us(t.target.error);n(e)}}))}var ss=!1;function us(t){var e=es._t(Object(i.getUA)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new cr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ss||(ss=!0,setTimeout((function(){throw r}),0)),r}}return t}var cs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(ar.__extends)(e,t),e}(Ja);function ls(t,e){var n=mr(t);return es.It(n.Mt,e)}var hs=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&co(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&lo(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&lo(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Or.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Uo())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ir(this.mutations,t.mutations,(function(t,e){return fo(t,e)}))&&Ir(this.baseMutations,t.baseMutations,(function(t,e){return fo(t,e)}))},t}(),fs=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){yr(e.mutations.length===r.length);for(var i=Mo(),o=e.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new t(e,n,r,i)},t}(),ds=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=Or.min()),void 0===o&&(o=Or.min()),void 0===a&&(a=xr.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),ps=function(t){this.Lt=t};function vs(t,e){if(e.document)return da(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Wr.fromSegments(e.noDocument.path),r=bs(e.noDocument.readTime),i=oi.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Wr.fromSegments(e.unknownDocument.path);return r=bs(e.unknownDocument.version),oi.newUnknownDocument(o,r)}return gr()}function gs(t,e,n){var r=ys(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:aa(t,e.key),fields:e.data.toProto().mapValue.fields,updateTime:ta(t,e.version.toTimestamp())}}(t.Lt,e),a=e.hasCommittedMutations;return new qa(null,null,o,a,r,i)}if(e.isNoDocument()){var s=e.key.path.toArray(),u=_s(e.version);return a=e.hasCommittedMutations,new qa(null,new Fa(s,u),null,a,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),l=_s(e.version);return new qa(new Ua(c,l),null,null,!0,r,i)}return gr()}function ys(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ms(t){var e=new Er(t[0],t[1]);return Or.fromTimestamp(e)}function _s(t){var e=t.toTimestamp();return new Ra(e.seconds,e.nanoseconds)}function bs(t){var e=new Er(t.seconds,t.nanoseconds);return Or.fromTimestamp(e)}function ws(t,e){for(var n=(e.baseMutations||[]).map((function(e){return va(t.Lt,e)})),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var i=e.mutations.map((function(e){return va(t.Lt,e)})),o=Er.fromMillis(e.localWriteTimeMs);return new hs(e.batchId,o,n,i)}function Is(t){var e,n,r=bs(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?bs(t.lastLimboFreeSnapshotVersion):Or.min();return void 0!==t.query.documents?(yr(1===(n=t.query).documents.length),e=Di(ki(ca(n.documents[0])))):e=function(t){return Di(ma(t))}(t.query),new ds(e,t.targetId,0,t.lastListenSequenceNumber,r,i,xr.fromBase64String(t.resumeToken))}function Ts(t,e){var n,r=_s(e.snapshotVersion),i=_s(e.lastLimboFreeSnapshotVersion);n=li(e.target)?ga(t.Lt,e.target):ya(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Ba(e.targetId,ui(e.target),r,o,e.sequenceNumber,i,n)}function Es(t){var e=ma({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Li(e,e.limit,"L"):e}var Os=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Ss(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:bs(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Ss(t).put({bundleId:(n=e).id,createTime:_s(ra(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Cs(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Es(e.bundledQuery),readTime:bs(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Cs(t).put(function(t){return{name:t.name,readTime:_s(ra(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Ss(t){return ls(t,za.store)}function Cs(t){return ls(t,Qa.store)}var ks=function(){function t(){this.Bt=new As}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Za.resolve()},t.prototype.getCollectionParents=function(t,e){return Za.resolve(this.Bt.getEntries(e))},t}(),As=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new No(Nr.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new No(Nr.comparator)).toArray()},t}(),Ns=function(){function t(){this.qt=new As}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Aa(i)};return Ps(t).put(o)}return Za.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Tr(e),""],!1,!0);return Ps(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ja(o.parent))}return n}))},t}();function Ps(t){return ls(t,Ha.store)}var js={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Rs=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function xs(t,e,n){var r=t.store(La.store),i=t.store(Ma.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.Ot({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){yr(1===s)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=Ma.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Za.waitFor(o).next((function(){return c}))}function Ds(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw gr();e=t.noDocument}return JSON.stringify(e).length}Rs.DEFAULT_COLLECTION_PERCENTILE=10,Rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rs.DEFAULT=new Rs(41943040,Rs.DEFAULT_COLLECTION_PERCENTILE,Rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rs.DISABLED=new Rs(-1,0,0);var Ls=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return yr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Fs(t).Ot({index:La.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Us(t),a=Fs(t);return a.add({}).next((function(s){yr("number"==typeof s);for(var u=new hs(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return pa(t.Lt,e)})),i=n.mutations.map((function(e){return pa(t.Lt,e)}));return new La(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new No((function(t,e){return wr(t.canonicalString(),e.canonicalString())})),f=0,d=r;f<d.length;f++){var p=d[f],v=Ma.key(i.userId,p.key.path,s);h=h.add(p.key.path.popLast()),l.push(a.put(c)),l.push(o.put(v,Ma.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Qt[s]=u.keys()})),Za.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Fs(t).get(e).next((function(t){return t?(yr(t.userId===n.userId),ws(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?Za.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Fs(t).Ot({index:La.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(yr(e.batchId>=r),o=ws(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Fs(t).Ot({index:La.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Fs(t).Nt(La.userMutationsIndex,n).next((function(t){return t.map((function(t){return ws(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Ma.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Us(t).Ot({range:i},(function(r,i,a){var s=r[0],u=r[2],c=ja(r[1]);if(s===n.userId&&e.path.isEqual(c))return Fs(t).get(u).next((function(t){if(!t)throw gr();yr(t.userId===n.userId),o.push(ws(n.R,t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new No(wr),i=[];return e.forEach((function(e){var o=Ma.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=Us(t).Ot({range:a},(function(t,i,o){var a=t[0],s=t[2],u=ja(t[1]);a===n.userId&&e.path.isEqual(u)?r=r.add(s):o.done()}));i.push(s)})),Za.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ma.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new No(wr);return Us(t).Ot({range:a},(function(t,e,o){var a=t[0],u=t[2],c=ja(t[1]);a===n.userId&&r.isPrefixOf(c)?c.length===i&&(s=s.add(u)):o.done()})).next((function(){return n.Wt(t,s)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Fs(t).get(e).next((function(t){if(null===t)throw gr();yr(t.userId===n.userId),r.push(ws(n.R,t))})))})),Za.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return xs(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Za.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Za.resolve();var r=IDBKeyRange.lowerBound(Ma.prefixForUser(e.userId)),i=[];return Us(t).Ot({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ja(t[1]);i.push(o)}else r.done()})).next((function(){yr(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Ms(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return qs(t).get(this.userId).next((function(t){return t||new Da(e.userId,-1,"")}))},t}();function Ms(t,e,n){var r=Ma.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Us(t).Ot({range:o,kt:!0},(function(t,n,r){t[0]===e&&t[1]===i&&(a=!0),r.done()})).next((function(){return a}))}function Fs(t){return ls(t,La.store)}function Us(t){return ls(t,Ma.store)}function qs(t){return ls(t,Da.store)}var Vs=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Bs=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Vs(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return Or.fromTimestamp(new Er(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Ks(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return yr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Ks(t).Ot((function(a,s){var u=Is(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Za.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Ks(t).Ot((function(t,n){var r=Is(n);e(r)}))},t.prototype.Xt=function(t){return Ws(t).get(Wa.key).next((function(t){return yr(null!==t),t}))},t.prototype.Zt=function(t,e){return Ws(t).put(Wa.key,e)},t.prototype.te=function(t,e){return Ks(t).put(Ts(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=ui(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ks(t).Ot({range:r,index:Ba.queryTargetsIndexName},(function(t,n,r){var o=Is(n);ci(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Hs(t);return e.forEach((function(e){var a=Aa(e.path);i.push(o.put(new Ka(n,a))),i.push(r.referenceDelegate.addReference(t,n,e))})),Za.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Hs(t);return Za.forEach(e,(function(e){var o=Aa(e.path);return Za.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Hs(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Hs(t),i=Uo();return r.Ot({range:n,kt:!0},(function(t,e,n){var r=ja(t[1]),o=new Wr(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Aa(e.path),r=IDBKeyRange.bound([n],[Tr(n)],!1,!0),i=0;return Hs(t).Ot({index:Ka.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){0!==t[0]&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Ks(t).get(e).next((function(t){return t?Is(t):null}))},t}();function Ks(t){return ls(t,Ba.store)}function Ws(t){return ls(t,Wa.store)}function Hs(t){return ls(t,Ka.store)}function Gs(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){if(t.code!==ur.FAILED_PRECONDITION||t.message!==Xa)throw t;return fr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function zs(t,e){var n=t[1],r=e[1],i=wr(t[0],e[0]);return 0===i?wr(n,r):i}var Qs=function(){function t(t){this.ne=t,this.buffer=new No(zs),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();zs(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ys=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ae(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ae=function(t){var e=this,n=this.oe?3e5:6e4;fr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Object(ar.__awaiter)(e,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return is(e=n.sent())?(fr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Gs(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ae(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Xs=function(){function t(t,e){this.ue=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ue.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Za.resolve(sr.o);var r=new Qs(e);return this.ue.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ue.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ue.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ue.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(fr("LruGarbageCollector","Garbage collection skipped; disabled"),Za.resolve(js)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(fr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),js):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ue.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,a,s,u,c,l=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>l.params.maximumSequenceNumbersToCollect?(fr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+e),r=l.params.maximumSequenceNumbersToCollect):r=e,a=Date.now(),l.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),l.removeTargets(t,n,e)})).next((function(e){return i=e,u=Date.now(),l.removeOrphanedDocuments(t,n)})).next((function(t){return c=Date.now(),hr()<=o.LogLevel.DEBUG&&fr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-h)+"ms"),Za.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),Js=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Xs(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return $s(t,n)},t.prototype.removeReference=function(t,e,n){return $s(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return $s(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return qs(t).$t((function(r){return Ms(t,r,e).next((function(t){return t&&(n=!0),Za.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(a,s){if(s<=e){var u=n._e(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),Hs(t).delete([0,Aa(a.path)])}))}));i.push(u)}})).next((function(){return Za.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return $s(t,e)},t.prototype.we=function(t,e){var n,r=Hs(t),i=sr.o;return r.Ot({index:Ka.documentTargetsIndex},(function(t,r){var o=r.path,a=r.sequenceNumber;0===t[0]?(i!==sr.o&&e(new Wr(ja(n)),i),i=a,n=o):i=sr.o})).next((function(){i!==sr.o&&e(new Wr(ja(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function $s(t,e){return Hs(t).put(function(t,e){return new Ka(0,Aa(t.path),e)}(e,t.currentSequenceNumber))}var Zs=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[1];if(this.equalsFn(o[0],t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Cr(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}}))},t.prototype.isEmpty=function(){return kr(this.inner)},t}(),tu=function(){function t(){this.changes=new Zs((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Or.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:oi.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Za.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),eu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return iu(t).put(ou(e),n)},t.prototype.removeEntry=function(t,e){var n=iu(t),r=ou(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return iu(t).get(ou(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return iu(t).get(ou(e)).next((function(t){return{document:n.ye(e,t),size:Ds(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Ro();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Ro(),i=new Co(Wr.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Ds(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Za.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return iu(t).Ot({range:r},(function(t,e,r){for(var a=Wr.fromSegments(t);o&&Wr.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Ro(),o=e.path.length+1,a={};if(n.isEqual(Or.min())){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=ys(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=qa.collectionReadTimeIndex}return iu(t).Ot(a,(function(t,n,a){if(t.length===o){var s=vs(r.R,n);e.path.isPrefixOf(s.key.path)?qi(e,s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new nu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return ru(t).get(Va.key).next((function(t){return yr(!!t),t}))},t.prototype.me=function(t,e){return ru(t).put(Va.key,e)},t.prototype.ye=function(t,e){if(e){var n=vs(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(Or.min()))return n}return oi.newInvalidDocument(t)},t}(),nu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Zs((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Object(ar.__extends)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new No((function(t,e){return wr(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.Ae.get(o);if(a.document.isValidDocument()){var u=gs(e.Ie.R,a.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Ds(u);r+=c-s,n.push(e.Ie.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var l=gs(e.Ie.R,oi.newNoDocument(o,Or.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,l))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Za.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(tu);function ru(t){return ls(t,Va.store)}function iu(t){return ls(t,qa.store)}function ou(t){return t.path.toArray()}var au=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;yr(n<r&&n>=0&&r<=11);var o=new ts("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(xa.store)}(t),function(t){t.createObjectStore(Da.store,{keyPath:Da.keyPath}),t.createObjectStore(La.store,{keyPath:La.keyPath,autoIncrement:!0}).createIndex(La.userMutationsIndex,La.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ma.store)}(t),su(t),function(t){t.createObjectStore(qa.store)}(t));var a=Za.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ka.store),t.deleteObjectStore(Ba.store),t.deleteObjectStore(Wa.store)}(t),su(t)),a=a.next((function(){return function(t){var e=t.store(Wa.store),n=new Wa(0,0,Or.min().toTimestamp(),0);return e.put(Wa.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(La.store).Nt().next((function(n){t.deleteObjectStore(La.store),t.createObjectStore(La.store,{keyPath:La.keyPath,autoIncrement:!0}).createIndex(La.userMutationsIndex,La.userMutationsKeyPath,{unique:!0});var r=e.store(La.store),i=n.map((function(t){return r.put(t)}));return Za.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(Ga.store,{keyPath:Ga.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.Re(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(Va.store)}(t),i.be(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ve(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(qa.store);e.createIndex(qa.readTimeIndex,qa.readTimeIndexPath,{unique:!1}),e.createIndex(qa.collectionReadTimeIndex,qa.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(a=a.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(a=a.next((function(){!function(t){t.createObjectStore(za.store,{keyPath:za.keyPath})}(t),function(t){t.createObjectStore(Qa.store,{keyPath:Qa.keyPath})}(t)}))),a},t.prototype.be=function(t){var e=0;return t.store(qa.store).Ot((function(t,n){e+=Ds(n)})).next((function(){var n=new Va(e);return t.store(Va.store).put(Va.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Da.store),r=t.store(La.store);return n.Nt().next((function(n){return Za.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(La.userMutationsIndex,i).next((function(r){return Za.forEach(r,(function(r){yr(r.userId===n.userId);var i=ws(e.R,r);return xs(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Ka.store),n=t.store(qa.store);return t.store(Wa.store).get(Wa.key).next((function(t){var r=[];return n.Ot((function(n,i){var o=new Nr(n),a=function(t){return[0,Aa(t)]}(o);r.push(e.get(a).next((function(n){return n?Za.resolve():function(n){return e.put(new Ka(0,Aa(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Za.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Ha.store,{keyPath:Ha.keyPath});var n=e.store(Ha.store),r=new As,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Aa(i)})}};return e.store(qa.store).Ot({kt:!0},(function(t,e){var n=new Nr(t);return i(n.popLast())})).next((function(){return e.store(Ma.store).Ot({kt:!0},(function(t,e){var n=ja(t[1]);return i(n.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Ba.store);return n.Ot((function(t,r){var i=Is(r),o=Ts(e.R,i);return n.put(o)}))},t}();function su(t){t.createObjectStore(Ka.store,{keyPath:Ka.keyPath}).createIndex(Ka.documentTargetsIndex,Ka.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ba.store,{keyPath:Ba.keyPath}).createIndex(Ba.queryTargetsIndexName,Ba.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Wa.store)}var uu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",cu=function(){function t(e,n,r,i,o,a,s,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.Oe=null,this.$e=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new cr(ur.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Js(this,i),this.Le=n+"main",this.R=new ps(u),this.Be=new es(this.Le,11,new au(this.R)),this.qe=new Bs(this.referenceDelegate,this.R),this.Ut=new Ns,this.Ue=function(t,e){return new eu(t,e)}(this.R,this.Ut),this.Qe=new Os,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===l&&dr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new cr(ur.FAILED_PRECONDITION,uu);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new sr(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(ar.__awaiter)(e,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return Object(ar.__awaiter)(e,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return Object(ar.__awaiter)(e,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return hu(e).put(new Ga(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(is(e))return fr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return fr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return lu(t).get(xa.key).next((function(t){return Za.resolve(e.tn(t))}))},t.prototype.en=function(t){return hu(t).delete(this.clientId)},t.prototype.nn=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r=this;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.$e,18e5)?[3,2]:(this.$e=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=ls(t,Ga.store);return e.Nt().next((function(t){var n=r.rn(t,18e5),i=t.filter((function(t){return-1===n.indexOf(t)}));return Za.forEach(i,(function(t){return e.delete(t.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}))]);case 1:if(t=i.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)this.Ke.removeItem(this.on(n[e].clientId));i.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.Oe=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Za.resolve(!0):lu(t).get(xa.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new cr(ur.FAILED_PRECONDITION,uu);return!1}}return!(!e.networkEnabled||!e.inForeground)||hu(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))}))}))})).next((function(t){return e.isPrimary!==t&&fr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.an(),this.Oe&&(this.Oe.cancel(),this.Oe=null),this.un(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[xa.store,Ga.store],(function(e){var n=new cs(e,sr.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return hu(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Ls.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r,i=this;return fr("IndexedDbPersistence","Starting transaction:",t),this.Be.runTransaction(t,"readonly"===e?"readonly":"readwrite",Ya,(function(o){return r=new cs(o,i.Ne?i.Ne.next():sr.o),"readwrite-primary"===e?i.Je(r).next((function(t){return!!t||i.Ye(r)})).next((function(e){if(!e)throw dr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable((function(){return i.Me(!1)})),new cr(ur.FAILED_PRECONDITION,Xa);return n(r)})).next((function(t){return i.Ze(r).next((function(){return t}))})):i.dn(r).next((function(){return n(r)}))})).then((function(t){return r.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return lu(t).get(xa.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new cr(ur.FAILED_PRECONDITION,uu)}))},t.prototype.Ze=function(t){var e=new xa(this.clientId,this.allowTabSynchronization,Date.now());return lu(t).put(xa.key,e)},t.yt=function(){return es.yt()},t.prototype.Xe=function(t){var e=this,n=lu(t);return n.get(xa.key).next((function(t){return e.tn(t)?(fr("IndexedDbPersistence","Releasing primary lease."),n.delete(xa.key)):Za.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(dr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.un=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.an(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return fr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return dr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.an=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){dr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function lu(t){return ls(t,xa.store)}function hu(t){return ls(t,Ga.store)}function fu(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var du=function(t,e){this.progress=t,this.wn=e},pu=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Wr.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Ri(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Wr(e)).next((function(t){var e=Do();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Do();return this.Ut.getCollectionParents(t,i).next((function(a){return Za.forEach(a,(function(a){var s=function(t,e){return new Si(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,a.child(i));return r.An(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return o.Rn(t,i=e,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c);null==l&&(l=oi.newInvalidDocument(c),r=r.insert(c,l)),lo(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){qi(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=Uo(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof go&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),vu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Uo(),i=Uo(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),gu=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Or.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(a){var s=i.Cn(e,a);return(Ai(e)||Ni(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(hr()<=o.LogLevel.DEBUG&&fr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ui(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new No(Vi(t));return e.forEach((function(e,r){qi(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return hr()<=o.LogLevel.DEBUG&&fr("QueryEngine","Using full collection scan to execute query:",Ui(e)),this.Sn.getDocumentsMatchingQuery(t,e,Or.min())},t}(),yu=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new Co(wr),this.kn=new Zs((function(t){return ui(t)}),ci),this.On=Or.min(),this._n=t.getMutationQueue(n),this.$n=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new pu(this.$n,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();function mu(t,e,n,r){return new yu(t,e,n,r)}function _u(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:return n=mr(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(a){return o=a,r=n.persistence.getMutationQueue(e),i=new pu(n.$n,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],a=Uo(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++)a=a.add(h[l].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var v=0,g=p.mutations;v<g.length;v++)a=a.add(g[v].key)}return i.pn(t,a).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=a.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function bu(t,e){var n=mr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.$n.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=Za.resolve();return o.forEach((function(t){a=a.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);yr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),a.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function wu(t){var e=mr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Iu(t,e){var n=mr(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.$n.newChangeBuffer({trackRemovals:!0});i=n.Fn;var a=[];e.targetChanges.forEach((function(e,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return yr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,e)&&a.push(n.qe.updateTargetData(t,c))}}}));var s=Ro();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),a.push(Tu(t,o,e.documentUpdates,r,void 0).next((function(t){s=t}))),!r.isEqual(Or.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));a.push(u)}return Za.waitFor(a).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,s)})).next((function(){return s}))})).then((function(t){return n.Fn=i,t}))}function Tu(t,e,n,r,i){var o=Uo();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Ro();return n.forEach((function(n,a){var s=t.get(n),u=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(Or.min())?(e.removeEntry(n,u),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(e.addEntry(a,u),o=o.insert(n,a)):fr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),o}))}function Eu(t,e){var n=mr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Ou(t,e){var n=mr(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?Za.resolve(r=i):n.qe.allocateTargetId(t).next((function(i){return r=new ds(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function Su(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:r=mr(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!is(a=s.sent()))throw a;return fr("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function Cu(t,e,n){var r=mr(t),i=Or.min(),o=Uo();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=mr(t),i=r.kn.get(n);return void 0!==i?Za.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,Di(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:Or.min(),n?o:Uo())})).next((function(t){return{documents:t,Bn:o}}))}))}function ku(t,e){var n=mr(t),r=mr(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Au(t){var e=mr(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=mr(t),i=Ro(),o=ys(n),a=iu(e),s=IDBKeyRange.lowerBound(o,!0);return a.Ot({index:qa.readTimeIndex,range:s},(function(t,e){var n=vs(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:ms(o)}}))}(e.$n,t,e.On)})).then((function(t){var n=t.wn;return e.On=t.readTime,n}))}function Nu(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){return[2,(e=mr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=iu(t),n=Or.min();return e.Ot({index:qa.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=ms(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.On=t}))]}))}))}function Pu(t,e,n,r){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u,c,l,h,f,d;return Object(ar.__generator)(this,(function(p){switch(p.label){case 0:for(i=mr(t),o=Uo(),a=Ro(),s=Mo(),u=0,c=n;u<c.length;u++)h=e.qn((l=c[u]).metadata.name),l.document&&(o=o.add(h)),a=a.insert(h,e.Un(l)),s=s.insert(h,e.Qn(l.metadata.readTime));return f=i.$n.newChangeBuffer({trackRemovals:!0}),[4,Ou(i,function(t){return Di(ki(Nr.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return Tu(t,f,a,Or.min(),s).next((function(e){return f.apply(t),e})).next((function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next((function(){return i.qe.addMatchingKeys(t,o,d.targetId)})).next((function(){return i.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function ju(t,e,n){return void 0===n&&(n=Uo()),Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return[4,Ou(t,Di(Es(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=mr(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=ra(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(t,e);var a=r.withResumeToken(xr.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(a.targetId,a),i.qe.updateTargetData(t,a).next((function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.Qe.saveNamedQuery(t,e)}))}))]}}))}))}var Ru=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Za.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:ra(n.createTime)}),Za.resolve()},t.prototype.getNamedQuery=function(t,e){return Za.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Es(t.bundledQuery),readTime:ra(t.readTime)}}(e)),Za.resolve()},t}(),xu=function(){function t(){this.Wn=new No(Du.Gn),this.zn=new No(Du.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Du(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Du(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Wr(new Nr([])),r=new Du(n,t),i=new Du(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Wr(new Nr([])),n=new Du(e,t),r=new Du(e,t+1),i=Uo();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Du(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Du=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Wr.comparator(t.key,e.key)||wr(t.ns,e.ns)},t.Hn=function(t,e){return wr(t.ns,e.ns)||Wr.comparator(t.key,e.key)},t}(),Lu=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new No(Du.Gn)}return t.prototype.checkEmpty=function(t){return Za.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++;var o=new hs(i,e,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.rs=this.rs.add(new Du(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Za.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Za.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=n<0?0:n;return Za.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Za.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Za.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Du(e,0),i=new Du(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Za.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new No(wr);return e.forEach((function(t){var e=new Du(t,0),i=new Du(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Za.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Wr.isDocumentKey(i)||(i=i.child(""));var o=new Du(new Wr(i),0),a=new No(wr);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.ns)),!0)}),o),Za.resolve(this.us(a))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;yr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Za.forEach(e.mutations,(function(i){var o=new Du(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Du(e,0),r=this.rs.firstAfterOrEqual(n);return Za.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return Za.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Mu=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Co(Wr.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Za.resolve(n?n.document.clone():oi.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Ro();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():oi.newInvalidDocument(t))})),Za.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Ro(),i=new Wr(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.value,u=s.document,c=s.readTime;if(!e.path.isPrefixOf(a.key.path))break;c.compareTo(n)<=0||qi(e,u)&&(r=r.insert(u.key,u.clone()))}return Za.resolve(r)},t.prototype.fs=function(t,e){return Za.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new Fu(this)},t.prototype.getSize=function(t){return Za.resolve(this.size)},t}(),Fu=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(ar.__extends)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Za.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(tu),Uu=function(){function t(t){this.persistence=t,this.ds=new Zs((function(t){return ui(t)}),ci),this.lastRemoteSnapshotVersion=Or.min(),this.highestTargetId=0,this.ws=0,this._s=new xu,this.targetCount=0,this.ys=Vs.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Za.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Za.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Za.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Za.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Za.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Vs(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Za.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Za.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Za.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),Za.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Za.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Za.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Za.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Za.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Za.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Za.resolve(n)},t.prototype.containsKey=function(t,e){return Za.resolve(this._s.containsKey(e))},t}(),qu=function(){function t(t,e){var n=this;this.gs={},this.Ne=new sr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Uu(this),this.Ut=new ks,this.Ue=function(t,e){return new Mu(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new ps(e),this.Qe=new Ru(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Lu(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;fr("MemoryPersistence","Starting transaction:",t);var i=new Vu(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Za.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Vu=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(ar.__extends)(e,t),e}(Ja),Bu=function(){function t(t){this.persistence=t,this.As=new xu,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw gr()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Za.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Za.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Za.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Za.forEach(this.vs,(function(r){var i=Wr.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Za.or([function(){return Za.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Ku=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function Wu(t,e){return"firestore_clients_"+t+"_"+e}function Hu(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Gu(t,e){return"firestore_targets_"+t+"_"+e}Ku.UNAUTHENTICATED=new Ku(null),Ku.GOOGLE_CREDENTIALS=new Ku("google-credentials-uid"),Ku.FIRST_PARTY=new Ku("first-party-uid");var zu=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new cr(o.error.code,o.error.message)),a?new t(e,n,o.state,i):(dr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Qu=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new cr(i.error.code,i.error.message)),o?new t(e,i.state,r):(dr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Yu=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Vo(),a=0;i&&a<r.activeTargetIds.length;++a)i=Kr(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(dr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Xu=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(dr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Ju=function(){function t(){this.activeTargetIds=Vo()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),$u=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new Co(wr),this.started=!1,this.Os=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.$s=Wu(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Ju),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,c,l=this;return Object(ar.__generator)(this,(function(h){switch(h.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=h.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Wu(this.persistenceKey,r)))&&(o=Yu.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(a=this.storage.getItem(this.Us))&&(s=this.js(a))&&this.Ws(s),u=0,c=this.Os;u<c.length;u++)this.Fs(c[u]);return this.Os=[],this.window.addEventListener("pagehide",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Gu(this.persistenceKey,t));if(n){var r=Qu.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Gu(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.$s),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return fr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){fr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){fr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(fr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.$s)return void dr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Object(ar.__awaiter)(e,void 0,void 0,(function(){var t,e,r,i,o,a;return Object(ar.__generator)(this,(function(s){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(a=function(t){var e=sr.o;if(null!=t)try{var n=JSON.parse(t);yr("number"==typeof n),e=n}catch(t){dr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==sr.o&&this.sequenceNumberHandler(a);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.Os.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.$s,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new zu(this.currentUser,t,e,n),i=Hu(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Hu(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:t}))},t.prototype.Ys=function(t,e,n){var r=Gu(this.persistenceKey,t),i=new Qu(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Yu.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]);return zu.Vs(new Ku(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Qu.Vs(r,e)},t.prototype.js=function(t){return Xu.Vs(t)},t.prototype.ii=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ai(t.batchId,t.state,t.error)]:(fr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ui(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),a=[],s=[];return o.forEach((function(t){i.has(t)||a.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.syncEngine.hi(a,s).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Vo();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Zu=function(){function t(){this.li=new Ju,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Ju,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),tc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),ec=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){fr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){fr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),nc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},rc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),ic=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n}return Object(ar.__extends)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var a=new or;a.listenOnce(nr.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case er.NO_ERROR:var e=a.getResponseJson();fr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case er.TIMEOUT:fr("Connection",'RPC "'+t+'" timed out'),o(new cr(ur.DEADLINE_EXCEEDED,"Request time out"));break;case er.HTTP_ERROR:var n=a.getStatus();if(fr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(ur).indexOf(e)>=0?e:ur.UNKNOWN}(r.status);o(new cr(s,r.message))}else o(new cr(ur.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new cr(ur.UNAVAILABLE,"Connection failed."));break;default:gr()}}finally{fr("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);a.send(e,"POST",s,n,15)}))},e.prototype.$i=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Xn,o=$t(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Fi(a.initMessageHeaders,e),Object(i.isMobileCordova)()||Object(i.isReactNative)()||Object(i.isElectron)()||Object(i.isIE)()||Object(i.isUWP)()||Object(i.isBrowserExtension)()||(a.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");fr("Connection","Creating WebChannel: "+s,a);var u=r.createWebChannel(s,a),c=!1,l=!1,h=new rc({Ei:function(t){l?fr("Connection","Not sending because WebChannel is closed:",t):(c||(fr("Connection","Opening WebChannel transport."),u.open(),c=!0),fr("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,ir.EventType.OPEN,(function(){l||fr("Connection","WebChannel transport opened.")})),f(u,ir.EventType.CLOSE,(function(){l||(l=!0,fr("Connection","WebChannel transport closed"),h.Vi())})),f(u,ir.EventType.ERROR,(function(t){l||(l=!0,pr("Connection","WebChannel transport errored:",t),h.Vi(new cr(ur.UNAVAILABLE,"The operation could not be completed")))})),f(u,ir.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];yr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){fr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=bo[t];if(void 0!==e)return So(e)}(i),a=r.message;void 0===o&&(o=ur.INTERNAL,a="Unknown error status: "+i+" with message "+r.message),l=!0,h.Vi(new cr(o,a)),u.close()}else fr("Connection","WebChannel received:",n),h.Si(n)}})),f(o,rr.STAT_EVENT,(function(t){10===t.stat?fr("Connection","Detected buffering proxy"):11===t.stat&&fr("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.Di=(t.ssl?"https":"http")+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);fr("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return fr("RestConnection","Received: ",t),t}),(function(e){throw pr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Oi=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.6.2",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){return this.Di+"/v1/"+e+":"+nc[t]},t}());function oc(){return"undefined"!=typeof window?window:null}function ac(){return"undefined"!=typeof document?document:null}function sc(t){return new Zo(t,!0)}var uc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&fr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Qi=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),cc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new uc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ar(),this.stream.send(t)},t.prototype.rr=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ar=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return this.ar(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===ur.RESOURCE_EXHAUSTED?(dr(e.toString()),dr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===ur.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ur(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ur=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new cr(ur.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return Object(ar.__awaiter)(t,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return fr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(fr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),lc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return Object(ar.__extends)(e,t),e.prototype.wr=function(t){return this.Hi.$i("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:gr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(yr(void 0===e||"string"==typeof e),xr.fromBase64String(e||"")):(yr(void 0===e||e instanceof Uint8Array),xr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?ur.UNKNOWN:So(t.code);return new cr(e,t.message||"")}(s);n=new Go(r,i,o,a||null)}else if("documentChange"in e){i=sa(t,(r=e.documentChange).document.name),o=ra(r.document.updateTime);var s=new ri({mapValue:{fields:r.document.fields}}),u=(a=oi.newFoundDocument(i,o,s),r.targetIds||[]);n=new Wo(u,r.removedTargetIds||[],a.key,a)}else if("documentDelete"in e)i=sa(t,(r=e.documentDelete).document),o=r.readTime?ra(r.readTime):Or.min(),s=oi.newNoDocument(i,o),n=new Wo([],a=r.removedTargetIds||[],s.key,s);else if("documentRemove"in e)i=sa(t,(r=e.documentRemove).document),n=new Wo([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return gr();var c=e.filter;i=new Eo(r=c.count||0),n=new Ho(o=c.targetId,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return Or.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Or.min():e.readTime?ra(e.readTime):Or.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=la(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=li(r)?{documents:ga(t,r)}:{query:ya(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=ea(t,e.resumeToken):e.snapshotVersion.compareTo(Or.min())>0&&(n.readTime=ta(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return gr()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=la(this.R),e.removeTarget=t,this.cr(e)},e}(cc),hc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return Object(ar.__extends)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ur=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.$i("Write",t)},e.prototype.onMessage=function(t){if(yr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(yr(void 0!==e),t.map((function(t){return function(t,e){var n=ra(t.updateTime?t.updateTime:e);return n.isEqual(Or.min())&&(n=ra(e)),new oo(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=ra(t.commitTime);return this.listener.Tr(n,e)}return yr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=la(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return pa(e.R,t)}))};this.cr(n)},e}(cc),fc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(ar.__extends)(e,t),e.prototype.br=function(){if(this.Rr)throw new cr(ur.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===ur.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new cr(ur.UNKNOWN,t.toString())}))},e.prototype.Oi=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Oi(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===ur.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new cr(ur.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),dc=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(dr(e),this.Vr=!1):fr("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),pc=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.Or=new Map,this.$r=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return Object(ar.__awaiter)(o,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){switch(t.label){case 0:return Tc(this)?(fr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return(e=mr(t)).$r.add(4),[4,gc(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.$r.delete(4),[4,vc(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new dc(n,r)};function vc(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:if(!Tc(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function gc(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function yc(t,e){var n=mr(t);n.Or.has(e.targetId)||(n.Or.set(e.targetId,e),Ic(n)?wc(n):Fc(n).er()&&_c(n,e))}function mc(t,e){var n=mr(t),r=Fc(n);n.Or.delete(e),r.er()&&bc(n,e),0===n.Or.size&&(r.er()?r.ir():Tc(n)&&n.Br.set("Unknown"))}function _c(t,e){t.qr.U(e.targetId),Fc(t).mr(e)}function bc(t,e){t.qr.U(e),Fc(t).yr(e)}function wc(t){t.qr=new Qo({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.Or.get(e)||null}}),Fc(t).start(),t.Br.Sr()}function Ic(t){return Tc(t)&&!Fc(t).tr()&&t.Or.size>0}function Tc(t){return 0===mr(t).$r.size}function Ec(t){t.qr=void 0}function Oc(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){return t.Or.forEach((function(e,n){_c(t,e)})),[2]}))}))}function Sc(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(n){return Ec(t),Ic(t)?(t.Br.Nr(e),wc(t)):t.Br.set("Unknown"),[2]}))}))}function Cc(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:if(t.Br.set("Online"),!(e instanceof Go&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:n=e.cause,r=0,i=e.targetIds,a.label=1;case 1:return r<i.length?t.Or.has(o=i[r])?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:a.sent(),t.Or.delete(o),t.qr.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),fr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,kc(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Wo?t.qr.X(e):e instanceof Ho?t.qr.rt(e):t.qr.et(e),n.isEqual(Or.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,wu(t.localStore)];case 8:return i=a.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.at(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.Or.get(r);i&&t.Or.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.Or.get(e);if(n){t.Or.set(e,n.withResumeToken(xr.EMPTY_BYTE_STRING,n.snapshotVersion)),bc(t,e);var r=new ds(n.target,e,1,n.sequenceNumber);_c(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return fr("RemoteStore","Failed to raise snapshot:",o=a.sent()),[4,kc(t,o)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function kc(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r=this;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:if(!is(e))throw e;return t.$r.add(1),[4,gc(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return wu(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return Object(ar.__awaiter)(r,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return fr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.$r.delete(1),[4,vc(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Ac(t,e){return e().catch((function(n){return kc(t,n,e)}))}function Nc(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:e=mr(t),n=Uc(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,a.label=1;case 1:if(!function(t){return Tc(t)&&t.kr.length<10}(e))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,Eu(e.localStore,r)];case 3:return null===(i=a.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Uc(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=a.sent(),[4,kc(e,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return Pc(e)&&jc(e),[2]}}))}))}function Pc(t){return Tc(t)&&!Uc(t).tr()&&t.kr.length>0}function jc(t){Uc(t).start()}function Rc(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){return Uc(t).Ar(),[2]}))}))}function xc(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(ar.__generator)(this,(function(i){for(e=Uc(t),n=0,r=t.kr;n<r.length;n++)e.Er(r[n].mutations);return[2]}))}))}function Dc(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=fs.from(r,e,n),[4,Ac(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,Nc(t)];case 2:return o.sent(),[2]}}))}))}function Lc(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return e&&Uc(t).pr?[4,function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return Oo(r=e.code)&&r!==ur.ABORTED?(n=t.kr.shift(),Uc(t).sr(),[4,Ac(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Nc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Pc(t)&&jc(t),[2]}}))}))}function Mc(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return n=mr(t),e?(n.$r.delete(2),[4,vc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.$r.add(2),[4,gc(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Fc(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=mr(t);return r.br(),new lc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Oc.bind(null,t),Ri:Sc.bind(null,t),_r:Cc.bind(null,t)}),t.Mr.push((function(n){return Object(ar.__awaiter)(e,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Ic(t)?wc(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Ec(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function Uc(t){var e=this;return t.Qr||(t.Qr=function(t,e,n){var r=mr(t);return r.br(),new hc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Rc.bind(null,t),Ri:Lc.bind(null,t),Ir:xc.bind(null,t),Tr:Dc.bind(null,t)}),t.Mr.push((function(n){return Object(ar.__awaiter)(e,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return n?(t.Qr.sr(),[4,Nc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:e.sent(),t.kr.length>0&&(fr("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Qr}var qc=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new $a,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new cr(ur.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Vc(t,e){if(dr("AsyncQueue",e+": "+t),is(t))return new cr(ur.UNAVAILABLE,e+": "+t);throw t}var Bc=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Wr.comparator(e.key,n.key)}:function(t,e){return Wr.comparator(t.key,e.key)},this.keyedMap=Do(),this.sortedSet=new Co(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Kc=function(){function t(){this.Kr=new Co(Wr.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):gr():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Wc=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Bc.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Mi(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Hc=function(){this.Wr=void 0,this.listeners=[]},Gc=function(){this.queries=new Zs((function(t){return Fi(t)}),Mi),this.onlineState="Unknown",this.Gr=new Set};function zc(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return Object(ar.__generator)(this,(function(c){switch(c.label){case 0:if(n=mr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Hc),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),a=o,[4,n.onListen(r)];case 2:return a.Wr=c.sent(),[3,4];case 3:return s=c.sent(),u=Vc(s,"Initialization of query '"+Ui(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Jc(n),[2]}}))}))}function Qc(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(ar.__generator)(this,(function(s){return n=mr(t),i=!1,(o=n.queries.get(r=e.query))&&(a=o.listeners.indexOf(e))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Yc(t,e){for(var n=mr(t),r=!1,i=0,o=e;i<o.length;i++){var a=o[i],s=n.queries.get(a.query);if(s){for(var u=0,c=s.listeners;u<c.length;u++)c[u].Hr(a)&&(r=!0);s.Wr=a}}r&&Jc(n)}function Xc(t,e,n){var r=mr(t),i=r.queries.get(e);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(e)}function Jc(t){t.Gr.forEach((function(t){t.next()}))}var $c=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Wc(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Wc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Zc=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),tl=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return sa(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?da(this.R,t.document,!1):oi.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime))},t.prototype.Qn=function(t){return ra(t)},t}(),el=function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=nl(t)}return t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new tl(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var a=n.qn(o.metadata.name),s=0,u=o.metadata.queries;s<u.length;s++){var c=u[s],l=(e.get(c)||Uo()).add(a);e.set(c,l)}}return e},t.prototype.complete=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return[4,Pu(this.localStore,new tl(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,ju(this.localStore,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new du(Object.assign({},this.progress),t))]}}))}))},t}();function nl(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var rl=function(t){this.key=t},il=function(t){this.key=t},ol=function(){function t(t,e){this.query=t,this.ao=e,this.uo=null,this.current=!1,this.ho=Uo(),this.mutatedKeys=Uo(),this.lo=Vi(t),this.fo=new Bc(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.ao},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Kc,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=Ai(this.query)&&i.size===this.query.limit?i.last():null,c=Ni(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=qi(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.yo(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(a=a.add(h),o=d?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),Ai(this.query)||Ni(this.query))for(;a.size>this.query.limit;){var l=Ai(this.query)?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return gr()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var a=e?this.Eo():[],s=0===this.ho.size&&this.current?1:0,u=s!==this.uo;return this.uo=s,0!==o.length||u?{snapshot:new Wc(this.query,t.fo,i,o,t.mutatedKeys,0===s,u,!1),To:a}:{To:a}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Kc,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.ao.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.ao=e.ao.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.ao=e.ao.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Uo(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new il(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new rl(t))})),n},t.prototype.Ao=function(t){this.ao=t.Bn,this.ho=Uo();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Wc.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.uo)},t}(),al=function(t,e,n){this.query=t,this.targetId=e,this.view=n},sl=function(t){this.key=t,this.bo=!1},ul=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Zs((function(t){return Fi(t)}),Mi),this.Vo=new Map,this.So=new Set,this.Do=new Co(Wr.comparator),this.Co=new Map,this.No=new xu,this.xo={},this.Fo=new Map,this.ko=Vs.Yt(),this.onlineState="Unknown",this.Oo=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.Oo},enumerable:!1,configurable:!0}),t}();function cl(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return n=Fl(t),(i=n.Po.get(e))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,Ou(n.localStore,Di(e))];case 2:return o=s.sent(),a=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,ll(n,e,o.targetId,"current"===a)];case 3:r=s.sent(),n.isPrimaryClient&&yc(n.remoteStore,o),s.label=4;case 4:return[2,r]}}))}))}function ll(t,e,n,r){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u,c;return Object(ar.__generator)(this,(function(l){switch(l.label){case 0:return t.$o=function(e,n,r){return function(t,e,n,r){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return(i=e.view._o(n)).Nn?[4,Cu(t.localStore,e.query,!1).then((function(t){return e.view._o(t.documents,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Tl(t,e.targetId,a.To),a.snapshot)]}}))}))}(t,e,n,r)},[4,Cu(t.localStore,e,!0)];case 1:return i=l.sent(),o=new ol(e,i.Bn),a=o._o(i.documents),s=Ko.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(a,t.isPrimaryClient,s),Tl(t,n,u.To),c=new al(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function hl(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return n=mr(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Mi(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Su(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),mc(n.remoteStore,r.targetId),wl(n,r.targetId)})).catch(Gs)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return wl(n,r.targetId),[4,Su(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function fl(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:r=Ul(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=mr(t),i=Er.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Uo());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],l=ho(c,n.get(c.key));null!=l&&a.push(new go(c.key,l,ii(l.toProto().mapValue),ao.exists(!0)))}return r._n.addMutationBatch(t,i,a,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=s.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Co(wr)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Sl(r,i.changes)];case 3:return s.sent(),[4,Nc(r.remoteStore)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=Vc(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}function dl(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:n=mr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Iu(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(yr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?yr(r.bo):t.removedDocuments.size>0&&(yr(r.bo),r.bo=!1))})),[4,Sl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Gs(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function pl(t,e,n){var r=mr(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=mr(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&Jc(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function vl(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u;return Object(ar.__generator)(this,(function(c){switch(c.label){case 0:return(r=mr(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(a=(a=new Co(Wr.comparator)).insert(o,oi.newNoDocument(o,Or.min())),s=Uo().add(o),u=new Bo(Or.min(),new Map,new No(wr),a,s),[4,dl(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Ol(r),[3,4];case 2:return[4,Su(r.localStore,e,!1).then((function(){return wl(r,e,n)})).catch(Gs)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function gl(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:n=mr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,bu(n.localStore,e)];case 2:return i=o.sent(),bl(n,r,null),_l(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Sl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Gs(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function yl(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:r=mr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=mr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return yr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),bl(r,e,n),_l(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Sl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Gs(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function ml(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:Tc((n=mr(t)).remoteStore)||fr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=mr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=s.sent(),a=Vc(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}function _l(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function bl(t,e,n){var r=mr(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function wl(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Il(t,e)}))}function Il(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(mc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Ol(t))}function Tl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof rl?(t.No.addReference(o.key,e),El(t,o)):o instanceof il?(fr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Il(t,o.key)):gr()}}function El(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(fr("SyncEngine","New document in limbo: "+n),t.So.add(r),Ol(t))}function Ol(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Wr(Nr.fromString(e)),r=t.ko.next();t.Co.set(r,new sl(n)),t.Do=t.Do.insert(n,r),yc(t.remoteStore,new ds(Di(ki(n.path)),r,2,sr.o))}}function Sl(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return r=mr(t),i=[],o=[],a=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,s){a.push(r.$o(s,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=vu.Pn(s.targetId,t);o.push(e)}})))})),[4,Promise.all(a)]);case 1:return s.sent(),r.vo._r(i),[4,function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c;return Object(ar.__generator)(this,(function(l){switch(l.label){case 0:n=mr(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Za.forEach(e,(function(e){return Za.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Za.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!is(r=l.sent()))throw r;return fr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=(a=o[i]).targetId,a.fromCache||(u=n.Fn.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),n.Fn=n.Fn.insert(s,c));return[2]}}))}))}(r.localStore,o)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function Cl(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return(n=mr(t)).currentUser.isEqual(e)?[3,3]:(fr("SyncEngine","User change. New user:",e.toKey()),[4,_u(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new cr(ur.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Sl(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function kl(t,e){var n=mr(t),r=n.Co.get(e);if(r&&r.bo)return Uo().add(r.key);var i=Uo(),o=n.Vo.get(e);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=n.Po.get(s[a]);i=i.unionWith(u.view.wo)}return i}function Al(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return[4,Cu((n=mr(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&Tl(n,e.targetId,i.To),i)]}}))}))}function Nl(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){return[2,Au((e=mr(t)).localStore).then((function(t){return Sl(e,t)}))]}))}))}function Pl(t,e,n,r){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:return[4,function(t,e){var n=mr(t),r=mr(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):Za.resolve(null)}))}))}((i=mr(t)).localStore,e)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,Nc(i.remoteStore)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(bl(i,e,r||null),_l(i,e),function(t,e){mr(mr(t)._n).Gt(e)}(i.localStore,e)):gr(),a.label=4;case 4:return[4,Sl(i,o)];case 5:return a.sent(),[3,7];case 6:fr("SyncEngine","Cannot apply mutation batch with id: "+e),a.label=7;case 7:return[2]}}))}))}function jl(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return Object(ar.__generator)(this,(function(c){switch(c.label){case 0:return Fl(n=mr(t)),Ul(n),!0!==e||!0===n.Oo?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Rl(n,r.toArray())]);case 1:return i=c.sent(),n.Oo=!0,[4,Mc(n.remoteStore,!0)];case 2:for(c.sent(),o=0,a=i;o<a.length;o++)yc(n.remoteStore,a[o]);return[3,7];case 3:return!1!==e||!1===n.Oo?[3,7]:(s=[],u=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?s.push(e):u=u.then((function(){return wl(n,e),Su(n.localStore,e,!0)})),mc(n.remoteStore,e)})),[4,u]);case 4:return c.sent(),[4,Rl(n,s)];case 5:return c.sent(),function(t){var e=mr(t);e.Co.forEach((function(t,n){mc(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new Co(Wr.comparator)}(n),n.Oo=!1,[4,Mc(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}}))}))}function Rl(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,d,p;return Object(ar.__generator)(this,(function(v){switch(v.label){case 0:n=mr(t),r=[],i=[],o=0,a=e,v.label=1;case 1:return o<a.length?(u=void 0,(c=n.Vo.get(s=a[o]))&&0!==c.length?[4,Ou(n.localStore,Di(c[0]))]:[3,7]):[3,13];case 2:u=v.sent(),l=0,h=c,v.label=3;case 3:return l<h.length?(f=n.Po.get(h[l]),[4,Al(n,f)]):[3,6];case 4:(d=v.sent()).snapshot&&i.push(d.snapshot),v.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,ku(n.localStore,s)];case 8:return p=v.sent(),[4,Ou(n.localStore,p)];case 9:return u=v.sent(),[4,ll(n,xl(p),s,!1)];case 10:v.sent(),v.label=11;case 11:r.push(u),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function xl(t){return Ci(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Dl(t){var e=mr(t);return mr(mr(e.localStore).persistence).fn()}function Ll(t,e,n,r){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return(i=mr(t)).Oo?(fr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Au(i.localStore)];case 3:return o=s.sent(),a=Bo.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Sl(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,Su(i.localStore,e,!0)];case 6:return s.sent(),wl(i,e,r),[3,8];case 7:gr(),s.label=8;case 8:return[2]}}))}))}function Ml(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h;return Object(ar.__generator)(this,(function(f){switch(f.label){case 0:if(!(r=Fl(t)).Oo)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.Vo.has(a=o[i])?(fr("SyncEngine","Adding an already active target "+a),[3,5]):[4,ku(r.localStore,a)]:[3,6];case 2:return s=f.sent(),[4,Ou(r.localStore,s)];case 3:return u=f.sent(),[4,ll(r,xl(s),u.targetId,!1)];case 4:f.sent(),yc(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Su(r.localStore,t,!1).then((function(){mc(r.remoteStore,t),wl(r,t)})).catch(Gs)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,h=n,f.label=7;case 7:return l<h.length?[5,c(h[l])]:[3,10];case 8:f.sent(),f.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Fl(t){var e=mr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=dl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vl.bind(null,e),e.vo._r=Yc.bind(null,e.eventManager),e.vo.Mo=Xc.bind(null,e.eventManager),e}function Ul(t){var e=mr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=yl.bind(null,e),e}function ql(t,e,n){var r=mr(t);(function(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u;return Object(ar.__generator)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=c.sent(),[4,function(t,e){var n=mr(t),r=ra(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.Qe.getBundleMetadata(t,e.id)})).then((function(t){return!!t&&t.createTime.compareTo(r)>=0}))}(t.localStore,r)];case 2:return c.sent()?[4,e.close()]:[3,4];case 3:return[2,(c.sent(),void n._completeWith(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n._updateProgress(nl(r)),i=new el(r,t.localStore,e.R),[4,e.Lo()];case 5:o=c.sent(),c.label=6;case 6:return o?[4,i.oo(o)]:[3,10];case 7:return(a=c.sent())&&n._updateProgress(a),[4,e.Lo()];case 8:o=c.sent(),c.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return s=c.sent(),[4,Sl(t,s.wn,void 0)];case 12:return c.sent(),[4,function(t,e){var n=mr(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.Qe.saveBundleMetadata(t,e)}))}(t.localStore,r)];case 13:return c.sent(),n._completeWith(s.progress),[3,15];case 14:return pr("SyncEngine","Loading bundle failed with "+(u=c.sent())),n._failWith(u),[3,15];case 15:return[2]}}))}))})(r,e,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var Vl=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return this.R=sc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return mu(this.persistence,new gu,t.initialUser,this.R)},t.prototype.qo=function(t){return new qu(Bu.bs,this.R)},t.prototype.Bo=function(t){return new Zu},t.prototype.terminate=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Bl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(ar.__extends)(e,t),e.prototype.initialize=function(e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Nu(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,Ul(this.Ko.syncEngine)];case 4:return n.sent(),[4,Nc(this.Ko.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Qo=function(t){return mu(this.persistence,new gu,t.initialUser,this.R)},e.prototype.Uo=function(t){return new Ys(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue)},e.prototype.qo=function(t){var e=fu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Rs.withCacheSize(this.cacheSizeBytes):Rs.DEFAULT;return new cu(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,oc(),ac(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Zu},e}(Vl),Kl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(ar.__extends)(e,t),e.prototype.initialize=function(e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof $u?(this.sharedClientState.syncEngine={ai:Pl.bind(null,n),ui:Ll.bind(null,n),hi:Ml.bind(null,n),fn:Dl.bind(null,n),ci:Nl.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return Object(ar.__awaiter)(r,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return[4,jl(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=oc();if(!$u.yt(e))throw new cr(ur.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=fu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new $u(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Bl),Wl=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n=this;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return pl(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Cl.bind(null,this.syncEngine),[4,Mc(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Gc},t.prototype.createDatastore=function(t){var e=sc(t.databaseInfo.databaseId),n=new ic(t.databaseInfo);return function(t,e,n){return new fc(t,e,n)}(t.credentials,n,e)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,a=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return pl(a.syncEngine,t,0)},o=ec.yt()?new ec:new tc,new pc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,a){var s=new ul(t,e,n,r,i,o);return a&&(s.Oo=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return e=mr(t),fr("RemoteStore","RemoteStore shutting down."),e.$r.add(5),[4,gc(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}();function Hl(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r;return Object(ar.__generator)(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var Gl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),zl=function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new $a,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Zc(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.Jo=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),Ql=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new cr(ur.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Object(ar.__generator)(this,(function(u){switch(u.label){case 0:return n=mr(t),r=la(n.R)+"/documents",i={documents:e.map((function(t){return aa(n.R,t)}))},[4,n.Oi("BatchGetDocuments",r,i)];case 1:return o=u.sent(),a=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){yr(!!e.found);var n=sa(t,e.found.name),r=ra(e.found.updateTime),i=new ri({mapValue:{fields:e.found.fields}});return oi.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){yr(!!e.missing),yr(!!e.readTime);var n=sa(t,e.missing),r=ra(e.readTime);return oi.newNoDocument(n,r)}(t,e):gr()}(n.R,t);a.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=a.get(t.toString());yr(!!e),s.push(e)})),s)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Io(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Wr.fromPath(n);e.mutations.push(new To(r,e.precondition(r)))})),[4,function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return n=mr(t),r=la(n.R)+"/documents",i={writes:e.map((function(t){return pa(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw gr();e=Or.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new cr(ur.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?ao.updateTime(e):ao.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Or.min()))throw new cr(ur.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ao.updateTime(e)}return ao.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),Yl=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new uc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return Object(ar.__awaiter)(t,void 0,void 0,(function(){var t,e,n=this;return Object(ar.__generator)(this,(function(r){return t=new Ql(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Vr(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Oo(e)}return!1},t}(),Xl=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Ku.UNAUTHENTICATED,this.clientId=br.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return Object(ar.__awaiter)(r,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return fr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new cr(ur.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new $a;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Object(ar.__awaiter)(t,void 0,void 0,(function(){var t,n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Vc(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function Jl(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i=this;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),fr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return Object(ar.__awaiter)(i,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,_u(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function $l(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Zl(t)];case 1:return n=i.sent(),fr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return(n=mr(t)).asyncQueue.verifyOperationInProgress(),fr("RemoteStore","RemoteStore received new credentials"),r=Tc(n),n.$r.add(3),[4,gc(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.$r.delete(3),[4,vc(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Zl(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(fr("FirestoreClient","Using default OfflineComponentProvider"),[4,Jl(t,new Vl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function th(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(fr("FirestoreClient","Using default OnlineComponentProvider"),[4,$l(t,new Wl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function eh(t){return Zl(t).then((function(t){return t.persistence}))}function nh(t){return Zl(t).then((function(t){return t.localStore}))}function rh(t){return th(t).then((function(t){return t.remoteStore}))}function ih(t){return th(t).then((function(t){return t.syncEngine}))}function oh(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,th(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=cl.bind(null,e.syncEngine),n.onUnlisten=hl.bind(null,e.syncEngine),n)]}}))}))}function ah(t,e,n){var r=this;void 0===n&&(n={});var i=new $a;return t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(r,void 0,void 0,(function(){var r;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Gl({next:function(o){e.enqueueAndForget((function(){return Qc(t,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new cr(ur.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new cr(ur.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),a=new $c(ki(n.path),o,{includeMetadataChanges:!0,so:!0});return zc(t,a)},[4,oh(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function sh(t,e,n){var r=this;void 0===n&&(n={});var i=new $a;return t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(r,void 0,void 0,(function(){var r;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Gl({next:function(n){e.enqueueAndForget((function(){return Qc(t,a)})),n.fromCache&&"server"===r.source?i.reject(new cr(ur.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),a=new $c(n,o,{includeMetadataChanges:!0,so:!0});return zc(t,a)},[4,oh(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var uh=function(t,e,n,r,i,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a},ch=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),lh=new Map,hh=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},fh=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(Ku.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),dh=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),ph=function(){function t(t){var e=this;this.currentUser=Ku.UNAUTHENTICATED,this.oc=new $a,this.cc=0,this.changeListener=function(){return Promise.resolve()},this.ac=!1,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.hc(),e.oc.resolve(),e.ac&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){fr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.lc(),e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):e.ac&&(fr("FirebaseCredentialsProvider","Auth not yet detected"),e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)})))}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(fr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(yr("string"==typeof n.accessToken),new hh(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){this.ac=!0,this.asyncQueue=t,this.changeListener=e},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.hc=function(){var t=this.auth&&this.auth.getUid();return yr(null===t||"string"==typeof t),new Ku(t)},t.prototype.lc=function(){var t=this;this.ac&&(this.ac=!1,this.asyncQueue.enqueueRetryable((function(){return Object(ar.__awaiter)(t,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,this.changeListener(this.currentUser)];case 2:return t.sent(),this.ac=!0,[2]}}))}))})))},t}(),vh=function(){function t(t,e,n){this.fc=t,this.dc=e,this.wc=n,this.type="FirstParty",this.user=Ku.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.dc},e=this.fc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.wc&&(t["X-Goog-Iam-Authorization-Token"]=this.wc),t},enumerable:!1,configurable:!0}),t}(),gh=function(){function t(t,e,n){this.fc=t,this.dc=e,this.wc=n}return t.prototype.getToken=function(){return Promise.resolve(new vh(this.fc,this.dc,this.wc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(Ku.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function yh(t,e,n){if(!n)throw new cr(ur.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function mh(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new cr(ur.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function _h(t,e,n,r){if(!0===e&&!0===r)throw new cr(ur.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function bh(t){if(!Wr.isDocumentKey(t))throw new cr(ur.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function wh(t){if(Wr.isDocumentKey(t))throw new cr(ur.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Ih(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":gr()}function Th(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new cr(ur.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Ih(t);throw new cr(ur.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Eh(t,e){if(e<=0)throw new cr(ur.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Oh=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new cr(ur.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new cr(ur.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,_h("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Sh=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Oh({}),this._settingsFrozen=!1,t instanceof ch?(this._databaseId=t,this._credentials=new fh):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new cr(ur.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ch(t.options.projectId)}(t),this._credentials=new ph(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new cr(ur.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new cr(ur.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Oh(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new fh;switch(t.type){case"gapi":var e=t.client;return yr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new gh(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new cr(ur.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=lh.get(this))&&(fr("ComponentProvider","Removing Datastore"),lh.delete(this),t.terminate()),Promise.resolve();var t},t}(),Ch=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ah(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),kh=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Ah=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ki(r))||this)._path=r,i.type="collection",i}return Object(ar.__extends)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Ch(this.firestore,null,new Wr(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(kh);function Nh(t,e){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t=Object(i.getModularInstance)(t),yh("collection","path",e),t instanceof Sh)return wh(n=Nr.fromString.apply(Nr,Object(ar.__spreadArray)([e],r))),new Ah(t,null,n);if(!(t instanceof Ch||t instanceof Ah))throw new cr(ur.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return wh(n=Nr.fromString.apply(Nr,Object(ar.__spreadArray)([t.path],r)).child(Nr.fromString(e))),new Ah(t.firestore,null,n)}function Ph(t,e){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t=Object(i.getModularInstance)(t),1===arguments.length&&(e=br.u()),yh("doc","path",e),t instanceof Sh)return bh(n=Nr.fromString.apply(Nr,Object(ar.__spreadArray)([e],r))),new Ch(t,null,new Wr(n));if(!(t instanceof Ch||t instanceof Ah))throw new cr(ur.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return bh(n=t._path.child(Nr.fromString.apply(Nr,Object(ar.__spreadArray)([e],r)))),new Ch(t.firestore,t instanceof Ah?t.converter:null,new Wr(n))}function jh(t,e){return t=Object(i.getModularInstance)(t),e=Object(i.getModularInstance)(e),(t instanceof Ch||t instanceof Ah)&&(e instanceof Ch||e instanceof Ah)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Rh(t,e){return t=Object(i.getModularInstance)(t),e=Object(i.getModularInstance)(e),t instanceof kh&&e instanceof kh&&t.firestore===e.firestore&&Mi(t._query,e._query)&&t.converter===e.converter}var xh=function(){function t(){var t=this;this._c=Promise.resolve(),this.mc=[],this.yc=!1,this.gc=[],this.Ec=null,this.Tc=!1,this.Ic=[],this.Zi=new uc(this,"async_queue_retry"),this.Ac=function(){var e=ac();e&&fr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=ac();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ac)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this.yc},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Rc(),this.bc(t)},t.prototype.enterRestrictedMode=function(){if(!this.yc){this.yc=!0;var t=ac();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ac)}},t.prototype.enqueue=function(t){return this.Rc(),this.yc?new Promise((function(t){})):this.bc(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.mc.push(t),e.vc()}))},t.prototype.vc=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:if(0===this.mc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.mc[0]()];case 2:return n.sent(),this.mc.shift(),this.Zi.reset(),[3,4];case 3:if(!is(t=n.sent()))throw t;return fr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.mc.length>0&&this.Zi.ji((function(){return e.vc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.bc=function(t){var e=this,n=this._c.then((function(){return e.Tc=!0,t().catch((function(t){throw e.Ec=t,e.Tc=!1,dr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Tc=!1,t}))}));return this._c=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Rc(),this.Ic.indexOf(t)>-1&&(e=0);var i=qc.createAndSchedule(this,t,e,n,(function(t){return r.Pc(t)}));return this.gc.push(i),i},t.prototype.Rc=function(){this.Ec&&gr()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Vc=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t;return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return[4,t=this._c];case 1:e.sent(),e.label=2;case 2:if(t!==this._c)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Sc=function(t){for(var e=0,n=this.gc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Dc=function(t){var e=this;return this.Vc().then((function(){e.gc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.gc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Vc()}))},t.prototype.Cc=function(t){this.Ic.push(t)},t.prototype.Pc=function(t){var e=this.gc.indexOf(t);this.gc.splice(e,1)},t}();function Dh(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Lh=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new $a,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),Mh=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new xh,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Object(ar.__extends)(e,t),e.prototype._terminate=function(){return this._firestoreClient||Uh(this),this._firestoreClient.terminate()},e}(Sh);function Fh(t){return t._firestoreClient||Uh(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Uh(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new uh(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Xl(t._credentials,t._queue,r)}function qh(t,e,n){var r=this,i=new $a;return t.asyncQueue.enqueue((function(){return Object(ar.__awaiter)(r,void 0,void 0,(function(){var r;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Jl(t,n)];case 1:return o.sent(),[4,$l(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===ur.FAILED_PRECONDITION||t.code===ur.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function Vh(t){if(t._initialized||t._terminated)throw new cr(ur.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Bh=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new cr(ur.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jr(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Kh=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(xr.fromBase64String(e))}catch(e){throw new cr(ur.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(xr.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Wh=function(t){this._methodName=t},Hh=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new cr(ur.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new cr(ur.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return wr(this._lat,t._lat)||wr(this._long,t._long)},t}(),Gh=/^__.*__$/,zh=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new go(t,this.data,this.fieldMask,e,this.fieldTransforms):new vo(t,this.data,e,this.fieldTransforms)},t}(),Qh=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new go(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function Yh(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw gr()}}var Xh=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xc",{get:function(){return this.settings.xc},enumerable:!1,configurable:!0}),t.prototype.Fc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Fc({path:n,Oc:!1});return r.$c(t),r},t.prototype.Mc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Fc({path:n,Oc:!1});return r.Nc(),r},t.prototype.Lc=function(t){return this.Fc({path:void 0,Oc:!0})},t.prototype.Bc=function(t){return yf(t,this.settings.methodName,this.settings.qc||!1,this.path,this.settings.Uc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Nc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Bc("Document fields must not be empty");if(Yh(this.xc)&&Gh.test(t))throw this.Bc('Document fields cannot begin and end with "__"')},t}(),Jh=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||sc(t)}return t.prototype.Qc=function(t,e,n,r){return void 0===r&&(r=!1),new Xh({xc:t,methodName:e,Uc:n,path:jr.emptyPath(),Oc:!1,qc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function $h(t){var e=t._freezeSettings(),n=sc(t._databaseId);return new Jh(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Zh(t,e,n,r,i,o){void 0===o&&(o={});var a=t.Qc(o.merge||o.mergeFields?2:0,e,n,i);df("Data must be an object, but it was:",a,r);var s,u,c=hf(r,a);if(o.merge)s=new Rr(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var d=pf(e,f[h],n);if(!a.contains(d))throw new cr(ur.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");mf(l,d)||l.push(d)}s=new Rr(l),u=a.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,u=a.fieldTransforms;return new zh(new ri(c),s,u)}var tf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ar.__extends)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.xc)throw t.Bc(1===t.xc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Wh);function ef(t,e,n){return new Xh({xc:3,Uc:e.settings.Uc,methodName:t._methodName,Oc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var nf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ar.__extends)(e,t),e.prototype._toFieldTransform=function(t){return new io(t.path,new Xi)},e.prototype.isEqual=function(t){return t instanceof e},e}(Wh),rf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Object(ar.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=ef(this,t,!0),n=this.Kc.map((function(t){return lf(t,e)})),r=new Ji(n);return new io(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Wh),of=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Object(ar.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=ef(this,t,!0),n=this.Kc.map((function(t){return lf(t,e)})),r=new Zi(n);return new io(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Wh),af=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).jc=n,r}return Object(ar.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=new eo(t.R,Hi(t.R,this.jc));return new io(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Wh);function sf(t,e,n,r){var o=t.Qc(1,e,n);df("Data must be an object, but it was:",o,r);var a=[],s=ri.empty();Cr(r,(function(t,r){var u=gf(e,t,n);r=Object(i.getModularInstance)(r);var c=o.Mc(u);if(r instanceof tf)a.push(u);else{var l=lf(r,c);null!=l&&(a.push(u),s.set(u,l))}}));var u=new Rr(a);return new Qh(s,u,o.fieldTransforms)}function uf(t,e,n,r,o,a){var s=t.Qc(1,e,n),u=[pf(e,r,n)],c=[o];if(a.length%2!=0)throw new cr(ur.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var l=0;l<a.length;l+=2)u.push(pf(e,a[l])),c.push(a[l+1]);for(var h=[],f=ri.empty(),d=u.length-1;d>=0;--d)if(!mf(h,u[d])){var p=u[d],v=c[d];v=Object(i.getModularInstance)(v);var g=s.Mc(p);if(v instanceof tf)h.push(p);else{var y=lf(v,g);null!=y&&(h.push(p),f.set(p,y))}}var m=new Rr(h);return new Qh(f,m,s.fieldTransforms)}function cf(t,e,n,r){return void 0===r&&(r=!1),lf(n,t.Qc(r?4:3,e))}function lf(t,e){if(ff(t=Object(i.getModularInstance)(t)))return df("Unsupported field value:",e,t),hf(t,e);if(t instanceof Wh)return function(t,e){if(!Yh(e.xc))throw e.Bc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Bc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Oc&&4!==e.xc)throw e.Bc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=lf(o[i],e.Lc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(i.getModularInstance)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Hi(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Er.fromDate(t);return{timestampValue:ta(e.R,n)}}if(t instanceof Er)return n=new Er(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ta(e.R,n)};if(t instanceof Hh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Kh)return{bytesValue:ea(e.R,t._byteString)};if(t instanceof Ch){var r=t.firestore._databaseId;if(!r.isEqual(n=e.databaseId))throw e.Bc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ia(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Bc("Unsupported field value: "+Ih(t))}(t,e)}function hf(t,e){var n={};return kr(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Cr(t,(function(t,r){var i=lf(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function ff(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Er||t instanceof Hh||t instanceof Kh||t instanceof Ch||t instanceof Wh)}function df(t,e,n){if(!ff(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Ih(n);throw e.Bc("an object"===r?t+" a custom object":t+" "+r)}}function pf(t,e,n){if((e=Object(i.getModularInstance)(e))instanceof Bh)return e._internalPath;if("string"==typeof e)return gf(t,e);throw yf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var vf=new RegExp("[~\\*/\\[\\]]");function gf(t,e,n){if(e.search(vf)>=0)throw yf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Bh.bind.apply(Bh,Object(ar.__spreadArray)([void 0],e.split(".")))))._internalPath}catch(r){throw yf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function yf(t,e,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new cr(ur.INVALID_ARGUMENT,(s+=". ")+t+u)}function mf(t,e){return t.some((function(t){return t.isEqual(e)}))}var _f=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ch(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new bf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.toProto())}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(wf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),bf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ar.__extends)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(_f);function wf(t,e){return"string"==typeof e?gf(t,e):e instanceof Bh?e._internalPath:e._delegate._internalPath}var If=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Tf=function(t){function e(e,n,r,i,o,a){var s=this;return(s=t.call(this,e,n,r,i,a)||this)._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return Object(ar.__extends)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Ef(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.toProto(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(wf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(_f),Ef=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ar.__extends)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Tf),Of=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new If(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Ef(n._firestore,n._userDataWriter,r.key,r,new If(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new cr(ur.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new Ef(t._firestore,t._userDataWriter,e.doc.key,e.doc,new If(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Ef(t._firestore,t._userDataWriter,e.doc.key,e.doc,new If(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Sf(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Sf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return gr()}}function Cf(t,e){return t instanceof Tf&&e instanceof Tf?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Of&&e instanceof Of&&t._firestore===e._firestore&&Rh(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function kf(t){if(Ni(t)&&0===t.explicitOrderBy.length)throw new cr(ur.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Af=function(){};function Nf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Pf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Wc=e,i.Gc=n,i.zc=r,i.type="where",i}return Object(ar.__extends)(e,t),e.prototype._apply=function(t){var e=$h(t.firestore),n=function(t,e,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new cr(ur.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Ff(a,o);for(var u=[],c=0,l=a;c<l.length;c++)u.push(Mf(r,t,l[c]));s={arrayValue:{values:u}}}else s=Mf(r,t,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Ff(a,o),s=cf(n,"where",a,"in"===o||"not-in"===o);var h=hi.create(i,o,s);return function(t,e){if(e.g()){var n=ji(t);if(null!==n&&!n.isEqual(e.field))throw new cr(ur.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Pi(t);null!==r&&Uf(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new cr(ur.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,h),h}(t._query,0,e,t.firestore._databaseId,this.Wc,this.Gc,this.zc);return new kh(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Si(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Af),jf=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Wc=e,r.Hc=n,r.type="orderBy",r}return Object(ar.__extends)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new cr(ur.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new cr(ur.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ii(e,n);return function(t,e){if(null===Pi(t)){var n=ji(t);null!==n&&Uf(0,n,e.field)}}(t,r),r}(t._query,this.Wc,this.Hc);return new kh(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Si(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Af),Rf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(ar.__extends)(e,t),e.prototype._apply=function(t){return new kh(t.firestore,t.converter,Li(t._query,this.Jc,this.Yc))},e}(Af),xf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return Object(ar.__extends)(e,t),e.prototype._apply=function(t){var e=Lf(t,this.type,this.Xc,this.Zc);return new kh(t.firestore,t.converter,function(t,e){return new Si(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Af),Df=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return Object(ar.__extends)(e,t),e.prototype._apply=function(t){var e=Lf(t,this.type,this.Xc,this.Zc);return new kh(t.firestore,t.converter,function(t,e){return new Si(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Af);function Lf(t,e,n,r){if(n[0]=Object(i.getModularInstance)(n[0]),n[0]instanceof _f)return function(t,e,n,r,i){if(!r)throw new cr(ur.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=xi(t);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(Jr(e,r.key));else{var c=r.data.field(u.field);if(Ur(c))throw new cr(ur.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new cr(ur.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new bi(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var o=$h(t.firestore);return function(t,e,n,r,i,o){var a=t.explicitOrderBy;if(i.length>a.length)throw new cr(ur.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new cr(ur.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ri(t)&&-1!==c.indexOf("/"))throw new cr(ur.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(Nr.fromString(c));if(!Wr.isDocumentKey(l))throw new cr(ur.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new Wr(l);s.push(Jr(e,h))}else{var f=cf(n,r,c);s.push(f)}}return new bi(s,o)}(t._query,t.firestore._databaseId,o,e,n,r)}function Mf(t,e,n){if("string"==typeof(n=Object(i.getModularInstance)(n))){if(""===n)throw new cr(ur.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ri(e)&&-1!==n.indexOf("/"))throw new cr(ur.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Nr.fromString(n));if(!Wr.isDocumentKey(r))throw new cr(ur.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Jr(t,new Wr(r))}if(n instanceof Ch)return Jr(t,n._key);throw new cr(ur.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ih(n)+".")}function Ff(t,e){if(!Array.isArray(t)||0===t.length)throw new cr(ur.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new cr(ur.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Uf(t,e,n){if(!n.isEqual(e))throw new cr(ur.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var qf=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Hr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Mr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Fr(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw gr()}},t.prototype.convertObject=function(t,e){var n=this,r={};return Cr(t.fields||{},(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new Hh(Mr(t.latitude),Mr(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=function t(e){var n=e.mapValue.fields.__previous_value__;return Ur(n)?t(n):n}(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(qr(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Lr(t);return new Er(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=Nr.fromString(t);yr(ka(n));var r=new ch(n.get(1),n.get(3)),i=new Wr(n.popFirst(5));return r.isEqual(e)||dr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function Vf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Bf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(ar.__extends)(e,t),e.prototype.convertBytes=function(t){return new Kh(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ch(this.firestore,null,e)},e}(qf),Kf=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=$h(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Wf(t,this._firestore),i=Vf(r.converter,e,n),o=Zh(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,ao.none())),this},t.prototype.update=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];this._verifyNotCommitted();var a,s=Wf(t,this._firestore);return a="string"==typeof(e=Object(i.getModularInstance)(e))||e instanceof Bh?uf(this._dataReader,"WriteBatch.update",s._key,e,n,r):sf(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(a.toMutation(s._key,ao.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Wf(t,this._firestore);return this._mutations=this._mutations.concat(new Io(e._key,ao.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new cr(ur.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Wf(t,e){if((t=Object(i.getModularInstance)(t)).firestore!==e)throw new cr(ur.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Hf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(ar.__extends)(e,t),e.prototype.convertBytes=function(t){return new Kh(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ch(this.firestore,null,e)},e}(qf);function Gf(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];t=Th(t,Ch);var a=Th(t.firestore,Mh),s=$h(a);return Qf(a,[("string"==typeof(e=Object(i.getModularInstance)(e))||e instanceof Bh?uf(s,"updateDoc",t._key,e,n,r):sf(s,"updateDoc",t._key,e)).toMutation(t._key,ao.exists(!0))])}function zf(t){for(var e,n,r,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];t=Object(i.getModularInstance)(t);var s={includeMetadataChanges:!1},u=0;"object"!=typeof o[u]||Dh(o[u])||(s=o[u],u++);var c,l,h,f={includeMetadataChanges:s.includeMetadataChanges};if(Dh(o[u])){var d=o[u];o[u]=null===(e=d.next)||void 0===e?void 0:e.bind(d),o[u+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),o[u+2]=null===(r=d.complete)||void 0===r?void 0:r.bind(d)}if(t instanceof Ch)l=Th(t.firestore,Mh),h=ki(t._key.path),c={next:function(e){o[u]&&o[u](Yf(l,t,e))},error:o[u+1],complete:o[u+2]};else{var p=Th(t,kh);l=Th(p.firestore,Mh),h=p._query;var v=new Hf(l);c={next:function(t){o[u]&&o[u](new Of(l,v,p,t))},error:o[u+1],complete:o[u+2]},kf(t._query)}return function(t,e,n,r){var i=this,o=new Gl(r),a=new $c(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(i,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return e=zc,[4,oh(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(i,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return e=Qc,[4,oh(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))}))}}(Fh(l),h,f,c)}function Qf(t,e){return function(t,e){var n=this,r=new $a;return t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(n,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return n=fl,[4,ih(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Fh(t),e)}function Yf(t,e,n){var r=n.docs.get(e._key),i=new Hf(t);return new Tf(t,i,e._key,r,new If(n.hasPendingWrites,n.fromCache),e.converter)}var Xf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(ar.__extends)(e,t),e.prototype.get=function(e){var n=this,r=Wf(e,this._firestore),i=new Hf(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Tf(n._firestore,i,r._key,t._document,new If(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=$h(t)}return t.prototype.get=function(t){var e=this,n=Wf(t,this._firestore),r=new Bf(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return gr();var i=t[0];if(i.isFoundDocument())return new _f(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new _f(e._firestore,r,n._key,null,n.converter);throw gr()}))},t.prototype.set=function(t,e,n){var r=Wf(t,this._firestore),i=Vf(r.converter,e,n),o=Zh(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var a,s=Wf(t,this._firestore);return a="string"==typeof(e=Object(i.getModularInstance)(e))||e instanceof Bh?uf(this._dataReader,"Transaction.update",s._key,e,n,r):sf(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,a),this},t.prototype.delete=function(t){var e=Wf(t,this._firestore);return this._transaction.delete(e._key),this},t}());function Jf(){if("undefined"==typeof Uint8Array)throw new cr(ur.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function $f(){if("undefined"==typeof atob)throw new cr(ur.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Zf=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return $f(),new t(Kh.fromBase64String(e))},t.fromUint8Array=function(e){return Jf(),new t(Kh.fromUint8Array(e))},t.prototype.toBase64=function(){return $f(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Jf(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),td=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Vh(t=Th(t,Mh));var n=Fh(t),r=t._freezeSettings(),i=new Wl;return qh(n,i,new Bl(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Vh(t=Th(t,Mh));var e=Fh(t),n=t._freezeSettings(),r=new Wl;return qh(e,r,new Kl(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new cr(ur.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new $a;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return Object(ar.__awaiter)(e,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return es.yt()?[4,es.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}}))}))}(fu(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),ed=function(){function t(t,e,n){var r=this;this._delegate=e,this.ta=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof ch||(this.ea=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._delegate._getSettings()),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var o=(t=Th(t,Sh))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&pr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),r.mockUserToken){var a=Object(i.createMockUserToken)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new cr(ur.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new dh(new hh(a,new Ku(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Object(ar.__awaiter)(e,void 0,void 0,(function(){var e,n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,eh(t)];case 1:return e=r.sent(),[4,rh(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=mr(t);return e.$r.delete(0),vc(e)}(n))]}}))}))}))}(Fh(Th(this._delegate,Mh)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Object(ar.__awaiter)(e,void 0,void 0,(function(){var e,n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,eh(t)];case 1:return e=r.sent(),[4,rh(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return(e=mr(t)).$r.add(0),[4,gc(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Fh(Th(this._delegate,Mh)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&_h("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.ta.enableMultiTabIndexedDbPersistence(this):this.ta.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.ta.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.ea&&(this.ea._removeServiceInstance("firestore"),this.ea._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new $a;return t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(e,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return e=ml,[4,ih(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Fh(Th(this._delegate,Mh)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Gl(e);return t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(n,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return e=function(t,e){mr(t).Gr.add(e),e.next()},[4,oh(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(n,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return e=function(t,e){mr(t).Gr.delete(e)},[4,oh(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Fh(t=Th(t,Mh)),Dh(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.ea)throw new cr(ur.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ea},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new vd(this,Nh(this._delegate,t))}catch(t){throw sd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new ad(this,Ph(this._delegate,t))}catch(t){throw sd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new fd(this,function(t,e){if(t=Th(t,Sh),yh("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new cr(ur.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new kh(t,null,function(t){return new Si(Nr.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw sd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new $a;return t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(n,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return[4,function(t){return th(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new Yl(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(Fh(t),(function(n){return e(new Xf(t,n))}))}(this._delegate,(function(n){return t(new rd(e,n))}))},t.prototype.batch=function(){var t=this;return Fh(this._delegate),new id(new Kf(this._delegate,(function(e){return Qf(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new cr(ur.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new cr(ur.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),nd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(ar.__extends)(e,t),e.prototype.convertBytes=function(t){return new Zf(new Kh(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return ad.na(e,this.firestore,null)},e}(qf),rd=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new nd(t)}return t.prototype.get=function(t){var e=this,n=gd(t);return this._delegate.get(n).then((function(t){return new ld(e._firestore,new Tf(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=gd(t);return n?(mh("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=gd(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,Object(ar.__spreadArray)([a,e,n],i)),this},t.prototype.delete=function(t){var e=gd(t);return this._delegate.delete(e),this},t}(),id=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=gd(t);return n?(mh("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=gd(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,Object(ar.__spreadArray)([a,e,n],i)),this},t.prototype.delete=function(t){var e=gd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),od=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Ef(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new hd(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.sa=function(e,n){var r=t.ia,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new nd(e),n),i.set(n,o)),o},t}();od.ia=new WeakMap;var ad=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new nd(t)}return t.ra=function(e,n,r){if(e.length%2!=0)throw new cr(ur.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Ch(n._delegate,r,new Wr(e)))},t.na=function(e,n,r){return new t(n,new Ch(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new vd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new vd(this.firestore,Nh(this._delegate,t))}catch(t){throw sd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Object(i.getModularInstance)(t))instanceof Ch&&jh(this._delegate,t)},t.prototype.set=function(t,e){e=mh("DocumentReference.set",e);try{return function(t,e,n){t=Th(t,Ch);var r=Th(t.firestore,Mh),i=Vf(t.converter,e,n);return Qf(r,[Zh($h(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,ao.none())])}(this._delegate,t,e)}catch(t){throw sd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Gf(this._delegate,t):Gf.apply(void 0,Object(ar.__spreadArray)([this._delegate,t,e],n))}catch(t){throw sd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Qf(Th((t=this._delegate).firestore,Mh),[new Io(t._key,ao.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=ud(e),i=cd(e,(function(e){return new ld(t.firestore,new Tf(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return zf(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Th(t,Ch);var e=Th(t.firestore,Mh),n=Fh(e),r=new Hf(e);return function(t,e){var n=this,r=new $a;return t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(n,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=mr(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new cr(ur.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Vc(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,nh(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Tf(e,r,t._key,n,new If(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Th(t,Ch);var e=Th(t.firestore,Mh);return ah(Fh(e),t._key,{source:"server"}).then((function(n){return Yf(e,t,n)}))}(this._delegate):function(t){t=Th(t,Ch);var e=Th(t.firestore,Mh);return ah(Fh(e),t._key).then((function(n){return Yf(e,t,n)}))}(this._delegate)).then((function(t){return new ld(e.firestore,new Tf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?od.sa(this.firestore,e):null))},t}();function sd(t,e,n){return t.message=t.message.replace(e,n),t}function ud(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Dh(r))return r}return{}}function cd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Dh(t[0])?t[0]:Dh(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var ld=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new ad(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Cf(this._delegate,t._delegate)},t}(),hd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(ar.__extends)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(ld),fd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new nd(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Nf(this._delegate,function(t,e,n){var r=e,i=wf("where",t);return new Pf(i,r,n)}(e,n,r)))}catch(e){throw sd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Nf(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=wf("orderBy",t);return new jf(r,n)}(e,n)))}catch(e){throw sd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Nf(this._delegate,function(t){return Eh("limit",t),new Rf("limit",t,"F")}(e)))}catch(e){throw sd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Nf(this._delegate,function(t){return Eh("limitToLast",t),new Rf("limitToLast",t,"L")}(e)))}catch(e){throw sd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Nf(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new xf("startAt",t,!0)}).apply(void 0,e)))}catch(e){throw sd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Nf(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new xf("startAfter",t,!1)}).apply(void 0,e)))}catch(e){throw sd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Nf(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Df("endBefore",t,!0)}).apply(void 0,e)))}catch(e){throw sd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Nf(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Df("endAt",t,!1)}).apply(void 0,e)))}catch(e){throw sd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return Rh(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Th(t,kh);var e=Th(t.firestore,Mh),n=Fh(e),r=new Hf(e);return function(t,e){var n=this,r=new $a;return t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(n,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s;return Object(ar.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,Cu(t,e,!0)];case 1:return s=u.sent(),r=new ol(e,s.Bn),i=r._o(s.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return a=u.sent(),s=Vc(a,"Failed to execute query '"+e+" against cache"),n.reject(s),[3,3];case 3:return[2]}}))}))},[4,nh(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Of(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Th(t,kh);var e=Th(t.firestore,Mh),n=Fh(e),r=new Hf(e);return sh(n,t._query,{source:"server"}).then((function(n){return new Of(e,r,t,n)}))}(this._delegate):function(t){t=Th(t,kh);var e=Th(t.firestore,Mh),n=Fh(e),r=new Hf(e);return kf(t._query),sh(n,t._query).then((function(n){return new Of(e,r,t,n)}))}(this._delegate)).then((function(t){return new pd(e.firestore,new Of(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=ud(e),i=cd(e,(function(e){return new pd(t.firestore,new Of(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return zf(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?od.sa(this.firestore,e):null))},t}(),dd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new hd(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),pd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new fd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new hd(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new dd(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new hd(n._firestore,r))}))},t.prototype.isEqual=function(t){return Cf(this._delegate,t._delegate)},t}(),vd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(ar.__extends)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new ad(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new ad(this.firestore,void 0===t?Ph(this._delegate):Ph(this._delegate,t))}catch(t){throw sd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Th(t.firestore,Mh),r=Ph(t),i=Vf(t.converter,e);return Qf(n,[Zh($h(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,ao.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new ad(e.firestore,t)}))},e.prototype.isEqual=function(t){return jh(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?od.sa(this.firestore,t):null))},e}(fd);function gd(t){return Th(t,Ch)}var yd,md,_d=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Bh.bind.apply(Bh,Object(ar.__spreadArray)([void 0],t)))}return t.documentId=function(){return new t(jr.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(i.getModularInstance)(t))instanceof Bh&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),bd=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new nf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new tf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rf("arrayUnion",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new of("arrayRemove",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new af("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),wd=n("/6Yf"),Id={Firestore:ed,GeoPoint:Hh,Timestamp:Er,Blob:Zf,Transaction:rd,WriteBatch:id,DocumentReference:ad,DocumentSnapshot:ld,Query:fd,QueryDocumentSnapshot:hd,QuerySnapshot:pd,CollectionReference:vd,FieldPath:_d,FieldValue:bd,setLogLevel:function(t){lr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new wd.Component("firestore",(function(t){return function(t,e){return new ed(t,new Mh(t,e),new td)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Id)))})(yd=r.default),yd.registerVersion("@firebase/firestore","2.3.1"),(md=ed).prototype.loadBundle=function(t){return function(t,e){var n=Fh(t=Th(t,Mh)),r=new Lh;return function(t,e,n,r){var i=this,o=function(t,e){return function(t,e){return new zl(t,e)}(function(t,e){if(t instanceof Uint8Array)return Hl(t,e);if(t instanceof ArrayBuffer)return Hl(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,sc(e));t.asyncQueue.enqueueAndForget((function(){return Object(ar.__awaiter)(i,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return e=ql,[4,ih(t)];case 1:return e.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(n,t._databaseId,e,r),r}(this._delegate,t)},md.prototype.namedQuery=function(t){var e,n,r=this;return(e=this._delegate,n=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return Object(ar.__awaiter)(n,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=mr(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.Qe.getNamedQuery(t,e)}))},[4,nh(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(Fh(e=Th(e,Mh)),n).then((function(t){return t?new kh(e,null,t.query):null}))).then((function(t){return t?new fd(r,t):null}))};var Td={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ed=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return Object(ar.__extends)(e,t),e}(Error),Od=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t;return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function Sd(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var Cd,kd,Ad,Nd=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return Sd(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?Sd(t,(function(t){return e.decode(t)})):t},t}(),Pd=function(){function t(t,e,n,r,i,o){var a=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new Nd,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(a.deleteService())}},this.contextProvider=new Od(e,n),this.cancelAllRequests=new Promise((function(t){a.deleteService=function(){return t()}}));try{var s=new URL(i);this.customDomain=s.origin,this.region="us-central1"}catch(yd){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=a.sent())&&(n["X-Firebase-AppCheck"]=r),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=a.sent(),[3,5];case 4:return a.sent(),[2,{status:0,json:null}];case 5:o=null,a.label=6;case 6:return a.trys.push([6,8,,9]),[4,i.json()];case 7:return o=a.sent(),[3,9];case 8:return a.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}}))}))},t.prototype.getAppCheckToken=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t;return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f;return Object(ar.__generator)(this,(function(d){switch(d.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(a=d.sent()).authToken&&(o.Authorization="Bearer "+a.authToken),a.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=a.instanceIdToken),s=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new Ed("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(n.timeout||7e4),u=s.timer,c=s.promise,[4,Promise.race([jd(u,this.postJSON(r,i,o)),c,jd(u,this.cancelAllRequests)])];case 2:if(!(l=d.sent()))throw new Ed("cancelled","Firebase Functions instance was deleted.");if(h=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var s=a.status;if("string"==typeof s){if(!Td[s])return new Ed("internal","internal");r=Td[s],i=s}var u=a.message;"string"==typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(yd){}return"ok"===r?null:new Ed(r,i,o)}(l.status,l.json,this.serializer))throw h;if(!l.json)throw new Ed("internal","Response is not valid JSON object.");if(void 0===(f=l.json.data)&&(f=l.json.result),void 0===f)throw new Ed("internal","Response is missing data field.");return[2,{data:this.serializer.decode(f)}]}}))}))},t}();function jd(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}Cd=r.default,kd=fetch.bind(self),Ad={Functions:Pd},Cd.INTERNAL.registerComponent(new wd.Component("functions",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal"),a=t.getProvider("messaging");return new Pd(r,i,a,o,n,kd)}),"PUBLIC").setServiceProps(Ad).setMultipleInstances(!0)),r.default.registerVersion("@firebase/functions","0.6.9");var Rd,xd=n("nbvr"),Dd=((Rd={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Rd["not-registered"]="Firebase Installation is not registered.",Rd["installation-not-found"]="Firebase Installation not found.",Rd["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',Rd["app-offline"]="Could not process request. Application offline.",Rd["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",Rd),Ld=new i.ErrorFactory("installations","Installations",Dd);function Md(t){return t instanceof i.FirebaseError&&t.code.includes("request-failed")}function Fd(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function Ud(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function qd(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),[2,Ld.create("request-failed",{requestName:t,serverCode:(r=n.error).code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function Vd(t){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey})}function Bd(t,e){var n=e.refreshToken,r=Vd(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}(n)),r}function Kd(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function Wd(t,e){var n=e.fid;return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,r,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return e=Fd(t),r=Vd(t),i={method:"POST",headers:r,body:JSON.stringify({fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:"w:0.4.26"})},[4,Kd((function(){return fetch(e,i)}))];case 1:return(o=s.sent()).ok?[4,o.json()]:[3,3];case 2:return[2,{fid:(a=s.sent()).fid||n,registrationStatus:2,refreshToken:a.refreshToken,authToken:Ud(a.authToken)}];case 3:return[4,qd("Create Installation",o)];case 4:throw s.sent()}}))}))}function Hd(t){return new Promise((function(e){setTimeout(e,t)}))}var Gd=/^[cdef][\w-]{21}$/;function zd(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,Object(ar.__spreadArray)([],Object(ar.__read)(e)))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return Gd.test(e)?e:""}catch(n){return""}}function Qd(t){return t.appName+"!"+t.appId}var Yd=new Map;function Xd(t,e){var n=Qd(t);Jd(n,e),function(t,e){var n=Zd();n&&n.postMessage({key:t,fid:e}),tp()}(n,e)}function Jd(t,e){var n,r,i=Yd.get(t);if(i)try{for(var o=Object(ar.__values)(i),a=o.next();!a.done;a=o.next())(0,a.value)(e)}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var $d=null;function Zd(){return!$d&&"BroadcastChannel"in self&&(($d=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){Jd(t.data.key,t.data.fid)}),$d}function tp(){0===Yd.size&&$d&&($d.close(),$d=null)}var ep,np="firebase-installations-store",rp=null;function ip(){return rp||(rp=Object(xd.openDb)("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(np)}}))),rp}function op(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return n=Qd(t),[4,ip()];case 1:return r=s.sent(),i=r.transaction(np,"readwrite"),[4,(o=i.objectStore(np)).get(n)];case 2:return a=s.sent(),[4,o.put(e,n)];case 3:return s.sent(),[4,i.complete];case 4:return s.sent(),a&&a.fid===e.fid||Xd(t,e.fid),[2,e]}}))}))}function ap(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return e=Qd(t),[4,ip()];case 1:return n=i.sent(),[4,(r=n.transaction(np,"readwrite")).objectStore(np).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function sp(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Object(ar.__generator)(this,(function(u){switch(u.label){case 0:return n=Qd(t),[4,ip()];case 1:return r=u.sent(),i=r.transaction(np,"readwrite"),[4,(o=i.objectStore(np)).get(n)];case 2:return a=u.sent(),void 0!==(s=e(a))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(s,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!s||a&&a.fid===s.fid||Xd(t,s.fid),[2,s]}}))}))}function up(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return[4,sp(t,(function(n){var r=function(t){return hp(t||{fid:zd(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(Ld.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,Wd(t,e)];case 1:return n=i.sent(),[2,op(t,n)];case 2:return Md(r=i.sent())&&409===r.customData.serverCode?[4,ap(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,op(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:cp(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function cp(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return[4,lp(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,Hd(100)];case 3:return o.sent(),[4,lp(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,up(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function lp(t){return sp(t,(function(t){if(!t)throw Ld.create("installation-not-found");return hp(t)}))}function hp(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function fp(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,i,o,a,s;return Object(ar.__generator)(this,(function(u){switch(u.label){case 0:return t=function(t,e){var n=e.fid;return Fd(t)+"/"+n+"/authTokens:generate"}(n,e),i=Bd(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),a={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:"w:0.4.26"}})},[4,Kd((function(){return fetch(t,a)}))];case 1:return(s=u.sent()).ok?[4,s.json()]:[3,3];case 2:return[2,Ud(u.sent())];case 3:return[4,qd("Generate Auth Token",s)];case 4:throw u.sent()}}))}))}function dp(t,e){return void 0===e&&(e=!1),Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return[4,sp(t.appConfig,(function(r){if(!vp(r))throw Ld.create("not-registered");var i,o=r.authToken;if(!e&&2===(i=o).requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(i))return r;if(1===o.requestStatus)return n=function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return[4,pp(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,Hd(100)];case 3:return i.sent(),[4,pp(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,dp(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw Ld.create("app-offline");var a=function(t){var e={requestStatus:1,requestTime:Date.now()};return Object(ar.__assign)(Object(ar.__assign)({},t),{authToken:e})}(r);return n=function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,fp(t,e)];case 1:return n=o.sent(),i=Object(ar.__assign)(Object(ar.__assign)({},e),{authToken:n}),[4,op(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!Md(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,ap(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=Object(ar.__assign)(Object(ar.__assign)({},e),{authToken:{requestStatus:0}}),[4,op(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,a),a}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function pp(t){return sp(t,(function(t){if(!vp(t))throw Ld.create("not-registered");var e;return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Object(ar.__assign)(Object(ar.__assign)({},t),{authToken:{requestStatus:0}}):t}))}function vp(t){return void 0!==t&&2===t.registrationStatus}function gp(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return[4,up(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function yp(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:return n=function(t,e){var n=e.fid;return Fd(t)+"/"+n}(t,e),r=Bd(t,e),i={method:"DELETE",headers:r},[4,Kd((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,qd("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}function mp(t){return Ld.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new wd.Component("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw mp("App Configuration");if(!t.name)throw mp("App Name");try{for(var r=Object(ar.__values)(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw mp(o)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return[4,up(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):dp(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return[4,gp(t.appConfig)];case 1:return n.sent(),[4,dp(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,sp(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw Ld.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw Ld.create("app-offline");case 3:return[4,yp(e,n)];case 4:return r.sent(),[4,ap(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return function(t,e){var n=t.appConfig;return function(t,e){Zd();var n=Qd(t),r=Yd.get(n);r||(r=new Set,Yd.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=Qd(t),r=Yd.get(n);r&&(r.delete(e),0===r.size&&Yd.delete(n),tp())}(n,e)}}(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations","0.4.26")}(r.default);var _p=((ep={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',ep["only-available-in-window"]="This method is available in a Window context.",ep["only-available-in-sw"]="This method is available in a service worker context.",ep["permission-default"]="The notification permission was not granted and dismissed instead.",ep["permission-blocked"]="The notification permission was not granted and blocked instead.",ep["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",ep["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",ep["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",ep["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",ep["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",ep["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",ep["token-update-no-token"]="FCM returned no token when updating the user to push.",ep["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",ep["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",ep["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",ep["invalid-vapid-key"]="The public VAPID key must be a string.",ep["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",ep),bp=new i.ErrorFactory("messaging","Messaging",_p),wp="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Ip=function(t){return t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked",t}({});function Tp(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,Object(ar.__spreadArray)([],Object(ar.__read)(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ep(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}function Op(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!r.sent().map((function(t){return t.name})).includes("fcm_token_details_db"))return[2,null];r.label=2;case 2:return e=null,[4,Object(xd.openDb)("fcm_token_details_db",5,(function(r){return Object(ar.__awaiter)(n,void 0,void 0,(function(){var n,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return r.oldVersion<2?[2]:r.objectStoreNames.contains("fcm_token_object_Store")?[4,(n=r.transaction.objectStore("fcm_token_object_Store")).index("fcmSenderId").get(t)]:[2];case 1:return i=s.sent(),[4,n.clear()];case 2:if(s.sent(),!i)return[2];if(2===r.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];e={token:o.fcmToken,createTime:null!==(a=o.createTime)&&void 0!==a?a:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:Tp(o.vapidKey)}}}else(3===r.oldVersion||4===r.oldVersion)&&(e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:Tp(o.auth),p256dh:Tp(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:Tp(o.vapidKey)}});return[2]}}))}))}))];case 3:return r.sent().close(),[4,Object(xd.deleteDb)("fcm_token_details_db")];case 4:return r.sent(),[4,Object(xd.deleteDb)("fcm_vapid_details_db")];case 5:return r.sent(),[4,Object(xd.deleteDb)("undefined")];case 6:return r.sent(),[2,Sp(e)?e:null]}}))}))}function Sp(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}var Cp=null;function kp(){return Cp||(Cp=Object(xd.openDb)("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore("firebase-messaging-store")}}))),Cp}function Ap(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return e=jp(t),[4,kp()];case 1:return[4,i.sent().transaction("firebase-messaging-store").objectStore("firebase-messaging-store").get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,Op(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,Np(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function Np(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return n=jp(t),[4,kp()];case 1:return r=o.sent(),[4,(i=r.transaction("firebase-messaging-store","readwrite")).objectStore("firebase-messaging-store").put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function Pp(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return e=jp(t),[4,kp()];case 1:return n=i.sent(),[4,(r=n.transaction("firebase-messaging-store","readwrite")).objectStore("firebase-messaging-store").delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function jp(t){return t.appConfig.appId}function Rp(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return[4,Mp(t)];case 1:n=s.sent(),r=Fp(e),i={method:"POST",headers:n,body:JSON.stringify(r)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(Lp(t.appConfig),i)];case 3:return[4,s.sent().json()];case 4:return o=s.sent(),[3,6];case 5:throw a=s.sent(),bp.create("token-subscribe-failed",{errorInfo:a});case 6:if(o.error)throw bp.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw bp.create("token-subscribe-no-token");return[2,o.token]}}))}))}function xp(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return[4,Mp(t)];case 1:n=s.sent(),r=Fp(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(Lp(t.appConfig)+"/"+e.token,i)];case 3:return[4,s.sent().json()];case 4:return o=s.sent(),[3,6];case 5:throw a=s.sent(),bp.create("token-update-failed",{errorInfo:a});case 6:if(o.error)throw bp.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw bp.create("token-update-no-token");return[2,o.token]}}))}))}function Dp(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:return[4,Mp(t)];case 1:n=a.sent(),r={method:"DELETE",headers:n},a.label=2;case 2:return a.trys.push([2,5,,6]),[4,fetch(Lp(t.appConfig)+"/"+e,r)];case 3:return[4,a.sent().json()];case 4:if((i=a.sent()).error)throw bp.create("token-unsubscribe-failed",{errorInfo:i.error.message});return[3,6];case 5:throw o=a.sent(),bp.create("token-unsubscribe-failed",{errorInfo:o});case 6:return[2]}}))}))}function Lp(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function Mp(t){var e=t.appConfig,n=t.installations;return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function Fp(t){var e=t.vapidKey,n={web:{endpoint:t.endpoint,auth:t.auth,p256dh:t.p256dh}};return e!==wp&&(n.web.applicationPubKey=e),n}function Up(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:if("granted"!==Notification.permission)throw bp.create("permission-blocked");return[4,Kp(e,n)];case 1:return r=s.sent(),[4,Ap(t)];case 2:return i=s.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:Tp(r.getKey("auth")),p256dh:Tp(r.getKey("p256dh"))},i?[3,3]:[2,Bp(t,o)];case 3:if(l=(c=o).endpoint===(u=i.subscriptionOptions).endpoint,c.vapidKey===u.vapidKey&&l&&c.auth===u.auth&&c.p256dh===u.p256dh)return[3,8];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,Dp(t,i.token)];case 5:return s.sent(),[3,7];case 6:return a=s.sent(),console.warn(a),[3,7];case 7:return[2,Bp(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,Vp({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,l}))}))}function qp(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return[4,Ap(t)];case 1:return(n=i.sent())?[4,Dp(t,n.token)]:[3,4];case 2:return i.sent(),[4,Pp(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function Vp(t,e,n){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,5]),[4,xp(e,t)];case 1:return r=a.sent(),i=Object(ar.__assign)(Object(ar.__assign)({},t),{token:r,createTime:Date.now()}),[4,Np(e,i)];case 2:return a.sent(),[2,r];case 3:return o=a.sent(),[4,qp(e,n)];case 4:throw a.sent(),o;case 5:return[2]}}))}))}function Bp(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return[4,Rp(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,Np(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function Kp(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ep(e)})]}}))}))}function Wp(t){return"object"==typeof t&&!!t&&"google.c.a.c_id"in t}function Hp(t){return new Promise((function(e){setTimeout(e,t)}))}var Gp=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw bp.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,Ap(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:wp,r.label=2;case 2:return[2,Up(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return qp(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw bp.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw bp.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw bp.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw bp.create("only-available-in-window")},t.prototype.onMessage=function(){throw bp.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw bp.create("only-available-in-window")},t.prototype.onPush=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(n){return null}}(t))?[4,Xp()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,Yp(n,e)]:(r=!1,e.notification?[4,Jp(zp(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,Hp(1e3)]);case 4:return o.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,qp(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,Ap(this.firebaseDependencies)];case 3:return r=i.sent(),[4,qp(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,Up(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:wp)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return Object(ar.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s;return Object(ar.__generator)(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r;return(null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action)||(Wp(t.data)?self.location.origin:null)}(r))?(o=new URL(i,self.location.href),a=new URL(self.location.origin),o.host!==a.host?[2]:[4,Qp(o)]):[2]):[2];case 1:return(s=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return s=u.sent(),[4,Hp(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,s.focus()];case 5:s=u.sent(),u.label=6;case 6:return s?(r.messageType=Ip.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,s.postMessage(r)]):[2]}}))}))},t}();function zp(t){var e,n=Object(ar.__assign)({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function Qp(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return Object(ar.__generator)(this,(function(u){switch(u.label){case 0:return[4,Xp()];case 1:e=u.sent();try{for(n=Object(ar.__values)(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(c){a={error:c}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}}))}))}function Yp(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=Ip.PUSH_RECEIVED;try{for(var i=Object(ar.__values)(t),o=i.next();!o.done;o=i.next())o.value.postMessage(e)}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function Xp(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Jp(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var $p=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===Ip.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),Wp(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw bp.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,Up(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=wp),[2]}))}))},t.prototype.updateSwReg=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw bp.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),bp.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,qp(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t;return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw bp.create("denied"===t?"permission-blocked":"permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw bp.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw bp.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw bp.create("invalid-sw-registration");if(this.swRegistration)throw bp.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw bp.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw bp.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case Ip.NOTIFICATION_CLICKED:return"notification_open";case Ip.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function Zp(t){return bp.create("missing-app-config-values",{valueName:t})}var tv={isSupported:ev};function ev(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}r.default.INTERNAL.registerComponent(new wd.Component("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw Zp("App Configuration Object");if(!t.name)throw Zp("App Name");var r=t.options;try{for(var i=Object(ar.__values)(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw Zp(a)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!ev())throw bp.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new Gp(n):new $p(n)}),"PUBLIC").setServiceProps(tv));var nv=function(t){function e(n,r){var i=t.call(this,rv(n),"Firebase Storage: "+r+" ("+rv(n)+")")||this;return i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(i,e.prototype),i}return Object(ar.__extends)(e,t),e.prototype._codeEquals=function(t){return rv(t)===this.code},Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t,this.message=this.customData.serverResponse?this._baseMessage+"\n"+this.customData.serverResponse:this._baseMessage},enumerable:!1,configurable:!0}),e}(i.FirebaseError);function rv(t){return"storage/"+t}function iv(){return new nv("unknown","An unknown error occurred, please check the error payload for server response.")}function ov(){return new nv("canceled","User canceled the upload/download.")}function av(){return new nv("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function sv(t){return new nv("invalid-argument",t)}function uv(){return new nv("app-deleted","The Firebase app was deleted.")}function cv(t){return new nv("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function lv(t,e){return new nv("invalid-format","String does not match format '"+t+"': "+e)}function hv(t){throw new nv("internal-error","Internal error: "+t)}var fv={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},dv=function(){return function(t,e){this.data=t,this.contentType=e||null}}();function pv(t,e){switch(t){case fv.RAW:return new dv(vv(e));case fv.BASE64:case fv.BASE64URL:return new dv(gv(t,e));case fv.DATA_URL:return new dv((n=new yv(e)).base64?gv(fv.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(yd){throw lv(fv.DATA_URL,"Malformed data URL.")}return vv(e)}(n.rest),function(t){return new yv(t).contentType}(e))}var n;throw iv()}function vv(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r))if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1))){var i=r,o=t.charCodeAt(++n);e.push(240|(r=65536|(1023&i)<<10|1023&o)>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else e.push(239,191,189);else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function gv(t,e){switch(t){case fv.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw lv(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case fv.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw lv(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(yd){throw lv(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var yv=function(){return function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw lv(fv.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r=e[1]||null;null!=r&&(this.base64=(n=r).length>=";base64".length&&";base64"===n.substring(n.length-";base64".length),this.contentType=this.base64?r.substring(0,r.length-";base64".length):r),this.rest=t.substring(t.indexOf(",")+1)}}(),mv={STATE_CHANGED:"state_changed"},_v={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function bv(t){switch(t){case"running":case"pausing":case"canceling":return _v.RUNNING;case"paused":return _v.PAUSED;case"success":return _v.SUCCESS;case"canceled":return _v.CANCELED;case"error":default:return _v.ERROR}}var wv=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}({}),Iv=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=wv.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=wv.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=wv.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw hv("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw hv("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw hv("cannot .getStatus() before sending");try{return this.xhr_.status}catch(yd){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw hv("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}(),Tv=function(){function t(){}return t.prototype.createXhrIo=function(){return new Iv},t}(),Ev=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch(yd){return new t(e,"")}if(""===r.path)return r;throw new nv("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e,n){var r=null,i=new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i");function o(t){t.path_=decodeURIComponent(t.path)}for(var a=n.replace(/[.]/g,"\\."),s=[{regex:i,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+a+"/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://"+("firebasestorage.googleapis.com"===n?"(?:storage.googleapis.com|storage.cloud.google.com)":n)+"/([A-Za-z0-9.\\-_]+)/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:o}],u=0;u<s.length;u++){var c=s[u],l=c.regex.exec(e);if(l){var h=l[c.indices.path];h||(h=""),r=new t(l[c.indices.bucket],h),c.postModify(r);break}}if(null==r)throw function(t){return new nv("invalid-url","Invalid URL '"+t+"'.")}(e);return r},t}(),Ov=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();function Sv(t){return"string"==typeof t||t instanceof String}function Cv(t){return kv()&&t instanceof Blob}function kv(){return"undefined"!=typeof Blob}function Av(t,e,n,r){if(r<e)throw sv("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw sv("Invalid value for '"+t+"'. Expected "+n+" or less.")}function Nv(t,e){var n=e.match(/^(\w+):\/\/.+/),r=e;return null==(null==n?void 0:n[1])&&(r="https://"+e),r+"/v0"+t}function Pv(t){var e=encodeURIComponent,n="?";for(var r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n.slice(0,-1)}var jv=function(){function t(t,e,n,r,i,o,a,s,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());void 0!==s?i(s):i()}catch(yd){o(yd)}else null!==a?((r=iv()).serverResponse=a.getResponseText(),o(t.errorCallback_?t.errorCallback_(a,r):r)):o(r=n.canceled?t.appDelete_?uv():ov():new nv("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new Rv(!1,null,!0)):this.backoffId_=function(e,n,r){var i=1,o=null,a=!1,s=0;function u(){return 2===s}var c=!1;function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c||(c=!0,n.apply(null,t))}function h(e){o=setTimeout((function(){o=null,function(e,n){if(n)e(!1,new Rv(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===wv.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new Rv(a,n))}else{var s=n.getErrorCode()===wv.ABORT;e(!1,new Rv(!1,null,s))}}))}function i(e){null!==t.progressCallback_&&t.progressCallback_(e.loaded,e.lengthComputable?e.total:-1)}}(f,u())}),e)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!c)if(t)l.call.apply(l,Object(ar.__spreadArray)([null,t],e));else{var r,o=u()||a;o?l.call.apply(l,Object(ar.__spreadArray)([null,t],e)):(i<64&&(i*=2),1===s?(s=2,r=0):r=1e3*(i+Math.random()),h(r))}}var d=!1;function p(t){d||(d=!0,c||(null!==o?(t||(s=2),clearTimeout(o),h(0)):t||(s=1)))}return h(0),setTimeout((function(){a=!0,p(!0)}),r),p}(0,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),Rv=function(){return function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n}}();function xv(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Dv(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=xv();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(kv())return new Blob(t);throw new nv("unsupported-environment","This browser doesn't seem to support creating Blobs")}var Lv=function(){function t(t,e){var n=0,r="";Cv(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(Cv(this.data_)){var r=(o=e,a=n,(i=this.data_).webkitSlice?i.webkitSlice(o,a):i.mozSlice?i.mozSlice(o,a):i.slice?i.slice(o,a):null);return null===r?null:new t(r)}var i,o,a;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(kv()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(Dv.apply(null,r))}var i=e.map((function(t){return Sv(t)?pv(fv.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}();function Mv(t){var e,n;try{e=JSON.parse(t)}catch(yd){return null}return"object"!=typeof(n=e)||Array.isArray(n)?null:e}function Fv(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Uv(t,e){return e}var qv=function(){return function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Uv}}(),Vv=null;function Bv(){if(Vv)return Vv;var t=[];t.push(new qv("bucket")),t.push(new qv("generation")),t.push(new qv("metageneration")),t.push(new qv("name","fullPath",!0));var e=new qv("name");e.xform=function(t,e){return function(t){return!Sv(t)||t.length<2?t:Fv(t)}(e)},t.push(e);var n=new qv("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new qv("timeCreated")),t.push(new qv("updated")),t.push(new qv("md5Hash",null,!0)),t.push(new qv("cacheControl",null,!0)),t.push(new qv("contentDisposition",null,!0)),t.push(new qv("contentEncoding",null,!0)),t.push(new qv("contentLanguage",null,!0)),t.push(new qv("contentType",null,!0)),t.push(new qv("metadata","customMetadata",!0)),Vv=t}function Kv(t,e,n){var r=Mv(e);return null===r?null:function(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=new Ev(t.bucket,t.fullPath);return e._makeStorageReference(n)}})}(r,t),r}(t,r,n)}function Wv(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}var Hv=function(){return function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}();function Gv(t){if(!t)throw iv()}function zv(t,e){return function(n,r){var i=Kv(t,r,e);return Gv(null!==i),i}}function Qv(t){return function(e,n){var r;return(r=401===e.getStatus()?e.getResponseText().includes("Firebase App Check token is invalid")?new nv("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new nv("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?new nv("quota-exceeded","Quota for bucket '"+t.bucket+"' exceeded, please view quota on https://firebase.google.com/pricing/."):403===e.getStatus()?new nv("unauthorized","User does not have permission to access '"+t.path+"'."):n).serverResponse=n.serverResponse,r}}function Yv(t){var e=Qv(t);return function(n,r){var i=e(n,r);return 404===n.getStatus()&&(i=new nv("object-not-found","Object '"+t.path+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function Xv(t,e,n){var r=Nv(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new Hv(r,"GET",zv(t,n),i);return o.errorHandler=Yv(e),o}function Jv(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),r}var $v=function(){return function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null}}();function Zv(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(yd){Gv(!1)}return Gv(!!n&&-1!==(e||["active"]).indexOf(n)),n}var tg=function(){return function(t,e,n){if("function"==typeof t||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var r=t;this.next=r.next,this.error=r.error,this.complete=r.complete}}}();function eg(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var ng=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=Bv(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t._codeEquals("canceled")?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition("error"))},this._metadataErrorHandler=function(t){r._request=void 0,t._codeEquals("canceled")?r.completeTransitions_():(r._error=t,r._transition("error"))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=n[0],i=n[1];switch(e._state){case"running":t(r,i);break;case"canceling":e._transition("canceled");break;case"pausing":e._transition("paused")}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=Jv(e,r,i),s={name:a.fullPath},u=Nv(o,t.host),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=Wv(a,n),h=new Hv(u,"POST",(function(t){var e;Zv(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(yd){Gv(!1)}return Gv(Sv(e)),e}),t.maxUploadRetryTime);return h.urlParams=s,h.headers=c,h.body=l,h.errorHandler=Qv(e),h}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n,r){var i=function(t,e,n,r){var i=new Hv(n,"POST",(function(t){var e=Zv(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(yd){Gv(!1)}n||Gv(!1);var i=Number(n);return Gv(!isNaN(i)),new $v(i,r.size(),"final"===e)}),t.maxUploadRetryTime);return i.headers={"X-Goog-Upload-Command":"query"},i.errorHandler=Qv(e),i}(t._ref.storage,t._ref._location,e,t._blob),o=t._ref.storage._makeRequest(i,n,r);t._request=o,o.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=262144*this._chunkMultiplier,n=new $v(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,o){var a;try{a=function(t,e,n,r,i,o,a,s){var u=new $v(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new nv("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,f={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},d=r.slice(h,h+l);if(null===d)throw av();var p=new Hv(n,"POST",(function(t,n){var i,a=Zv(t,["active","final"]),s=u.current+l,c=r.size();return i="final"===a?zv(e,o)(t,n):null,new $v(s,c,"final"===a,i)}),e.maxUploadRetryTime);return p.headers=f,p.body=d.uploadData(),p.progressCallback=s||null,p.errorHandler=Qv(t),p}(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(yd){return t._error=yd,void t._transition("error")}var s=t._ref.storage._makeRequest(a,i,o);t._request=s,s.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition("success")):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e,n){var r=Xv(t._ref.storage,t._ref._location,t._mappings),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition("success")}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=Jv(e,r,i),c=Wv(u,n),l=Lv.getBlob("--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+c+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",r,"\r\n--"+s+"--");if(null===l)throw av();var h={name:u.fullPath},f=Nv(o,t.host),d=t.maxUploadRetryTime,p=new Hv(f,"POST",zv(t,n),d);return p.urlParams=h,p.headers=a,p.body=l.uploadData(),p.errorHandler=Qv(e),p}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition("success")}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request&&this._request.cancel();break;case"running":var e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":this._state=t,this._notifyObservers();break;case"canceled":this._error=ov(),this._state=t,this._notifyObservers();break;case"error":case"success":this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=bv(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new tg(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(bv(this._state)){case _v.SUCCESS:eg(this._resolve.bind(null,this.snapshot))();break;case _v.CANCELED:case _v.ERROR:eg(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(bv(this._state)){case _v.RUNNING:case _v.PAUSED:t.next&&eg(t.next.bind(t,this.snapshot))();break;case _v.SUCCESS:t.complete&&eg(t.complete.bind(t))();break;case _v.CANCELED:case _v.ERROR:t.error&&eg(t.error.bind(t,this._error))();break;default:t.error&&eg(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t},t.prototype.pause=function(){var t="running"===this._state;return t&&this._transition("pausing"),t},t.prototype.cancel=function(){var t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t},t}(),rg=function(){function t(t,e){this._service=t,this._location=e instanceof Ev?e:Ev.makeFromUrl(e,t.host)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new Ev(this._location.bucket,"");return this._newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Fv(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new Ev(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw cv(t)},t}();function ig(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return null!=e&&"number"==typeof e.maxResults&&Av("options.maxResults",1,1e3,e.maxResults),r=function(t,e,n,r,i){var o={};o.prefix=e.isRoot?"":e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=Nv(e.bucketOnlyServerUrl(),t.host),s=t.maxOperationRetryTime,u=new Hv(a,"GET",function(t,e){return function(n,r){var i=function(t,e,n){var r=Mv(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t._makeStorageReference(new Ev(e,a));r.prefixes.push(s)}if(n.items)for(var u=0,c=n.items;u<c.length;u++)s=t._makeStorageReference(new Ev(e,c[u].name)),r.items.push(s);return r}(t,e,r)}(t,e,r);return Gv(null!==i),i}}(t,e.bucket),s);return u.urlParams=o,u.errorHandler=Qv(e),u}(t.storage,t._location,"/",(n=e||{}).pageToken,n.maxResults),[4,t.storage.makeRequestWithTokens(r)];case 1:return[2,i.sent().getPromise()]}}))}))}function og(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new Ev(t._location.bucket,n);return new rg(t.storage,r)}function ag(t){return/^[A-Za-z]+:\/\//.test(t)}function sg(t,e){var n=null==e?void 0:e.storageBucket;return null==n?null:Ev.makeFromBucketSpec(n,t)}var ug=function(){function t(t,e,n,r,i,o){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host="firebasestorage.googleapis.com",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Ev.makeFromBucketSpec(i,this._host):sg(this._host,this.app.options)}return Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t,this._bucket=null!=this._url?Ev.makeFromBucketSpec(this._url,t):sg(t,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){Av("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){Av("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._getAppCheckToken=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t;return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return(t=this._appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype._makeStorageReference=function(t){return new rg(this,t)},t.prototype._makeRequest=function(t,e,n){var r=this;if(this._deleted)return new Ov(uv());var i=function(t,e,n,r,i,o){var a=Pv(t.urlParams),s=t.url+a,u=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(u,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(u,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(u,o),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(u,r),new jv(s,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}(t,this._appId,e,n,this._pool,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((function(){return r._requests.delete(i)}),(function(){return r._requests.delete(i)})),i},t.prototype.makeRequestWithTokens=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([this._getAuthToken(),this._getAppCheckToken()])];case 1:return e=n.sent(),[2,this._makeRequest(t,e[0],e[1])]}}))}))},t}();function cg(t,e){return function(t,e){if(e&&ag(e)){if(t instanceof ug)return new rg(t,e);throw sv("To use ref(service, url), the first argument must be a Storage instance.")}return function t(e,n){if(e instanceof ug){var r=e;if(null==r._bucket)throw new nv("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var i=new rg(r,r._bucket);return null!=n?t(i,n):i}if(void 0!==n){if(n.includes(".."))throw sv('`path` param cannot contain ".."');return og(e,n)}return e}(t,e)}(t=Object(i.getModularInstance)(t),e)}var lg=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),hg=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new lg(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new lg(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"==typeof e?function(t){return e(new lg(t,i,i._ref))}:{next:e.next?function(t){return e.next(new lg(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),fg=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new dg(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new dg(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),dg=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(function(t,e){return og(t,e)}(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new hg(function(t,e,n){return function(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new ng(t,new Lv(e),n)}(t=Object(i.getModularInstance)(t),e,n)}(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){void 0===e&&(e=fv.RAW),this._throwIfRoot("putString");var r=pv(e,t),i=Object(ar.__assign)({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new hg(new ng(this._delegate,new Lv(r.data,!0),i),this)},t.prototype.listAll=function(){var t,e=this;return(t=this._delegate,function(t){var e={prefixes:[],items:[]};return function t(e,n,r){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var i,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return[4,ig(e,{pageToken:r})];case 1:return i=s.sent(),(o=n.prefixes).push.apply(o,i.prefixes),(a=n.items).push.apply(a,i.items),null==i.nextPageToken?[3,3]:[4,t(e,n,i.nextPageToken)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}(t,e).then((function(){return e}))}(t=Object(i.getModularInstance)(t))).then((function(t){return new fg(t,e.storage)}))},t.prototype.list=function(t){var e=this;return function(t,e){return ig(t=Object(i.getModularInstance)(t),e)}(this._delegate,t||void 0).then((function(t){return new fg(t,e.storage)}))},t.prototype.getMetadata=function(){return t=this._delegate,function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getMetadata"),e=Xv(t.storage,t._location,Bv()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}(t=Object(i.getModularInstance)(t));var t},t.prototype.updateMetadata=function(t){return function(t,e){return function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("updateMetadata"),n=function(t,e,n,r){var i=Nv(e.fullServerUrl(),t.host),o=Wv(n,r),a=t.maxOperationRetryTime,s=new Hv(i,"PATCH",zv(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=Yv(e),s}(t.storage,t._location,e,Bv()),[4,t.storage.makeRequestWithTokens(n)];case 1:return[2,r.sent().getPromise()]}}))}))}(t=Object(i.getModularInstance)(t),e)}(this._delegate,t)},t.prototype.getDownloadURL=function(){return t=this._delegate,function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getDownloadURL"),e=function(t,e,n){var r=Nv(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new Hv(r,"GET",function(t,e){return function(n,r){var i=Kv(t,r,e);return Gv(null!==i),function(t,e,n){var r=Mv(e);if(null===r)return null;if(!Sv(r.downloadTokens))return null;var i=r.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map((function(e){var r=t.fullPath;return Nv("/b/"+o(t.bucket)+"/o/"+o(r),n)+Pv({alt:"media",token:e})}))[0]}(i,r,t.host)}}(t,n),i);return o.errorHandler=Yv(e),o}(t.storage,t._location,Bv()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise().then((function(t){if(null===t)throw new nv("no-download-url","The given file does not have any download URLs.");return t}))]}}))}))}(t=Object(i.getModularInstance)(t));var t},t.prototype.delete=function(){return this._throwIfRoot("delete"),t=this._delegate,function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("deleteObject"),e=function(t,e){var n=Nv(e.fullServerUrl(),t.host),r=new Hv(n,"DELETE",(function(t,e){}),t.maxOperationRetryTime);return r.successCodes=[200,204],r.errorHandler=Yv(e),r}(t.storage,t._location),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}(t=Object(i.getModularInstance)(t));var t},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw cv(t)},t}(),pg=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(ag(t))throw sv("ref() expected a child path but got a URL, use refFromURL instead.");return new dg(cg(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!ag(t))throw sv("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Ev.makeFromUrl(t,this._delegate.host)}catch(yd){throw sv("refFromUrl() expected a valid full URL but got an invalid one.")}return new dg(cg(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t.prototype.useEmulator=function(t,e){!function(t,e,n){t.host="http://"+e+":"+n}(this._delegate,t,e)},t}();function vg(t,e){var n=e.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new pg(i,new ug(i,o,a,new Tv,n,r.default.SDK_VERSION))}!function(t){var e={TaskState:_v,TaskEvent:mv,StringFormat:fv,Storage:ug,Reference:dg};t.INTERNAL.registerComponent(new wd.Component("storage",vg,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.5.2")}(r.default);var gg,yg,mg,_g=((gg={})["trace started"]="Trace {$traceName} was started before.",gg["trace stopped"]="Trace {$traceName} is not running.",gg["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",gg["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",gg["no window"]="Window is not available.",gg["no app id"]="App id is not available.",gg["no project id"]="Project id is not available.",gg["no api key"]="Api key is not available.",gg["invalid cc log"]="Attempted to queue invalid cc event",gg["FB not default"]="Performance can only start when Firebase app instance is the default one.",gg["RC response not ok"]="RC response is not ok",gg["invalid attribute name"]="Attribute name {$attributeName} is invalid.",gg["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",gg["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",gg["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",gg),bg=new i.ErrorFactory("performance","Performance",_g),wg=new o.Logger("Performance");wg.logLevel=o.LogLevel.INFO;var Ig,Tg=function(){function t(t){if(this.window=t,!t)throw bg.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!Object(i.isIndexedDBAvailable)()||(wg.info("IndexedDB is not supported by current browswer"),!1):(wg.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++)e(r[n])})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===yg&&(yg=new t(mg)),yg},t}();function Eg(t,e){var n=t.length-e.length;if(n<0||n>1)throw bg.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var Og,Sg=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Eg("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Eg("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw bg.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw bg.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw bg.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===Ig&&(Ig=new t),Ig},t}();function Cg(){return Og}var kg=function(t){return t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN",t}({}),Ag=["firebase_","google_","ga_"],Ng=new RegExp("^[a-zA-Z]\\w*$");function Pg(){var t=Tg.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function jg(){switch(Tg.getInstance().document.visibilityState){case"visible":return kg.VISIBLE;case"hidden":return kg.HIDDEN;default:return kg.UNKNOWN}}function Rg(){var t=Tg.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function xg(t){if(!t)return t;var e=Sg.getInstance(),n=t.entries||{};return e.loggingEnabled=void 0===n.fpr_enabled||"true"===String(n.fpr_enabled),n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=Dg(e.tracesSamplingRate),e.logNetworkAfterSampling=Dg(e.networkRequestsSamplingRate),t}function Dg(t){return Math.random()<=t}var Lg,Mg=1;function Fg(){return Mg=2,Lg=Lg||function(){var t=Tg.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return(t=Sg.getInstance().installationsService.getId()).then((function(t){Og=t})),t;var t})).then((function(t){return function(t){var e=function(){var t=Tg.getInstance().localStorage;if(t){var e=t.getItem("@firebase/performance/configexpire");if(e&&Number(e)>Date.now()){var n=t.getItem("@firebase/performance/config");if(n)try{return JSON.parse(n)}catch(r){return}}}}();return e?(xg(e),Promise.resolve()):function(t){return(e=Sg.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+Sg.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+Sg.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:Sg.getInstance().getAppId(),app_version:"0.4.12",sdk_version:"0.0.1"})});return fetch(r).then((function(t){if(t.ok)return t.json();throw bg.create("RC response not ok")}))})).catch((function(){wg.info("Could not fetch config, will use default configs")}));var e}(t).then(xg).then((function(t){return function(t){var e=Tg.getInstance().localStorage;t&&e&&(e.setItem("@firebase/performance/config",JSON.stringify(t)),e.setItem("@firebase/performance/configexpire",String(Date.now()+60*Sg.getInstance().configTimeToLive*60*1e3)))}(t)}),(function(){}))}(t)})).then((function(){return Ug()}),(function(){return Ug()}))}function Ug(){Mg=3}var qg,Vg=3,Bg=[],Kg=!1;function Wg(t){if(!t.eventTime||!t.message)throw bg.create("invalid cc log");Bg=Object(ar.__spreadArray)(Object(ar.__spreadArray)([],Bg),[t])}function Hg(t,e){qg||(qg=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=t.apply(void 0,e);Wg({message:r,eventTime:Date.now()})}}(Qg)),qg(t,e)}function Gg(t){var e=Sg.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&Tg.getInstance().requiredApisAvailable()&&(t.isAuto&&jg()!==kg.VISIBLE||(3===Mg?zg(t):Fg().then((function(){return zg(t)}),(function(){return zg(t)}))))}function zg(t){if(Cg()){var e=Sg.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return Hg(t,1)}),0)}}function Qg(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:Yg(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:Yg(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function Yg(){return{google_app_id:Sg.getInstance().getAppId(),app_instance_id:Cg(),web_app_info:{sdk_version:"0.4.12",page_url:Tg.getInstance().getUrl(),service_worker_status:Pg(),visibility_state:jg(),effective_connection_type:Rg()},application_process_state:0}}var Xg=["_fp","_fcp","_fid"],Jg=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=Tg.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw bg.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw bg.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Gg(this)},t.prototype.record=function(t,e,n){if(t<=0)throw bg.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw bg.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Object(ar.__assign)({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}Gg(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),this.putMetric(t,void 0===this.counters[t]?e:this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(o=this.name,0===(i=t).length||i.length>100||!(o&&o.startsWith("_wt_")&&Xg.indexOf(i)>-1)&&i.startsWith("_"))throw bg.create("invalid custom metric name",{customMetricName:t});var n,r,i,o;this.counters[t]=(n=e,(r=Math.floor(n))<n&&wg.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>40||Ag.some((function(t){return n.startsWith(t)}))||!n.match(Ng)),i=function(t){return 0!==t.length&&t.length<=100}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw bg.create("invalid attribute name",{attributeName:t});if(!i)throw bg.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return Object(ar.__assign)({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=Tg.getInstance().getUrl();if(i){var o=new t("_wt_"+i,!0),a=Math.floor(1e3*Tg.getInstance().getTimeOrigin());if(o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var s=n.find((function(t){return"first-paint"===t.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric("_fcp",Math.floor(1e3*u.startTime)),r&&o.putMetric("_fid",Math.floor(1e3*r))}Gg(o)}},t.createUserTimingTrace=function(e){Gg(new t(e,!1,e))},t}();function $g(t){var e=t;if(e&&void 0!==e.responseStart){var n=Tg.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=Sg.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return Hg(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function Zg(){Cg()&&(setTimeout((function(){return function(){var t=Tg.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){Jg.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),Jg.createOobTrace(e,n,t))}))}else Jg.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=Tg.getInstance(),e=0,n=t.getEntriesByType("resource");e<n.length;e++)$g(n[e]);t.setupObserver("resource",$g)}()}),0),setTimeout((function(){return function(){for(var t=Tg.getInstance(),e=0,n=t.getEntriesByType("measure");e<n.length;e++)ty(n[e]);t.setupObserver("measure",ty)}()}),0))}function ty(t){var e=t.name;"FB-PERF-TRACE-MEASURE"!==e.substring(0,"FB-PERF-TRACE-MEASURE".length)&&Jg.createUserTimingTrace(e)}var ey=function(){function t(t){this.app=t,Tg.getInstance().requiredApisAvailable()&&Object(i.validateIndexedDBOpenable)().then((function(t){t&&(Kg||(function t(e){setTimeout((function(){var e,n;if(0!==Vg)return Bg.length?(n=(e=Bg.splice(0,1e3)).map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}})),void function(e,n){return function(t){var e=Sg.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(e).then((function(t){return t.ok||wg.info("Call to Firebase backend failed."),t.json()})).then((function(e){var r=Number(e.nextRequestWaitMillis),i=1e4;isNaN(r)||(i=Math.max(r,i));var o=e.logResponseDetails;Array.isArray(o)&&o.length>0&&"RETRY_REQUEST_LATER"===o[0].responseAction&&(Bg=Object(ar.__spreadArray)(Object(ar.__spreadArray)([],n),Bg),wg.info("Retry transport request later.")),Vg=3,t(i)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Sg.getInstance().logSource,log_event:n},e).catch((function(){Bg=Object(ar.__spreadArray)(Object(ar.__spreadArray)([],e),Bg),Vg--,wg.info("Tries left: "+Vg+"."),t(1e4)}))):t(1e4)}),e)}(5500),Kg=!0),Fg().then(Zg,Zg))})).catch((function(t){wg.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new Jg(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return Sg.getInstance().instrumentationEnabled},set:function(t){Sg.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return Sg.getInstance().dataCollectionEnabled},set:function(t){Sg.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){t.INTERNAL.registerComponent(new wd.Component("performance",(function(t){return function(t,e){if("[DEFAULT]"!==t.name)throw bg.create("FB not default");if("undefined"==typeof window)throw bg.create("no window");return function(t){mg=t}(window),Sg.getInstance().firebaseAppInstance=t,Sg.getInstance().installationsService=e,new ey(t)}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC")),t.registerVersion("@firebase/performance","0.4.12")}(r.default);var ny,ry="https://www.googletagmanager.com/gtag/js",iy=function(t){return t.EVENT="event",t.SET="set",t.CONFIG="config",t}({}),oy=function(t){return t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results",t}({}),ay=new o.Logger("@firebase/analytics");function sy(t,e,n,r,i,o){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var a,s,u,c;return Object(ar.__generator)(this,(function(l){switch(l.label){case 0:a=r[i],l.label=1;case 1:return l.trys.push([1,7,,8]),a?[4,e[a]]:[3,3];case 2:return l.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return s=l.sent(),(u=s.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:l.sent(),l.label=6;case 6:return[3,8];case 7:return c=l.sent(),ay.error(c),[3,8];case 8:return t(iy.CONFIG,i,o),[2]}}))}))}function uy(t,e,n,r,i){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c,l,h;return Object(ar.__generator)(this,(function(f){switch(f.label){case 0:return f.trys.push([0,4,,5]),o=[],i&&i.send_to?(a=i.send_to,Array.isArray(a)||(a=[a]),[4,Promise.all(n)]):[3,2];case 1:for(s=f.sent(),u=function(t){var n=s.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,l=a;c<l.length&&"break"!==u(l[c]);c++);f.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return f.sent(),t(iy.EVENT,r,i||{}),[3,5];case 4:return h=f.sent(),ay.error(h),[3,5];case 5:return[2]}}))}))}var cy=((ny={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",ny["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",ny["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",ny["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",ny["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",ny["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",ny["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",ny["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',ny["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',ny),ly=new i.ErrorFactory("analytics","Analytics",cy),hy=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function fy(t){var e;return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Object(ar.__generator)(this,(function(u){switch(u.label){case 0:return n=t.appId,r={method:"GET",headers:(c=t.apiKey,new Headers({Accept:"application/json","x-goog-api-key":c}))},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(i,r)];case 1:if(200===(o=u.sent()).status||304===o.status)return[3,6];a="",u.label=2;case 2:return u.trys.push([2,4,,5]),[4,o.json()];case 3:return s=u.sent(),(null===(e=s.error)||void 0===e?void 0:e.message)&&(a=s.error.message),[3,5];case 4:return u.sent(),[3,5];case 5:throw ly.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a});case 6:return[2,o.json()]}var c}))}))}function dy(t,e,n,r){var o=e.throttleEndTimeMillis,a=e.backoffCount;return void 0===r&&(r=hy),Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,s,u,c,l,h,f;return Object(ar.__generator)(this,(function(d){switch(d.label){case 0:e=t.appId,s=t.measurementId,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,py(n,o)];case 2:return d.sent(),[3,4];case 3:if(u=d.sent(),s)return ay.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+u.message+"]"),[2,{appId:e,measurementId:s}];throw u;case 4:return d.trys.push([4,6,,7]),[4,fy(t)];case 5:return c=d.sent(),r.deleteThrottleMetadata(e),[2,c];case 6:if(!function(t){if(!(t instanceof i.FirebaseError&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l=d.sent())){if(r.deleteThrottleMetadata(e),s)return ay.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+l.message+"]"),[2,{appId:e,measurementId:s}];throw l}return h=503===Number(l.customData.httpStatus)?Object(i.calculateBackoffMillis)(a,r.intervalMillis,30):Object(i.calculateBackoffMillis)(a,r.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:a+1},r.setThrottleMetadata(e,f),ay.debug("Calling attemptFetch again in "+h+" millis"),[2,dy(t,f,n,r)];case 7:return[2]}}))}))}function py(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(ly.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var vy,gy,yy=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),my={},_y=[],by={},wy="dataLayer",Iy="gtag",Ty=!1;function Ey(t){if(Ty)throw ly.create("already-initialized");t.dataLayerName&&(wy=t.dataLayerName),t.gtagName&&(Iy=t.gtagName)}function Oy(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){switch(t.label){case 0:if(Object(i.isBrowserExtension)())return[2,!1];if(!Object(i.areCookiesEnabled)())return[2,!1];if(!Object(i.isIndexedDBAvailable)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Object(i.validateIndexedDBOpenable)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new wd.Component("analytics",(function(t){return function(t,e){!function(){var t=[];if(Object(i.isBrowserExtension)()&&t.push("This is a browser extension environment."),Object(i.areCookiesEnabled)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=ly.create("invalid-analytics-context",{errorInfo:e});ay.warn(n.message)}}();var n,r,o=t.options.appId;if(!o)throw ly.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw ly.create("no-api-key");ay.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=my[o])throw ly.create("already-exists",{id:o});if(!Ty){n=wy,r=[],Array.isArray(window[n])?r=window[n]:window[n]=r;var a=function(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,a){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var s;return Object(ar.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==iy.EVENT?[3,2]:[4,uy(t,e,n,o,a)];case 1:return u.sent(),[3,5];case 2:return i!==iy.CONFIG?[3,4]:[4,sy(t,e,n,r,o,a)];case 3:return u.sent(),[3,5];case 4:t(iy.SET,o),u.label=5;case 5:return[3,7];case 6:return s=u.sent(),ay.error(s),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}(my,_y,by,wy,Iy);gy=a.wrappedGtag,vy=a.gtagCore,Ty=!0}return my[o]=function(t,e,n,r,o,a){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var s,u,c,l,h,f,d;return Object(ar.__generator)(this,(function(p){switch(p.label){case 0:return(s=function(t,e,n){return void 0===e&&(e=hy),Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u=this;return Object(ar.__generator)(this,(function(c){if(i=(n=t.options).apiKey,o=n.measurementId,!(r=n.appId))throw ly.create("no-app-id");if(!i){if(o)return[2,{measurementId:o,appId:r}];throw ly.create("no-api-key")}return a=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},s=new yy,setTimeout((function(){return Object(ar.__awaiter)(u,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){return s.abort(),[2]}))}))}),6e4),[2,dy({appId:r,apiKey:i,measurementId:o},a,s,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&ay.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return ay.error(t)})),e.push(s),u=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t;return Object(ar.__generator)(this,(function(e){switch(e.label){case 0:return Object(i.isIndexedDBAvailable)()?[3,1]:(ay.warn(ly.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,Object(i.validateIndexedDBOpenable)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),ay.warn(ly.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([s,u])];case 1:return c=p.sent(),l=c[0],h=c[1],function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(ry))return r}return null}()||function(t,e){var n=document.createElement("script");n.src=ry+"?l="+t+"&id="+e,n.async=!0,document.head.appendChild(n)}(a,l.measurementId),o("js",new Date),(d={}).origin="firebase",d.update=!0,f=d,null!=h&&(f.firebase_id=h),o(iy.CONFIG,l.measurementId,f),[2,l.measurementId]}}))}))}(t,_y,by,e,vy,wy),{app:t,logEvent:function(t,e,n){(function(t,e,n,r,i){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return i&&i.global?(t(iy.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=s.sent(),a=Object(ar.__assign)(Object(ar.__assign)({},r),{send_to:o}),t(iy.EVENT,n,a),s.label=3;case 3:return[2]}}))}))})(gy,my[o],t,e,n).catch((function(t){return ay.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(iy.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(iy.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(gy,my[o],t,e).catch((function(t){return ay.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var i;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(iy.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(iy.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(gy,my[o],t,e).catch((function(t){return ay.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u;return Object(ar.__generator)(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,a=Object.keys(n);o<a.length;o++)i["user_properties."+(s=a[o])]=n[s];return t(iy.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(iy.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(gy,my[o],t,e).catch((function(t){return ay.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(my[o],t).catch((function(t){return ay.error(t)}))},INTERNAL:{delete:function(){return delete my[o],Promise.resolve()}}}}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:Ey,EventName:oy,isSupported:Oy})),t.INTERNAL.registerComponent(new wd.Component("analytics-internal",(function(t){try{return{logEvent:t.getProvider("analytics").getImmediate().logEvent}}catch(yd){throw ly.create("interop-component-reg-failed",{reason:yd})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.10")}(r.default);var Sy,Cy=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=a.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},t}(),ky=((Sy={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",Sy["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",Sy["registration-api-key"]="Undefined API key. Check Firebase app initialization.",Sy["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",Sy["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",Sy["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",Sy["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",Sy["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",Sy["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",Sy["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',Sy["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',Sy["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",Sy["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",Sy),Ay=new i.ErrorFactory("remoteconfig","Remote Config",ky),Ny=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l,h,f,d,p,v,g;return Object(ar.__generator)(this,(function(y){switch(y.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=y.sent(),n=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",r=n+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,i={sdk_version:this.sdkVersion,app_instance_id:e[0],app_instance_id_token:e[1],app_id:this.appId,language_code:(void 0===m&&(m=navigator),m.languages&&m.languages[0]||m.language)},o={method:"POST",headers:{"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},body:JSON.stringify(i)},a=fetch(r,o),s=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),y.label=2;case 2:return y.trys.push([2,5,,6]),[4,Promise.race([a,s])];case 3:return y.sent(),[4,a];case 4:return u=y.sent(),[3,6];case 5:throw c=y.sent(),l="fetch-client-network","AbortError"===c.name&&(l="fetch-timeout"),Ay.create(l,{originalErrorMessage:c.message});case 6:if(h=u.status,f=u.headers.get("ETag")||void 0,200!==u.status)return[3,11];v=void 0,y.label=7;case 7:return y.trys.push([7,9,,10]),[4,u.json()];case 8:return v=y.sent(),[3,10];case 9:throw g=y.sent(),Ay.create("fetch-client-parse",{originalErrorMessage:g.message});case 10:d=v.entries,p=v.state,y.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===p?h=500:"NO_CHANGE"===p?h=304:"NO_TEMPLATE"!==p&&"EMPTY_CONFIG"!==p||(d={}),304!==h&&200!==h)throw Ay.create("fetch-status",{httpStatus:h});return[2,{status:h,eTag:f,config:d}]}var m}))}))},t}(),Py=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),jy=["1","true","t","yes","y","on"],Ry=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&jy.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),xy=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=o.LogLevel.DEBUG;break;case"silent":this._logger.logLevel=o.LogLevel.SILENT;break;default:this._logger.logLevel=o.LogLevel.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e,n;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),n=t[1],(e=t[0])&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r=this;return Object(ar.__generator)(this,(function(o){switch(o.label){case 0:t=new Py,setTimeout((function(){return Object(ar.__awaiter)(r,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return o.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return o.sent(),[3,6];case 4:return e=o.sent(),n=function(t,e){return t instanceof i.FirebaseError&&-1!==t.code.indexOf("fetch-throttle")}(e)?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw o.sent(),e;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){return Object(ar.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t,e,n=this;return(t=this._storageCache.getActiveConfig(),e=this.defaultConfig,void 0===t&&(t={}),void 0===e&&(e={}),Object.keys(Object(ar.__assign)(Object(ar.__assign)({},t),e))).reduce((function(t,e){return t[e]=n.getValue(e),t}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new Ry("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new Ry("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new Ry("static"))},t}();function Dy(t,e){var n=t.target.error||void 0;return Ay.create(e,{originalErrorMessage:n&&n.message})}var Ly=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(Dy(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore("app_namespace_store",{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction(["app_namespace_store"],"readonly").objectStore("app_namespace_store"),a=n.createCompositeKey(t);try{var s=o.get(a);s.onerror=function(t){i(Dy(t,"storage-get"))},s.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(yd){i(Ay.create("storage-get",{originalErrorMessage:yd&&yd.message}))}}))]}}))}))},t.prototype.set=function(t,e){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(ar.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction(["app_namespace_store"],"readwrite").objectStore("app_namespace_store"),s=r.createCompositeKey(t);try{var u=a.put({compositeKey:s,value:e});u.onerror=function(t){o(Dy(t,"storage-set"))},u.onsuccess=function(){i()}}catch(yd){o(Ay.create("storage-set",{originalErrorMessage:yd&&yd.message}))}}))]}}))}))},t.prototype.delete=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return Object(ar.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction(["app_namespace_store"],"readwrite").objectStore("app_namespace_store"),a=n.createCompositeKey(t);try{var s=o.delete(a);s.onerror=function(t){i(Dy(t,"storage-delete"))},s.onsuccess=function(){r()}}catch(yd){i(Ay.create("storage-delete",{originalErrorMessage:yd&&yd.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),My=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i,o;return Object(ar.__generator)(this,(function(a){switch(a.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=a.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=a.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=a.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function Fy(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(Ay.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Uy,qy=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e;return Object(ar.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return Object(ar.__awaiter)(this,void 0,void 0,(function(){var e,o,a;return Object(ar.__generator)(this,(function(s){switch(s.label){case 0:return[4,Fy(t.signal,n)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof i.FirebaseError&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(o=s.sent()))throw o;return a={throttleEndTimeMillis:Date.now()+Object(i.calculateBackoffMillis)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(a)];case 6:return s.sent(),[2,this.attemptFetch(t,a)];case 7:return[2]}}))}))},t}();(Uy=r.default).INTERNAL.registerComponent(new wd.Component("remoteConfig",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw Ay.create("registration-window");var a=r.options,s=a.projectId,u=a.apiKey,c=a.appId;if(!s)throw Ay.create("registration-project-id");if(!u)throw Ay.create("registration-api-key");if(!c)throw Ay.create("registration-app-id");var l=new Ly(c,r.name,n=n||"firebase"),h=new My(l),f=new o.Logger("@firebase/remote-config");f.logLevel=o.LogLevel.ERROR;var d=new Ny(i,Uy.SDK_VERSION,n,s,u,c),p=new qy(d,l),v=new Cy(p,l,h,f),g=new xy(r,v,h,l,f);return g.ensureInitialized(),g}),"PUBLIC").setMultipleInstances(!0)),Uy.registerVersion("@firebase/remote-config","0.1.37"),n("X8/r"),r.default.registerVersion("firebase","8.6.2","app"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),r.default.registerVersion("firebase","8.6.2");var Vy=n("AytR"),By=n("8Y7J"),Ky=n("sZkV");let Wy=(()=>{class t{constructor(t){this.platform=t,this.config=Vy.a.config,this.appname=Vy.a.appname,this.platform.ready().then(()=>{0==r.default.apps.length&&r.default.initializeApp(this.config)})}getMetaInfo(t){r.default.database().ref(this.appname+"/metainfo").once("value").then((function(e){let n=e.val();t(n)}))}insertMetaInfo(t){r.default.database().ref(this.appname+"/metainfo").set(t)}deleteData(t,e){r.default.database().ref(this.appname+"/data/"+t+"/").remove((function(t){e(t?JSON.stringify(t):"Sikeresen t\xf6r\xf6lve!!!")}))}getBigFish(t){r.default.database().ref(this.appname+"/bigfish").once("value").then((function(e){let n=e.val();t(n)}))}insertBigFish(t){r.default.database().ref(this.appname+"/bigfish/").set(t)}saveSponser(t){r.default.database().ref(this.appname+"/sponser/").set(t)}insertClickedTime(t){var e=(new Date).toISOString().split("T")[0]+" "+(new Date).toTimeString().split("GMT")[0].trim();r.default.database().ref(this.appname+"/timestamp/").set(e).then((function(e){t("ok")}))}insertSektorCount(t){r.default.database().ref(this.appname+"/sektors/").set(t)}gettSektorCount(){r.default.database().ref(this.appname+"/sektors/").once("value").then(t=>{alert(t.val())})}getSponser(){return r.default.database().ref(this.appname+"/sponser/").once("value")}getClickedTime(t){r.default.database().ref(this.appname+"/timestamp").once("value").then((function(e){let n=e.val();t(n)}))}insertColName(t){r.default.database().ref(this.appname+"/colname/").set(t)}getData(t){r.default.database().ref(this.appname+"/data/").once("value").then((function(e){let n=e.val();t(n)}))}insertData(t,e){r.default.database().ref(this.appname+"/data/").set(t,(function(t){e(t?JSON.stringify(t):"Sikeresen mentve!!!")}))}}return t.\u0275fac=function(e){return new(e||t)(By.Nb(Ky.x))},t.\u0275prov=By.Cb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},mrSG:function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return o})),n.d(e,"__rest",(function(){return a})),n.d(e,"__decorate",(function(){return s})),n.d(e,"__param",(function(){return u})),n.d(e,"__metadata",(function(){return c})),n.d(e,"__awaiter",(function(){return l})),n.d(e,"__generator",(function(){return h})),n.d(e,"__createBinding",(function(){return f})),n.d(e,"__exportStar",(function(){return d})),n.d(e,"__values",(function(){return p})),n.d(e,"__read",(function(){return v})),n.d(e,"__spread",(function(){return g})),n.d(e,"__spreadArrays",(function(){return y})),n.d(e,"__spreadArray",(function(){return m})),n.d(e,"__await",(function(){return _})),n.d(e,"__asyncGenerator",(function(){return b})),n.d(e,"__asyncDelegator",(function(){return w})),n.d(e,"__asyncValues",(function(){return I})),n.d(e,"__makeTemplateObject",(function(){return T})),n.d(e,"__importStar",(function(){return O})),n.d(e,"__importDefault",(function(){return S})),n.d(e,"__classPrivateFieldGet",(function(){return C})),n.d(e,"__classPrivateFieldSet",(function(){return k}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var f=Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]};function d(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||f(e,t,n)}function p(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function m(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function b(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof _?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(r){l(o[0][3],r)}var n}function u(t){s("next",t)}function c(t){s("throw",t)}function l(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:_(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function I(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=p(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}function T(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var E=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function O(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&f(e,t,n);return E(e,t),e}function S(t){return t&&t.__esModule?t:{default:t}}function C(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}function k(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n}},nbvr:function(t,e,n){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){n(i=t[e].apply(t,r)).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new l(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function l(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function d(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function p(t){this._db=t}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(l,"_cursor",["direction","key","primaryKey","value"]),a(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(l.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new l(t,e._request)}))}))})})),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(h,"_store",["name","keyPath","indexNames","autoIncrement"]),a(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[h,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,h].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new d(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new p(t)}))},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)},"q/0M":function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.r(e),n.d(e,"LogLevel",(function(){return a})),n.d(e,"Logger",(function(){return h})),n.d(e,"setLogLevel",(function(){return f})),n.d(e,"setUserLogHandler",(function(){return d}));var o=[],a=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}({}),s={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},u=a.INFO,c=((i={})[a.DEBUG]="log",i[a.VERBOSE]="log",i[a.INFO]="info",i[a.WARN]="warn",i[a.ERROR]="error",i),l=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),a=c[e];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[a].apply(console,r(["["+o+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?s[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.DEBUG],t)),this._logHandler.apply(this,r([this,a.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.VERBOSE],t)),this._logHandler.apply(this,r([this,a.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.INFO],t)),this._logHandler.apply(this,r([this,a.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.WARN],t)),this._logHandler.apply(this,r([this,a.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.ERROR],t)),this._logHandler.apply(this,r([this,a.ERROR],t))},t}();function f(t){o.forEach((function(e){e.setLogLevel(t)}))}function d(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=s[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:a[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=o;r<i.length;r++)n(i[r])}},qOnz:function(t,e,n){"use strict";n.r(e),n.d(e,"CONSTANTS",(function(){return i})),n.d(e,"Deferred",(function(){return d})),n.d(e,"ErrorFactory",(function(){return P})),n.d(e,"FirebaseError",(function(){return N})),n.d(e,"MAX_VALUE_MILLIS",(function(){return at})),n.d(e,"RANDOM_FACTOR",(function(){return st})),n.d(e,"Sha1",(function(){return Q})),n.d(e,"areCookiesEnabled",(function(){return k})),n.d(e,"assert",(function(){return o})),n.d(e,"assertionError",(function(){return a})),n.d(e,"async",(function(){return J})),n.d(e,"base64",(function(){return u})),n.d(e,"base64Decode",(function(){return l})),n.d(e,"base64Encode",(function(){return c})),n.d(e,"calculateBackoffMillis",(function(){return ut})),n.d(e,"contains",(function(){return V})),n.d(e,"createMockUserToken",(function(){return p})),n.d(e,"createSubscribe",(function(){return Y})),n.d(e,"decode",(function(){return L})),n.d(e,"deepCopy",(function(){return h})),n.d(e,"deepExtend",(function(){return f})),n.d(e,"errorPrefix",(function(){return tt})),n.d(e,"extractQuerystring",(function(){return z})),n.d(e,"getGlobal",(function(){return A})),n.d(e,"getModularInstance",(function(){return lt})),n.d(e,"getUA",(function(){return v})),n.d(e,"isAdmin",(function(){return q})),n.d(e,"isBrowser",(function(){return m})),n.d(e,"isBrowserExtension",(function(){return _})),n.d(e,"isElectron",(function(){return w})),n.d(e,"isEmpty",(function(){return K})),n.d(e,"isIE",(function(){return I})),n.d(e,"isIndexedDBAvailable",(function(){return S})),n.d(e,"isMobileCordova",(function(){return g})),n.d(e,"isNode",(function(){return y})),n.d(e,"isNodeSdk",(function(){return E})),n.d(e,"isReactNative",(function(){return b})),n.d(e,"isSafari",(function(){return O})),n.d(e,"isUWP",(function(){return T})),n.d(e,"isValidFormat",(function(){return U})),n.d(e,"isValidTimestamp",(function(){return M})),n.d(e,"issuedAtTime",(function(){return F})),n.d(e,"jsonEval",(function(){return x})),n.d(e,"map",(function(){return W})),n.d(e,"ordinal",(function(){return ct})),n.d(e,"querystring",(function(){return H})),n.d(e,"querystringDecode",(function(){return G})),n.d(e,"safeGet",(function(){return B})),n.d(e,"stringLength",(function(){return ot})),n.d(e,"stringToByteArray",(function(){return it})),n.d(e,"stringify",(function(){return D})),n.d(e,"validateArgCount",(function(){return Z})),n.d(e,"validateCallback",(function(){return nt})),n.d(e,"validateContextObject",(function(){return rt})),n.d(e,"validateIndexedDBOpenable",(function(){return C})),n.d(e,"validateNamespace",(function(){return et}));var r=n("mrSG"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=(15&s)<<2|c>>6,h=63&c;u||(h=64,a||(l=64)),r.push(n[o>>2],n[(3&o)<<4|s>>4],n[l],n[h])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();r.push(o<<2|a>>4),64!==s&&(r.push(a<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){var e=s(t);return u.encodeByteArray(e,!0)},l=function(t){try{return u.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function h(t){return f(void 0,t)}function f(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=f(t[n],e[n]));return t}var d=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function p(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object(r.__assign)({iss:"https://securetoken.google.com/"+n,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[u.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),u.encodeString(JSON.stringify(a),!1),""].join(".")}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function g(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())}function y(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}function m(){return"object"==typeof self&&self.self===self}function _(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function b(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function w(){return v().indexOf("Electron/")>=0}function I(){var t=v();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function T(){return v().indexOf("MSAppHost/")>=0}function E(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN}function O(){return!y()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function S(){return"indexedDB"in self&&null!=indexedDB}function C(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(o){e(o)}}))}function k(){return!(!navigator||!navigator.cookieEnabled)}function A(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}var N=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,P.prototype.create),o}return Object(r.__extends)(e,t),e}(Error),P=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?j(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new N(i,s,r);return u},t}();function j(t,e){return t.replace(R,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var R=/\{\$([^}]+)}/g;function x(t){return JSON.parse(t)}function D(t){return JSON.stringify(t)}var L=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=x(l(o[0])||""),n=x(l(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:e,claims:n,data:r,signature:i}},M=function(t){var e=L(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},F=function(t){var e=L(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},U=function(t){var e=L(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},q=function(t){var e=L(t).claims;return"object"==typeof e&&!0===e.admin};function V(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function B(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function K(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function W(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function H(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}function G(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("="),r=n[1];e[decodeURIComponent(n[0])]=decodeURIComponent(r)}})),e}function z(t){var e=t.indexOf("?");if(!e)return"";var n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}var Q=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var i,o,a=this.chain_[0],s=this.chain_[1],u=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=c^s&(u^c),o=1518500249):(i=s^u^c,o=1859775393):r<60?(i=s&u|c&(s|u),o=2400959708):(i=s^u^c,o=3395469782);var h=(a<<5|a>>>27)+i+l+o+n[r]&4294967295;l=c,c=u,u=4294967295&(s<<30|s>>>2),s=a,a=h}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function Y(t,e){var n=new X(t,e);return n.subscribe.bind(n)}var X=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=$),void 0===r.error&&(r.error=$),void 0===r.complete&&(r.complete=$);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function J(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}}function $(){}var Z=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function tt(t,e){return t+" failed: "+e+" argument "}function et(t,e,n){if((!n||e)&&"string"!=typeof e)throw new Error(tt(t,"namespace")+"must be a valid firebase namespace.")}function nt(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(tt(t,e)+"must be a valid function.")}function rt(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(tt(t,e)+"must be a valid context object.")}var it=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},ot=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},at=144e5,st=.5;function ut(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(st*r*(Math.random()-.5)*2);return Math.min(at,r+i)}function ct(t){return Number.isFinite(t)?t+function(t){var e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";var n=t%10;return 1===n?"st":2===n?"nd":3===n?"rd":"th"}(t):""+t}function lt(t){return t&&t._delegate?t._delegate:t}},zIRd:function(t,e,n){"use strict";n.r(e),n.d(e,"firebase",(function(){return _}));var r,i,o=n("mrSG"),a=n("qOnz"),s=n("/6Yf"),u=n("q/0M"),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),l=new a.ErrorFactory("app","Firebase",c),h="@firebase/app",f=((i={})[h]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/app-check"]="fire-app-check",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),d=new u.Logger("@firebase/app"),p=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Object(a.deepCopy)(t),this.container=new s.ComponentContainer(e.name),this._addComponent(new s.Component("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){d.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();p.prototype.name&&p.prototype.options||p.prototype.delete||console.log("dc");var v=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name="[DEFAULT]");var s=o.name;if("string"!=typeof s||!s)throw l.create("bad-app-name",{appName:String(s)});if(Object(a.contains)(e,s))throw l.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=f[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),u=e.match(/\s|\//);if(a||u){var c=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&u&&c.push("and"),u&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void d.warn(c.join(" "))}o(new s.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw l.create("invalid-log-argument");Object(u.setUserLogHandler)(t,e)},apps:null,SDK_VERSION:"8.6.1",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||"[DEFAULT]",!Object(a.contains)(e,t))throw l.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return d.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var u=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw l.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&Object(a.deepExtend)(u,o.serviceProps),r[s]=u,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var c=0,h=Object.keys(e);c<h.length;c++)e[h[c]]._addComponent(o);return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(p);return e.INTERNAL=Object(o.__assign)(Object(o.__assign)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Object(a.deepExtend)(e,t)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),e}(),g=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if(Object(a.isBrowser)()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var y=self.firebase.SDK_VERSION;y&&y.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var m=v.initializeApp;v.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Object(a.isNode)()&&d.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),m.apply(void 0,t)};var _=v;!function(t,e){t.INTERNAL.registerComponent(new s.Component("platform-logger",(function(t){return new g(t)}),"PRIVATE")),t.registerVersion(h,"0.6.22",void 0),t.registerVersion("fire-js","")}(_),e.default=_}}]);